<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Computing Quantal Response Equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="12 Computing Quantal Response Equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Computing Quantal Response Equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Computing Quantal Response Equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-03-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"/>
<link rel="next" href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>8</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="8.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>8.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="8.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>8.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="8.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>8.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="8.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>8.4</b> Vectorization</a></li>
<li class="chapter" data-level="8.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>8.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="8.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>8.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>8.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="8.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>8.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>8.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>8.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="8.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>8.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="9" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>9</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>9.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="9.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>9.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="9.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>9.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>9.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="9.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>9.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="9.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results"><i class="fa fa-check"></i><b>9.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>9.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>9.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="9.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>9.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="9.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>9.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>9.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>9.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="9.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>9.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="9.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>10</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>10.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="10.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>10.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>10.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="10.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>10.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>10.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>11</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="11.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>11.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="11.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>11.2</b> The likelihood function</a></li>
<li class="chapter" data-level="11.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>11.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="11.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-2"><i class="fa fa-check"></i><b>11.4</b> Results</a></li>
<li class="chapter" data-level="11.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>11.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>12</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="12.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>12.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="12.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>12.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>12.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="12.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>12.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="12.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>12.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="12.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>12.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>12.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="12.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>12.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>12.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="12.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>12.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="12.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>12.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>13</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>13.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="13.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>13.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>13.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="13.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>13.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="13.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>13.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="13.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-3"><i class="fa fa-check"></i><b>13.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>13.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>14</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models"><i class="fa fa-check"></i><b>14.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="14.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>14.2</b> A note on replication</a></li>
<li class="chapter" data-level="14.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>14.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>14.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="14.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>14.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="14.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>14.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-4"><i class="fa fa-check"></i><b>14.4</b> Results</a></li>
<li class="chapter" data-level="14.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>14.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>15</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>15.1</b> Data and game</a></li>
<li class="chapter" data-level="15.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>15.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>15.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="15.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>15.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>15.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>15.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="15.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>15.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="15.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-5"><i class="fa fa-check"></i><b>15.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>15.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>15.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="15.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>15.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>15.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="15.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>15.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="15.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>15.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="15.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>15.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="15.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>15.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="15.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>15.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="15.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>15.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="15.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>15.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="15.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>15.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="15.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>15.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="15.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>15.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="15.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>15.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>15.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="15.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>15.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="15.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>15.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="15.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>15.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="15.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>15.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>16</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>16.1</b> Example dataset</a></li>
<li class="chapter" data-level="16.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>16.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="16.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>16.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>16.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="16.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>16.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="16.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>16.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>16.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>16.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="16.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>16.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>16.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>17</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>17.1</b> Data</a></li>
<li class="chapter" data-level="17.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>17.2</b> A basic model</a></li>
<li class="chapter" data-level="17.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>17.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="17.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>17.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="17.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>17.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="17.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>17.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>18</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>18.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="18.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>18.2</b> Computational issues</a></li>
<li class="chapter" data-level="18.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>18.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="18.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>18.4</b> A representative agent model</a></li>
<li class="chapter" data-level="18.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>18.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="18.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>18.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="computing-quantal-response-equilibrium" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Computing Quantal Response Equilibrium<a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Quantal response equilibrium <span class="citation">(<a href="#ref-McKelvey1995">McKelvey and Palfrey 1995</a>)</span> is an extension of Nash equilibrium that replaces the concept of a best response with a <em>probabilistic</em> best response. That is, instead of choosing an action that is in their best response correspondence, players assign positive probability to all of their actions in a game, and are more likely to take actions that yield greater utility. This extension offers some big advantages over Nash equilibrium when structurally analyzing data from economic experiments. Firstly, the idea of a <em>probabilistic</em> best response is <em>behaviorally plausible</em>. Just as we assume a probabilistic choice rule (like softmax) for individual choice experiments, the same reasons for using this in a game apply: people make mistakes, our model is probably mis-specified, and so on. Secondly, also for the same reasons we use them in individual choice experiments, the probabilistic choice rule permits us to use a likelihood. Otherwise one decision that goes against the prescription of the deterministic component of our model will make the likelihood zero everywhere, and so we cannot simulate a posterior. For games, this is especially a problem when players have a strictly dominated strategy, as these should never be played in equilibrium. Finally, Quantal Response Equilibrium has been shown to organize experimental data a lot better than Nash equilibrium. For example, it models well the “own payoff” effect observed in some games, where Nash equilibrium does not.</p>
<p>Compared to typical structural models for <em>individual</em> choice experiments, the challenges of estimating a Quantal Response Equilibrium model are somewhat unique. Individual choice experiments are sometimes difficult to estimate because it is difficult for our sampler to explore the posterior distribution implied by our likelihood and prior.<a href="#fn53" class="footnote-ref" id="fnref53"><sup>53</sup></a> While this problem is by no means ruled out for Quantal Response Equilibrium, its typical computational hurdles come from computing the fixed point condition associated with the equilibrium. I will therefore devote the entirety of this chapter to feasible methods for computing quantal response equilibrium, as this can really make the difference between a model being feasible to estimate or not. As such, this chapter will be more of a <em>computational</em> chapter and less of an <em>estimation</em> chapter. Fear not, I will follow up with a Quantal Response Equilibrium estimation chapter later.</p>
<div id="overview-of-quantal-response-equilibrium" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Overview of quantal response equilibrium<a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Quantal response equilibrium assumes that players <em>probabilistically</em> best respond to their opponents’ mixed strategies. We model this with a <em>probabilistic best response function</em>, which I will denote as <span class="math inline">\(q(\lambda,u_{i}(\sigma))\)</span>, where <span class="math inline">\(\lambda&gt;0\)</span> is a choice precision parameter, and <span class="math inline">\(u_{i,a}(\sigma)\)</span> is the expected utility to player <span class="math inline">\(i\)</span> of taking action <span class="math inline">\(a\)</span>, given that they are facing mixed strategy profile <span class="math inline">\(\sigma\)</span>. Holding <span class="math inline">\(\lambda\)</span> constant, <span class="math inline">\(q_i\)</span> takes a vector of expected utilities <span class="math inline">\(u_i(\sigma)\)</span>, and returns a probability distribution over actions in the player’s choice set, which itself is a vector of probabilities the same size as <span class="math inline">\(u_i(\sigma)\)</span>. Some popular choices of the functional form of <span class="math inline">\(q\)</span> include the logit or softmax specification:</p>
<p><span class="math display">\[
q_{i,a}(\lambda,u_i(\sigma))=\frac{\exp(\lambda u_{i,a}(\sigma))}{\sum_{b\in A_i}\exp(\lambda u_{i,b}(\sigma))}
\]</span></p>
<p>and the Luce specification:</p>
<p><span class="math display">\[
q_{i,a}(\lambda, u_i(\sigma))=\frac{u_{i,a}(\sigma)^\lambda}{\sum_{b\in A_i} u_{i,b}(\sigma)^\lambda}
\]</span></p>
<p>Note that both of these functions approach best response functions as <span class="math inline">\(\lambda\to\infty\)</span>. At the other end of the parameter space, <span class="math inline">\(\lambda=0\)</span>, players randomize uniformly over their action space.</p>
<p>The “equilibrium” part of Quantal Response Equilibrium comes from assuming that players have correct beliefs about their opponents’ mixed strategies. Mathematically then, the equilibrium condition is:</p>
<p><span class="math display" id="eq:QREfixedpoint">\[
\sigma_i=q_i(\lambda,u_i(\sigma))\quad \forall i\in \{1, 2, \ldots ,n\} \tag{12.1}
\]</span></p>
<p>That is, every equilibrium mixed strategy <span class="math inline">\(\sigma_i\)</span> is a probabilistic best response to the equilibrium mixed strategy profile <span class="math inline">\(\sigma\)</span>.</p>
</div>
<div id="computing-quantal-response-equilibrium-1" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> Computing Quantal Response Equilibrium<a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Finding a solution to <a href="computing-quantal-response-equilibrium.html#eq:QREfixedpoint">(12.1)</a> can be difficult because it is a fixed point condition: <span class="math inline">\(\sigma\)</span> appears on both the right- and left-hand side of the equation, and we typically cannot find a closed-form solution. Furthermore, we cannot be guaranteed that it is a contraction, so iterating the equation by first guessing a <span class="math inline">\(\sigma\)</span>, then computing the probabilistic best response profile, and then repeating, will not in general find a solution. A far more reliable way to compute Quantal Response Equilibrium is to use a <em>predictor-corrector</em> algorithm. This algorithm in the context of Quantal Response Equilibrium was developed in <span class="citation">Turocy (<a href="#ref-Turocy2005">2005</a>)</span> and <span class="citation">Turocy (<a href="#ref-Turocy2010">2010</a>)</span>, and is discussed in detail in <span class="citation">Bland and Turocy (<a href="#ref-BlandTurocy2023">2025</a>)</span>. This algorithm is also implemented in the software package <em>Gambit</em> <span class="citation">(<a href="#ref-Gambit">McKelvey, McLennan, and Turocy 2022</a>)</span>.</p>
<div id="setting-up-the-problem" class="section level3 hasAnchor" number="12.2.1">
<h3><span class="header-section-number">12.2.1</span> Setting up the problem<a href="computing-quantal-response-equilibrium.html#setting-up-the-problem" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While it might be more intuitive to think about solving <a href="computing-quantal-response-equilibrium.html#eq:QREfixedpoint">(12.1)</a> exactly as it is written in probability <em>levels</em>, you will likely run into some stability issues if you do. This is because for some games the algorithm will want to jump into “probabilities” that are either less than zero or greater than one. In practice, the problem is much more stable if we first translate <a href="computing-quantal-response-equilibrium.html#eq:QREfixedpoint">(12.1)</a> into <em>log</em>-probability <em>differences</em>. That is, we re-write this equation as:</p>
<p><span class="math display">\[
\begin{aligned}
0=H_{i,a}(\lambda,\sigma)&amp;=\log\sigma_{i,a}-\log\sigma_{i,a+1}-\left(\log q_{i,a}(\lambda,u_i(\sigma))-\log q_{i,a+1}(\lambda,u_i(\sigma))\right)\\
&amp;\forall i\in\{1, 2, \ldots, n\},\ \forall a \in \{1, 2, \ldots ,J_i-1\}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(n\)</span> is the number of players and <span class="math inline">\(J_i\)</span> is the number of actions in player <span class="math inline">\(i\)</span>’s action space.</p>
<p>This representation is particularly useful, because the log-difference of the probabilistic best responses (the term in the parentheses) for the logit and Luce specifications become:</p>
<p><span class="math display">\[
\begin{aligned}
\text{logit: }\quad H_{i,a}(\lambda,\sigma)&amp;=\log\sigma_{i,a}-\log\sigma_{i,a+1}-\lambda\left[u_{i,a}(\sigma)-u_{i,a+1}(\sigma)\right]\\
\text{Luce: }\quad  H_{i,a}(\lambda,\sigma)&amp;=\log\sigma_{i,a}-\log\sigma_{i,a+1}-\lambda\left[\log u_{i,a}(\sigma)-\log u_{i,a+1}(\sigma)\right]
\end{aligned}
\]</span></p>
<p>respectively. That is, we can cancel out the common denominators.</p>
<p>We then need some adding-up constraints to ensure that the mixed strategies add up to one:</p>
<p><span class="math display">\[
\begin{aligned}
0=H_{i,\Sigma}(\lambda,\sigma)&amp;=\sum_{a=1}^{J_i}\sigma_{i,a}-1,\quad \forall i \in\{1, 2, \ldots ,n\}
\end{aligned}
\]</span></p>
<p>Letting <span class="math inline">\(\rho_{i,a}=\log\sigma_{i,a}\)</span>, these constraints become:</p>
<p><span class="math display">\[
\begin{aligned}
\text{logit:}\quad H_{i,a}(\lambda,\rho)&amp;=\rho_{i,a}-\rho_{i,a+1}-\lambda\left[u_{i,a}(\exp(\rho))-u_{i,a+1}(\exp(\rho))\right]\\
\text{Luce: }\quad H_{i,a}(\lambda,\rho)&amp;=\rho_{i,a}-\rho_{i,a+1}-\lambda\left[\log u_{i,a}(\exp(\rho))-\log u_{i,a+1}(\exp(\rho))\right]\\
\text{adding up: }\quad H_{i,\Sigma}(\lambda,\rho)&amp;=\sum_{a=1}^{J_i}\exp(\rho_{i,a})-1
\end{aligned}
\]</span>
where <span class="math inline">\(\exp(\rho)=\sigma\)</span> is the element-wise exponentiation of <span class="math inline">\(\rho\)</span>.</p>
<p>Stacking all of these together, we have one great big vector of zero conditions defining a quantal response equilibrium:</p>
<p><span class="math display">\[
0=H(\lambda,\rho)=\begin{pmatrix}
H_{1,1} \\ H_{1,2}\\ \vdots \\ H_{1,J_1-1} \\ H_{2,1} \\ \vdots \\ H_{2,J_2-1} \\ \vdots\\ H_{n,J_n-1}\\
H_{1,\Sigma} \\ H_{2,\Sigma}\\\vdots \\ H_{n,\Sigma}
\end{pmatrix}
\]</span></p>
</div>
<div id="a-predictor-corrector-algorithm" class="section level3 hasAnchor" number="12.2.2">
<h3><span class="header-section-number">12.2.2</span> A predictor-corrector algorithm<a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A good way to solve for quantal response equilibrium is to use a predictor corrector algorithm. This algorithm, developed in <span class="citation">Turocy (<a href="#ref-Turocy2005">2005</a>)</span> and <span class="citation">Turocy (<a href="#ref-Turocy2010">2010</a>)</span>, initializes with a known quantal response equilibrium <span class="math inline">\((\lambda^t,\rho^t)\)</span>, then uses information contained in <span class="math inline">\(H\)</span> find a nearby solution <span class="math inline">\((\lambda^{t+1},\rho^{t+1})\)</span>.</p>
<p>To begin with, we will re-parameterize the problem using <span class="math inline">\(x\equiv \begin{pmatrix}\rho^\top &amp; \lambda\end{pmatrix}^\top\)</span>. This is because the algorithm does not really make a distinction between the parameters <span class="math inline">\(\rho\)</span> and <span class="math inline">\(\lambda\)</span>.</p>
<p>A quantal response equilibrium <span class="math inline">\((\lambda,\rho)\)</span> can therefore be characterized as a solution to:</p>
<p><span class="math display">\[
H(x)=0
\]</span></p>
<p>where <span class="math inline">\(H(x)\)</span> is a <span class="math inline">\({\sum_{i=1}^n}J_i \times 1\)</span> vector. Furthermore, since the solutions of <span class="math inline">\(H(x)=0\)</span> form a smooth, differentiable curve in the <span class="math inline">\(\rho-\lambda\)</span> space, we can trace out this curve using information contained in <span class="math inline">\(H\)</span>. Specifically, we will use the <em>jacobian</em> of <span class="math inline">\(H\)</span> to make a first-order approximation of the curve. We will then use the zero condition to correct any errors that come from this approximation.</p>
<p>Following the initialization, the algorithm applies two distinct steps:</p>
<p>First, in the <em>predictor</em> step, the algorithm makes a first-order approximation of the path continues from point <span class="math inline">\(x^t\)</span> to point <span class="math inline">\(x^{t+1}\)</span>. This approximation is found using the total derivative of <span class="math inline">\(H\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial H(x)}{\partial x^\top}\Delta x\approx0
\end{aligned}
\]</span></p>
<p>There are many solutions to this equation.<a href="#fn54" class="footnote-ref" id="fnref54"><sup>54</sup></a> What we really need from this is a <em>direction</em> to move. To do this, we can take a “fat” QR decomposition of the transpose of the jacobian <span class="math inline">\(\frac{\partial H(x)}{\partial x^\top}\)</span>. The final column of the <span class="math inline">\(Q\)</span> that comes out of this gives us the direction we want, and has magnitude one. Therefore the predictor step is:</p>
<p><span class="math display">\[
\begin{aligned}
x^{t+1}&amp;=x^t+h\omega Q_{,-1}(x_t)
\end{aligned}
\]</span>
where:</p>
<ul>
<li><span class="math inline">\(Q_{,-1}(x_t)\)</span> is the final column of the <span class="math inline">\(Q\)</span> component of the “fat” QR decomposition of <span class="math inline">\(\left[\frac{\partial H(x_t)}{\partial x^\top}\right]^\top\)</span>. We can compute the fat decomposition of matrix <span class="math inline">\(A\)</span> in <em>R</em> using <code>qr(A) |&gt; qr.Q(complete=TRUE)</code>.<a href="#fn55" class="footnote-ref" id="fnref55"><sup>55</sup></a></li>
<li><span class="math inline">\(\omega\in\{-1,1\}\)</span> ensures that we are moving in the right direction along the curve, and not back-tracking. For example, if we are looking to trace out the curve for increasing <span class="math inline">\(\lambda\)</span>, then <span class="math inline">\(\omega\)</span> will have the same sign as the last element in <span class="math inline">\(Q_{,-1}(x_t)\)</span>, which corresponds to <span class="math inline">\(\lambda\)</span>.</li>
<li><span class="math inline">\(h&gt;0\)</span> is a tuning parameter specifying the step length. Recall that the magnitude of <span class="math inline">\(Q_{,-1}(x_t)\)</span> has a magnitude of 1, so <span class="math inline">\(h\)</span> is the step length.</li>
</ul>
<p>As noted in <span class="citation">Turocy (<a href="#ref-Turocy2005">2005</a>)</span>, while it may be feasible to solve for quantal response equilibrium using only predictor steps, which are a form of numerical integration, this ignores some information that we have about quantal response equilibrium: it is characterized by a solution to a set of equations.<a href="#fn56" class="footnote-ref" id="fnref56"><sup>56</sup></a> Therefore, we can also exploit these equations to correct any errors that may have made their way into the system equations because the predictor step is only an approximation of the change in <span class="math inline">\(x\)</span>. Specifically, the following <em>corrector step</em> moves <span class="math inline">\(x\)</span> in the direction that gets <span class="math inline">\(H(x^{t+1})\)</span> closer to zero:</p>
<p><span class="math display">\[
x^{t+1}=x^t-\left(\frac{\partial H(x^t)}{\partial x^\top}\right)^+ H(x^t)
\]</span></p>
<p>where <span class="math inline">\(A^+\)</span> is the Moore-Penrose inverse of <span class="math inline">\(A\)</span>. We can compute this inverse in <em>R</em> using <code>ginv(A)</code>, which comes in the <code>MASS</code> library. We iterate on the corrector step until it has reached our desired level of accuracy.</p>
</div>
<div id="initial-conditions" class="section level3 hasAnchor" number="12.2.3">
<h3><span class="header-section-number">12.2.3</span> Initial conditions<a href="computing-quantal-response-equilibrium.html#initial-conditions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So once we have one solution to <span class="math inline">\(H(\lambda,\rho)=0\)</span>, we can trace out many other solutions. Great! But how do we initialize the problem? That is, we are doing this because we want to compute quantal response equilibrium, but we need to know one in order to start the algorithm. Fortunately, there are a couple of natural starting places. The simplest to start with is at the <em>centroid</em>: <span class="math inline">\(\lambda=0\)</span>, <span class="math inline">\(\sigma_{i,a}=1/J_i\)</span> will always be a quantal response equilibrium. That is, when choice precision is zero, they payoffs of the game don’t matter, and uniform randomization is the equilibrium strategy profile. The path <span class="math inline">\(\{(\lambda,\rho): H(\lambda,\rho)=0,\lambda\geq 0\}\)</span> starting at the centroid and <span class="math inline">\(\lambda=0\)</span> is called the “principal branch”, and is often used to select an equilibrium when multiple are present.</p>
<p>Other places to consider starting might be ones close to a Nash equilibrium. This is because quantal response equilibrium will nest every Nash equilibrium when <span class="math inline">\(\lambda\to\infty\)</span>. Therefore starting with <span class="math inline">\(\lambda^0 =\)</span> something very large, and <span class="math inline">\(\rho^0=\log\sigma^\text{Nash}\)</span>, then tracing out the branch from there might also be useful. Of course, computing Nash equilibrium can be difficult, too, so this starting point may not be computationally feasible in some games.</p>
</div>
<div id="algorithm-tuning" class="section level3 hasAnchor" number="12.2.4">
<h3><span class="header-section-number">12.2.4</span> Algorithm tuning<a href="computing-quantal-response-equilibrium.html#algorithm-tuning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The predictor-corrector algorithm described above allows us to choose two tuning parameters in order to (hopefully) improve the algorithm’s performance.</p>
<ol style="list-style-type: decimal">
<li>For the <em>predictor step</em>, we can choose the step size <span class="math inline">\(h\)</span>, which pins down how large is <span class="math inline">\(\|x^{t+1}-x^t\|\)</span></li>
<li>For the <em>corrector step</em>, we can choose the stopping rule, which defines how accurate is “accurate enough” for our solution to <span class="math inline">\(H(0)=0\)</span>.</li>
</ol>
<p>A good solution to this is to choose a desired level of accuracy for the corrector step, and then use the number of iterations needed in the corrector step to adjust the predictor step’s step length <span class="math inline">\(h\)</span>. Broadly speaking, if the corrector step requires a lot of iteration, then the previous predictor step jumped too far, and so we should reduce <span class="math inline">\(h\)</span> for the next step. On the other hand if only a few iterations are needed for the corrector step, then we could have jumped further using the predictor step without too much loss of accuracy, so increasing <span class="math inline">\(h\)</span> in this case is warranted.</p>
</div>
</div>
<div id="the-predictor-corrector-algorithm-in-r" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> The predictor-corrector algorithm in <em>R</em><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here is my implementation of the predictor-corrector algorithm in <em>R</em>. It is unashamedly translated from Ted Turocy’s <a href="http://www.gambit-project.org/turocy/papers/qrefit-20230421-src.zip"><em>Python</em> code</a>, which accompanies our paper <span class="citation">Bland and Turocy (<a href="#ref-BlandTurocy2023">2025</a>)</span>.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="computing-quantal-response-equilibrium.html#cb153-1" tabindex="-1"></a><span class="co"># Needed for the Moore-Penrose inverse</span></span>
<span id="cb153-2"><a href="computing-quantal-response-equilibrium.html#cb153-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb153-3"><a href="computing-quantal-response-equilibrium.html#cb153-3" tabindex="-1"></a> </span>
<span id="cb153-4"><a href="computing-quantal-response-equilibrium.html#cb153-4" tabindex="-1"></a>PC<span class="ot">&lt;-</span><span class="cf">function</span>(</span>
<span id="cb153-5"><a href="computing-quantal-response-equilibrium.html#cb153-5" tabindex="-1"></a>             <span class="co"># A named list comprising of functions H, Hlambda, and Hrho</span></span>
<span id="cb153-6"><a href="computing-quantal-response-equilibrium.html#cb153-6" tabindex="-1"></a>             Hlist, </span>
<span id="cb153-7"><a href="computing-quantal-response-equilibrium.html#cb153-7" tabindex="-1"></a>             <span class="co"># Total number of actions in the game</span></span>
<span id="cb153-8"><a href="computing-quantal-response-equilibrium.html#cb153-8" tabindex="-1"></a>             nActions,</span>
<span id="cb153-9"><a href="computing-quantal-response-equilibrium.html#cb153-9" tabindex="-1"></a>             <span class="co"># range of lambda to compute QRE for. First element is the starting point. Second element can be above or below this</span></span>
<span id="cb153-10"><a href="computing-quantal-response-equilibrium.html#cb153-10" tabindex="-1"></a>             lambda_span, <span class="co"># c(lambda0,lambda_end)</span></span>
<span id="cb153-11"><a href="computing-quantal-response-equilibrium.html#cb153-11" tabindex="-1"></a>             <span class="co"># Starting poring for log probabilities</span></span>
<span id="cb153-12"><a href="computing-quantal-response-equilibrium.html#cb153-12" tabindex="-1"></a>             x0, <span class="co"># rho0</span></span>
<span id="cb153-13"><a href="computing-quantal-response-equilibrium.html#cb153-13" tabindex="-1"></a>             <span class="co"># first step size</span></span>
<span id="cb153-14"><a href="computing-quantal-response-equilibrium.html#cb153-14" tabindex="-1"></a>             first_step,</span>
<span id="cb153-15"><a href="computing-quantal-response-equilibrium.html#cb153-15" tabindex="-1"></a>             <span class="co"># Minimum step size</span></span>
<span id="cb153-16"><a href="computing-quantal-response-equilibrium.html#cb153-16" tabindex="-1"></a>             min_step,</span>
<span id="cb153-17"><a href="computing-quantal-response-equilibrium.html#cb153-17" tabindex="-1"></a>             <span class="co"># Maximum deceleration of step size</span></span>
<span id="cb153-18"><a href="computing-quantal-response-equilibrium.html#cb153-18" tabindex="-1"></a>             max_decel,</span>
<span id="cb153-19"><a href="computing-quantal-response-equilibrium.html#cb153-19" tabindex="-1"></a>             <span class="co"># Maimum number of iterations for corrector step</span></span>
<span id="cb153-20"><a href="computing-quantal-response-equilibrium.html#cb153-20" tabindex="-1"></a>             maxiter,</span>
<span id="cb153-21"><a href="computing-quantal-response-equilibrium.html#cb153-21" tabindex="-1"></a>             <span class="co"># Tolerance for corrector step (a step size)</span></span>
<span id="cb153-22"><a href="computing-quantal-response-equilibrium.html#cb153-22" tabindex="-1"></a>             tol</span>
<span id="cb153-23"><a href="computing-quantal-response-equilibrium.html#cb153-23" tabindex="-1"></a>) {</span>
<span id="cb153-24"><a href="computing-quantal-response-equilibrium.html#cb153-24" tabindex="-1"></a>  </span>
<span id="cb153-25"><a href="computing-quantal-response-equilibrium.html#cb153-25" tabindex="-1"></a>  </span>
<span id="cb153-26"><a href="computing-quantal-response-equilibrium.html#cb153-26" tabindex="-1"></a>  <span class="co"># unpack the list of functions Hlist</span></span>
<span id="cb153-27"><a href="computing-quantal-response-equilibrium.html#cb153-27" tabindex="-1"></a>  </span>
<span id="cb153-28"><a href="computing-quantal-response-equilibrium.html#cb153-28" tabindex="-1"></a>  H<span class="ot">&lt;-</span>Hlist[[<span class="st">&quot;H&quot;</span>]]</span>
<span id="cb153-29"><a href="computing-quantal-response-equilibrium.html#cb153-29" tabindex="-1"></a>  Hlambda<span class="ot">&lt;-</span>Hlist[[<span class="st">&quot;Hlambda&quot;</span>]]</span>
<span id="cb153-30"><a href="computing-quantal-response-equilibrium.html#cb153-30" tabindex="-1"></a>  Hrho<span class="ot">&lt;-</span>Hlist[[<span class="st">&quot;Hrho&quot;</span>]]</span>
<span id="cb153-31"><a href="computing-quantal-response-equilibrium.html#cb153-31" tabindex="-1"></a>  </span>
<span id="cb153-32"><a href="computing-quantal-response-equilibrium.html#cb153-32" tabindex="-1"></a>  jac<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb153-33"><a href="computing-quantal-response-equilibrium.html#cb153-33" tabindex="-1"></a>    <span class="fu">cbind</span>(<span class="fu">Hrho</span>(x[nActions<span class="sc">+</span><span class="dv">1</span>],x[<span class="dv">1</span><span class="sc">:</span>nActions]),<span class="fu">Hlambda</span>(x[nActions<span class="sc">+</span><span class="dv">1</span>],x[<span class="dv">1</span><span class="sc">:</span>nActions]))</span>
<span id="cb153-34"><a href="computing-quantal-response-equilibrium.html#cb153-34" tabindex="-1"></a>  }</span>
<span id="cb153-35"><a href="computing-quantal-response-equilibrium.html#cb153-35" tabindex="-1"></a>  <span class="co"># Maximum distance to curve</span></span>
<span id="cb153-36"><a href="computing-quantal-response-equilibrium.html#cb153-36" tabindex="-1"></a>    max_dist <span class="ot">&lt;-</span> <span class="fl">0.4</span></span>
<span id="cb153-37"><a href="computing-quantal-response-equilibrium.html#cb153-37" tabindex="-1"></a>    <span class="co"># Maximum contraction rate in corrector</span></span>
<span id="cb153-38"><a href="computing-quantal-response-equilibrium.html#cb153-38" tabindex="-1"></a>    max_contr <span class="ot">&lt;-</span> <span class="fl">0.6</span></span>
<span id="cb153-39"><a href="computing-quantal-response-equilibrium.html#cb153-39" tabindex="-1"></a>    <span class="co"># Perturbation to avoid cancellation in calculating contraction rate</span></span>
<span id="cb153-40"><a href="computing-quantal-response-equilibrium.html#cb153-40" tabindex="-1"></a>    eta <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb153-41"><a href="computing-quantal-response-equilibrium.html#cb153-41" tabindex="-1"></a>    </span>
<span id="cb153-42"><a href="computing-quantal-response-equilibrium.html#cb153-42" tabindex="-1"></a>    <span class="co"># Initial conditions</span></span>
<span id="cb153-43"><a href="computing-quantal-response-equilibrium.html#cb153-43" tabindex="-1"></a>    x<span class="ot">&lt;-</span><span class="fu">c</span>(x0,lambda_span[<span class="dv">1</span>])</span>
<span id="cb153-44"><a href="computing-quantal-response-equilibrium.html#cb153-44" tabindex="-1"></a>    QRE<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">c</span>(),x)</span>
<span id="cb153-45"><a href="computing-quantal-response-equilibrium.html#cb153-45" tabindex="-1"></a>    </span>
<span id="cb153-46"><a href="computing-quantal-response-equilibrium.html#cb153-46" tabindex="-1"></a>    </span>
<span id="cb153-47"><a href="computing-quantal-response-equilibrium.html#cb153-47" tabindex="-1"></a>  </span>
<span id="cb153-48"><a href="computing-quantal-response-equilibrium.html#cb153-48" tabindex="-1"></a>    <span class="co"># The last column of Q in the QR decomposition is the tangent vector</span></span>
<span id="cb153-49"><a href="computing-quantal-response-equilibrium.html#cb153-49" tabindex="-1"></a>    t <span class="ot">&lt;-</span> (<span class="fu">qr</span>(<span class="fu">jac</span>(x) <span class="sc">|&gt;</span> <span class="fu">t</span>())  <span class="sc">|&gt;</span> <span class="fu">qr.Q</span>(<span class="at">complete=</span><span class="cn">TRUE</span>))[,nActions<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb153-50"><a href="computing-quantal-response-equilibrium.html#cb153-50" tabindex="-1"></a>    </span>
<span id="cb153-51"><a href="computing-quantal-response-equilibrium.html#cb153-51" tabindex="-1"></a>    h<span class="ot">&lt;-</span>first_step</span>
<span id="cb153-52"><a href="computing-quantal-response-equilibrium.html#cb153-52" tabindex="-1"></a>    </span>
<span id="cb153-53"><a href="computing-quantal-response-equilibrium.html#cb153-53" tabindex="-1"></a>    <span class="co"># Set orientation of curve, so we are tracing into the interior of `t_span`</span></span>
<span id="cb153-54"><a href="computing-quantal-response-equilibrium.html#cb153-54" tabindex="-1"></a>    omega<span class="ot">&lt;-</span><span class="fu">sign</span>(t[nActions<span class="sc">+</span><span class="dv">1</span>])<span class="sc">*</span><span class="fu">sign</span>(lambda_span[<span class="dv">2</span>]<span class="sc">-</span>lambda_span[<span class="dv">1</span>])</span>
<span id="cb153-55"><a href="computing-quantal-response-equilibrium.html#cb153-55" tabindex="-1"></a>    </span>
<span id="cb153-56"><a href="computing-quantal-response-equilibrium.html#cb153-56" tabindex="-1"></a>  </span>
<span id="cb153-57"><a href="computing-quantal-response-equilibrium.html#cb153-57" tabindex="-1"></a>   <span class="cf">while</span> ((x[nActions<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&gt;=</span><span class="fu">min</span>(lambda_span)) <span class="sc">&amp;</span> (x[nActions<span class="sc">+</span><span class="dv">1</span>]<span class="sc">&lt;=</span><span class="fu">max</span>(lambda_span))) {</span>
<span id="cb153-58"><a href="computing-quantal-response-equilibrium.html#cb153-58" tabindex="-1"></a>   accept <span class="ot">&lt;-</span><span class="cn">TRUE</span></span>
<span id="cb153-59"><a href="computing-quantal-response-equilibrium.html#cb153-59" tabindex="-1"></a>   </span>
<span id="cb153-60"><a href="computing-quantal-response-equilibrium.html#cb153-60" tabindex="-1"></a>     <span class="cf">if</span> (<span class="fu">abs</span>(h)<span class="sc">&lt;=</span> min_step) {</span>
<span id="cb153-61"><a href="computing-quantal-response-equilibrium.html#cb153-61" tabindex="-1"></a>       <span class="co"># Stepsize below minimum tolerance; terminate.</span></span>
<span id="cb153-62"><a href="computing-quantal-response-equilibrium.html#cb153-62" tabindex="-1"></a>       success <span class="ot">&lt;-</span><span class="cn">FALSE</span></span>
<span id="cb153-63"><a href="computing-quantal-response-equilibrium.html#cb153-63" tabindex="-1"></a>       <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Stepsize&quot;</span>,<span class="fu">abs</span>(h),<span class="st">&quot;less than minimum&quot;</span>,min_step))</span>
<span id="cb153-64"><a href="computing-quantal-response-equilibrium.html#cb153-64" tabindex="-1"></a>       <span class="cf">break</span></span>
<span id="cb153-65"><a href="computing-quantal-response-equilibrium.html#cb153-65" tabindex="-1"></a>     }</span>
<span id="cb153-66"><a href="computing-quantal-response-equilibrium.html#cb153-66" tabindex="-1"></a>     </span>
<span id="cb153-67"><a href="computing-quantal-response-equilibrium.html#cb153-67" tabindex="-1"></a>     <span class="co"># Predictor step</span></span>
<span id="cb153-68"><a href="computing-quantal-response-equilibrium.html#cb153-68" tabindex="-1"></a>     u<span class="ot">&lt;-</span>x <span class="sc">+</span> h<span class="sc">*</span>omega<span class="sc">*</span>t</span>
<span id="cb153-69"><a href="computing-quantal-response-equilibrium.html#cb153-69" tabindex="-1"></a>     q<span class="ot">&lt;-</span><span class="fu">qr</span>(<span class="fu">jac</span>(u) <span class="sc">|&gt;</span> <span class="fu">t</span>())  <span class="sc">|&gt;</span> <span class="fu">qr.Q</span>(<span class="at">complete=</span><span class="cn">TRUE</span>)</span>
<span id="cb153-70"><a href="computing-quantal-response-equilibrium.html#cb153-70" tabindex="-1"></a></span>
<span id="cb153-71"><a href="computing-quantal-response-equilibrium.html#cb153-71" tabindex="-1"></a>     disto <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb153-72"><a href="computing-quantal-response-equilibrium.html#cb153-72" tabindex="-1"></a>     decel <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>max_decel <span class="co"># deceleration factor</span></span>
<span id="cb153-73"><a href="computing-quantal-response-equilibrium.html#cb153-73" tabindex="-1"></a>     </span>
<span id="cb153-74"><a href="computing-quantal-response-equilibrium.html#cb153-74" tabindex="-1"></a>     <span class="cf">for</span> (it <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxiter) {</span>
<span id="cb153-75"><a href="computing-quantal-response-equilibrium.html#cb153-75" tabindex="-1"></a>       y<span class="ot">&lt;-</span><span class="fu">H</span>(u[nActions<span class="sc">+</span><span class="dv">1</span>],u[<span class="dv">1</span><span class="sc">:</span>nActions])</span>
<span id="cb153-76"><a href="computing-quantal-response-equilibrium.html#cb153-76" tabindex="-1"></a>       </span>
<span id="cb153-77"><a href="computing-quantal-response-equilibrium.html#cb153-77" tabindex="-1"></a>       </span>
<span id="cb153-78"><a href="computing-quantal-response-equilibrium.html#cb153-78" tabindex="-1"></a>       <span class="co"># change in rho proposed by Newton step</span></span>
<span id="cb153-79"><a href="computing-quantal-response-equilibrium.html#cb153-79" tabindex="-1"></a>       <span class="co"># This is the step we&#39;d use if we kept lambda constant</span></span>
<span id="cb153-80"><a href="computing-quantal-response-equilibrium.html#cb153-80" tabindex="-1"></a>       <span class="co">#drho &lt;- -solve(Hrho(u[nActions+1],u[1:nActions]),y)</span></span>
<span id="cb153-81"><a href="computing-quantal-response-equilibrium.html#cb153-81" tabindex="-1"></a>       drho<span class="ot">&lt;-</span> <span class="sc">-</span> <span class="fu">ginv</span>(<span class="fu">jac</span>(u)) <span class="sc">%*%</span> y</span>
<span id="cb153-82"><a href="computing-quantal-response-equilibrium.html#cb153-82" tabindex="-1"></a>       dist<span class="ot">&lt;-</span>(drho<span class="sc">^</span><span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">sqrt</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb153-83"><a href="computing-quantal-response-equilibrium.html#cb153-83" tabindex="-1"></a>       </span>
<span id="cb153-84"><a href="computing-quantal-response-equilibrium.html#cb153-84" tabindex="-1"></a>       </span>
<span id="cb153-85"><a href="computing-quantal-response-equilibrium.html#cb153-85" tabindex="-1"></a>       <span class="cf">if</span> (dist <span class="sc">&gt;=</span> max_dist) {</span>
<span id="cb153-86"><a href="computing-quantal-response-equilibrium.html#cb153-86" tabindex="-1"></a>         <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Proposed distance&quot;</span>,dist,<span class="st">&quot;exceeds max_dist =&quot;</span>,max_dist))</span>
<span id="cb153-87"><a href="computing-quantal-response-equilibrium.html#cb153-87" tabindex="-1"></a>         accept<span class="ot">&lt;-</span><span class="cn">FALSE</span></span>
<span id="cb153-88"><a href="computing-quantal-response-equilibrium.html#cb153-88" tabindex="-1"></a>         <span class="cf">break</span></span>
<span id="cb153-89"><a href="computing-quantal-response-equilibrium.html#cb153-89" tabindex="-1"></a>       }</span>
<span id="cb153-90"><a href="computing-quantal-response-equilibrium.html#cb153-90" tabindex="-1"></a>       </span>
<span id="cb153-91"><a href="computing-quantal-response-equilibrium.html#cb153-91" tabindex="-1"></a>       decel<span class="ot">&lt;-</span><span class="fu">max</span>(<span class="fu">c</span>(decel,<span class="fu">sqrt</span>(dist<span class="sc">/</span>max_dist)<span class="sc">*</span>max_decel))</span>
<span id="cb153-92"><a href="computing-quantal-response-equilibrium.html#cb153-92" tabindex="-1"></a>       </span>
<span id="cb153-93"><a href="computing-quantal-response-equilibrium.html#cb153-93" tabindex="-1"></a>       <span class="cf">if</span> (it<span class="sc">&gt;</span><span class="dv">1</span>) {</span>
<span id="cb153-94"><a href="computing-quantal-response-equilibrium.html#cb153-94" tabindex="-1"></a>         contr<span class="ot">&lt;-</span> dist<span class="sc">/</span>(disto <span class="sc">+</span>tol<span class="sc">*</span>eta)</span>
<span id="cb153-95"><a href="computing-quantal-response-equilibrium.html#cb153-95" tabindex="-1"></a>         <span class="cf">if</span> (contr <span class="sc">&gt;</span> max_contr) {</span>
<span id="cb153-96"><a href="computing-quantal-response-equilibrium.html#cb153-96" tabindex="-1"></a>           <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Maximum contraction rate exceeded&quot;</span>))</span>
<span id="cb153-97"><a href="computing-quantal-response-equilibrium.html#cb153-97" tabindex="-1"></a>           accept<span class="ot">&lt;-</span><span class="cn">FALSE</span></span>
<span id="cb153-98"><a href="computing-quantal-response-equilibrium.html#cb153-98" tabindex="-1"></a>           <span class="cf">break</span></span>
<span id="cb153-99"><a href="computing-quantal-response-equilibrium.html#cb153-99" tabindex="-1"></a>         }</span>
<span id="cb153-100"><a href="computing-quantal-response-equilibrium.html#cb153-100" tabindex="-1"></a>         decel <span class="ot">&lt;-</span><span class="fu">max</span>(<span class="fu">c</span>(decel,<span class="fu">sqrt</span>(contr<span class="sc">/</span>max_contr)<span class="sc">*</span>max_decel))</span>
<span id="cb153-101"><a href="computing-quantal-response-equilibrium.html#cb153-101" tabindex="-1"></a>       }</span>
<span id="cb153-102"><a href="computing-quantal-response-equilibrium.html#cb153-102" tabindex="-1"></a>       <span class="cf">if</span> (dist <span class="sc">&lt;</span> tol) {</span>
<span id="cb153-103"><a href="computing-quantal-response-equilibrium.html#cb153-103" tabindex="-1"></a>        </span>
<span id="cb153-104"><a href="computing-quantal-response-equilibrium.html#cb153-104" tabindex="-1"></a>         <span class="co"># Success! update and break out of iteration</span></span>
<span id="cb153-105"><a href="computing-quantal-response-equilibrium.html#cb153-105" tabindex="-1"></a>         <span class="cf">break</span></span>
<span id="cb153-106"><a href="computing-quantal-response-equilibrium.html#cb153-106" tabindex="-1"></a>       }</span>
<span id="cb153-107"><a href="computing-quantal-response-equilibrium.html#cb153-107" tabindex="-1"></a>       disto<span class="ot">&lt;-</span>dist</span>
<span id="cb153-108"><a href="computing-quantal-response-equilibrium.html#cb153-108" tabindex="-1"></a>       </span>
<span id="cb153-109"><a href="computing-quantal-response-equilibrium.html#cb153-109" tabindex="-1"></a>       <span class="co"># if we have got to this point, then:</span></span>
<span id="cb153-110"><a href="computing-quantal-response-equilibrium.html#cb153-110" tabindex="-1"></a>       <span class="co">#  1. The Newton step has not proposed a too-large change</span></span>
<span id="cb153-111"><a href="computing-quantal-response-equilibrium.html#cb153-111" tabindex="-1"></a>       <span class="co">#  2. The contraction rate has not been exceeded</span></span>
<span id="cb153-112"><a href="computing-quantal-response-equilibrium.html#cb153-112" tabindex="-1"></a>       <span class="co">#  3. The proposed Newton step is not so small that we have effectively </span></span>
<span id="cb153-113"><a href="computing-quantal-response-equilibrium.html#cb153-113" tabindex="-1"></a>       <span class="co">#    found a solution</span></span>
<span id="cb153-114"><a href="computing-quantal-response-equilibrium.html#cb153-114" tabindex="-1"></a>       <span class="co"># Therefore, we update rho</span></span>
<span id="cb153-115"><a href="computing-quantal-response-equilibrium.html#cb153-115" tabindex="-1"></a>       </span>
<span id="cb153-116"><a href="computing-quantal-response-equilibrium.html#cb153-116" tabindex="-1"></a>       u<span class="ot">&lt;-</span>u<span class="sc">+</span>drho</span>
<span id="cb153-117"><a href="computing-quantal-response-equilibrium.html#cb153-117" tabindex="-1"></a>       </span>
<span id="cb153-118"><a href="computing-quantal-response-equilibrium.html#cb153-118" tabindex="-1"></a>       </span>
<span id="cb153-119"><a href="computing-quantal-response-equilibrium.html#cb153-119" tabindex="-1"></a>       </span>
<span id="cb153-120"><a href="computing-quantal-response-equilibrium.html#cb153-120" tabindex="-1"></a>       <span class="cf">if</span> (it<span class="sc">==</span>maxiter) {</span>
<span id="cb153-121"><a href="computing-quantal-response-equilibrium.html#cb153-121" tabindex="-1"></a>         <span class="co"># We have run out of iterations. Terminate</span></span>
<span id="cb153-122"><a href="computing-quantal-response-equilibrium.html#cb153-122" tabindex="-1"></a>         <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Maximum number of iterations&quot;</span>,maxiter,<span class="st">&quot;reached&quot;</span>))</span>
<span id="cb153-123"><a href="computing-quantal-response-equilibrium.html#cb153-123" tabindex="-1"></a>       }</span>
<span id="cb153-124"><a href="computing-quantal-response-equilibrium.html#cb153-124" tabindex="-1"></a>       </span>
<span id="cb153-125"><a href="computing-quantal-response-equilibrium.html#cb153-125" tabindex="-1"></a>     } <span class="do">## </span><span class="re">END</span><span class="do"> OF CORRECTOR STEP</span></span>
<span id="cb153-126"><a href="computing-quantal-response-equilibrium.html#cb153-126" tabindex="-1"></a>       </span>
<span id="cb153-127"><a href="computing-quantal-response-equilibrium.html#cb153-127" tabindex="-1"></a>       <span class="cf">if</span> (<span class="sc">!</span>accept) {</span>
<span id="cb153-128"><a href="computing-quantal-response-equilibrium.html#cb153-128" tabindex="-1"></a>         <span class="co"># Step was not accepted; take a smaller step and try again</span></span>
<span id="cb153-129"><a href="computing-quantal-response-equilibrium.html#cb153-129" tabindex="-1"></a>         h<span class="ot">&lt;-</span>h<span class="sc">/</span>max_decel</span>
<span id="cb153-130"><a href="computing-quantal-response-equilibrium.html#cb153-130" tabindex="-1"></a>       }</span>
<span id="cb153-131"><a href="computing-quantal-response-equilibrium.html#cb153-131" tabindex="-1"></a>       </span>
<span id="cb153-132"><a href="computing-quantal-response-equilibrium.html#cb153-132" tabindex="-1"></a>       <span class="co"># Standard steplength adaptation</span></span>
<span id="cb153-133"><a href="computing-quantal-response-equilibrium.html#cb153-133" tabindex="-1"></a>       h<span class="ot">&lt;-</span><span class="fu">abs</span>(h<span class="sc">/</span><span class="fu">min</span>(<span class="fu">c</span>(decel,max_decel)))</span>
<span id="cb153-134"><a href="computing-quantal-response-equilibrium.html#cb153-134" tabindex="-1"></a>       </span>
<span id="cb153-135"><a href="computing-quantal-response-equilibrium.html#cb153-135" tabindex="-1"></a>       <span class="co"># Update with outcome of successful PC step</span></span>
<span id="cb153-136"><a href="computing-quantal-response-equilibrium.html#cb153-136" tabindex="-1"></a>       <span class="cf">if</span> (<span class="fu">sum</span>(t<span class="sc">*</span>q[,nActions<span class="sc">+</span><span class="dv">1</span>])<span class="sc">&lt;</span><span class="dv">0</span>) {</span>
<span id="cb153-137"><a href="computing-quantal-response-equilibrium.html#cb153-137" tabindex="-1"></a>         <span class="co"># The orientation of the curve as determined by the QR</span></span>
<span id="cb153-138"><a href="computing-quantal-response-equilibrium.html#cb153-138" tabindex="-1"></a>         <span class="co"># decomposition has changed.</span></span>
<span id="cb153-139"><a href="computing-quantal-response-equilibrium.html#cb153-139" tabindex="-1"></a>         <span class="co">#</span></span>
<span id="cb153-140"><a href="computing-quantal-response-equilibrium.html#cb153-140" tabindex="-1"></a>         <span class="co"># The original Allgower-Georg QR decomposition implementation</span></span>
<span id="cb153-141"><a href="computing-quantal-response-equilibrium.html#cb153-141" tabindex="-1"></a>         <span class="co"># ensures the sign of the tangent is stable; when it is stable</span></span>
<span id="cb153-142"><a href="computing-quantal-response-equilibrium.html#cb153-142" tabindex="-1"></a>         <span class="co"># the curve orientation switching is a sign of a bifurcation.</span></span>
<span id="cb153-143"><a href="computing-quantal-response-equilibrium.html#cb153-143" tabindex="-1"></a>         omega<span class="ot">&lt;-</span> <span class="sc">-</span>omega</span>
<span id="cb153-144"><a href="computing-quantal-response-equilibrium.html#cb153-144" tabindex="-1"></a>         <span class="co">#print(&quot;sign of omega flipped&quot;)</span></span>
<span id="cb153-145"><a href="computing-quantal-response-equilibrium.html#cb153-145" tabindex="-1"></a>       }</span>
<span id="cb153-146"><a href="computing-quantal-response-equilibrium.html#cb153-146" tabindex="-1"></a>       </span>
<span id="cb153-147"><a href="computing-quantal-response-equilibrium.html#cb153-147" tabindex="-1"></a></span>
<span id="cb153-148"><a href="computing-quantal-response-equilibrium.html#cb153-148" tabindex="-1"></a>       </span>
<span id="cb153-149"><a href="computing-quantal-response-equilibrium.html#cb153-149" tabindex="-1"></a>       x<span class="ot">&lt;-</span>u</span>
<span id="cb153-150"><a href="computing-quantal-response-equilibrium.html#cb153-150" tabindex="-1"></a>       t<span class="ot">&lt;-</span>q[,nActions<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb153-151"><a href="computing-quantal-response-equilibrium.html#cb153-151" tabindex="-1"></a>       </span>
<span id="cb153-152"><a href="computing-quantal-response-equilibrium.html#cb153-152" tabindex="-1"></a>       <span class="co">#print(c(exp(x[1:nActions]),x[nActions+1]))</span></span>
<span id="cb153-153"><a href="computing-quantal-response-equilibrium.html#cb153-153" tabindex="-1"></a>       </span>
<span id="cb153-154"><a href="computing-quantal-response-equilibrium.html#cb153-154" tabindex="-1"></a>       </span>
<span id="cb153-155"><a href="computing-quantal-response-equilibrium.html#cb153-155" tabindex="-1"></a>        QRE<span class="ot">&lt;-</span><span class="fu">rbind</span>(QRE,x <span class="sc">|&gt;</span> <span class="fu">as.vector</span>())</span>
<span id="cb153-156"><a href="computing-quantal-response-equilibrium.html#cb153-156" tabindex="-1"></a>        <span class="co">#print(c(exp(x[1:nActions]),x[nActions+1]) |&gt; t())</span></span>
<span id="cb153-157"><a href="computing-quantal-response-equilibrium.html#cb153-157" tabindex="-1"></a>     </span>
<span id="cb153-158"><a href="computing-quantal-response-equilibrium.html#cb153-158" tabindex="-1"></a>     </span>
<span id="cb153-159"><a href="computing-quantal-response-equilibrium.html#cb153-159" tabindex="-1"></a>     </span>
<span id="cb153-160"><a href="computing-quantal-response-equilibrium.html#cb153-160" tabindex="-1"></a>   }</span>
<span id="cb153-161"><a href="computing-quantal-response-equilibrium.html#cb153-161" tabindex="-1"></a>  QRE</span>
<span id="cb153-162"><a href="computing-quantal-response-equilibrium.html#cb153-162" tabindex="-1"></a>  </span>
<span id="cb153-163"><a href="computing-quantal-response-equilibrium.html#cb153-163" tabindex="-1"></a>  </span>
<span id="cb153-164"><a href="computing-quantal-response-equilibrium.html#cb153-164" tabindex="-1"></a>}</span>
<span id="cb153-165"><a href="computing-quantal-response-equilibrium.html#cb153-165" tabindex="-1"></a></span>
<span id="cb153-166"><a href="computing-quantal-response-equilibrium.html#cb153-166" tabindex="-1"></a><span class="co"># Save the function so I can use it in later chapters if needed</span></span>
<span id="cb153-167"><a href="computing-quantal-response-equilibrium.html#cb153-167" tabindex="-1"></a></span>
<span id="cb153-168"><a href="computing-quantal-response-equilibrium.html#cb153-168" tabindex="-1"></a>PC <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(<span class="st">&quot;Code/QRE1/PCalgorithm.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="some-example-games" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Some example games<a href="computing-quantal-response-equilibrium.html#some-example-games" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="generalized-matching-pennies-ochs1995" class="section level3 hasAnchor" number="12.4.1">
<h3><span class="header-section-number">12.4.1</span> Generalized matching pennies <span class="citation">(<a href="#ref-Ochs1995">Ochs 1995</a>)</span><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To begin with, I will show you the logit quantal response equilibrium for a generalized matching pennies game. Generalized matching pennies games are a good place to start due to their simplicity: there is only one path that we have to follow, which is the principal branch connecting the centroid <span class="math inline">\((\rho^0,0)\)</span> to the unique Nash equilibrium. Therefore we can be sure to trace out all quantal response equilibria by starting at the centroid. The game, studied in <span class="citation">Ochs (<a href="#ref-Ochs1995">1995</a>)</span>, is shows in Table <a href="computing-quantal-response-equilibrium.html#tab:QRE1GMP">12.1</a>. This game is also used as an example in <span class="citation">McKelvey and Palfrey (<a href="#ref-McKelvey1995">1995</a>)</span>.</p>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:QRE1GMP">Table 12.1: </span>A generalized matching pennies game
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
L
</th>
<th style="text-align:left;">
R
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
4, 0
</td>
<td style="text-align:left;">
0, 1
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:left;">
0, 1
</td>
<td style="text-align:left;">
1, 0
</td>
</tr>
</tbody>
</table>
<p>Here is some working constructing the function <span class="math inline">\(H\)</span> and finding its derivatives:</p>
<p><span class="math display">\[
\begin{aligned}
H(\lambda,\rho)&amp;=\begin{pmatrix}
\rho_U-\rho_D -\lambda(4\exp(\rho_L)-1\exp(\rho_R))\\
\rho_L-\rho_R-\lambda(-1\exp(\rho_U)+1\exp(\rho_D))\\
\exp(\rho_U)+\exp(\rho_D)-1\\
\exp(\rho_L)+\exp(\rho_R)-1
\end{pmatrix}
\\~\\
\frac{\partial H(\lambda,\rho)}{\partial \lambda}
&amp;=\begin{pmatrix}
-(4\exp(\rho_L)-1\exp(\rho_R))\\
-(-1\exp(\rho_U)+1\exp(\rho_D))\\
0\\0
\end{pmatrix}
\\ ~ \\
\frac{\partial H(\lambda,\rho)}{\partial \rho^\top}&amp;=
\begin{bmatrix}
1 &amp; -1 &amp; -4\lambda\exp(\rho_L) &amp; +1\lambda \exp(\rho_R)\\
1\lambda\exp(\rho_U) &amp; -1\lambda\exp(\rho_D) &amp; 1 &amp; -1\\
\exp(\rho_U) &amp; \exp(\rho_D) &amp; 0 &amp; 0\\
0 &amp; 0 &amp; \exp(\rho_L) &amp; \exp(\rho_R)
\end{bmatrix}
\end{aligned}
\]</span></p>
<p>And here is how we pass this information to the solver function I wrote above:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="computing-quantal-response-equilibrium.html#cb154-1" tabindex="-1"></a>GMP<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb154-2"><a href="computing-quantal-response-equilibrium.html#cb154-2" tabindex="-1"></a>  <span class="co"># Function defining QRE conditions</span></span>
<span id="cb154-3"><a href="computing-quantal-response-equilibrium.html#cb154-3" tabindex="-1"></a>  <span class="at">H =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb154-4"><a href="computing-quantal-response-equilibrium.html#cb154-4" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb154-5"><a href="computing-quantal-response-equilibrium.html#cb154-5" tabindex="-1"></a>      rho[<span class="dv">1</span>]<span class="sc">-</span>rho[<span class="dv">2</span>]<span class="sc">-</span>lambda<span class="sc">*</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">3</span>])<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">4</span>])),</span>
<span id="cb154-6"><a href="computing-quantal-response-equilibrium.html#cb154-6" tabindex="-1"></a>      rho[<span class="dv">3</span>]<span class="sc">-</span>rho[<span class="dv">4</span>]<span class="sc">-</span>lambda<span class="sc">*</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">+</span><span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">2</span>])),</span>
<span id="cb154-7"><a href="computing-quantal-response-equilibrium.html#cb154-7" tabindex="-1"></a>      <span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">exp</span>(rho[<span class="dv">2</span>])<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb154-8"><a href="computing-quantal-response-equilibrium.html#cb154-8" tabindex="-1"></a>      <span class="fu">exp</span>(rho[<span class="dv">3</span>])<span class="sc">+</span><span class="fu">exp</span>(rho[<span class="dv">4</span>])<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb154-9"><a href="computing-quantal-response-equilibrium.html#cb154-9" tabindex="-1"></a>    )</span>
<span id="cb154-10"><a href="computing-quantal-response-equilibrium.html#cb154-10" tabindex="-1"></a>  },</span>
<span id="cb154-11"><a href="computing-quantal-response-equilibrium.html#cb154-11" tabindex="-1"></a>  <span class="co"># derivative with respect to lambda</span></span>
<span id="cb154-12"><a href="computing-quantal-response-equilibrium.html#cb154-12" tabindex="-1"></a>  <span class="at">Hlambda =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb154-13"><a href="computing-quantal-response-equilibrium.html#cb154-13" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb154-14"><a href="computing-quantal-response-equilibrium.html#cb154-14" tabindex="-1"></a>      <span class="sc">-</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">3</span>])<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">4</span>])),</span>
<span id="cb154-15"><a href="computing-quantal-response-equilibrium.html#cb154-15" tabindex="-1"></a>      <span class="sc">-</span>(<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">+</span><span class="dv">1</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">2</span>])),</span>
<span id="cb154-16"><a href="computing-quantal-response-equilibrium.html#cb154-16" tabindex="-1"></a>      <span class="dv">0</span>,</span>
<span id="cb154-17"><a href="computing-quantal-response-equilibrium.html#cb154-17" tabindex="-1"></a>      <span class="dv">0</span></span>
<span id="cb154-18"><a href="computing-quantal-response-equilibrium.html#cb154-18" tabindex="-1"></a>    )</span>
<span id="cb154-19"><a href="computing-quantal-response-equilibrium.html#cb154-19" tabindex="-1"></a>  },</span>
<span id="cb154-20"><a href="computing-quantal-response-equilibrium.html#cb154-20" tabindex="-1"></a>  <span class="co"># derivative with respect to rho</span></span>
<span id="cb154-21"><a href="computing-quantal-response-equilibrium.html#cb154-21" tabindex="-1"></a>  <span class="at">Hrho =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb154-22"><a href="computing-quantal-response-equilibrium.html#cb154-22" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb154-23"><a href="computing-quantal-response-equilibrium.html#cb154-23" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="sc">-</span><span class="dv">4</span><span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">3</span>]),<span class="dv">1</span><span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">4</span>])),</span>
<span id="cb154-24"><a href="computing-quantal-response-equilibrium.html#cb154-24" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">1</span><span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">1</span>]),<span class="sc">-</span><span class="dv">1</span><span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">2</span>]),<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb154-25"><a href="computing-quantal-response-equilibrium.html#cb154-25" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fu">exp</span>(rho[<span class="dv">1</span>]),<span class="fu">exp</span>(rho[<span class="dv">2</span>]),<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb154-26"><a href="computing-quantal-response-equilibrium.html#cb154-26" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="fu">exp</span>(rho[<span class="dv">3</span>]),<span class="fu">exp</span>(rho[<span class="dv">4</span>]))</span>
<span id="cb154-27"><a href="computing-quantal-response-equilibrium.html#cb154-27" tabindex="-1"></a>    )</span>
<span id="cb154-28"><a href="computing-quantal-response-equilibrium.html#cb154-28" tabindex="-1"></a>  }</span>
<span id="cb154-29"><a href="computing-quantal-response-equilibrium.html#cb154-29" tabindex="-1"></a>)</span>
<span id="cb154-30"><a href="computing-quantal-response-equilibrium.html#cb154-30" tabindex="-1"></a></span>
<span id="cb154-31"><a href="computing-quantal-response-equilibrium.html#cb154-31" tabindex="-1"></a>     QRE<span class="ot">&lt;-</span>   <span class="fu">PC</span>(GMP,</span>
<span id="cb154-32"><a href="computing-quantal-response-equilibrium.html#cb154-32" tabindex="-1"></a>             <span class="dv">4</span>, <span class="co"># total number of actions</span></span>
<span id="cb154-33"><a href="computing-quantal-response-equilibrium.html#cb154-33" tabindex="-1"></a>             <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="co"># c(lambda0,lambda_end)</span></span>
<span id="cb154-34"><a href="computing-quantal-response-equilibrium.html#cb154-34" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="fu">log</span>(<span class="fl">0.5</span>),<span class="dv">4</span>), <span class="co"># rho0</span></span>
<span id="cb154-35"><a href="computing-quantal-response-equilibrium.html#cb154-35" tabindex="-1"></a>             <span class="fl">0.1</span>, <span class="co"># first step size</span></span>
<span id="cb154-36"><a href="computing-quantal-response-equilibrium.html#cb154-36" tabindex="-1"></a>             <span class="fl">1e-4</span>,<span class="co"># minimum step size</span></span>
<span id="cb154-37"><a href="computing-quantal-response-equilibrium.html#cb154-37" tabindex="-1"></a>             <span class="fl">1.1</span>, <span class="co"># max deceleration</span></span>
<span id="cb154-38"><a href="computing-quantal-response-equilibrium.html#cb154-38" tabindex="-1"></a>             <span class="dv">1000</span>, <span class="co"># maximum number of iterations</span></span>
<span id="cb154-39"><a href="computing-quantal-response-equilibrium.html#cb154-39" tabindex="-1"></a>             <span class="fl">1e-4</span> <span class="co"># tolerance</span></span>
<span id="cb154-40"><a href="computing-quantal-response-equilibrium.html#cb154-40" tabindex="-1"></a>        )  </span>
<span id="cb154-41"><a href="computing-quantal-response-equilibrium.html#cb154-41" tabindex="-1"></a></span>
<span id="cb154-42"><a href="computing-quantal-response-equilibrium.html#cb154-42" tabindex="-1"></a>QRE<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">exp</span>(QRE[,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]),QRE[,<span class="dv">5</span>])</span>
<span id="cb154-43"><a href="computing-quantal-response-equilibrium.html#cb154-43" tabindex="-1"></a><span class="fu">colnames</span>(QRE)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;U&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;L&quot;</span>,<span class="st">&quot;R&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb154-44"><a href="computing-quantal-response-equilibrium.html#cb154-44" tabindex="-1"></a></span>
<span id="cb154-45"><a href="computing-quantal-response-equilibrium.html#cb154-45" tabindex="-1"></a>QRE<span class="ot">&lt;-</span>QRE <span class="sc">|&gt;</span> <span class="fu">data.frame</span>()</span>
<span id="cb154-46"><a href="computing-quantal-response-equilibrium.html#cb154-46" tabindex="-1"></a></span>
<span id="cb154-47"><a href="computing-quantal-response-equilibrium.html#cb154-47" tabindex="-1"></a>(</span>
<span id="cb154-48"><a href="computing-quantal-response-equilibrium.html#cb154-48" tabindex="-1"></a>  <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>U,<span class="at">y=</span>L))</span>
<span id="cb154-49"><a href="computing-quantal-response-equilibrium.html#cb154-49" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb154-50"><a href="computing-quantal-response-equilibrium.html#cb154-50" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb154-51"><a href="computing-quantal-response-equilibrium.html#cb154-51" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">coord_fixed</span>(<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb154-52"><a href="computing-quantal-response-equilibrium.html#cb154-52" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE1GMPlocus"></span>
<img src="index_files/figure-html/QRE1GMPlocus-1.png" alt="Locus of logit quantal response equilibrium probabilities for a generalized matching pennies game." width="672" />
<p class="caption">
Figure 12.1: Locus of logit quantal response equilibrium probabilities for a generalized matching pennies game.
</p>
</div>
<p>Figure @(fig:QRE1GMPlocus) shows the logit quantal response equilibrium <em>locus</em>. This is the set of mixed strategy profiles that are a quantal response equilibrium. While this kind of plot obfuscates the choice precision parametrer <span class="math inline">\(\lambda\)</span>, I really like to show a QRE this way, as it very clearly shows the kind of predictions that it can make.<a href="#fn57" class="footnote-ref" id="fnref57"><sup>57</sup></a></p>
<p>However to visualize the curves that the predictor-corrector algorithm is actually tracing out, you need to include <span class="math inline">\(\lambda\)</span>. This is shown in Figure <a href="computing-quantal-response-equilibrium.html#fig:QRE1GMPlambda">12.2</a>. Note that I have included <span class="math inline">\(\lambda\)</span> on a log scale. For this plot this transformation ensures that all of the interesting stuff isn’t squished up into the first 10% of horizontal coordinates.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="computing-quantal-response-equilibrium.html#cb155-1" tabindex="-1"></a>(</span>
<span id="cb155-2"><a href="computing-quantal-response-equilibrium.html#cb155-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>lambda))</span>
<span id="cb155-3"><a href="computing-quantal-response-equilibrium.html#cb155-3" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">y=</span>U,<span class="at">linetype=</span><span class="st">&quot;U&quot;</span>),<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb155-4"><a href="computing-quantal-response-equilibrium.html#cb155-4" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="fu">aes</span>(<span class="at">y=</span>L,<span class="at">linetype=</span><span class="st">&quot;L&quot;</span>),<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb155-5"><a href="computing-quantal-response-equilibrium.html#cb155-5" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb155-6"><a href="computing-quantal-response-equilibrium.html#cb155-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb155-7"><a href="computing-quantal-response-equilibrium.html#cb155-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb155-8"><a href="computing-quantal-response-equilibrium.html#cb155-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Mixed strategy&quot;</span>)</span>
<span id="cb155-9"><a href="computing-quantal-response-equilibrium.html#cb155-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_linetype_discrete</span>(<span class="at">name=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb155-10"><a href="computing-quantal-response-equilibrium.html#cb155-10" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE1GMPlambda"></span>
<img src="index_files/figure-html/QRE1GMPlambda-1.png" alt="Logit quantal response equilibrium of generalized matching pennies game as a function of choice precision $\lambda$" width="672" />
<p class="caption">
Figure 12.2: Logit quantal response equilibrium of generalized matching pennies game as a function of choice precision <span class="math inline">\(\lambda\)</span>
</p>
</div>
</div>
<div id="stag-hunt" class="section level3 hasAnchor" number="12.4.2">
<h3><span class="header-section-number">12.4.2</span> Stag hunt<a href="computing-quantal-response-equilibrium.html#stag-hunt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Table <a href="computing-quantal-response-equilibrium.html#tab:QRE1StagHunt">12.2</a> shows a <em>stag hunt</em> game, which is a coordination game with three Nash equilibria: <span class="math inline">\((U,L)\)</span>, <span class="math inline">\((D,R)\)</span>, and <span class="math inline">\(\sigma_U=\sigma_L=a/4\)</span>. This should get us a bit worried about computing quantal response equilibrium, because we will not find <em>all</em> of the paths if we just start at the centroid. To begin with, let’s set up the system of equations, and see what happens when we start at the centroid. Here I am going to take advantage of the symmetry of the game, noting that I can set <span class="math inline">\(\sigma_U=\sigma_L\)</span> without loss of generality.</p>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:QRE1StagHunt">Table 12.2: </span>A stag hunt game. <span class="math inline">\(0&lt;a&lt;4\)</span>
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
L
</th>
<th style="text-align:left;">
R
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
U
</td>
<td style="text-align:left;">
4, 4
</td>
<td style="text-align:left;">
0, a
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:left;">
a, 0
</td>
<td style="text-align:left;">
a, a
</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
\begin{aligned}
H(\lambda,\rho)
&amp;=
\begin{pmatrix}
\rho_U-\rho_D-\lambda(4\exp(\rho_U)-a)\\
\exp(\rho_U)+\exp(\rho_D)-1
\end{pmatrix}
\\
\frac{\partial H(\lambda,\rho)}{\partial \rho^\top}
&amp;=\begin{bmatrix}
1-4\lambda\exp(\rho_U) &amp; -1\\
\exp(\rho_U) &amp; \exp(\rho_D)
\end{bmatrix}
\\
\frac{\partial H(\lambda,\rho)}{\partial \lambda}
&amp;=\begin{pmatrix}
-(4\exp(\rho_U)-a)\\ 0
\end{pmatrix}
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="computing-quantal-response-equilibrium.html#cb156-1" tabindex="-1"></a>StagHunt<span class="ot">&lt;-</span><span class="cf">function</span>(a) {</span>
<span id="cb156-2"><a href="computing-quantal-response-equilibrium.html#cb156-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb156-3"><a href="computing-quantal-response-equilibrium.html#cb156-3" tabindex="-1"></a>  <span class="at">H =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb156-4"><a href="computing-quantal-response-equilibrium.html#cb156-4" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb156-5"><a href="computing-quantal-response-equilibrium.html#cb156-5" tabindex="-1"></a>      rho[<span class="dv">1</span>]<span class="sc">-</span>rho[<span class="dv">2</span>]<span class="sc">-</span>lambda<span class="sc">*</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">-</span>a),</span>
<span id="cb156-6"><a href="computing-quantal-response-equilibrium.html#cb156-6" tabindex="-1"></a>      <span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">exp</span>(rho[<span class="dv">2</span>])<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb156-7"><a href="computing-quantal-response-equilibrium.html#cb156-7" tabindex="-1"></a>    )</span>
<span id="cb156-8"><a href="computing-quantal-response-equilibrium.html#cb156-8" tabindex="-1"></a>  }</span>
<span id="cb156-9"><a href="computing-quantal-response-equilibrium.html#cb156-9" tabindex="-1"></a>  ,</span>
<span id="cb156-10"><a href="computing-quantal-response-equilibrium.html#cb156-10" tabindex="-1"></a>  <span class="at">Hrho =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb156-11"><a href="computing-quantal-response-equilibrium.html#cb156-11" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb156-12"><a href="computing-quantal-response-equilibrium.html#cb156-12" tabindex="-1"></a>      <span class="fu">c</span>(<span class="dv">1-4</span><span class="sc">*</span>lambda<span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">1</span>]),<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb156-13"><a href="computing-quantal-response-equilibrium.html#cb156-13" tabindex="-1"></a>      <span class="fu">c</span>(<span class="fu">exp</span>(rho[<span class="dv">1</span>]),<span class="fu">exp</span>(rho[<span class="dv">2</span>]))</span>
<span id="cb156-14"><a href="computing-quantal-response-equilibrium.html#cb156-14" tabindex="-1"></a>    )</span>
<span id="cb156-15"><a href="computing-quantal-response-equilibrium.html#cb156-15" tabindex="-1"></a>  }</span>
<span id="cb156-16"><a href="computing-quantal-response-equilibrium.html#cb156-16" tabindex="-1"></a>  ,</span>
<span id="cb156-17"><a href="computing-quantal-response-equilibrium.html#cb156-17" tabindex="-1"></a>  <span class="at">Hlambda =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb156-18"><a href="computing-quantal-response-equilibrium.html#cb156-18" tabindex="-1"></a>    <span class="fu">rbind</span>(</span>
<span id="cb156-19"><a href="computing-quantal-response-equilibrium.html#cb156-19" tabindex="-1"></a>      <span class="sc">-</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">-</span>a),</span>
<span id="cb156-20"><a href="computing-quantal-response-equilibrium.html#cb156-20" tabindex="-1"></a>      <span class="dv">0</span></span>
<span id="cb156-21"><a href="computing-quantal-response-equilibrium.html#cb156-21" tabindex="-1"></a>    )</span>
<span id="cb156-22"><a href="computing-quantal-response-equilibrium.html#cb156-22" tabindex="-1"></a>  }</span>
<span id="cb156-23"><a href="computing-quantal-response-equilibrium.html#cb156-23" tabindex="-1"></a>)</span>
<span id="cb156-24"><a href="computing-quantal-response-equilibrium.html#cb156-24" tabindex="-1"></a>}</span>
<span id="cb156-25"><a href="computing-quantal-response-equilibrium.html#cb156-25" tabindex="-1"></a></span>
<span id="cb156-26"><a href="computing-quantal-response-equilibrium.html#cb156-26" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb156-27"><a href="computing-quantal-response-equilibrium.html#cb156-27" tabindex="-1"></a></span>
<span id="cb156-28"><a href="computing-quantal-response-equilibrium.html#cb156-28" tabindex="-1"></a>QRE1<span class="ot">&lt;-</span>   <span class="fu">PC</span>(<span class="fu">StagHunt</span>(a),</span>
<span id="cb156-29"><a href="computing-quantal-response-equilibrium.html#cb156-29" tabindex="-1"></a>             <span class="dv">2</span>, <span class="co"># total number of actions</span></span>
<span id="cb156-30"><a href="computing-quantal-response-equilibrium.html#cb156-30" tabindex="-1"></a>           <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb156-31"><a href="computing-quantal-response-equilibrium.html#cb156-31" tabindex="-1"></a>           <span class="fu">rep</span>(<span class="fu">log</span>(<span class="fl">0.5</span>),<span class="dv">2</span>), <span class="co"># rho0</span></span>
<span id="cb156-32"><a href="computing-quantal-response-equilibrium.html#cb156-32" tabindex="-1"></a>             <span class="fl">0.03</span>, <span class="co"># first step size</span></span>
<span id="cb156-33"><a href="computing-quantal-response-equilibrium.html#cb156-33" tabindex="-1"></a>             <span class="fl">1e-4</span>,<span class="co"># minimum step size</span></span>
<span id="cb156-34"><a href="computing-quantal-response-equilibrium.html#cb156-34" tabindex="-1"></a>             <span class="fl">1.1</span>, <span class="co"># max deceleration</span></span>
<span id="cb156-35"><a href="computing-quantal-response-equilibrium.html#cb156-35" tabindex="-1"></a>             <span class="dv">1000</span>, <span class="co"># maximum number of iterations</span></span>
<span id="cb156-36"><a href="computing-quantal-response-equilibrium.html#cb156-36" tabindex="-1"></a>             <span class="fl">1e-4</span> <span class="co"># tolerance</span></span>
<span id="cb156-37"><a href="computing-quantal-response-equilibrium.html#cb156-37" tabindex="-1"></a>        )  </span>
<span id="cb156-38"><a href="computing-quantal-response-equilibrium.html#cb156-38" tabindex="-1"></a></span>
<span id="cb156-39"><a href="computing-quantal-response-equilibrium.html#cb156-39" tabindex="-1"></a>QRE1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(QRE1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb156-40"><a href="computing-quantal-response-equilibrium.html#cb156-40" tabindex="-1"></a></span>
<span id="cb156-41"><a href="computing-quantal-response-equilibrium.html#cb156-41" tabindex="-1"></a>QRE1<span class="ot">&lt;-</span>QRE1 <span class="sc">|&gt;</span> <span class="fu">data.frame</span>()</span>
<span id="cb156-42"><a href="computing-quantal-response-equilibrium.html#cb156-42" tabindex="-1"></a><span class="fu">colnames</span>(QRE1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;U&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb156-43"><a href="computing-quantal-response-equilibrium.html#cb156-43" tabindex="-1"></a></span>
<span id="cb156-44"><a href="computing-quantal-response-equilibrium.html#cb156-44" tabindex="-1"></a>(</span>
<span id="cb156-45"><a href="computing-quantal-response-equilibrium.html#cb156-45" tabindex="-1"></a>  <span class="fu">ggplot</span>(QRE1,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>U))</span>
<span id="cb156-46"><a href="computing-quantal-response-equilibrium.html#cb156-46" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb156-47"><a href="computing-quantal-response-equilibrium.html#cb156-47" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb156-48"><a href="computing-quantal-response-equilibrium.html#cb156-48" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb156-49"><a href="computing-quantal-response-equilibrium.html#cb156-49" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb156-50"><a href="computing-quantal-response-equilibrium.html#cb156-50" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,a<span class="sc">/</span><span class="dv">4</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb156-51"><a href="computing-quantal-response-equilibrium.html#cb156-51" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE1StagHuntPrincipalBranch"></span>
<img src="index_files/figure-html/QRE1StagHuntPrincipalBranch-1.png" alt="The principal branch of the logit quantal response equilibrium of the stag hunt game with $a=1$." width="672" />
<p class="caption">
Figure 12.3: The principal branch of the logit quantal response equilibrium of the stag hunt game with <span class="math inline">\(a=1\)</span>.
</p>
</div>
<p>Tracing out the principal branch of the logit QRE is done in exactly the same way as we did it for the asymmetric matching pennies games. This branch is shown in Figure <a href="computing-quantal-response-equilibrium.html#fig:QRE1StagHuntPrincipalBranch">12.3</a> for <span class="math inline">\(a=1\)</span>. However note that we have only approach one of the three Nash equilibria, which are shown with horizontal dashed lines. In order to trace out the other parts of the quantal response equilibrium, we need to give the predictor-corrector algorithm different starting points. Let’s do this and add them to the principal branch:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="computing-quantal-response-equilibrium.html#cb157-1" tabindex="-1"></a><span class="co"># Starting close to the mixed strategy Nash equilibrium</span></span>
<span id="cb157-2"><a href="computing-quantal-response-equilibrium.html#cb157-2" tabindex="-1"></a></span>
<span id="cb157-3"><a href="computing-quantal-response-equilibrium.html#cb157-3" tabindex="-1"></a>QRE2<span class="ot">&lt;-</span>   <span class="fu">PC</span>(<span class="fu">StagHunt</span>(a),</span>
<span id="cb157-4"><a href="computing-quantal-response-equilibrium.html#cb157-4" tabindex="-1"></a>             <span class="dv">2</span>, <span class="co"># total number of actions</span></span>
<span id="cb157-5"><a href="computing-quantal-response-equilibrium.html#cb157-5" tabindex="-1"></a>           <span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">0</span>),</span>
<span id="cb157-6"><a href="computing-quantal-response-equilibrium.html#cb157-6" tabindex="-1"></a>           <span class="fu">c</span>(<span class="fu">log</span>(a<span class="sc">/</span><span class="dv">4</span>),<span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>a<span class="sc">/</span><span class="dv">4</span>)), <span class="co"># rho0</span></span>
<span id="cb157-7"><a href="computing-quantal-response-equilibrium.html#cb157-7" tabindex="-1"></a>             <span class="fl">0.001</span>, <span class="co"># first step size</span></span>
<span id="cb157-8"><a href="computing-quantal-response-equilibrium.html#cb157-8" tabindex="-1"></a>             <span class="fl">1e-4</span>,<span class="co"># minimum step size</span></span>
<span id="cb157-9"><a href="computing-quantal-response-equilibrium.html#cb157-9" tabindex="-1"></a>             <span class="fl">1.01</span>, <span class="co"># max deceleration</span></span>
<span id="cb157-10"><a href="computing-quantal-response-equilibrium.html#cb157-10" tabindex="-1"></a>             <span class="dv">1000</span>, <span class="co"># maximum number of iterations</span></span>
<span id="cb157-11"><a href="computing-quantal-response-equilibrium.html#cb157-11" tabindex="-1"></a>             <span class="fl">1e-4</span> <span class="co"># tolerance</span></span>
<span id="cb157-12"><a href="computing-quantal-response-equilibrium.html#cb157-12" tabindex="-1"></a>        )  </span>
<span id="cb157-13"><a href="computing-quantal-response-equilibrium.html#cb157-13" tabindex="-1"></a></span>
<span id="cb157-14"><a href="computing-quantal-response-equilibrium.html#cb157-14" tabindex="-1"></a>QRE2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(QRE2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb157-15"><a href="computing-quantal-response-equilibrium.html#cb157-15" tabindex="-1"></a></span>
<span id="cb157-16"><a href="computing-quantal-response-equilibrium.html#cb157-16" tabindex="-1"></a>QRE2<span class="ot">&lt;-</span>QRE2 <span class="sc">|&gt;</span> <span class="fu">data.frame</span>()</span>
<span id="cb157-17"><a href="computing-quantal-response-equilibrium.html#cb157-17" tabindex="-1"></a><span class="fu">colnames</span>(QRE2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;U&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb157-18"><a href="computing-quantal-response-equilibrium.html#cb157-18" tabindex="-1"></a></span>
<span id="cb157-19"><a href="computing-quantal-response-equilibrium.html#cb157-19" tabindex="-1"></a><span class="do">## Joining them together</span></span>
<span id="cb157-20"><a href="computing-quantal-response-equilibrium.html#cb157-20" tabindex="-1"></a></span>
<span id="cb157-21"><a href="computing-quantal-response-equilibrium.html#cb157-21" tabindex="-1"></a>QRE<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb157-22"><a href="computing-quantal-response-equilibrium.html#cb157-22" tabindex="-1"></a>  QRE1 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">branch =</span> <span class="st">&quot;Principal&quot;</span>),</span>
<span id="cb157-23"><a href="computing-quantal-response-equilibrium.html#cb157-23" tabindex="-1"></a>  QRE2 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">branch =</span> <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb157-24"><a href="computing-quantal-response-equilibrium.html#cb157-24" tabindex="-1"></a>)</span>
<span id="cb157-25"><a href="computing-quantal-response-equilibrium.html#cb157-25" tabindex="-1"></a></span>
<span id="cb157-26"><a href="computing-quantal-response-equilibrium.html#cb157-26" tabindex="-1"></a>(</span>
<span id="cb157-27"><a href="computing-quantal-response-equilibrium.html#cb157-27" tabindex="-1"></a>  <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>U,<span class="at">color=</span>branch))</span>
<span id="cb157-28"><a href="computing-quantal-response-equilibrium.html#cb157-28" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb157-29"><a href="computing-quantal-response-equilibrium.html#cb157-29" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb157-30"><a href="computing-quantal-response-equilibrium.html#cb157-30" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb157-31"><a href="computing-quantal-response-equilibrium.html#cb157-31" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb157-32"><a href="computing-quantal-response-equilibrium.html#cb157-32" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,a<span class="sc">/</span><span class="dv">4</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb157-33"><a href="computing-quantal-response-equilibrium.html#cb157-33" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE1StagHuntOtherBranches"></span>
<img src="index_files/figure-html/QRE1StagHuntOtherBranches-1.png" alt="Logit quantal response equilibrium branches for the stag hunt game with $a=1$." width="672" />
<p class="caption">
Figure 12.4: Logit quantal response equilibrium branches for the stag hunt game with <span class="math inline">\(a=1\)</span>.
</p>
</div>
<p>The principal branch is shown alongside the other branch in Figure <a href="computing-quantal-response-equilibrium.html#fig:QRE1StagHuntOtherBranches">12.4</a>. Note with the above code that I had to tweak some of the tuning parameters: <code>max_deceleration</code> is much smaller, which means that the step size will change more slowly. What is also apparent from this Figure is that we can get turning points in <span class="math inline">\(\lambda\)</span>. This can be seen in the “Other” branch (red curve). We therefore cannot always parameterize these curves as a function of <span class="math inline">\(\lambda\)</span>.</p>
<p>An interesting knife-edge case for this game is when <span class="math inline">\(a=2\)</span>. Here the principal branch is constant at <span class="math inline">\(\sigma_U=0.5\)</span>, and hence is always equal to the mixed strategy Nash equilibrium. In this case, we get a bifurcation, and the two pure-strategy Nash equilibria are connected by a branch. Therefore, the only way to compute the non-principal branch is to start really close to one of the pure-strategy Nash equilibria. For this case, suppose we start close to the Nash equilibrium where <span class="math inline">\(\sigma_U=0\)</span>. This means that the expected utility of playing <span class="math inline">\(U\)</span> will be approximately zero (for large but finite <span class="math inline">\(\lambda\)</span>), and the expected utility of playing <span class="math inline">\(D\)</span> will be <span class="math inline">\(a=2\)</span>. Therefore the approximate quantal response equilibrium mixed strategy for large <span class="math inline">\(\lambda\)</span> will be:</p>
<p><span class="math display">\[
\sigma_U(\lambda)\approx(1+\exp(-\lambda(0-2)))^{-1}
\]</span></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="computing-quantal-response-equilibrium.html#cb158-1" tabindex="-1"></a>a<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb158-2"><a href="computing-quantal-response-equilibrium.html#cb158-2" tabindex="-1"></a></span>
<span id="cb158-3"><a href="computing-quantal-response-equilibrium.html#cb158-3" tabindex="-1"></a></span>
<span id="cb158-4"><a href="computing-quantal-response-equilibrium.html#cb158-4" tabindex="-1"></a>QRE1<span class="ot">&lt;-</span>   <span class="fu">PC</span>(<span class="fu">StagHunt</span>(a),</span>
<span id="cb158-5"><a href="computing-quantal-response-equilibrium.html#cb158-5" tabindex="-1"></a>             <span class="dv">2</span>, <span class="co"># total number of actions</span></span>
<span id="cb158-6"><a href="computing-quantal-response-equilibrium.html#cb158-6" tabindex="-1"></a>           <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),</span>
<span id="cb158-7"><a href="computing-quantal-response-equilibrium.html#cb158-7" tabindex="-1"></a>           <span class="fu">rep</span>(<span class="fu">log</span>(<span class="fl">0.5</span>),<span class="dv">2</span>), <span class="co"># rho0</span></span>
<span id="cb158-8"><a href="computing-quantal-response-equilibrium.html#cb158-8" tabindex="-1"></a>             <span class="fl">0.03</span>, <span class="co"># first step size</span></span>
<span id="cb158-9"><a href="computing-quantal-response-equilibrium.html#cb158-9" tabindex="-1"></a>             <span class="fl">1e-4</span>,<span class="co"># minimum step size</span></span>
<span id="cb158-10"><a href="computing-quantal-response-equilibrium.html#cb158-10" tabindex="-1"></a>             <span class="fl">1.1</span>, <span class="co"># max deceleration</span></span>
<span id="cb158-11"><a href="computing-quantal-response-equilibrium.html#cb158-11" tabindex="-1"></a>             <span class="dv">1000</span>, <span class="co"># maximum number of iterations</span></span>
<span id="cb158-12"><a href="computing-quantal-response-equilibrium.html#cb158-12" tabindex="-1"></a>             <span class="fl">1e-4</span> <span class="co"># tolerance</span></span>
<span id="cb158-13"><a href="computing-quantal-response-equilibrium.html#cb158-13" tabindex="-1"></a>        )  </span>
<span id="cb158-14"><a href="computing-quantal-response-equilibrium.html#cb158-14" tabindex="-1"></a></span>
<span id="cb158-15"><a href="computing-quantal-response-equilibrium.html#cb158-15" tabindex="-1"></a>QRE1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(QRE1[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb158-16"><a href="computing-quantal-response-equilibrium.html#cb158-16" tabindex="-1"></a>QRE1<span class="ot">&lt;-</span>QRE1 <span class="sc">|&gt;</span> <span class="fu">data.frame</span>()</span>
<span id="cb158-17"><a href="computing-quantal-response-equilibrium.html#cb158-17" tabindex="-1"></a><span class="fu">colnames</span>(QRE1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;U&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb158-18"><a href="computing-quantal-response-equilibrium.html#cb158-18" tabindex="-1"></a></span>
<span id="cb158-19"><a href="computing-quantal-response-equilibrium.html#cb158-19" tabindex="-1"></a>lambdaStart<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb158-20"><a href="computing-quantal-response-equilibrium.html#cb158-20" tabindex="-1"></a></span>
<span id="cb158-21"><a href="computing-quantal-response-equilibrium.html#cb158-21" tabindex="-1"></a>QRE2<span class="ot">&lt;-</span>   <span class="fu">PC</span>(<span class="fu">StagHunt</span>(a),</span>
<span id="cb158-22"><a href="computing-quantal-response-equilibrium.html#cb158-22" tabindex="-1"></a>             <span class="dv">2</span>, <span class="co"># total number of actions</span></span>
<span id="cb158-23"><a href="computing-quantal-response-equilibrium.html#cb158-23" tabindex="-1"></a>           <span class="fu">c</span>(lambdaStart,<span class="dv">0</span>),</span>
<span id="cb158-24"><a href="computing-quantal-response-equilibrium.html#cb158-24" tabindex="-1"></a>           <span class="fu">c</span>(<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="dv">2</span><span class="sc">*</span>lambdaStart)),<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>lambdaStart))), <span class="co"># rho0</span></span>
<span id="cb158-25"><a href="computing-quantal-response-equilibrium.html#cb158-25" tabindex="-1"></a>             <span class="fl">0.03</span>, <span class="co"># first step size</span></span>
<span id="cb158-26"><a href="computing-quantal-response-equilibrium.html#cb158-26" tabindex="-1"></a>             <span class="fl">1e-4</span>,<span class="co"># minimum step size</span></span>
<span id="cb158-27"><a href="computing-quantal-response-equilibrium.html#cb158-27" tabindex="-1"></a>             <span class="fl">1.01</span>, <span class="co"># max deceleration</span></span>
<span id="cb158-28"><a href="computing-quantal-response-equilibrium.html#cb158-28" tabindex="-1"></a>             <span class="dv">1000</span>, <span class="co"># maximum number of iterations</span></span>
<span id="cb158-29"><a href="computing-quantal-response-equilibrium.html#cb158-29" tabindex="-1"></a>             <span class="fl">1e-4</span> <span class="co"># tolerance</span></span>
<span id="cb158-30"><a href="computing-quantal-response-equilibrium.html#cb158-30" tabindex="-1"></a>        ) </span>
<span id="cb158-31"><a href="computing-quantal-response-equilibrium.html#cb158-31" tabindex="-1"></a></span>
<span id="cb158-32"><a href="computing-quantal-response-equilibrium.html#cb158-32" tabindex="-1"></a>QRE2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(QRE2[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb158-33"><a href="computing-quantal-response-equilibrium.html#cb158-33" tabindex="-1"></a>QRE2<span class="ot">&lt;-</span>QRE2 <span class="sc">|&gt;</span> <span class="fu">data.frame</span>()</span>
<span id="cb158-34"><a href="computing-quantal-response-equilibrium.html#cb158-34" tabindex="-1"></a><span class="fu">colnames</span>(QRE2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;U&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb158-35"><a href="computing-quantal-response-equilibrium.html#cb158-35" tabindex="-1"></a></span>
<span id="cb158-36"><a href="computing-quantal-response-equilibrium.html#cb158-36" tabindex="-1"></a>QRE<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb158-37"><a href="computing-quantal-response-equilibrium.html#cb158-37" tabindex="-1"></a>  QRE1 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">branch =</span> <span class="st">&quot;Principal&quot;</span>),</span>
<span id="cb158-38"><a href="computing-quantal-response-equilibrium.html#cb158-38" tabindex="-1"></a>  QRE2 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">branch =</span> <span class="st">&quot;Other&quot;</span>)</span>
<span id="cb158-39"><a href="computing-quantal-response-equilibrium.html#cb158-39" tabindex="-1"></a>)</span>
<span id="cb158-40"><a href="computing-quantal-response-equilibrium.html#cb158-40" tabindex="-1"></a></span>
<span id="cb158-41"><a href="computing-quantal-response-equilibrium.html#cb158-41" tabindex="-1"></a>(</span>
<span id="cb158-42"><a href="computing-quantal-response-equilibrium.html#cb158-42" tabindex="-1"></a>  <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>U,<span class="at">color=</span>branch))</span>
<span id="cb158-43"><a href="computing-quantal-response-equilibrium.html#cb158-43" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb158-44"><a href="computing-quantal-response-equilibrium.html#cb158-44" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb158-45"><a href="computing-quantal-response-equilibrium.html#cb158-45" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb158-46"><a href="computing-quantal-response-equilibrium.html#cb158-46" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb158-47"><a href="computing-quantal-response-equilibrium.html#cb158-47" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,a<span class="sc">/</span><span class="dv">4</span>),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb158-48"><a href="computing-quantal-response-equilibrium.html#cb158-48" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE1StagHuntPitchfork"></span>
<img src="index_files/figure-html/QRE1StagHuntPitchfork-1.png" alt="Logit quantal response equilibrium branches for the stag hunt game with $a=2$." width="672" />
<p class="caption">
Figure 12.5: Logit quantal response equilibrium branches for the stag hunt game with <span class="math inline">\(a=2\)</span>.
</p>
</div>
</div>
<div id="n-player-volunteers-dilemma-imposing-symmetric-strategies" class="section level3 hasAnchor" number="12.4.3">
<h3><span class="header-section-number">12.4.3</span> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies<a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In their experimental analysis of the Volunteer’s Dilemma <span class="citation">(<a href="#ref-Diekmann1985">Diekmann 1985</a>)</span>, <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span> analyze the data through the lens of the <em>symmetric</em> quantal response equilibrium, which assumes that all players volunteer with the same probability.<a href="#fn58" class="footnote-ref" id="fnref58"><sup>58</sup></a> The Volunteer’s dilemma is an <span class="math inline">\(n\geq 2\)</span> person game, and is summarized in Table <a href="computing-quantal-response-equilibrium.html#tab:QRE1VolunteersDilemma">12.3</a>. Each player either volunteers (<span class="math inline">\(V\)</span>) at a private cost of <span class="math inline">\(c\)</span>, or does not volunteer <span class="math inline">\(D\)</span> at no cost. If at least one player volunteers, then all players earn <span class="math inline">\(V&gt;c\)</span>, and if no player volunteers, all earn <span class="math inline">\(L&lt;V-c\)</span>.</p>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:QRE1VolunteersDilemma">Table 12.3: </span>Payoffs for the Volunteer’s Dilemma
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
At least one other player volunteers
</th>
<th style="text-align:left;">
Nobody else volunteers
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Volunteer
</td>
<td style="text-align:left;">
V-c
</td>
<td style="text-align:left;">
V-c
</td>
</tr>
<tr>
<td style="text-align:left;">
Don’t volunteer
</td>
<td style="text-align:left;">
V
</td>
<td style="text-align:left;">
L
</td>
</tr>
</tbody>
</table>
<p>The symmetry assumption here greatly simplifies the equilibrium predictions. For example, in Nash equilibrium, it rules out everything except for the symmetric mixed strategy Nash equilibrium. Similarly for quantal response equilibrium, we are left just with the equilibria where everybody volunteers with probability <span class="math inline">\(\sigma_V(\lambda)\)</span>.
In working out the payoff differences needed to compute quantal response equilibrium, it is useful to have an expression for the probability that none of the <span class="math inline">\(n-1\)</span> opponents volunteer:</p>
<p><span class="math display">\[
\begin{aligned}
p(\text{nobody else volunteers})&amp;=\sigma_N^{n-1}\\
&amp;=\exp(\rho_N)^{n-1}\\
&amp;=\exp((n-1)\rho_N)
\\
p(\text{at least one other player volunteers})&amp;=1-\exp((n-1)\rho_N)
\end{aligned}
\]</span></p>
<p>These can then be used to construct <span class="math inline">\(H(\rho,\lambda)\)</span> and its derivatives as follows:</p>
<p><span class="math display">\[
\begin{aligned}
H(\lambda,\rho)
&amp;=\begin{pmatrix}
\rho_V - \rho_N
-\lambda(V-c-V(1-\exp((n-1)\rho_N))-L\exp((n-1)\rho_N)))\\
\exp(\rho_V)+\exp(\rho_N)-1
\end{pmatrix}\\
\frac{\partial H(\lambda,\rho)}{\partial \rho^\top}
&amp;=\begin{bmatrix}
1 &amp; -1-\lambda(n-1)\exp((n-1)\rho_N)\left(V-L\right)\\
1 &amp; 1
\end{bmatrix}
\\
\frac{\partial H(\rho,\lambda)}{\partial \lambda}
&amp;=\begin{pmatrix}
-(V-c-V(1-\exp((n-1)\rho_N))-L\exp((n-1)\rho_N)))\\
0
\end{pmatrix}
\end{aligned}
\]</span></p>
<p>Here are these functions coded in <em>R</em>:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="computing-quantal-response-equilibrium.html#cb159-1" tabindex="-1"></a>VolunteersDilemma<span class="ot">&lt;-</span><span class="cf">function</span>(n,V,c,L) {</span>
<span id="cb159-2"><a href="computing-quantal-response-equilibrium.html#cb159-2" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb159-3"><a href="computing-quantal-response-equilibrium.html#cb159-3" tabindex="-1"></a>    <span class="at">H =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb159-4"><a href="computing-quantal-response-equilibrium.html#cb159-4" tabindex="-1"></a>      <span class="fu">rbind</span>(</span>
<span id="cb159-5"><a href="computing-quantal-response-equilibrium.html#cb159-5" tabindex="-1"></a>        rho[<span class="dv">1</span>]<span class="sc">-</span>rho[<span class="dv">2</span>]<span class="sc">-</span>lambda<span class="sc">*</span>(</span>
<span id="cb159-6"><a href="computing-quantal-response-equilibrium.html#cb159-6" tabindex="-1"></a>          V<span class="sc">-</span>c<span class="sc">-</span>V<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>((n<span class="dv">-1</span>)<span class="sc">*</span>rho[<span class="dv">2</span>]))<span class="sc">-</span>L<span class="sc">*</span><span class="fu">exp</span>((n<span class="dv">-1</span>)<span class="sc">*</span>rho[<span class="dv">2</span>])</span>
<span id="cb159-7"><a href="computing-quantal-response-equilibrium.html#cb159-7" tabindex="-1"></a>        ),</span>
<span id="cb159-8"><a href="computing-quantal-response-equilibrium.html#cb159-8" tabindex="-1"></a>        <span class="fu">exp</span>(rho[<span class="dv">1</span>])<span class="sc">+</span><span class="fu">exp</span>(rho[<span class="dv">2</span>])<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb159-9"><a href="computing-quantal-response-equilibrium.html#cb159-9" tabindex="-1"></a>      )</span>
<span id="cb159-10"><a href="computing-quantal-response-equilibrium.html#cb159-10" tabindex="-1"></a>    }</span>
<span id="cb159-11"><a href="computing-quantal-response-equilibrium.html#cb159-11" tabindex="-1"></a>    ,</span>
<span id="cb159-12"><a href="computing-quantal-response-equilibrium.html#cb159-12" tabindex="-1"></a>    <span class="at">Hrho =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb159-13"><a href="computing-quantal-response-equilibrium.html#cb159-13" tabindex="-1"></a>      <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span><span class="sc">-</span>lambda<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">exp</span>((n<span class="dv">-1</span>)<span class="sc">*</span>rho[<span class="dv">2</span>])<span class="sc">*</span>(V<span class="sc">-</span>L)),</span>
<span id="cb159-14"><a href="computing-quantal-response-equilibrium.html#cb159-14" tabindex="-1"></a>            <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb159-15"><a href="computing-quantal-response-equilibrium.html#cb159-15" tabindex="-1"></a>      )</span>
<span id="cb159-16"><a href="computing-quantal-response-equilibrium.html#cb159-16" tabindex="-1"></a>    }</span>
<span id="cb159-17"><a href="computing-quantal-response-equilibrium.html#cb159-17" tabindex="-1"></a>    ,</span>
<span id="cb159-18"><a href="computing-quantal-response-equilibrium.html#cb159-18" tabindex="-1"></a>    <span class="at">Hlambda =</span> <span class="cf">function</span>(lambda,rho) {</span>
<span id="cb159-19"><a href="computing-quantal-response-equilibrium.html#cb159-19" tabindex="-1"></a>      <span class="fu">rbind</span>(</span>
<span id="cb159-20"><a href="computing-quantal-response-equilibrium.html#cb159-20" tabindex="-1"></a>        <span class="sc">-</span>( V<span class="sc">-</span>c<span class="sc">-</span>V<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>((n<span class="dv">-1</span>)<span class="sc">*</span>rho[<span class="dv">2</span>]))<span class="sc">-</span>L<span class="sc">*</span><span class="fu">exp</span>((n<span class="dv">-1</span>)<span class="sc">*</span>rho[<span class="dv">2</span>])),</span>
<span id="cb159-21"><a href="computing-quantal-response-equilibrium.html#cb159-21" tabindex="-1"></a>        <span class="dv">0</span></span>
<span id="cb159-22"><a href="computing-quantal-response-equilibrium.html#cb159-22" tabindex="-1"></a>      )</span>
<span id="cb159-23"><a href="computing-quantal-response-equilibrium.html#cb159-23" tabindex="-1"></a>    }</span>
<span id="cb159-24"><a href="computing-quantal-response-equilibrium.html#cb159-24" tabindex="-1"></a>  )</span>
<span id="cb159-25"><a href="computing-quantal-response-equilibrium.html#cb159-25" tabindex="-1"></a>}</span></code></pre></div>
<p>And now we can solve this for a few values of the group size <span class="math inline">\(n\)</span> (here I hold <span class="math inline">\(V=1\)</span>, <span class="math inline">\(c=0.1\)</span>, and <span class="math inline">\(L=0.2\)</span> constant):</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="computing-quantal-response-equilibrium.html#cb160-1" tabindex="-1"></a>QRE<span class="ot">&lt;-</span><span class="fu">data.frame</span>()</span>
<span id="cb160-2"><a href="computing-quantal-response-equilibrium.html#cb160-2" tabindex="-1"></a></span>
<span id="cb160-3"><a href="computing-quantal-response-equilibrium.html#cb160-3" tabindex="-1"></a><span class="cf">for</span> (nn <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb160-4"><a href="computing-quantal-response-equilibrium.html#cb160-4" tabindex="-1"></a></span>
<span id="cb160-5"><a href="computing-quantal-response-equilibrium.html#cb160-5" tabindex="-1"></a>  qre<span class="ot">&lt;-</span><span class="fu">PC</span>(<span class="fu">VolunteersDilemma</span>(nn,<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>),</span>
<span id="cb160-6"><a href="computing-quantal-response-equilibrium.html#cb160-6" tabindex="-1"></a>               <span class="dv">2</span>, <span class="co"># total number of actions</span></span>
<span id="cb160-7"><a href="computing-quantal-response-equilibrium.html#cb160-7" tabindex="-1"></a>             <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>),</span>
<span id="cb160-8"><a href="computing-quantal-response-equilibrium.html#cb160-8" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="fu">log</span>(<span class="fl">0.5</span>),<span class="dv">2</span>), <span class="co"># rho0</span></span>
<span id="cb160-9"><a href="computing-quantal-response-equilibrium.html#cb160-9" tabindex="-1"></a>               <span class="fl">0.03</span>, <span class="co"># first step size</span></span>
<span id="cb160-10"><a href="computing-quantal-response-equilibrium.html#cb160-10" tabindex="-1"></a>               <span class="fl">1e-4</span>,<span class="co"># minimum step size</span></span>
<span id="cb160-11"><a href="computing-quantal-response-equilibrium.html#cb160-11" tabindex="-1"></a>               <span class="fl">1.1</span>, <span class="co"># max deceleration</span></span>
<span id="cb160-12"><a href="computing-quantal-response-equilibrium.html#cb160-12" tabindex="-1"></a>               <span class="dv">1000</span>, <span class="co"># maximum number of iterations</span></span>
<span id="cb160-13"><a href="computing-quantal-response-equilibrium.html#cb160-13" tabindex="-1"></a>               <span class="fl">1e-4</span> <span class="co"># tolerance</span></span>
<span id="cb160-14"><a href="computing-quantal-response-equilibrium.html#cb160-14" tabindex="-1"></a>          ) </span>
<span id="cb160-15"><a href="computing-quantal-response-equilibrium.html#cb160-15" tabindex="-1"></a>  </span>
<span id="cb160-16"><a href="computing-quantal-response-equilibrium.html#cb160-16" tabindex="-1"></a>  qre[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="fu">exp</span>(qre[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb160-17"><a href="computing-quantal-response-equilibrium.html#cb160-17" tabindex="-1"></a>  <span class="fu">colnames</span>(qre)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;V&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb160-18"><a href="computing-quantal-response-equilibrium.html#cb160-18" tabindex="-1"></a>  </span>
<span id="cb160-19"><a href="computing-quantal-response-equilibrium.html#cb160-19" tabindex="-1"></a>  QRE<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb160-20"><a href="computing-quantal-response-equilibrium.html#cb160-20" tabindex="-1"></a>    QRE,</span>
<span id="cb160-21"><a href="computing-quantal-response-equilibrium.html#cb160-21" tabindex="-1"></a>    qre <span class="sc">|&gt;</span> </span>
<span id="cb160-22"><a href="computing-quantal-response-equilibrium.html#cb160-22" tabindex="-1"></a>      <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb160-23"><a href="computing-quantal-response-equilibrium.html#cb160-23" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="st">`</span><span class="at">group size</span><span class="st">`</span> <span class="ot">=</span> nn)</span>
<span id="cb160-24"><a href="computing-quantal-response-equilibrium.html#cb160-24" tabindex="-1"></a>  )</span>
<span id="cb160-25"><a href="computing-quantal-response-equilibrium.html#cb160-25" tabindex="-1"></a></span>
<span id="cb160-26"><a href="computing-quantal-response-equilibrium.html#cb160-26" tabindex="-1"></a>}</span>
<span id="cb160-27"><a href="computing-quantal-response-equilibrium.html#cb160-27" tabindex="-1"></a></span>
<span id="cb160-28"><a href="computing-quantal-response-equilibrium.html#cb160-28" tabindex="-1"></a>(</span>
<span id="cb160-29"><a href="computing-quantal-response-equilibrium.html#cb160-29" tabindex="-1"></a>  <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>V,<span class="at">color=</span><span class="fu">as.factor</span>(<span class="st">`</span><span class="at">group size</span><span class="st">`</span>)))</span>
<span id="cb160-30"><a href="computing-quantal-response-equilibrium.html#cb160-30" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb160-31"><a href="computing-quantal-response-equilibrium.html#cb160-31" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb160-32"><a href="computing-quantal-response-equilibrium.html#cb160-32" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb160-33"><a href="computing-quantal-response-equilibrium.html#cb160-33" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb160-34"><a href="computing-quantal-response-equilibrium.html#cb160-34" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Probability of volunteering&quot;</span>)</span>
<span id="cb160-35"><a href="computing-quantal-response-equilibrium.html#cb160-35" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_color_discrete</span>(<span class="at">name=</span><span class="st">&quot;group size&quot;</span>)</span>
<span id="cb160-36"><a href="computing-quantal-response-equilibrium.html#cb160-36" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb160-37"><a href="computing-quantal-response-equilibrium.html#cb160-37" tabindex="-1"></a>  </span>
<span id="cb160-38"><a href="computing-quantal-response-equilibrium.html#cb160-38" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE1VolunteersDilemmaPlot"></span>
<img src="index_files/figure-html/QRE1VolunteersDilemmaPlot-1.png" alt="The symmetric quantal response equilubrium paths for the $n$-player Volunteer's Dilemma with $V=1$, $c=0.1$ and $L=0.2$" width="672" />
<p class="caption">
Figure 12.6: The symmetric quantal response equilubrium paths for the <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma with <span class="math inline">\(V=1\)</span>, <span class="math inline">\(c=0.1\)</span> and <span class="math inline">\(L=0.2\)</span>
</p>
</div>
<!--

### Asymmetric Chicken

<table class=" lightable-classic" style='color: black; font-family: "Arial Narrow", "Source Sans Pro", sans-serif; width: auto !important; margin-left: auto; margin-right: auto;'>
<caption>(\#tab:QRE1chicken)Asymmetric chicken</caption>
 <thead>
  <tr>
   <th style="text-align:left;">   </th>
   <th style="text-align:left;"> L </th>
   <th style="text-align:left;"> R </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> U </td>
   <td style="text-align:left;"> 0, 0 </td>
   <td style="text-align:left;"> 6, 1 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> L </td>
   <td style="text-align:left;"> 1, 14 </td>
   <td style="text-align:left;"> 2, 2 </td>
  </tr>
</tbody>
</table>

$$
\begin{aligned}
H(\lambda,\rho)&=\begin{pmatrix}
\rho_U-\rho_D-\lambda(-\exp(\rho_L)+4\exp(\rho_R))\\
\rho_L-\rho_R-\lambda(-\exp(\rho_U)+12\exp(\rho_L))\\
\exp(\rho_U)+\exp(\rho_D)-1\\
\exp(\rho_L)+\exp(\rho_R)-1
\end{pmatrix}
\\
\frac{\partial H(\lambda,\rho)}{\partial \rho^\top}&=\begin{bmatrix}
1 & -1 & \lambda\exp(\rho_L) & -4\lambda\exp(\rho_R)\\
\exp(\rho_U)&-12\exp(\rho_D)&1&-1\\
\exp(\rho_U)& \exp(\rho_D)&0&0\\
0&0&\exp(\rho_L)& \exp(\rho_R)
\end{bmatrix}
\\
\frac{\partial H(\lambda,\rho)}{\partial \lambda}
&=\begin{pmatrix}
-(-\exp(\rho_L)+4\exp(\rho_R))\\
-(-\exp(\rho_U)+12\exp(\rho_L))\\
0\\0
\end{pmatrix}
\end{aligned}
$$


```r
Chicken<-list(
  H=function(lambda,rho) {
    rbind(
      rho[1]-rho[2]-lambda*(-exp(rho[3])+4*exp(rho[4])),
      rho[3]-rho[4]-lambda*(-exp(rho[1])+12*exp(rho[2])),
      exp(rho[1])+exp(rho[2])-1,
      exp(rho[3])+exp(rho[3])-1
    )
  },
  Hrho = function(lambda,rho) {
    rbind(
      c(1,-1,lambda*exp(rho[3]),-4*lambda*exp(rho[4])),
      c(exp(rho[1]),-12*exp(rho[2]),1,-1),
      c(exp(rho[1]),exp(rho[2]),0,0),
      c(0,0,exp(rho[3]),exp(rho[4]))
    )
  },
  Hlambda = function(lambda,rho) {
    rbind(
      -(-exp(rho[3])+4*exp(rho[4])),
      -(-exp(rho[1])+12*exp(rho[2])),
      0,0
    )
  }
)

QRE1<-PC(Chicken,
               4, # total number of actions
             c(0,10),
             rep(log(0.5),4), # rho0
               0.03, # first step size
               1e-4,# minimum step size
               1.1, # max deceleration
               1000, # maximum number of iterations
               1e-4 # tolerance
          ) 

QRE1[,1:4]<-exp(QRE1[,1:4])
colnames(QRE1)<-c("U","D","L","R","lambda")


QRE<-QRE1 |>
  data.frame() |>
  mutate(branch="principal")

(
  ggplot(QRE,aes(x=lambda))
  +geom_path(aes(y=U,color="U"))
  +geom_path(aes(y=L,color="L"))
  +theme_bw()
  +scale_x_continuous(trans="log10")
  +xlab(expression(lambda))
  +ylab("probability")
  +scale_color_discrete(name="")
)
```

-->
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bland2023QRE" class="csl-entry">
———. 2023a. <span>“Bayesian Inference for Quantal Response Equilibrium in Normal-Form Games.”</span> <em>Games and Economic Behavior</em>. https://doi.org/<a href="https://doi.org/10.1016/j.geb.2023.05.005">https://doi.org/10.1016/j.geb.2023.05.005</a>.
</div>
<div id="ref-BlandTurocy2023" class="csl-entry">
Bland, James R, and Theodore L Turocy. 2025. <span>“Quantal Response Equilibrium as a Structural Model for Estimation: The Missing Manual.”</span> <em>Games and Economic Behavior</em>.
</div>
<div id="ref-Diekmann1985" class="csl-entry">
Diekmann, Andreas. 1985. <span>“Volunteer’s Dilemma.”</span> <em>Journal of Conflict Resolution</em> 29 (4): 605–10.
</div>
<div id="ref-Goeree2017" class="csl-entry">
Goeree, Jacob K, Charles A Holt, and Angela M Smith. 2017. <span>“An Experimental Examination of the Volunteer’s Dilemma.”</span> <em>Games and Economic Behavior</em> 102: 303–15.
</div>
<div id="ref-Gambit" class="csl-entry">
McKelvey, Richard D, Andrew M McLennan, and Theodore L Turocy. 2022. <span>“Gambit: Software Tools for Game Theory.”</span> <a href="http://www.gambit-project.org/">http://www.gambit-project.org/</a>.
</div>
<div id="ref-McKelvey1995" class="csl-entry">
McKelvey, Richard D, and Thomas R Palfrey. 1995. <span>“Quantal Response Equilibria for Normal Form Games.”</span> <em>Games and Economic Behavior</em> 10 (1): 6–38. <a href="https://doi.org/10.1006/game.1995.1023">https://doi.org/10.1006/game.1995.1023</a>.
</div>
<div id="ref-Ochs1995" class="csl-entry">
Ochs, Jack. 1995. <span>“Games with Unique, Mixed Strategy Equilibria: An Experimental Study.”</span> <em>Games and Economic Behavior</em> 10 (1): 202–17.
</div>
<div id="ref-Turocy2005" class="csl-entry">
Turocy, Theodore L. 2005. <span>“A Dynamic Homotopy Interpretation of the Logistic Quantal Response Equilibrium Correspondence.”</span> <em>Games and Economic Behavior</em> 51 (2): 243–63.
</div>
<div id="ref-Turocy2010" class="csl-entry">
———. 2010. <span>“Computing Sequential Equilibria Using Agent Quantal Response Equilibria.”</span> <em>Economic Theory</em> 42: 255–69.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="53">
<li id="fn53"><p>Loosely speaking, this is a similar problem to it being hard to maximize the likelihood in these applications.<a href="computing-quantal-response-equilibrium.html#fnref53" class="footnote-back">↩︎</a></p></li>
<li id="fn54"><p>For example, if <span class="math inline">\(\Delta x\)</span> is a solution to this equations, <span class="math inline">\(c\Delta x\)</span> for <span class="math inline">\(c\in\mathbb R\)</span> is also a solution.<a href="computing-quantal-response-equilibrium.html#fnref54" class="footnote-back">↩︎</a></p></li>
<li id="fn55"><p>This was a major time suck for me in converting Ted Turocy’s <em>Python</em> code into <em>R</em>, because the default options in each language are different. By default, <em>Python</em> computes the fat decomposition, but <em>R</em> does not. <a href="computing-quantal-response-equilibrium.html#fnref55" class="footnote-back">↩︎</a></p></li>
<li id="fn56"><p>That is, the predictor steps are equivalent if we are solving <span class="math inline">\(H(x)=0\)</span>, or <span class="math inline">\(H(x)=\)</span> any other vector of constants. In the predictor step, we explicitly take advantage of this being a zero condition.<a href="computing-quantal-response-equilibrium.html#fnref56" class="footnote-back">↩︎</a></p></li>
<li id="fn57"><p>You can see a lot of plots like this one in <span class="citation">Bland and Turocy (<a href="#ref-BlandTurocy2023">2025</a>)</span> and <span class="citation">Bland (<a href="#ref-Bland2023QRE">2023a</a>)</span>.<a href="computing-quantal-response-equilibrium.html#fnref57" class="footnote-back">↩︎</a></p></li>
<li id="fn58"><p>They then extend the model to investigate several motivations for heterogeneneous volunteering probabilities, which I might get to later.<a href="computing-quantal-response-equilibrium.html#fnref58" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
