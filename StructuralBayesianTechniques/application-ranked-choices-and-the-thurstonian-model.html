<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>17 Application: Ranked choices and the Thurstonian model | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="17 Application: Ranked choices and the Thurstonian model | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="17 Application: Ranked choices and the Thurstonian model | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="17 Application: Ranked choices and the Thurstonian model | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-03-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-meta-analysis-using-some-of-the-metaret-data.html"/>
<link rel="next" href="links-to-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>8</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="8.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>8.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="8.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>8.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="8.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>8.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="8.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>8.4</b> Vectorization</a></li>
<li class="chapter" data-level="8.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>8.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="8.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>8.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>8.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="8.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>8.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>8.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>8.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="8.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>8.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="9" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>9</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>9.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="9.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>9.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="9.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>9.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>9.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="9.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>9.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="9.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results"><i class="fa fa-check"></i><b>9.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>9.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>9.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="9.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>9.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="9.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>9.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>9.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>9.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="9.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>9.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="9.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>10</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>10.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="10.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>10.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>10.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="10.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>10.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>10.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>11</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="11.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>11.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="11.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>11.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>11.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="11.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>11.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="11.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>11.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="11.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>11.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>11.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="11.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>11.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>11.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="11.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>11.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="11.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>11.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>12</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>12.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="12.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>12.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>12.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="12.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>12.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="12.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>12.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="12.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-2"><i class="fa fa-check"></i><b>12.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>12.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>13</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models"><i class="fa fa-check"></i><b>13.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="13.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>13.2</b> A note on replication</a></li>
<li class="chapter" data-level="13.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>13.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>13.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="13.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>13.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="13.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>13.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-3"><i class="fa fa-check"></i><b>13.4</b> Results</a></li>
<li class="chapter" data-level="13.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>13.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>14</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>14.1</b> Data and game</a></li>
<li class="chapter" data-level="14.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>14.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>14.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>14.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>14.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>14.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>14.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="14.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-4"><i class="fa fa-check"></i><b>14.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>14.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>14.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-5"><i class="fa fa-check"></i><b>14.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>14.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>14.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>14.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="14.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>14.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>14.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>14.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="14.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>14.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>14.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>14.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>14.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>14.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>14.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>14.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="14.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>14.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="14.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>14.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="14.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>14.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="14.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>14.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>15</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>15.1</b> Example dataset</a></li>
<li class="chapter" data-level="15.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>15.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="15.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>15.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>15.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="15.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>15.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="15.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>15.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>15.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>15.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="15.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>15.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>15.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>16</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>16.1</b> Data</a></li>
<li class="chapter" data-level="16.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>16.2</b> A basic model</a></li>
<li class="chapter" data-level="16.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>16.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="16.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>16.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="16.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>16.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="16.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>16.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>17</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>17.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="17.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>17.2</b> Computational issues</a></li>
<li class="chapter" data-level="17.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>17.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="17.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>17.4</b> A representative agent model</a></li>
<li class="chapter" data-level="17.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>17.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="17.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>17.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="application-ranked-choices-and-the-thurstonian-model" class="section level1 hasAnchor" number="17">
<h1><span class="header-section-number">17</span> Application: Ranked choices and the Thurstonian model<a href="application-ranked-choices-and-the-thurstonian-model.html#application-ranked-choices-and-the-thurstonian-model" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Up to this point, I have shown you models for choosing <em>one thing</em> out of a choice set. This is often how we present things to our participants. In these situations, revealed preference tells us that the chosen item must be the item yielding the greatest utility of all items in the choice set. From a probabilistic choice perspective, we know that the utility of this item plus an error was the greatest. However in other experiments we might ask our participants to <em>rank</em> the items in a choice set. In principle, this gives a <em>a lot</em> more information, because not only do we know the payoff-maximizing item (i.e. the item ranked first), but we also know how all of the other items compare, too.<a href="#fn81" class="footnote-ref" id="fnref81"><sup>81</sup></a></p>
<p>While it is in principle possible to write down a (say) logit choice model where each option is one way to rank the items in the choice set, this will become computationally infeasible very quickly. Consider for example the choice data shown in Table <a href="application-ranked-choices-and-the-thurstonian-model.html#tab:ACKLP2022uid1">17.1</a>, which is the ranking of nine different distributions of earnings made by the first participant in the first game of <span class="citation">Alempaki et al. (<a href="#ref-ACKLP2022">2022</a>)</span>. There are <span class="math inline">\(9!=362,880\)</span> possible ways to rank these payoffs! In practice we will need a more tractable model for how people make decisions in environments like these.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-1" tabindex="-1"></a>ranking<span class="ot">&lt;-</span><span class="st">&quot;Data/ACKLP2022_ranking.dta&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb214-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-2" tabindex="-1"></a>  <span class="fu">read_dta</span>() <span class="sc">|&gt;</span></span>
<span id="cb214-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">uid =</span> <span class="fu">paste</span>(<span class="st">&quot;id&quot;</span>,id) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()) <span class="sc">|&gt;</span></span>
<span id="cb214-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-4" tabindex="-1"></a>  <span class="fu">arrange</span>(uid,game)</span>
<span id="cb214-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-5" tabindex="-1"></a></span>
<span id="cb214-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-6" tabindex="-1"></a>ranking <span class="sc">|&gt;</span> </span>
<span id="cb214-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-7" tabindex="-1"></a>  <span class="fu">filter</span>(uid<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> game<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb214-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ranking,own,other) <span class="sc">|&gt;</span></span>
<span id="cb214-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-9" tabindex="-1"></a>  <span class="fu">arrange</span>(ranking) <span class="sc">|&gt;</span></span>
<span id="cb214-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-10" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Ranking of payoffs in game 1 made by participant 1,&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb214-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb214-11" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:ACKLP2022uid1">Table 17.1: </span>Ranking of payoffs in game 1 made by participant 1,
</caption>
<thead>
<tr>
<th style="text-align:right;">
ranking
</th>
<th style="text-align:right;">
own
</th>
<th style="text-align:right;">
other
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
10
</td>
</tr>
</tbody>
</table>
<div id="the-thurstonian-model" class="section level2 hasAnchor" number="17.1">
<h2><span class="header-section-number">17.1</span> The Thurstonian model<a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One way to tractably handle ordered choice data is with a <a href="https://en.wikipedia.org/wiki/Thurstonian_model"><em>Thurstonian model</em></a>. This model assumes that each item <span class="math inline">\(k\)</span> in the choice set <span class="math inline">\(j\)</span> has a latent variable <span class="math inline">\(z_{j,k}\)</span>. The ranking we observe in the data is the ranking of the realization of the vector <span class="math inline">\(z_j\)</span>. We then assume a distribution for this latent vector, and estimate the parameters in this distribution. For example, we might assume a normal distribution:</p>
<p><span class="math display">\[
z_{j,k}\sim \text{ind }N(\mu_{j,k},\sigma^2)
\]</span></p>
<p>From a structural perspective, we can interpret <span class="math inline">\(z_{j,k}\)</span> as the utility of item <span class="math inline">\(k\)</span> in choice set <span class="math inline">\(j\)</span>. We can let the mean of this latent variable <span class="math inline">\(\mu_{j,k}\)</span> be a function of the data and our model’s parameters, which means that we can use this to estimate a utility function! That is, suppose we have a utility function <span class="math inline">\(U(x;\theta)\)</span> with arguments <span class="math inline">\(x\)</span> and parameters <span class="math inline">\(\theta\)</span>, then we can set <span class="math inline">\(\mu_{j,k}=U(x_{j,k};\theta)\)</span>.</p>
<p>To see how this model relates to models of choosing a single thing from a choice set, consider the special case where the choice set has just two items. In this case, the participant will rank item <span class="math inline">\(k=1\)</span> over <span class="math inline">\(k=2\)</span> if and only if <span class="math inline">\(z_{j,1}&gt;z_{j,2}\)</span>, which occurs with probability:</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(z_{j,1}&gt;z_{j,2})&amp;=\Pr\left(U(x_{j,1};\theta)-U(x_{j,2};\theta)+\sigma(\xi_1-\xi_2)&gt;0\right)&amp;\quad \xi_1,\xi_2\sim iid N(0,1)\\
&amp;=\Pr\left(\frac{U(x_{j,1};\theta)-U(x_{j,2};\theta)}{\sigma}&gt;\xi_2-\xi_1\right)\\
&amp;=\Phi\left(\frac{U(x_{j,1};\theta)-U(x_{j,2};\theta)}{\sqrt 2\sigma}\right)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Phi(\cdot)\)</span> is the standard normal cdf, so it reduces to a model of probit choice!</p>
<p>As I have described the model up to this point, it is not identifiable if each <span class="math inline">\(\mu_{j,k}\)</span> is a free parameter. This is because adding a constant to the mean vector <span class="math inline">\(\mu_j\)</span> will generate the same predictions. A simple solution to this is to normalize the mean utility of one of the items in the choice set to zero. However in the example I present below, we do not need to do this, because our utility function does not have a constant in it. In fact, this should be the case for all of our utility functions, becuase we can always represent the same preferences by adding a constant to all of our utilities.</p>
<p>The trick to estimating this model in <em>Stan</em> is to sort the data by the ranking, then take advantage of the <a href="https://mc-stan.org/docs/reference-manual/vector-and-matrix-data-types.html#ordered-vectors"><code>ordered vector</code></a> data type. That is, I pass the data about each choice set to <em>Stan</em> so that it is ordered from worst to best. That way, I know that the latent utilities must be ordered like this:</p>
<p><span class="math display">\[
z_{j,K}&gt;z_{j,K-1}&gt;z_{j,K-2}&gt;\ldots&gt;z_{j,1}
\]</span></p>
<p>I then use data augmentation to draw these <span class="math inline">\(z_j\)</span>s. This part is really easy once you organize the data in the right way (outcomes ranked from worst to best). You will see in the <em>Stan</em> files below that all you really need to do to augment the data here is to just declare the distribution (i.e. <code>z ~ normal(U,sigma);</code>). The <code>ordered</code> vector takes care of the constraints.</p>
</div>
<div id="computational-issues" class="section level2 hasAnchor" number="17.2">
<h2><span class="header-section-number">17.2</span> Computational issues<a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>All of this data augmentation means that there will be a lot of numbers <em>Stan</em> needs to keep track of: every <span class="math inline">\(z_{j,k}\)</span> needs to be augmented. For example, suppose you have <span class="math inline">\(N\)</span> participants each do <span class="math inline">\(J\)</span> ranking tasks, each with <span class="math inline">\(K\)</span> things to rank in each task. This means that your model needs to augment <span class="math inline">\(NJK\)</span> pieces of data on top of anything else that you are doing. This is a lot more than you would normally do with a hierarchical model that just needs to augment the individual-level parameters. In this case if you have <span class="math inline">\(p\)</span> individual-level parameters per participant, you would just be augmenting <span class="math inline">\(Np\)</span> things.<a href="#fn82" class="footnote-ref" id="fnref82"><sup>82</sup></a> All of this is to say, beware of how much memory this augmentation is chewing up, and consider not saving these augmented data from your estimation, because there will be thousands of realizations for each of these variables. Think about whether you would actually need them.</p>
</div>
<div id="example-dataset-and-model-2" class="section level2 hasAnchor" number="17.3">
<h2><span class="header-section-number">17.3</span> Example dataset and model<a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Alempaki et al. (<a href="#ref-ACKLP2022">2022</a>)</span> elicit their participants’ preferences over the outcomes in eight games by asking them to rank these outcomes. An example of this ranking for the first participant in the first game is shown in Table <a href="application-ranked-choices-and-the-thurstonian-model.html#tab:ACKLP2022uid1">17.1</a>. Here “own” refers to the participant’s own monetary payoff, and “other” refers to their opponent’s monetary payoff. In order to incentivize truth-telling, if this ranking task was selected for payment, two of the outcomes were randomly selected. The outcome that the participant ranked higher was then implemented. For example based on the choices in Table <a href="application-ranked-choices-and-the-thurstonian-model.html#tab:ACKLP2022uid1">17.1</a>, if outcomes <span class="math inline">\((8,0)\)</span> and <span class="math inline">\((2,2)\)</span> were randomly selected, <span class="math inline">\((8,0)\)</span> would be implemented because this participant ranked this outcome higher.</p>
<p>As <span class="citation">Alempaki et al. (<a href="#ref-ACKLP2022">2022</a>)</span> were concerned about other-regarding preferences in their games, we will estimate a simple 1-parameter utility model for other-regarding preferences:</p>
<p><span class="math display">\[
U(x;\alpha)=x^\mathrm{own}+\alpha x^\mathrm{other}
\]</span>
where <span class="math inline">\(x^\mathrm{own}\)</span> is the decisioon-maker’s own earnings, and <span class="math inline">\(x^\mathrm{other}\)</span> is the other participant’s earnings. Here I am trying to keep things a simple as possible (while still hopefully being interesting) becuase I was having trouble estimating the full <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999">1999</a>)</span> model of inequality-aversion. Maybe when I understand more the pathologies of this model I will extend this chapter to include this.<a href="#fn83" class="footnote-ref" id="fnref83"><sup>83</sup></a></p>
</div>
<div id="a-representative-agent-model" class="section level2 hasAnchor" number="17.4">
<h2><span class="header-section-number">17.4</span> A representative agent model<a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While at this point you know how I feel about the value of reporting representative agent models, this one was really useful in helping me to understand the Thurstoninal model, so I present it here as a Thurstonian <em>only</em> model without the hierarchical stuff that should really go with it. But don’t worry, we’ll put all of that back in before the end of the chapter.</p>
<p>This model has two parameters, <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\sigma\)</span>, so we willset thesir priors to:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha&amp;\sim N(0,1)\\
\sigma&amp;\sim \mathrm{Cauchy}^+(0,1)
\end{aligned}
\]</span></p>
<p>These are fairly diffuse. Probably too diffuse if I actually calibrated them properly (especially for <span class="math inline">\(\alpha\)</span>), but they will pin down the model enough.</p>
<p>Without further ado, here is the <em>Stan</em> program I came up with to implement the model.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb215-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-1" tabindex="-1"></a></span>
<span id="cb215-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb215-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-3" tabindex="-1"></a>  </span>
<span id="cb215-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-4" tabindex="-1"></a>  <span class="dt">int</span> nparticipants<span class="op">;</span></span>
<span id="cb215-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-5" tabindex="-1"></a>  </span>
<span id="cb215-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-6" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N9<span class="op">;</span> <span class="co">// total number of decisions with 9 unique payoffs</span></span>
<span id="cb215-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-7" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N8<span class="op">;</span> <span class="co">// total number of decisions with 8 unique payoffs</span></span>
<span id="cb215-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-8" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N7<span class="op">;</span> <span class="co">// total number of decisions with 7 unique payoffs</span></span>
<span id="cb215-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-9" tabindex="-1"></a>  </span>
<span id="cb215-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-10" tabindex="-1"></a>  <span class="dt">int</span> id9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb215-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-11" tabindex="-1"></a>  <span class="dt">int</span> id8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb215-12"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-12" tabindex="-1"></a>  <span class="dt">int</span> id7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb215-13"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-13" tabindex="-1"></a>  </span>
<span id="cb215-14"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-14" tabindex="-1"></a>  <span class="co">// payoffs from the game, ranked in ordered choice, worst to best</span></span>
<span id="cb215-15"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-15" tabindex="-1"></a>    <span class="co">// for the games with 9 uninque payoffs</span></span>
<span id="cb215-16"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-16" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> own9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb215-17"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-17" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> other9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb215-18"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-18" tabindex="-1"></a>    <span class="co">// for the games with 8 uninque payoffs</span></span>
<span id="cb215-19"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-19" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> own8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb215-20"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-20" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> other8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb215-21"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-21" tabindex="-1"></a>    <span class="co">// for the games with 9 uninque payoffs</span></span>
<span id="cb215-22"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-22" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">7</span><span class="op">]</span> own7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb215-23"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-23" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">7</span><span class="op">]</span> other7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb215-24"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-24" tabindex="-1"></a>  </span>
<span id="cb215-25"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-25" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_alpha<span class="op">;</span></span>
<span id="cb215-26"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-26" tabindex="-1"></a>    real prior_sigma<span class="op">;</span></span>
<span id="cb215-27"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-27" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb215-28"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-28" tabindex="-1"></a></span>
<span id="cb215-29"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-29" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb215-30"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-30" tabindex="-1"></a>  </span>
<span id="cb215-31"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-31" tabindex="-1"></a>  real alpha<span class="op">;</span> <span class="co">// coefficient on other&#39;s payoff</span></span>
<span id="cb215-32"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-32" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> sigma<span class="op">;</span> <span class="co">// sd of latent variable</span></span>
<span id="cb215-33"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-33" tabindex="-1"></a>  </span>
<span id="cb215-34"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-34" tabindex="-1"></a>  <span class="co">// augmented data</span></span>
<span id="cb215-35"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-35" tabindex="-1"></a>  ordered<span class="op">[</span><span class="dv">9</span><span class="op">]</span> z9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb215-36"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-36" tabindex="-1"></a>  ordered<span class="op">[</span><span class="dv">8</span><span class="op">]</span> z8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb215-37"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-37" tabindex="-1"></a>  ordered<span class="op">[</span><span class="dv">7</span><span class="op">]</span> z7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb215-38"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-38" tabindex="-1"></a>  </span>
<span id="cb215-39"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-39" tabindex="-1"></a>  </span>
<span id="cb215-40"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-40" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb215-41"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-41" tabindex="-1"></a></span>
<span id="cb215-42"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-42" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb215-43"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-43" tabindex="-1"></a> </span>
<span id="cb215-44"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-44" tabindex="-1"></a>  </span>
<span id="cb215-45"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-45" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb215-46"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-46" tabindex="-1"></a></span>
<span id="cb215-47"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-47" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb215-48"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-48" tabindex="-1"></a>  </span>
<span id="cb215-49"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-49" tabindex="-1"></a>  </span>
<span id="cb215-50"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-50" tabindex="-1"></a>  </span>
<span id="cb215-51"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-51" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N9<span class="op">)</span> <span class="op">{</span></span>
<span id="cb215-52"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-52" tabindex="-1"></a>    </span>
<span id="cb215-53"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-53" tabindex="-1"></a>    <span class="co">// utility </span></span>
<span id="cb215-54"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-54" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> U <span class="op">=</span> own9<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">*</span>other9<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb215-55"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-55" tabindex="-1"></a>    </span>
<span id="cb215-56"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-56" tabindex="-1"></a>    z9<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">);</span></span>
<span id="cb215-57"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-57" tabindex="-1"></a>    </span>
<span id="cb215-58"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-58" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb215-59"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-59" tabindex="-1"></a>  </span>
<span id="cb215-60"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-60" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N8<span class="op">)</span> <span class="op">{</span></span>
<span id="cb215-61"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-61" tabindex="-1"></a>    <span class="co">// utility </span></span>
<span id="cb215-62"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-62" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> U <span class="op">=</span> own8<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">*</span>other8<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb215-63"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-63" tabindex="-1"></a>    </span>
<span id="cb215-64"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-64" tabindex="-1"></a>    </span>
<span id="cb215-65"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-65" tabindex="-1"></a>    z8<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">);</span></span>
<span id="cb215-66"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-66" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb215-67"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-67" tabindex="-1"></a>  </span>
<span id="cb215-68"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-68" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N7<span class="op">)</span> <span class="op">{</span></span>
<span id="cb215-69"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-69" tabindex="-1"></a>    <span class="co">// utility </span></span>
<span id="cb215-70"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-70" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">7</span><span class="op">]</span> U <span class="op">=</span> own7<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">*</span>other7<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb215-71"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-71" tabindex="-1"></a>    </span>
<span id="cb215-72"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-72" tabindex="-1"></a>    z7<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">);</span></span>
<span id="cb215-73"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-73" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb215-74"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-74" tabindex="-1"></a>  </span>
<span id="cb215-75"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-75" tabindex="-1"></a>  </span>
<span id="cb215-76"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-76" tabindex="-1"></a>  </span>
<span id="cb215-77"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-77" tabindex="-1"></a>  alpha <span class="op">~</span> normal<span class="op">(</span>prior_alpha<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb215-78"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-78" tabindex="-1"></a>  sigma <span class="op">~</span> cauchy<span class="op">(</span><span class="dv">0</span><span class="er">.0</span><span class="op">,</span>prior_sigma<span class="op">);</span></span>
<span id="cb215-79"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-79" tabindex="-1"></a>  </span>
<span id="cb215-80"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb215-80" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>As you can see, it is really an exercise in data-augmentation, and a bit of thought put in to how to pass the data to <em>Stan</em>. With regard to the latter, one of the quirks of the dataset is that there ranking lists are of different length. This is because some of the <span class="citation">Alempaki et al. (<a href="#ref-ACKLP2022">2022</a>)</span> games have duplicate payoffs. So while there were nine outcomes of each game, in some games there were only seven or eight unique payoff profiles. I decided to handle these just as separate datasets, basically just splitting the full dataset into one that contained lists of length nine, one with lists of length eight, and one with lists of length seven. For the data-augmentation part, you can see this in the <code>model</code> block, for instance for the length-9 lists:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb216-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb216-1" tabindex="-1"></a></span>
<span id="cb216-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb216-2" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> U <span class="op">=</span> own9<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">*</span>other9<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb216-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb216-3" tabindex="-1"></a>    </span>
<span id="cb216-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb216-4" tabindex="-1"></a>    z9<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">);</span></span></code></pre></div>
<p>Here is <em>Stan</em>’s summary of the posterior simulation</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb217-1" tabindex="-1"></a><span class="fu">summary</span>(<span class="st">&quot;Code/ACKLP2022/estimates_FSranking_homogeneous.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb217-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb217-2" tabindex="-1"></a>          <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb217-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb217-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb217-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb217-4" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb217-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb217-5" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits=</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb217-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb217-6" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X25.
</th>
<th style="text-align:right;">
X50.
</th>
<th style="text-align:right;">
X75.
</th>
<th style="text-align:right;">
X97.5.
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
4433.08
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
sigma
</td>
<td style="text-align:right;">
1.52
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
1.48
</td>
<td style="text-align:right;">
1.50
</td>
<td style="text-align:right;">
1.52
</td>
<td style="text-align:right;">
1.53
</td>
<td style="text-align:right;">
1.56
</td>
<td style="text-align:right;">
2430.91
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
lp__
</td>
<td style="text-align:right;">
-7161.59
</td>
<td style="text-align:right;">
2.42
</td>
<td style="text-align:right;">
75.89
</td>
<td style="text-align:right;">
-7311.48
</td>
<td style="text-align:right;">
-7213.40
</td>
<td style="text-align:right;">
-7161.84
</td>
<td style="text-align:right;">
-7110.53
</td>
<td style="text-align:right;">
-7010.85
</td>
<td style="text-align:right;">
986.81
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
</div>
<div id="a-hierarchical-model" class="section level2 hasAnchor" number="17.5">
<h2><span class="header-section-number">17.5</span> A hierarchical model<a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While going to a hierarchical version of this model in principle should be fairly straightforward, this proved to be a long hot walk in the sun. In particular, for many of the specifications I tried, I kept getting BFMI warnings from <em>Stan</em>. In the end, the model I got to run successfully without warnings did the following relative to what I usually do with hierarchical models:</p>
<ol style="list-style-type: decimal">
<li>I set the correlation matrix equal to the idenitiy matrix. That is, I assumed no correlation between <span class="math inline">\(\alpha_i\)</span> and <span class="math inline">\(\sigma_i\)</span></li>
<li>I used a half-normal prior for the standard deviation parameters rather than a half-Cauchy. This puts less mass in the tail of the distribution</li>
<li>I used much more informative priors than I usually would, especially for the standard deviation parameters.</li>
</ol>
<p>Specifically, the hierarchical model specification is:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha_i&amp;\sim N(\mu_\alpha,\tau_\alpha^2)\\
\log\sigma_i&amp;\sim N(\mu_\sigma,\tau^2_\sigma)\\
\text{hyper-priors: }
\mu_\alpha &amp;\sim N(0,0.25)\\
\mu_\sigma&amp;\sim N(0,1)\\
\tau_\mu &amp;\sim N^+(0,0.01)\\
\tau_\sigma &amp;\sim N^+(0,0.01)
\end{aligned}
\]</span></p>
<p>Here is the <em>Stan</em> program that implements it:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb218-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-1" tabindex="-1"></a></span>
<span id="cb218-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb218-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-3" tabindex="-1"></a>  </span>
<span id="cb218-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-4" tabindex="-1"></a>  <span class="dt">int</span> nparticipants<span class="op">;</span></span>
<span id="cb218-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-5" tabindex="-1"></a>  </span>
<span id="cb218-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-6" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N9<span class="op">;</span> <span class="co">// total number of decisions with 9 unique payoffs</span></span>
<span id="cb218-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-7" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N8<span class="op">;</span> <span class="co">// total number of decisions with 8 unique payoffs</span></span>
<span id="cb218-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-8" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N7<span class="op">;</span> <span class="co">// total number of decisions with 7 unique payoffs</span></span>
<span id="cb218-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-9" tabindex="-1"></a>  </span>
<span id="cb218-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-10" tabindex="-1"></a>  <span class="dt">int</span> id9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb218-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-11" tabindex="-1"></a>  <span class="dt">int</span> id8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb218-12"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-12" tabindex="-1"></a>  <span class="dt">int</span> id7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb218-13"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-13" tabindex="-1"></a>  </span>
<span id="cb218-14"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-14" tabindex="-1"></a>  <span class="co">// payoffs from the game, ranked in ordered choice, worst to best</span></span>
<span id="cb218-15"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-15" tabindex="-1"></a>    <span class="co">// for the games with 9 uninque payoffs</span></span>
<span id="cb218-16"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-16" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> own9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb218-17"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-17" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> other9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb218-18"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-18" tabindex="-1"></a>    <span class="co">// for the games with 8 uninque payoffs</span></span>
<span id="cb218-19"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-19" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> own8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb218-20"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-20" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> other8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb218-21"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-21" tabindex="-1"></a>    <span class="co">// for the games with 9 uninque payoffs</span></span>
<span id="cb218-22"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-22" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">7</span><span class="op">]</span> own7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb218-23"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-23" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">7</span><span class="op">]</span> other7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb218-24"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-24" tabindex="-1"></a>  </span>
<span id="cb218-25"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-25" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_MU<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb218-26"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-26" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_TAU<span class="op">;</span></span>
<span id="cb218-27"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-27" tabindex="-1"></a>    real prior_OMEGA<span class="op">;</span></span>
<span id="cb218-28"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-28" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb218-29"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-29" tabindex="-1"></a></span>
<span id="cb218-30"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-30" tabindex="-1"></a></span>
<span id="cb218-31"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-31" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb218-32"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-32" tabindex="-1"></a>  </span>
<span id="cb218-33"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-33" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> MU<span class="op">;</span></span>
<span id="cb218-34"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-34" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;[</span><span class="dv">2</span><span class="op">]</span> TAU<span class="op">;</span></span>
<span id="cb218-35"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-35" tabindex="-1"></a>  <span class="co">//cholesky_factor_corr[2] L_OMEGA;</span></span>
<span id="cb218-36"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-36" tabindex="-1"></a>  </span>
<span id="cb218-37"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-37" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span>nparticipants<span class="op">]</span> z_pars<span class="op">;</span></span>
<span id="cb218-38"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-38" tabindex="-1"></a>  </span>
<span id="cb218-39"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-39" tabindex="-1"></a>  ordered<span class="op">[</span><span class="dv">9</span><span class="op">]</span> z9<span class="op">[</span>N9<span class="op">];</span></span>
<span id="cb218-40"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-40" tabindex="-1"></a>  ordered<span class="op">[</span><span class="dv">8</span><span class="op">]</span> z8<span class="op">[</span>N8<span class="op">];</span></span>
<span id="cb218-41"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-41" tabindex="-1"></a>  ordered<span class="op">[</span><span class="dv">7</span><span class="op">]</span> z7<span class="op">[</span>N7<span class="op">];</span></span>
<span id="cb218-42"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-42" tabindex="-1"></a>  </span>
<span id="cb218-43"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-43" tabindex="-1"></a>  </span>
<span id="cb218-44"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-44" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb218-45"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-45" tabindex="-1"></a></span>
<span id="cb218-46"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-46" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb218-47"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-47" tabindex="-1"></a>  </span>
<span id="cb218-48"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-48" tabindex="-1"></a>  vector<span class="op">[</span>nparticipants<span class="op">]</span> alpha<span class="op">;</span></span>
<span id="cb218-49"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-49" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;[</span>nparticipants<span class="op">]</span> sigma<span class="op">;</span></span>
<span id="cb218-50"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-50" tabindex="-1"></a>  </span>
<span id="cb218-51"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-51" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb218-52"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-52" tabindex="-1"></a>    </span>
<span id="cb218-53"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-53" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span>nparticipants<span class="op">]</span> pars <span class="op">=</span> rep_matrix<span class="op">(</span>MU<span class="op">,</span>nparticipants<span class="op">)</span> </span>
<span id="cb218-54"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-54" tabindex="-1"></a>      <span class="op">+</span> <span class="co">//diag_pre_multiply(TAU, L_OMEGA) * z_pars;</span></span>
<span id="cb218-55"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-55" tabindex="-1"></a>      diag_matrix<span class="op">(</span>TAU<span class="op">)*</span>z_pars<span class="op">;</span></span>
<span id="cb218-56"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-56" tabindex="-1"></a>      </span>
<span id="cb218-57"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-57" tabindex="-1"></a>    alpha <span class="op">=</span> pars<span class="op">[</span><span class="dv">1</span><span class="op">,]</span><span class="ch">&#39;;</span></span>
<span id="cb218-58"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-58" tabindex="-1"></a>    sigma <span class="op">=</span> exp<span class="op">(</span>pars<span class="op">[</span><span class="dv">2</span><span class="op">,]</span><span class="ch">&#39;)</span><span class="er">;</span></span>
<span id="cb218-59"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-59" tabindex="-1"></a>    </span>
<span id="cb218-60"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-60" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb218-61"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-61" tabindex="-1"></a>  </span>
<span id="cb218-62"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-62" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb218-63"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-63" tabindex="-1"></a></span>
<span id="cb218-64"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-64" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb218-65"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-65" tabindex="-1"></a>  </span>
<span id="cb218-66"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-66" tabindex="-1"></a>  </span>
<span id="cb218-67"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-67" tabindex="-1"></a>  </span>
<span id="cb218-68"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-68" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N9<span class="op">)</span> <span class="op">{</span></span>
<span id="cb218-69"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-69" tabindex="-1"></a>    </span>
<span id="cb218-70"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-70" tabindex="-1"></a>    <span class="co">// utility </span></span>
<span id="cb218-71"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-71" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> U <span class="op">=</span> own9<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">[</span>id9<span class="op">[</span>ii<span class="op">]]*</span>other9<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb218-72"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-72" tabindex="-1"></a>    </span>
<span id="cb218-73"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-73" tabindex="-1"></a>    z9<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">[</span>id9<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb218-74"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-74" tabindex="-1"></a>    </span>
<span id="cb218-75"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-75" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb218-76"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-76" tabindex="-1"></a>  </span>
<span id="cb218-77"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-77" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N8<span class="op">)</span> <span class="op">{</span></span>
<span id="cb218-78"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-78" tabindex="-1"></a>    <span class="co">// utility </span></span>
<span id="cb218-79"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-79" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> U <span class="op">=</span> own8<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">[</span>id8<span class="op">[</span>ii<span class="op">]]*</span>other8<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb218-80"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-80" tabindex="-1"></a>    </span>
<span id="cb218-81"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-81" tabindex="-1"></a>    </span>
<span id="cb218-82"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-82" tabindex="-1"></a>    z8<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">[</span>id8<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb218-83"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-83" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb218-84"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-84" tabindex="-1"></a>  </span>
<span id="cb218-85"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-85" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N7<span class="op">)</span> <span class="op">{</span></span>
<span id="cb218-86"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-86" tabindex="-1"></a>    <span class="co">// utility </span></span>
<span id="cb218-87"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-87" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">7</span><span class="op">]</span> U <span class="op">=</span> own7<span class="op">[</span>ii<span class="op">]+</span>alpha<span class="op">[</span>id7<span class="op">[</span>ii<span class="op">]]*</span>other7<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb218-88"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-88" tabindex="-1"></a>    </span>
<span id="cb218-89"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-89" tabindex="-1"></a>    z7<span class="op">[</span>ii<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>U<span class="op">,</span>sigma<span class="op">[</span>id7<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb218-90"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-90" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb218-91"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-91" tabindex="-1"></a>  </span>
<span id="cb218-92"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-92" tabindex="-1"></a>  </span>
<span id="cb218-93"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-93" tabindex="-1"></a>  <span class="co">// hierarchical structure</span></span>
<span id="cb218-94"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-94" tabindex="-1"></a>  </span>
<span id="cb218-95"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-95" tabindex="-1"></a>  to_vector<span class="op">(</span>z_pars<span class="op">)</span> <span class="op">~</span> std_normal<span class="op">();</span></span>
<span id="cb218-96"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-96" tabindex="-1"></a>  </span>
<span id="cb218-97"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-97" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb218-98"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-98" tabindex="-1"></a>  </span>
<span id="cb218-99"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-99" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>pp in <span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb218-100"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-100" tabindex="-1"></a>    </span>
<span id="cb218-101"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-101" tabindex="-1"></a>    MU<span class="op">[</span>pp<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>prior_MU<span class="op">[</span>pp<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_MU<span class="op">[</span>pp<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb218-102"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-102" tabindex="-1"></a>    TAU <span class="op">~</span> normal<span class="op">(</span><span class="dv">0</span><span class="er">.0</span><span class="op">,</span>prior_TAU<span class="op">[</span>pp<span class="op">]);</span></span>
<span id="cb218-103"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-103" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb218-104"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-104" tabindex="-1"></a>  </span>
<span id="cb218-105"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-105" tabindex="-1"></a>  <span class="co">//L_OMEGA ~ lkj_corr_cholesky(prior_OMEGA);</span></span>
<span id="cb218-106"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb218-106" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And here are the population-level estimates from it:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-1" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="st">&quot;Code/ACKLP2022/estimates_linearranking_hierarchical.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb219-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-2" tabindex="-1"></a>  <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb219-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb219-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-4" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;par&quot;</span>)</span>
<span id="cb219-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-5" tabindex="-1"></a></span>
<span id="cb219-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-6" tabindex="-1"></a>population<span class="ot">&lt;-</span>Fit <span class="sc">|&gt;</span></span>
<span id="cb219-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-7" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;MU&quot;</span>,par) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TAU&quot;</span>,par)) <span class="sc">|&gt;</span></span>
<span id="cb219-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-8" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb219-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-9" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">mu_</span><span class="sc">\\</span><span class="st">alpha$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">mu_</span><span class="sc">\\</span><span class="st">sigma$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">tau_</span><span class="sc">\\</span><span class="st">alpha$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">tau_</span><span class="sc">\\</span><span class="st">sigma$&quot;</span>)</span>
<span id="cb219-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-10" tabindex="-1"></a>  )</span>
<span id="cb219-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-11" tabindex="-1"></a></span>
<span id="cb219-12"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-12" tabindex="-1"></a>population <span class="sc">|&gt;</span></span>
<span id="cb219-13"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-13" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb219-14"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb219-14" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
par
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X25.
</th>
<th style="text-align:right;">
X50.
</th>
<th style="text-align:right;">
X75.
</th>
<th style="text-align:right;">
X97.5.
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mu_\alpha\)</span>
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.12
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
2208.84
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mu_\sigma\)</span>
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.03
</td>
<td style="text-align:right;">
-0.05
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
1612.34
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\tau_\alpha\)</span>
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.08
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
4569.19
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\tau_\sigma\)</span>
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.01
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.16
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
2321.31
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>and here are the shrinkage estimates for <span class="math inline">\(\alpha\)</span></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-1" tabindex="-1"></a>FitAlpha<span class="ot">&lt;-</span>Fit <span class="sc">|&gt;</span></span>
<span id="cb220-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;alpha&quot;</span>,par)) <span class="sc">|&gt;</span></span>
<span id="cb220-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb220-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-4" tabindex="-1"></a>    <span class="at">cumul =</span> <span class="fu">rank</span>(mean)<span class="sc">/</span><span class="fu">n</span>()</span>
<span id="cb220-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-5" tabindex="-1"></a>  )</span>
<span id="cb220-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-6" tabindex="-1"></a></span>
<span id="cb220-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-7" tabindex="-1"></a>(</span>
<span id="cb220-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(FitAlpha,<span class="fu">aes</span>(<span class="at">x=</span>mean))</span>
<span id="cb220-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>()</span>
<span id="cb220-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb220-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y=</span>cumul,<span class="at">xmin =</span> X2.<span class="fl">5.</span>,<span class="at">xmax =</span> X97.<span class="fl">5.</span>),<span class="at">alpha =</span> <span class="fl">0.2</span>)</span>
<span id="cb220-12"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(alpha[i]))</span>
<span id="cb220-13"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Empirical cumulative density of posterior mean&quot;</span>)</span>
<span id="cb220-14"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb220-14" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-383-1.png" width="672" /></p>
<p>and for <span class="math inline">\(\sigma\)</span>:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-1" tabindex="-1"></a>FitAlpha<span class="ot">&lt;-</span>Fit <span class="sc">|&gt;</span></span>
<span id="cb221-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;sigma&quot;</span>,par)) <span class="sc">|&gt;</span></span>
<span id="cb221-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb221-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-4" tabindex="-1"></a>    <span class="at">cumul =</span> <span class="fu">rank</span>(mean)<span class="sc">/</span><span class="fu">n</span>()</span>
<span id="cb221-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-5" tabindex="-1"></a>  )</span>
<span id="cb221-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-6" tabindex="-1"></a></span>
<span id="cb221-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-7" tabindex="-1"></a>(</span>
<span id="cb221-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(FitAlpha,<span class="fu">aes</span>(<span class="at">x=</span>mean))</span>
<span id="cb221-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>()</span>
<span id="cb221-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb221-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y=</span>cumul,<span class="at">xmin =</span> X2.<span class="fl">5.</span>,<span class="at">xmax =</span> X97.<span class="fl">5.</span>),<span class="at">alpha =</span> <span class="fl">0.2</span>)</span>
<span id="cb221-12"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(sigma[i]))</span>
<span id="cb221-13"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Empirical cumulative density of posterior mean&quot;</span>)</span>
<span id="cb221-14"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb221-14" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-384-1.png" width="672" /></p>
<p>For perspective, if <span class="math inline">\(\sigma_i=1\)</span> then a selfish person ranking two options with a dollar difference between them will rank them with the highest payoff first with probability:</p>
<p><span class="math display">\[
\Phi\left(\frac{1}{\sqrt 2}\right)\approx 0.76
\]</span></p>
</div>
<div id="r-code-used-to-run-this" class="section level2 hasAnchor" number="17.6">
<h2><span class="header-section-number">17.6</span> <em>R</em> code used to run this<a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb222-2"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-2" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb222-3"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-3" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb222-4"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-4" tabindex="-1"></a>  <span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb222-5"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-5" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb222-6"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-6" tabindex="-1"></a>  </span>
<span id="cb222-7"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-7" tabindex="-1"></a></span>
<span id="cb222-8"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-8" tabindex="-1"></a></span>
<span id="cb222-9"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-9" tabindex="-1"></a>ranking<span class="ot">&lt;-</span><span class="st">&quot;Data/ACKLP2022_ranking.dta&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb222-10"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-10" tabindex="-1"></a>  <span class="fu">read_dta</span>() <span class="sc">|&gt;</span></span>
<span id="cb222-11"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">uid =</span> <span class="fu">paste</span>(<span class="st">&quot;id&quot;</span>,id) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()) <span class="sc">|&gt;</span></span>
<span id="cb222-12"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-12" tabindex="-1"></a>  <span class="fu">arrange</span>(id,game,<span class="sc">-</span>ranking)</span>
<span id="cb222-13"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-13" tabindex="-1"></a></span>
<span id="cb222-14"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-14" tabindex="-1"></a></span>
<span id="cb222-15"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-15" tabindex="-1"></a></span>
<span id="cb222-16"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-16" tabindex="-1"></a></span>
<span id="cb222-17"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-17" tabindex="-1"></a></span>
<span id="cb222-18"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-18" tabindex="-1"></a></span>
<span id="cb222-19"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-19" tabindex="-1"></a></span>
<span id="cb222-20"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-20" tabindex="-1"></a></span>
<span id="cb222-21"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-21" tabindex="-1"></a></span>
<span id="cb222-22"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-22" tabindex="-1"></a>d<span class="ot">&lt;-</span>ranking <span class="sc">|&gt;</span></span>
<span id="cb222-23"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-23" tabindex="-1"></a>  <span class="fu">group_by</span>(id,game) <span class="sc">|&gt;</span></span>
<span id="cb222-24"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-24" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb222-25"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-25" tabindex="-1"></a>    <span class="at">nuniquepayoffs =</span> <span class="fu">n</span>(),</span>
<span id="cb222-26"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-26" tabindex="-1"></a>    <span class="at">idg =</span> <span class="fu">paste0</span>(id,<span class="st">&quot;-&quot;</span>,game),</span>
<span id="cb222-27"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-27" tabindex="-1"></a>    <span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()</span>
<span id="cb222-28"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-28" tabindex="-1"></a>  ) </span>
<span id="cb222-29"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-29" tabindex="-1"></a></span>
<span id="cb222-30"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-30" tabindex="-1"></a>own9<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb222-31"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-31" tabindex="-1"></a>other9<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb222-32"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-32" tabindex="-1"></a></span>
<span id="cb222-33"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-33" tabindex="-1"></a>own8<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb222-34"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-34" tabindex="-1"></a>other8<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb222-35"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-35" tabindex="-1"></a></span>
<span id="cb222-36"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-36" tabindex="-1"></a>own7<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb222-37"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-37" tabindex="-1"></a>other7<span class="ot">&lt;-</span><span class="fu">list</span>()</span>
<span id="cb222-38"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-38" tabindex="-1"></a></span>
<span id="cb222-39"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-39" tabindex="-1"></a><span class="cf">for</span> (gg <span class="cf">in</span> (d<span class="sc">$</span>idg <span class="sc">|&gt;</span> <span class="fu">unique</span>())) {</span>
<span id="cb222-40"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-40" tabindex="-1"></a>  </span>
<span id="cb222-41"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-41" tabindex="-1"></a>  </span>
<span id="cb222-42"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-42" tabindex="-1"></a>  dg<span class="ot">&lt;-</span>d <span class="sc">|&gt;</span> <span class="fu">filter</span>(idg<span class="sc">==</span>gg)</span>
<span id="cb222-43"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-43" tabindex="-1"></a>  </span>
<span id="cb222-44"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-44" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">dim</span>(dg)[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">9</span>) {</span>
<span id="cb222-45"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-45" tabindex="-1"></a>    </span>
<span id="cb222-46"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-46" tabindex="-1"></a>    own9[[<span class="fu">paste</span>(gg)]]<span class="ot">&lt;-</span>dg<span class="sc">$</span>own <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb222-47"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-47" tabindex="-1"></a>    other9[[<span class="fu">paste</span>(gg)]]<span class="ot">&lt;-</span>dg<span class="sc">$</span>other <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb222-48"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-48" tabindex="-1"></a>    </span>
<span id="cb222-49"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-49" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">dim</span>(dg)[<span class="dv">1</span>]<span class="sc">==</span><span class="dv">8</span>) {</span>
<span id="cb222-50"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-50" tabindex="-1"></a>    own8[[<span class="fu">paste</span>(gg)]]<span class="ot">&lt;-</span>dg<span class="sc">$</span>own <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb222-51"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-51" tabindex="-1"></a>    other8[[<span class="fu">paste</span>(gg)]]<span class="ot">&lt;-</span>dg<span class="sc">$</span>other <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb222-52"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-52" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb222-53"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-53" tabindex="-1"></a>    own7[[<span class="fu">paste</span>(gg)]]<span class="ot">&lt;-</span>dg<span class="sc">$</span>own <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb222-54"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-54" tabindex="-1"></a>    other7[[<span class="fu">paste</span>(gg)]]<span class="ot">&lt;-</span>dg<span class="sc">$</span>other <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb222-55"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-55" tabindex="-1"></a>  }</span>
<span id="cb222-56"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-56" tabindex="-1"></a>}</span>
<span id="cb222-57"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-57" tabindex="-1"></a></span>
<span id="cb222-58"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-58" tabindex="-1"></a></span>
<span id="cb222-59"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-59" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb222-60"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-60" tabindex="-1"></a><span class="co"># Pooled model</span></span>
<span id="cb222-61"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-61" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb222-62"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-62" tabindex="-1"></a></span>
<span id="cb222-63"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-63" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">&quot;Code/ACKLP2022/linearranking_homogeneous.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb222-64"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-64" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb222-65"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-65" tabindex="-1"></a></span>
<span id="cb222-66"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-66" tabindex="-1"></a></span>
<span id="cb222-67"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-67" tabindex="-1"></a></span>
<span id="cb222-68"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-68" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb222-69"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-69" tabindex="-1"></a>  </span>
<span id="cb222-70"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-70" tabindex="-1"></a>  <span class="at">nparticipants =</span> d<span class="sc">$</span>uid <span class="sc">|&gt;</span> <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">length</span>(),</span>
<span id="cb222-71"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-71" tabindex="-1"></a>  </span>
<span id="cb222-72"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-72" tabindex="-1"></a>  <span class="at">N9 =</span> <span class="fu">length</span>(own9),</span>
<span id="cb222-73"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-73" tabindex="-1"></a>  <span class="at">N8 =</span> <span class="fu">length</span>(own8),</span>
<span id="cb222-74"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-74" tabindex="-1"></a>  <span class="at">N7 =</span> <span class="fu">length</span>(own7),</span>
<span id="cb222-75"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-75" tabindex="-1"></a>  </span>
<span id="cb222-76"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-76" tabindex="-1"></a>  <span class="at">id9 =</span> (d <span class="sc">|&gt;</span> <span class="fu">filter</span>(nuniquepayoffs<span class="sc">==</span><span class="dv">9</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>))<span class="sc">$</span>uid,</span>
<span id="cb222-77"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-77" tabindex="-1"></a>  <span class="at">id8 =</span> (d <span class="sc">|&gt;</span> <span class="fu">filter</span>(nuniquepayoffs<span class="sc">==</span><span class="dv">8</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>))<span class="sc">$</span>uid,</span>
<span id="cb222-78"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-78" tabindex="-1"></a>  <span class="at">id7 =</span> (d <span class="sc">|&gt;</span> <span class="fu">filter</span>(nuniquepayoffs<span class="sc">==</span><span class="dv">7</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>))<span class="sc">$</span>uid,</span>
<span id="cb222-79"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-79" tabindex="-1"></a>  </span>
<span id="cb222-80"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-80" tabindex="-1"></a>  <span class="at">own9 =</span> own9,</span>
<span id="cb222-81"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-81" tabindex="-1"></a>  <span class="at">other9=</span>other9,</span>
<span id="cb222-82"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-82" tabindex="-1"></a>  <span class="at">own8 =</span> own8,</span>
<span id="cb222-83"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-83" tabindex="-1"></a>  <span class="at">other8=</span>other8,</span>
<span id="cb222-84"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-84" tabindex="-1"></a>  <span class="at">own7 =</span> own7,</span>
<span id="cb222-85"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-85" tabindex="-1"></a>  <span class="at">other7=</span>other7,</span>
<span id="cb222-86"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-86" tabindex="-1"></a>  </span>
<span id="cb222-87"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-87" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb222-88"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-88" tabindex="-1"></a>  <span class="at">prior_sigma =</span> <span class="dv">1</span></span>
<span id="cb222-89"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-89" tabindex="-1"></a>)</span>
<span id="cb222-90"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-90" tabindex="-1"></a></span>
<span id="cb222-91"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-91" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> model <span class="sc">|&gt;</span> </span>
<span id="cb222-92"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-92" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb222-93"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-93" tabindex="-1"></a>    <span class="at">data=</span>dStan, </span>
<span id="cb222-94"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-94" tabindex="-1"></a>    <span class="co">#chains=4,iter=10000,</span></span>
<span id="cb222-95"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-95" tabindex="-1"></a>    <span class="at">seed=</span><span class="dv">43</span>,</span>
<span id="cb222-96"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-96" tabindex="-1"></a>    <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;z9&quot;</span>,<span class="st">&quot;z8&quot;</span>,<span class="st">&quot;z7&quot;</span>),<span class="at">include=</span><span class="cn">FALSE</span></span>
<span id="cb222-97"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-97" tabindex="-1"></a>  )</span>
<span id="cb222-98"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-98" tabindex="-1"></a></span>
<span id="cb222-99"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-99" tabindex="-1"></a>Fit <span class="sc">|&gt;</span></span>
<span id="cb222-100"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-100" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/ACKLP2022/estimates_FSranking_homogeneous.rds&quot;</span>)</span>
<span id="cb222-101"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-101" tabindex="-1"></a></span>
<span id="cb222-102"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-102" tabindex="-1"></a></span>
<span id="cb222-103"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-103" tabindex="-1"></a></span>
<span id="cb222-104"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-104" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb222-105"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-105" tabindex="-1"></a><span class="co"># Hierarchical model</span></span>
<span id="cb222-106"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-106" tabindex="-1"></a><span class="do">###############################################################################</span></span>
<span id="cb222-107"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-107" tabindex="-1"></a></span>
<span id="cb222-108"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-108" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">&quot;Code/ACKLP2022/linearranking_hierarchical.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb222-109"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-109" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb222-110"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-110" tabindex="-1"></a></span>
<span id="cb222-111"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-111" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb222-112"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-112" tabindex="-1"></a>  </span>
<span id="cb222-113"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-113" tabindex="-1"></a>  <span class="at">nparticipants =</span> d<span class="sc">$</span>uid <span class="sc">|&gt;</span> <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">length</span>(),</span>
<span id="cb222-114"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-114" tabindex="-1"></a>  </span>
<span id="cb222-115"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-115" tabindex="-1"></a>  <span class="at">N9 =</span> <span class="fu">length</span>(own9),</span>
<span id="cb222-116"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-116" tabindex="-1"></a>  <span class="at">N8 =</span> <span class="fu">length</span>(own8),</span>
<span id="cb222-117"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-117" tabindex="-1"></a>  <span class="at">N7 =</span> <span class="fu">length</span>(own7),</span>
<span id="cb222-118"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-118" tabindex="-1"></a>  </span>
<span id="cb222-119"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-119" tabindex="-1"></a>  <span class="at">id9 =</span> (d <span class="sc">|&gt;</span> <span class="fu">filter</span>(nuniquepayoffs<span class="sc">==</span><span class="dv">9</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>))<span class="sc">$</span>uid,</span>
<span id="cb222-120"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-120" tabindex="-1"></a>  <span class="at">id8 =</span> (d <span class="sc">|&gt;</span> <span class="fu">filter</span>(nuniquepayoffs<span class="sc">==</span><span class="dv">8</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>))<span class="sc">$</span>uid,</span>
<span id="cb222-121"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-121" tabindex="-1"></a>  <span class="at">id7 =</span> (d <span class="sc">|&gt;</span> <span class="fu">filter</span>(nuniquepayoffs<span class="sc">==</span><span class="dv">7</span> <span class="sc">&amp;</span> k<span class="sc">==</span><span class="dv">1</span>))<span class="sc">$</span>uid,</span>
<span id="cb222-122"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-122" tabindex="-1"></a>  </span>
<span id="cb222-123"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-123" tabindex="-1"></a>  <span class="at">own9 =</span> own9,</span>
<span id="cb222-124"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-124" tabindex="-1"></a>  <span class="at">other9=</span>other9,</span>
<span id="cb222-125"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-125" tabindex="-1"></a>  <span class="at">own8 =</span> own8,</span>
<span id="cb222-126"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-126" tabindex="-1"></a>  <span class="at">other8=</span>other8,</span>
<span id="cb222-127"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-127" tabindex="-1"></a>  <span class="at">own7 =</span> own7,</span>
<span id="cb222-128"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-128" tabindex="-1"></a>  <span class="at">other7=</span>other7,</span>
<span id="cb222-129"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-129" tabindex="-1"></a>  </span>
<span id="cb222-130"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-130" tabindex="-1"></a>  <span class="at">prior_MU =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.25</span>),</span>
<span id="cb222-131"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-131" tabindex="-1"></a>                <span class="co">#  c(1,0.25),</span></span>
<span id="cb222-132"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-132" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb222-133"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-133" tabindex="-1"></a>                  ),</span>
<span id="cb222-134"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-134" tabindex="-1"></a>  <span class="at">prior_TAU =</span> <span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">0.01</span>),</span>
<span id="cb222-135"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-135" tabindex="-1"></a>  <span class="at">prior_OMEGA =</span> <span class="dv">4</span></span>
<span id="cb222-136"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-136" tabindex="-1"></a>)</span>
<span id="cb222-137"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-137" tabindex="-1"></a></span>
<span id="cb222-138"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-138" tabindex="-1"></a></span>
<span id="cb222-139"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-139" tabindex="-1"></a>Fit <span class="ot">&lt;-</span> model <span class="sc">|&gt;</span> </span>
<span id="cb222-140"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-140" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb222-141"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-141" tabindex="-1"></a>    <span class="at">data=</span>dStan, </span>
<span id="cb222-142"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-142" tabindex="-1"></a>    <span class="at">chains=</span><span class="dv">8</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb222-143"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-143" tabindex="-1"></a>    <span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb222-144"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-144" tabindex="-1"></a>    <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;z_pars&quot;</span>,<span class="st">&quot;z9&quot;</span>,<span class="st">&quot;z8&quot;</span>,<span class="st">&quot;z7&quot;</span>),<span class="at">include=</span><span class="cn">FALSE</span></span>
<span id="cb222-145"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-145" tabindex="-1"></a>  )</span>
<span id="cb222-146"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-146" tabindex="-1"></a></span>
<span id="cb222-147"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-147" tabindex="-1"></a>Fit <span class="sc">|&gt;</span> </span>
<span id="cb222-148"><a href="application-ranked-choices-and-the-thurstonian-model.html#cb222-148" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/ACKLP2022/estimates_linearranking_hierarchical.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-ACKLP2022" class="csl-entry">
Alempaki, Despoina, Andrew M Colman, Felix Kölle, Graham Loomes, and Briony D Pulford. 2022. <span>“Investigating the Failure to Best Respond in Experimental Games.”</span> <em>Experimental Economics</em>, 1–24.
</div>
<div id="ref-FS1999" class="csl-entry">
Fehr, Ernst, and Klaus M Schmidt. 1999. <span>“A Theory of Fairness, Competition, and Cooperation.”</span> <em>The Quarterly Journal of Economics</em> 114 (3): 817–68.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="81">
<li id="fn81"><p>This of course comes with the caveat that a ranking task may be more confusing to participants, and so decisions in a ranking task may be more noisy. I do not want to weigh in on the methodology here, instead we will just proceed with the understanding that we have ranked data. <a href="application-ranked-choices-and-the-thurstonian-model.html#fnref81" class="footnote-back">↩︎</a></p></li>
<li id="fn82"><p>I struggle to think of a tractable model/experiment combination where <span class="math inline">\(p&gt;JK\)</span>.<a href="application-ranked-choices-and-the-thurstonian-model.html#fnref82" class="footnote-back">↩︎</a></p></li>
<li id="fn83"><p>Specifically, <em>Stan</em> was giving me some BFMI warnings.<a href="application-ranked-choices-and-the-thurstonian-model.html#fnref83" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-meta-analysis-using-some-of-the-metaret-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="links-to-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
