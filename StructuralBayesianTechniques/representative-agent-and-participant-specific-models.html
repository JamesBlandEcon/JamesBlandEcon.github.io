<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Representative agent and participant-specific models | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="4 Representative agent and participant-specific models | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Representative agent and participant-specific models | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Representative agent and participant-specific models | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2023-06-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="building-blocks.html"/>
<link rel="next" href="hierarchical-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>4</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>4.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>4.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="4.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>4.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="4.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>4.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="4.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>4.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="4.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>4.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="4.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>4.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="4.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>4.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>4.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>5</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>5.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>5.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="5.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>5.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>5.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="5.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>5.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>5.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>5.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="5.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>5.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>5.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (<span>2019</span>)</span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>5.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="5.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>5.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="6" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>6</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="6.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>6.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="6.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>6.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="6.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>6.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>6.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="6.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>6.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="6.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results"><i class="fa fa-check"></i><b>6.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>6.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="6.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>6.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="6.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>6.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>6.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>6.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="6.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>6.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="6.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>6.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="strategy-frequency-estimation.html"><a href="strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>7</b> Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="7.1" data-path="strategy-frequency-estimation.html"><a href="strategy-frequency-estimation.html#basic-model-and-data"><i class="fa fa-check"></i><b>7.1</b> Basic model and data</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="strategy-frequency-estimation.html"><a href="strategy-frequency-estimation.html#data-wrangling"><i class="fa fa-check"></i><b>7.1.1</b> Data wrangling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="outline-of-future-chapters.html"><a href="outline-of-future-chapters.html"><i class="fa fa-check"></i>Outline of future chapters</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="representative-agent-and-participant-specific-models" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Representative agent and participant-specific models<a href="representative-agent-and-participant-specific-models.html#representative-agent-and-participant-specific-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Our participants are not homogeneous. Therefore representative agent models do not get us very far, both as economic models, and as econometric models. For economic models, this is because choices do not aggregate unless preferences meet some very strict criteria. Econometric models motivated from these economic models will inherit these problems, and create their own. In particular, we should be worried about <em>heterogeneity bias</em>, which occurs when we assume that a parameter is homogeneous across participants, when it is in fact heterogeneous. For example <span class="citation">Wilcox (<a href="#ref-Wilcox2006" role="doc-biblioref">2006</a>)</span> shows that conclusions about the type of learning that participants are doing in a game will be biased in favor of one model (reinforcement learning) if heterogeneity is not addressed in the econometric model.</p>
<p>While I therefore avoid pooled representative agent models for most of my work, they do provide us with a useful stepping stone in taking an economic model through the process of becoming a probabilistic econometric model. Estimating a representative agent model, even if we do not take it too seriously, is a useful proof-of-concept before advancing further into the depths of the hierarchical structure that our data probably deserves. This is because the representative agent model will likely identify certain coding or computational issues that are specific to your problem. For example in <span class="citation">Bland (<a href="#ref-Bland2020" role="doc-biblioref">2022</a>)</span> I spent a lot of time honing my pooled Quantal Response Equilibrium model before moving on to the hierarchical and off-equilibrium specifications. This first established for me that it was in fact feasible to estimate a Quantal Response Equilibrium model at all in <em>Stan</em>. If it hadn’t been, I would have discovered this much earlier in the research process than had I tried to do the hierarchical, off-equilibrium with risk-aversion model first. In the process I was able to identify the bits of the code that were slowing things down, and work out more speedy solutions to computing Quantal Response Equilibrium in a much simpler environment.
Furthermore, as you will see in some later chapters of this book, almost all of the work that follows once you have a representative agent model to extend it to a hierarchical or mixture model is quite mechanical: it will look the same irrespective of the specific model you are taking to the data. As such, once you get the hang of these more complicated specifications, I suspect that you will actually spend more time thinking about the parts of your code that would also be in the representative agent model.</p>
<p>Representative agent models are also useful if all we want are participant-specific estimates. When all we are using are data from one participant, the representative agent and the participant are the same person. Instead, the “representative agent” assumption is probably better called a “stable preferences” assumption, where we are assuming that the participant’s utility function remains the same for the entire experiment.
In this chapter, I will therefore present you with a guide to estimating participant-specific models.</p>
<div id="participant-specific-models" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Participant-specific models<a href="representative-agent-and-participant-specific-models.html#participant-specific-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-data-and-economic-model" class="section level3 hasAnchor" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Example data and economic model<a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, I will use data from the modified dictator games in <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span>. In this part of the experiment, 174 participants made 78 pairwise choices over allocations of money between themself and another participant. The 78 pairwise allocations, and the choices of the first participant to show up in the data, can be seen in Figure <a href="representative-agent-and-participant-specific-models.html#fig:BFS2019choices">4.1</a>. Here you can see these choices described by a line connecting the two allocations. There is a dot at the allocation chosen by the first participant. In this Figure you can see that each participant is presented with choices where they always earn less than the other person (top-left corner), when they always earn more than the other person (bottom-right corner), and when the two allocations span over both of these regions (in the middle of the plot).</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="representative-agent-and-participant-specific-models.html#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb44-2"><a href="representative-agent-and-participant-specific-models.html#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="representative-agent-and-participant-specific-models.html#cb44-3" aria-hidden="true" tabindex="-1"></a>d1<span class="ot">&lt;-</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data/BFS2019_choices_exp1.csv&quot;</span>)</span>
<span id="cb44-4"><a href="representative-agent-and-participant-specific-models.html#cb44-4" aria-hidden="true" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">experiment=</span><span class="dv">1</span>)</span>
<span id="cb44-5"><a href="representative-agent-and-participant-specific-models.html#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="representative-agent-and-participant-specific-models.html#cb44-6" aria-hidden="true" tabindex="-1"></a>d2<span class="ot">&lt;-</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data/BFS2019_choices_exp2.csv&quot;</span>)</span>
<span id="cb44-7"><a href="representative-agent-and-participant-specific-models.html#cb44-7" aria-hidden="true" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">experiment=</span><span class="dv">2</span>)    </span>
<span id="cb44-8"><a href="representative-agent-and-participant-specific-models.html#cb44-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-9"><a href="representative-agent-and-participant-specific-models.html#cb44-9" aria-hidden="true" tabindex="-1"></a>D<span class="ot">&lt;-</span>(<span class="fu">rbind</span>(d1,d2)</span>
<span id="cb44-10"><a href="representative-agent-and-participant-specific-models.html#cb44-10" aria-hidden="true" tabindex="-1"></a>     <span class="co"># Just use the dictator game data</span></span>
<span id="cb44-11"><a href="representative-agent-and-participant-specific-models.html#cb44-11" aria-hidden="true" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">filter</span>(dg<span class="sc">==</span><span class="dv">1</span>)  </span>
<span id="cb44-12"><a href="representative-agent-and-participant-specific-models.html#cb44-12" aria-hidden="true" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb44-13"><a href="representative-agent-and-participant-specific-models.html#cb44-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">self_alloc =</span> <span class="fu">ifelse</span>(choice_x<span class="sc">==</span><span class="dv">1</span>,self_x,self_y),</span>
<span id="cb44-14"><a href="representative-agent-and-participant-specific-models.html#cb44-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">other_alloc =</span> <span class="fu">ifelse</span>(choice_x<span class="sc">==</span><span class="dv">1</span>,other_x,other_y)</span>
<span id="cb44-15"><a href="representative-agent-and-participant-specific-models.html#cb44-15" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb44-16"><a href="representative-agent-and-participant-specific-models.html#cb44-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-17"><a href="representative-agent-and-participant-specific-models.html#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="representative-agent-and-participant-specific-models.html#cb44-18" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb44-19"><a href="representative-agent-and-participant-specific-models.html#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb44-20"><a href="representative-agent-and-participant-specific-models.html#cb44-20" aria-hidden="true" tabindex="-1"></a>    D <span class="sc">|&gt;</span> <span class="fu">filter</span>(sid<span class="sc">==</span><span class="dv">102010050706</span>),</span>
<span id="cb44-21"><a href="representative-agent-and-participant-specific-models.html#cb44-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb44-22"><a href="representative-agent-and-participant-specific-models.html#cb44-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-23"><a href="representative-agent-and-participant-specific-models.html#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>self_x,<span class="at">y=</span>other_x,<span class="at">xend=</span>self_y,<span class="at">yend=</span>other_y))</span>
<span id="cb44-24"><a href="representative-agent-and-participant-specific-models.html#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>self_alloc,<span class="at">y=</span>other_alloc))</span>
<span id="cb44-25"><a href="representative-agent-and-participant-specific-models.html#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb44-26"><a href="representative-agent-and-participant-specific-models.html#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Own payoff&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Other&#39;s payoff&quot;</span>)</span>
<span id="cb44-27"><a href="representative-agent-and-participant-specific-models.html#cb44-27" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb44-28"><a href="representative-agent-and-participant-specific-models.html#cb44-28" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">coord_fixed</span>()</span>
<span id="cb44-29"><a href="representative-agent-and-participant-specific-models.html#cb44-29" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:BFS2019choices"></span>
<img src="index_files/figure-html/BFS2019choices-1.png" alt="The 78 pairwise choices over allocations of money. Each pariwise choice is denoted by the endpoints of a line. The decisions of the first participant are shown as dots at the chosen endpoint." width="672" />
<p class="caption">
Figure 4.1: The 78 pairwise choices over allocations of money. Each pariwise choice is denoted by the endpoints of a line. The decisions of the first participant are shown as dots at the chosen endpoint.
</p>
</div>
<p><span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span> estimate the parameters in the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> model, which assumes that the decision-maker’s utility over allocations of money is linear in their own earnings, and the earnings of the other person, but there is a change in the marginal utility of money depending on whether the other person is earning less or more than the decision-maker. Here is the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> model (written just for two people, which is all we have here):</p>
<p><span class="math display">\[
U(\pi_1,\pi_2;\alpha,\beta)= \pi_1-\alpha\max\{\pi_2-\pi_1,0\}-\beta\max\{\pi_1-\pi_2,0\}
\]</span></p>
<p>Where <span class="math inline">\(\pi_1\)</span> is the decision-maker’s earnings, <span class="math inline">\(\pi_2\)</span> is the other person’s earnings, and <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are the parameters of the model. <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> further impose the parameter restrictions of <span class="math inline">\(\beta\in[0,1]\)</span> and <span class="math inline">\(\alpha&gt;\beta\)</span>, which make it a model of <em>inequality aversion</em>: all else held equal, the decision-maker prefers equal allocations of money. Restricting <span class="math inline">\(\beta&lt;1\)</span> means that the decision-maker would not be willing to burn money to equalize earnings. As these are parameter restrictions that are testable, I will instead estimate the models without these restrictions, and then comment on how empirically relevant these parameter restrictions seem to be. This is also how <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span> approaches the problem.</p>
<p>Other than the restrictions initially imposed by <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span>, it is also meaningful to divide the <span class="math inline">\(\alpha\)</span>-<span class="math inline">\(\beta\)</span> space into four regions based on the signs of these parameters. These regions tell us qualitatively the kind of preferences that the parameters imply:</p>
<ul>
<li><span class="math inline">\(\alpha&gt;0\)</span> and <span class="math inline">\(\beta&gt;0\)</span>: the participant is <em>inequality-averse</em>. Holding their own income equal, they prefer outcomes where the other person earns the same as them.</li>
<li><span class="math inline">\(\alpha&lt;0\)</span> and <span class="math inline">\(\beta&lt;0\)</span>: the participant is <em>inequality-loving</em>. Holding their own income equal, they prefer to have the other person earning a lot more or a lot less than them.</li>
<li><span class="math inline">\(\alpha&lt;0\)</span> and <span class="math inline">\(\beta&gt;0\)</span>: the participant is <em>efficiency-loving</em>. Holding their own income equal, they prefer the other person to earn more.</li>
<li><span class="math inline">\(\alpha&gt;0\)</span> and <span class="math inline">\(\beta&lt;0\)</span>: The participant is <em>efficiency-averse</em> or <em>competitive</em>. Holding their own income equal, the prefer the other person to earn less.</li>
</ul>
</div>
<div id="going-to-the-probabilistic-model" class="section level3 hasAnchor" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Going to the probabilistic model<a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Since we have a deterministic model specified above, we need to modify it so that it makes probabilistic predictions. As we have binary choice, it does not make sense to estimate a “optimal choice plus error” model. Therefore I will use the utility-based model of probabilistic choice discussed in the previous chapter: logit choice. This is also the model used in the maximum likelihood specification of <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span>. In the data, each allocation is coded as “Choice X” and “Choice Y”, and the binary variable identifying which allocation is chosen is equal to one if and only if X is chosen. Therefore, we can parameterize the logit choice model as follows:</p>
<p><span class="math display">\[
\Pr\left(X_{i,t}=1\mid \alpha_i,\beta_i,\lambda_i\right)
=\Lambda\left(\lambda\left(U(\pi_{1,t}^X,\pi_{2,t}^X;\alpha,\beta)-U(\pi_{1,t}^Y,\pi_{2,t}^Y;\alpha,\beta)\right)\right)
\]</span></p>
<p>where <span class="math inline">\(\Lambda(x)=1/(1+\exp(-x))\)</span> is the inverse logit function.</p>
<p>We could also do this by specifying a distribution:</p>
<p><span class="math display">\[
X_{i,t}\sim \mathrm{Bernoulli}\left(\Lambda\left(\lambda\left(U(\pi_{1,t}^X,\pi_{2,t}^X;\alpha,\beta)-U(\pi_{1,t}^Y,\pi_{2,t}^Y;\alpha,\beta)\right)\right)\right)
\]</span></p>
<p>Therefore we have three parameters to estimate: <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>, the parameters in the original economic model, and logit choice precision <span class="math inline">\(\lambda\)</span>, which we need to make the model probabilistic.</p>
</div>
<div id="a-short-side-quest-into-canned-estimation-techniques" class="section level3 hasAnchor" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> A short side quest into canned estimation techniques<a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before moving on, it is very important to note a practical implication of the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> model with logit choice: <strong>it is a logit model</strong>. As in, <strong>it is a logit model like you might estimate in <em>Stata</em> or <em>R</em>!</strong>. This is an immensely useful realization that could speed up your analysis if you were OK with estimating this model with pre-packaged estimation routines. Specifically, with a few transforms of the data, you can estimate <span class="math inline">\(\lambda\)</span>, and (linear transforms of) <span class="math inline">\(\alpha\)</span>, and <span class="math inline">\(\beta\)</span> using a standard logit. To see this, note that we can transform the data as follows:</p>
<p><span class="math display">\[
\begin{aligned}
d^X&amp;=\max\{\pi_2-\pi_1,0\},\quad a^X=\max\{\pi_1-\pi_2\}
\end{aligned}
\]</span></p>
<p>and similarly for allocation <span class="math inline">\(Y\)</span>, we can then write the model as:</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(X_{i,t}\mid \alpha_i,\beta_i,\lambda_i)
&amp;=\Lambda\left(\lambda\left(\pi_{1,t}^X-\alpha_id_{t}^X-\beta_id_t^X-\pi_{1,t}^Y+\alpha_id_{t}^Y+\beta_id_t^Y\right)\right)\\
&amp;=\Lambda\left(\lambda(\pi^X_{i,t}-\pi^Y_{i,t})+\lambda\alpha_i(d^Y_t-d^X_t)+\lambda\beta_i(a^Y_t-a^X_t)\right)
\end{aligned}
\]</span></p>
<p>which is a logit model without an intercept, and so we can estimate the model as follows (here I am just doing it for the first participant):</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="representative-agent-and-participant-specific-models.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb45-2"><a href="representative-agent-and-participant-specific-models.html#cb45-2" aria-hidden="true" tabindex="-1"></a>D<span class="ot">&lt;-</span>(</span>
<span id="cb45-3"><a href="representative-agent-and-participant-specific-models.html#cb45-3" aria-hidden="true" tabindex="-1"></a>  D</span>
<span id="cb45-4"><a href="representative-agent-and-participant-specific-models.html#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">rowwise</span>()</span>
<span id="cb45-5"><a href="representative-agent-and-participant-specific-models.html#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">dX =</span> <span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,other_x<span class="sc">-</span>self_x)),</span>
<span id="cb45-6"><a href="representative-agent-and-participant-specific-models.html#cb45-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">dY =</span> <span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,other_y<span class="sc">-</span>self_y)),</span>
<span id="cb45-7"><a href="representative-agent-and-participant-specific-models.html#cb45-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">aX =</span> <span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,self_x<span class="sc">-</span>other_x)),</span>
<span id="cb45-8"><a href="representative-agent-and-participant-specific-models.html#cb45-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">aY =</span> <span class="fu">max</span>(<span class="fu">c</span>(<span class="dv">0</span>,self_y<span class="sc">-</span>other_y))</span>
<span id="cb45-9"><a href="representative-agent-and-participant-specific-models.html#cb45-9" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb45-10"><a href="representative-agent-and-participant-specific-models.html#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">ungroup</span>()</span>
<span id="cb45-11"><a href="representative-agent-and-participant-specific-models.html#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">x1 =</span> self_x<span class="sc">-</span>self_y,</span>
<span id="cb45-12"><a href="representative-agent-and-participant-specific-models.html#cb45-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">x2 =</span> dY<span class="sc">-</span>dX,</span>
<span id="cb45-13"><a href="representative-agent-and-participant-specific-models.html#cb45-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">x3 =</span> aY<span class="sc">-</span>aX)</span>
<span id="cb45-14"><a href="representative-agent-and-participant-specific-models.html#cb45-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-15"><a href="representative-agent-and-participant-specific-models.html#cb45-15" aria-hidden="true" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">glm</span>(<span class="at">data=</span>D<span class="sc">|&gt;</span> <span class="fu">filter</span>(sid<span class="sc">==</span><span class="dv">102010050706</span>),</span>
<span id="cb45-16"><a href="representative-agent-and-participant-specific-models.html#cb45-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">formula=</span>choice_x<span class="sc">~</span>x1<span class="sc">+</span>x2<span class="sc">+</span>x3<span class="dv">-1</span>,</span>
<span id="cb45-17"><a href="representative-agent-and-participant-specific-models.html#cb45-17" aria-hidden="true" tabindex="-1"></a>           <span class="at">family=</span><span class="fu">binomial</span>(<span class="at">link=</span><span class="st">&quot;logit&quot;</span>)) </span>
<span id="cb45-18"><a href="representative-agent-and-participant-specific-models.html#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model,<span class="at">type=</span><span class="st">&quot;html&quot;</span>,<span class="at">digits=</span><span class="dv">6</span>)</span></code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
choice_x
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
x1
</td>
<td>
0.008173<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.001845)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
x2
</td>
<td>
0.000443
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.001339)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
x3
</td>
<td>
0.001269
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.001277)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
78
</td>
</tr>
<tr>
<td style="text-align:left">
Log Likelihood
</td>
<td>
-38.115470
</td>
</tr>
<tr>
<td style="text-align:left">
Akaike Inf. Crit.
</td>
<td>
82.230940
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<p>So here we have <span class="math inline">\(\hat\lambda=0.0081731\)</span>. We haven’t directly estimated <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Instead, we have estimated <span class="math inline">\(\lambda\alpha\)</span> and <span class="math inline">\(\lambda\beta\)</span>, so we need to divide by <span class="math inline">\(\hat\lambda\)</span> to get <span class="math inline">\(\hat\alpha=0.0541735\)</span>, and <span class="math inline">\(\hat\beta=0.1552275\)</span>.</p>
</div>
<div id="assigning-priors" class="section level3 hasAnchor" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Assigning priors<a href="representative-agent-and-participant-specific-models.html#assigning-priors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Up to this point, I have not talked much about priors. This stops here! Our priors are the information we give our econometric model as experts (yes, you’re one of them) about the economic model.</p>
<p>Let’s start with the choice precision parameter <span class="math inline">\(\lambda\)</span>. For me, this is always the most difficult to assign, because it does not have a great economic interpretation. Sure, larger values mean more precise choices, but you really don’t have any idea about scale until you look at some predictions implied by it. Let’s calibrate this prior to a reasonable distribution based on what it implies about the choices of a self-regarding participant. That is, when we set the other paranmeters <span class="math inline">\(\alpha=\beta=0\)</span>, what do the probabilistic predictions of our model look like as we change <span class="math inline">\(\lambda\)</span>. To do this, I will first get a smaller dataset together of all the unique payoff differences faced by a selfish decision-maker:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="representative-agent-and-participant-specific-models.html#cb46-1" aria-hidden="true" tabindex="-1"></a>d<span class="ot">&lt;-</span>(D</span>
<span id="cb46-2"><a href="representative-agent-and-participant-specific-models.html#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">absDiff =</span> <span class="fu">abs</span>(self_x<span class="sc">-</span>self_y))</span>
<span id="cb46-3"><a href="representative-agent-and-participant-specific-models.html#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="sc">|&gt;</span> <span class="fu">select</span>(absDiff)</span>
<span id="cb46-4"><a href="representative-agent-and-participant-specific-models.html#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="sc">|&gt;</span> <span class="fu">unique</span>()</span>
<span id="cb46-5"><a href="representative-agent-and-participant-specific-models.html#cb46-5" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb46-6"><a href="representative-agent-and-participant-specific-models.html#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="representative-agent-and-participant-specific-models.html#cb46-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> <span class="fu">as.vector</span>() <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
<pre><code>## $absDiff
##  [1] 140 200 380 240 120  80  40 280 180   0 160 360</code></pre>
<p>It looks like we have twelve of them. Let’s plot the probability of choosing the action with the greatest payoff against <span class="math inline">\(\lambda\)</span>. Since <span class="math inline">\(\lambda\)</span> (kind-of) happens on a log scale, it is helpful to have this in a log scale:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="representative-agent-and-participant-specific-models.html#cb48-1" aria-hidden="true" tabindex="-1"></a>lambdaCheck<span class="ot">&lt;-</span>(</span>
<span id="cb48-2"><a href="representative-agent-and-participant-specific-models.html#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand.grid</span>(<span class="at">lambda =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">seq</span>(<span class="fl">0.0001</span>,<span class="fl">0.6</span>,<span class="at">length=</span><span class="dv">1001</span>))<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb48-3"><a href="representative-agent-and-participant-specific-models.html#cb48-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">absDiff =</span> d<span class="sc">$</span>absDiff)</span>
<span id="cb48-4"><a href="representative-agent-and-participant-specific-models.html#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb48-5"><a href="representative-agent-and-participant-specific-models.html#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">PrOptimal =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>absDiff))</span>
<span id="cb48-6"><a href="representative-agent-and-participant-specific-models.html#cb48-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-7"><a href="representative-agent-and-participant-specific-models.html#cb48-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-8"><a href="representative-agent-and-participant-specific-models.html#cb48-8" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb48-9"><a href="representative-agent-and-participant-specific-models.html#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>lambdaCheck,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>PrOptimal,<span class="at">group=</span>absDiff))</span>
<span id="cb48-10"><a href="representative-agent-and-participant-specific-models.html#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>()</span>
<span id="cb48-11"><a href="representative-agent-and-participant-specific-models.html#cb48-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb48-12"><a href="representative-agent-and-participant-specific-models.html#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb48-13"><a href="representative-agent-and-participant-specific-models.html#cb48-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;\u03bb&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Probability of choosing the action with the higher payoff&quot;</span>)</span>
<span id="cb48-14"><a href="representative-agent-and-participant-specific-models.html#cb48-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:RepAgentPriorLambda"></span>
<img src="index_files/figure-html/RepAgentPriorLambda-1.png" alt="Probability of choosing the optimal action for selfish decison-makers as a function of choice precision $\lambda$. Each curve shows the model's prediction for a different payoff difference from the experiment." width="672" />
<p class="caption">
Figure 4.2: Probability of choosing the optimal action for selfish decison-makers as a function of choice precision <span class="math inline">\(\lambda\)</span>. Each curve shows the model’s prediction for a different payoff difference from the experiment.
</p>
</div>
<p>It looks to me like most of the interesting stuff happens at <span class="math inline">\(\lambda&lt;0.1\)</span>. Since <span class="math inline">\(\lambda\)</span> must be positive, I will use a log-normal prior, which gives me two parameters to play with, the location and scale:<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<p><span class="math display">\[
\log\lambda\sim N(m_\lambda,s_\lambda^2)
\]</span>
I will calibrate this prior so that the 95th percentile of <span class="math inline">\(\lambda\)</span> is 0.1, and the 5th percentile of <span class="math inline">\(\lambda\)</span> is 0.0001. The system of equations to solve this is:</p>
<p><span class="math display">\[
\begin{aligned}
\log 0.1&amp;=m_\lambda+1.64s_\lambda\\
\log0.0001&amp;=m_\lambda-1.64s_\lambda\\
\log(0.1)-\log(0.0001)&amp;=2\times1.64s_\lambda\\
s_\lambda&amp;=\frac{\log(0.1)-\log(0.0001)}{2\times 1.64}\approx 2.11\\
m_\lambda &amp;=\log0.1-1.64\times2.11\approx-5.76
\end{aligned}
\]</span></p>
<p>That leaves us with assigning priors to <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. I will lump these together and use the same prior for both parameters. I think this simplification of the problem is OK because we can interpret both of these as marginal utilities. Here I note that if either parameter is greater than one in absolute value, then the participant will respond very strongly to inequality (or efficiency, or something else, depending on their signs). Let’s place 75% of the prior probability mass of both parameters in the range <span class="math inline">\((-1,1)\)</span>, which means that our full prior distribution is:</p>
<p><span class="math display">\[
\begin{aligned}
\alpha&amp;\sim N(0,0.67^2)\\
\beta &amp;\sim N(0,0.67^2)\\
\log\lambda&amp;\sim N(-5.76,2.11^2)
\end{aligned}
\]</span></p>
</div>
<div id="estimating-the-model-for-one-participant" class="section level3 hasAnchor" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Estimating the model for one participant<a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here is the <em>Stan</em> program I wrote to estimate this model. Note that you could have generated the transformed data before passing it to <em>Stan</em> and got the same results. I just wanted to have the program take the data as close as possible to how it is on the journal website.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb49-1"><a href="representative-agent-and-participant-specific-models.html#cb49-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-2"><a href="representative-agent-and-participant-specific-models.html#cb49-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb49-3"><a href="representative-agent-and-participant-specific-models.html#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> n<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb49-4"><a href="representative-agent-and-participant-specific-models.html#cb49-4" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> self_x<span class="op">;</span> <span class="co">// payoff to self with allocation x</span></span>
<span id="cb49-5"><a href="representative-agent-and-participant-specific-models.html#cb49-5" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> other_x<span class="op">;</span> <span class="co">// payoff to other with allocation x</span></span>
<span id="cb49-6"><a href="representative-agent-and-participant-specific-models.html#cb49-6" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> self_y<span class="op">;</span> <span class="co">// payoff to self with allocation y</span></span>
<span id="cb49-7"><a href="representative-agent-and-participant-specific-models.html#cb49-7" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> other_y<span class="op">;</span> <span class="co">// payoff to other with allocation y</span></span>
<span id="cb49-8"><a href="representative-agent-and-participant-specific-models.html#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> choice_x<span class="op">[</span>n<span class="op">];</span> <span class="co">// =1 iff allocation x is chosen</span></span>
<span id="cb49-9"><a href="representative-agent-and-participant-specific-models.html#cb49-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-10"><a href="representative-agent-and-participant-specific-models.html#cb49-10" aria-hidden="true" tabindex="-1"></a>  real prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb49-11"><a href="representative-agent-and-participant-specific-models.html#cb49-11" aria-hidden="true" tabindex="-1"></a>  real prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb49-12"><a href="representative-agent-and-participant-specific-models.html#cb49-12" aria-hidden="true" tabindex="-1"></a>  real prior_beta<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb49-13"><a href="representative-agent-and-participant-specific-models.html#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb49-14"><a href="representative-agent-and-participant-specific-models.html#cb49-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-15"><a href="representative-agent-and-participant-specific-models.html#cb49-15" aria-hidden="true" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb49-16"><a href="representative-agent-and-participant-specific-models.html#cb49-16" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> dX<span class="op">;</span> <span class="co">// disadvantageous inequality at allocation x</span></span>
<span id="cb49-17"><a href="representative-agent-and-participant-specific-models.html#cb49-17" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> dY<span class="op">;</span> <span class="co">// disadvantageous inequality at allocation y</span></span>
<span id="cb49-18"><a href="representative-agent-and-participant-specific-models.html#cb49-18" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> aX<span class="op">;</span> <span class="co">// advantageous inequality at allocation X</span></span>
<span id="cb49-19"><a href="representative-agent-and-participant-specific-models.html#cb49-19" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> aY<span class="op">;</span> <span class="co">// advantageous inequality at allocation X</span></span>
<span id="cb49-20"><a href="representative-agent-and-participant-specific-models.html#cb49-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-21"><a href="representative-agent-and-participant-specific-models.html#cb49-21" aria-hidden="true" tabindex="-1"></a>  dX <span class="op">=</span> fmax<span class="op">(</span><span class="dv">0</span><span class="op">,</span>other_x<span class="op">-</span>self_x<span class="op">);</span></span>
<span id="cb49-22"><a href="representative-agent-and-participant-specific-models.html#cb49-22" aria-hidden="true" tabindex="-1"></a>  dY <span class="op">=</span> fmax<span class="op">(</span><span class="dv">0</span><span class="op">,</span>other_y<span class="op">-</span>self_y<span class="op">);</span></span>
<span id="cb49-23"><a href="representative-agent-and-participant-specific-models.html#cb49-23" aria-hidden="true" tabindex="-1"></a>  aX <span class="op">=</span> fmax<span class="op">(</span><span class="dv">0</span><span class="op">,</span>self_x<span class="op">-</span>other_x<span class="op">);</span></span>
<span id="cb49-24"><a href="representative-agent-and-participant-specific-models.html#cb49-24" aria-hidden="true" tabindex="-1"></a>  aY <span class="op">=</span> fmax<span class="op">(</span><span class="dv">0</span><span class="op">,</span>self_y<span class="op">-</span>other_y<span class="op">);</span></span>
<span id="cb49-25"><a href="representative-agent-and-participant-specific-models.html#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb49-26"><a href="representative-agent-and-participant-specific-models.html#cb49-26" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb49-27"><a href="representative-agent-and-participant-specific-models.html#cb49-27" aria-hidden="true" tabindex="-1"></a>  real alpha<span class="op">;</span></span>
<span id="cb49-28"><a href="representative-agent-and-participant-specific-models.html#cb49-28" aria-hidden="true" tabindex="-1"></a>  real beta<span class="op">;</span></span>
<span id="cb49-29"><a href="representative-agent-and-participant-specific-models.html#cb49-29" aria-hidden="true" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb49-30"><a href="representative-agent-and-participant-specific-models.html#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb49-31"><a href="representative-agent-and-participant-specific-models.html#cb49-31" aria-hidden="true" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb49-32"><a href="representative-agent-and-participant-specific-models.html#cb49-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-33"><a href="representative-agent-and-participant-specific-models.html#cb49-33" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> Ux<span class="op">;</span> <span class="co">// utility of allocation x</span></span>
<span id="cb49-34"><a href="representative-agent-and-participant-specific-models.html#cb49-34" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> Uy<span class="op">;</span> <span class="co">// utility of allocation y</span></span>
<span id="cb49-35"><a href="representative-agent-and-participant-specific-models.html#cb49-35" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-36"><a href="representative-agent-and-participant-specific-models.html#cb49-36" aria-hidden="true" tabindex="-1"></a>  Ux <span class="op">=</span> self_x<span class="op">-</span>alpha<span class="op">*</span>dX<span class="op">-</span>beta<span class="op">*</span>aX<span class="op">;</span></span>
<span id="cb49-37"><a href="representative-agent-and-participant-specific-models.html#cb49-37" aria-hidden="true" tabindex="-1"></a>  Uy <span class="op">=</span> self_y<span class="op">-</span>alpha<span class="op">*</span>dY<span class="op">-</span>beta<span class="op">*</span>aY<span class="op">;</span></span>
<span id="cb49-38"><a href="representative-agent-and-participant-specific-models.html#cb49-38" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-39"><a href="representative-agent-and-participant-specific-models.html#cb49-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb49-40"><a href="representative-agent-and-participant-specific-models.html#cb49-40" aria-hidden="true" tabindex="-1"></a>  choice_x <span class="op">~</span> bernoulli_logit<span class="op">(</span>lambda<span class="op">*(</span>Ux<span class="op">-</span>Uy<span class="op">));</span></span>
<span id="cb49-41"><a href="representative-agent-and-participant-specific-models.html#cb49-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-42"><a href="representative-agent-and-participant-specific-models.html#cb49-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb49-43"><a href="representative-agent-and-participant-specific-models.html#cb49-43" aria-hidden="true" tabindex="-1"></a>  alpha<span class="op">~</span>normal<span class="op">(</span>prior_alpha<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb49-44"><a href="representative-agent-and-participant-specific-models.html#cb49-44" aria-hidden="true" tabindex="-1"></a>  beta <span class="op">~</span>normal<span class="op">(</span>prior_beta<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_beta<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb49-45"><a href="representative-agent-and-participant-specific-models.html#cb49-45" aria-hidden="true" tabindex="-1"></a>  lambda <span class="op">~</span> lognormal<span class="op">(</span>prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb49-46"><a href="representative-agent-and-participant-specific-models.html#cb49-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-47"><a href="representative-agent-and-participant-specific-models.html#cb49-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Before moving on, I want to draw your attention to the vectorization used in this program. Specifically, since I have the data variables <code>self_x</code>, <code>dX</code>, and <code>aX</code> stored as vectors, and the model’s parameters <code>alpha</code> and <code>beta</code> are just real numbers (i.e. scalars), I can calculate the entire utility of Option X (and likewise for Option Y) in one line without looping over all observations. That is, the following two methods for calculating the utility of Option X will produce the same result:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb50-1"><a href="representative-agent-and-participant-specific-models.html#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">// the vectorized method</span></span>
<span id="cb50-2"><a href="representative-agent-and-participant-specific-models.html#cb50-2" aria-hidden="true" tabindex="-1"></a>Ux <span class="op">=</span> self_x<span class="op">-</span>alpha<span class="op">*</span>dX<span class="op">-</span>beta<span class="op">*</span>aX<span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb51-1"><a href="representative-agent-and-participant-specific-models.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">// a for loop</span></span>
<span id="cb51-2"><a href="representative-agent-and-participant-specific-models.html#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb51-3"><a href="representative-agent-and-participant-specific-models.html#cb51-3" aria-hidden="true" tabindex="-1"></a>  Ux<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> self_x<span class="op">[</span>ii<span class="op">]-</span>alpha<span class="op">*</span>dX<span class="op">[</span>ii<span class="op">]-</span>beta<span class="op">*</span>aX<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb51-4"><a href="representative-agent-and-participant-specific-models.html#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>However the second method will take longer. This is because <em>Stan</em> is geared towards vectorized calculations and matrix operations. The second option may seem more intuitive to you (it does to me), but I encourage you to see the matrix and vectorize things where you can. It’s not going to same much time for this model, but as we start estimating more complicated models every bit of speed-up helps.</p>
<p>Now, let’s estimate the model for the first participant</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="representative-agent-and-participant-specific-models.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb52-2"><a href="representative-agent-and-participant-specific-models.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb52-3"><a href="representative-agent-and-participant-specific-models.html#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb52-4"><a href="representative-agent-and-participant-specific-models.html#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="representative-agent-and-participant-specific-models.html#cb52-5" aria-hidden="true" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;RepAgentModels/RepAgentModels_BFS2019&quot;</span></span>
<span id="cb52-6"><a href="representative-agent-and-participant-specific-models.html#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="representative-agent-and-participant-specific-models.html#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># only run if I haven&#39;t estimated it yet</span></span>
<span id="cb52-8"><a href="representative-agent-and-participant-specific-models.html#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_subj1.rds&quot;</span>))) {</span>
<span id="cb52-9"><a href="representative-agent-and-participant-specific-models.html#cb52-9" aria-hidden="true" tabindex="-1"></a>  ii<span class="ot">&lt;-</span><span class="dv">102010050706</span></span>
<span id="cb52-10"><a href="representative-agent-and-participant-specific-models.html#cb52-10" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span> <span class="fu">filter</span>(sid<span class="sc">==</span>ii)</span>
<span id="cb52-11"><a href="representative-agent-and-participant-specific-models.html#cb52-11" aria-hidden="true" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb52-12"><a href="representative-agent-and-participant-specific-models.html#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span><span class="fu">dim</span>(d)[<span class="dv">1</span>],</span>
<span id="cb52-13"><a href="representative-agent-and-participant-specific-models.html#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">self_x=</span>d<span class="sc">$</span>self_x,</span>
<span id="cb52-14"><a href="representative-agent-and-participant-specific-models.html#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_x=</span>d<span class="sc">$</span>other_x,</span>
<span id="cb52-15"><a href="representative-agent-and-participant-specific-models.html#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">self_y=</span>d<span class="sc">$</span>self_y,</span>
<span id="cb52-16"><a href="representative-agent-and-participant-specific-models.html#cb52-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_y=</span>d<span class="sc">$</span>other_y,</span>
<span id="cb52-17"><a href="representative-agent-and-participant-specific-models.html#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">choice_x=</span>d<span class="sc">$</span>choice_x,</span>
<span id="cb52-18"><a href="representative-agent-and-participant-specific-models.html#cb52-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb52-19"><a href="representative-agent-and-participant-specific-models.html#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stan (and R for that matter) deal with standard deviations, </span></span>
<span id="cb52-20"><a href="representative-agent-and-participant-specific-models.html#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not variances for a normal distribution</span></span>
<span id="cb52-21"><a href="representative-agent-and-participant-specific-models.html#cb52-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.76</span>,<span class="fl">2.11</span>),</span>
<span id="cb52-22"><a href="representative-agent-and-participant-specific-models.html#cb52-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_alpha=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.67</span>),</span>
<span id="cb52-23"><a href="representative-agent-and-participant-specific-models.html#cb52-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.67</span>)</span>
<span id="cb52-24"><a href="representative-agent-and-participant-specific-models.html#cb52-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb52-25"><a href="representative-agent-and-participant-specific-models.html#cb52-25" aria-hidden="true" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">stan</span>(<span class="fu">paste0</span>(<span class="st">&quot;Code/&quot;</span>,file,<span class="st">&quot;.stan&quot;</span>),</span>
<span id="cb52-26"><a href="representative-agent-and-participant-specific-models.html#cb52-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>dStan,</span>
<span id="cb52-27"><a href="representative-agent-and-participant-specific-models.html#cb52-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb52-28"><a href="representative-agent-and-participant-specific-models.html#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(Fit,<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_subj1.rds&quot;</span>))</span>
<span id="cb52-29"><a href="representative-agent-and-participant-specific-models.html#cb52-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb52-30"><a href="representative-agent-and-participant-specific-models.html#cb52-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-31"><a href="representative-agent-and-participant-specific-models.html#cb52-31" aria-hidden="true" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_subj1.rds&quot;</span>))</span>
<span id="cb52-32"><a href="representative-agent-and-participant-specific-models.html#cb52-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-33"><a href="representative-agent-and-participant-specific-models.html#cb52-33" aria-hidden="true" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">summary</span>(Fit)<span class="sc">$</span>summary <span class="sc">%&gt;%</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&quot;Estimates from the first participant in @BFS2019&quot;</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:RepAgentBFS2019Subj1Table">Table 4.1: </span>Estimates from the first participant in <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span></caption>
<colgroup>
<col width="5%" />
<col width="10%" />
<col width="8%" />
<col width="8%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">se_mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">25%</th>
<th align="right">50%</th>
<th align="right">75%</th>
<th align="right">97.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">0.0889337</td>
<td align="right">0.0038723</td>
<td align="right">0.1932936</td>
<td align="right">-0.2584474</td>
<td align="right">-0.0372583</td>
<td align="right">0.0778896</td>
<td align="right">0.2045905</td>
<td align="right">0.5094519</td>
<td align="right">2491.683</td>
<td align="right">1.001793</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.1377641</td>
<td align="right">0.0035096</td>
<td align="right">0.1816480</td>
<td align="right">-0.2167278</td>
<td align="right">0.0241048</td>
<td align="right">0.1406289</td>
<td align="right">0.2529966</td>
<td align="right">0.4902746</td>
<td align="right">2678.910</td>
<td align="right">1.001272</td>
</tr>
<tr class="odd">
<td align="left">lambda</td>
<td align="right">0.0072245</td>
<td align="right">0.0000376</td>
<td align="right">0.0018702</td>
<td align="right">0.0038158</td>
<td align="right">0.0058960</td>
<td align="right">0.0071869</td>
<td align="right">0.0084521</td>
<td align="right">0.0110631</td>
<td align="right">2471.567</td>
<td align="right">1.000313</td>
</tr>
<tr class="even">
<td align="left">lp__</td>
<td align="right">-40.8879873</td>
<td align="right">0.0382728</td>
<td align="right">1.4314119</td>
<td align="right">-44.5129399</td>
<td align="right">-41.5399276</td>
<td align="right">-40.5390461</td>
<td align="right">-39.8432989</td>
<td align="right">-39.2968401</td>
<td align="right">1398.780</td>
<td align="right">1.000426</td>
</tr>
</tbody>
</table>
<p>Table <a href="representative-agent-and-participant-specific-models.html#tab:RepAgentBFS2019Subj1Table">4.1</a> shows the estimates summary, which is not too dissimilar from the point estimates from the logit above (there is lots of uncertainty in both kinds of estimate, so take into consideration the standard errors as well).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="representative-agent-and-participant-specific-models.html#cb53-1" aria-hidden="true" tabindex="-1"></a>sim<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">alpha =</span> rstan<span class="sc">::</span><span class="fu">extract</span>(Fit)<span class="sc">$</span>alpha,<span class="at">beta=</span>rstan<span class="sc">::</span><span class="fu">extract</span>(Fit)<span class="sc">$</span>beta)</span>
<span id="cb53-2"><a href="representative-agent-and-participant-specific-models.html#cb53-2" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb53-3"><a href="representative-agent-and-participant-specific-models.html#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(sim,</span>
<span id="cb53-4"><a href="representative-agent-and-participant-specific-models.html#cb53-4" aria-hidden="true" tabindex="-1"></a>         <span class="fu">aes</span>(<span class="at">x=</span>alpha,<span class="at">y=</span>beta))</span>
<span id="cb53-5"><a href="representative-agent-and-participant-specific-models.html#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">0.3</span>,<span class="at">alpha=</span><span class="fl">0.1</span>)</span>
<span id="cb53-6"><a href="representative-agent-and-participant-specific-models.html#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb53-7"><a href="representative-agent-and-participant-specific-models.html#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb53-8"><a href="representative-agent-and-participant-specific-models.html#cb53-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb53-9"><a href="representative-agent-and-participant-specific-models.html#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(alpha))<span class="sc">+</span><span class="fu">ylab</span>(<span class="fu">expression</span>(beta))</span>
<span id="cb53-10"><a href="representative-agent-and-participant-specific-models.html#cb53-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:RepAgentBFS2019Subj1Posterior"></span>
<img src="index_files/figure-html/RepAgentBFS2019Subj1Posterior-1.png" alt="Posterior draws for the first participant of @BFS2019." width="672" />
<p class="caption">
Figure 4.3: Posterior draws for the first participant of <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span>.
</p>
</div>
<p>Figure <a href="representative-agent-and-participant-specific-models.html#fig:RepAgentBFS2019Subj1Posterior">4.3</a> shows the 4,000 posterior draws from the posterior distribution of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. We can use these draws to work out a posterior probability that the parameters lies in each quadrant of this plot, which can help us assign a posterior probability to this participant having the parameter restrictions imposed by <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span>, which are:</p>
<ul>
<li><span class="math inline">\(\alpha&gt;0\)</span> and <span class="math inline">\(\beta&gt;0\)</span>, so the participant is averse to inequality,</li>
<li><span class="math inline">\(\alpha&gt;\beta\)</span>, so the participant dislikes being behind (aversion to disadvantageous inequality) more than being ahead, and</li>
<li><span class="math inline">\(\beta\in(0,1)\)</span>, so the participant would not be willing to burn money in order to equalize payoffs</li>
</ul>
<p>To compute the probability that all of these are true, we simply compute the fraction of posterior draws that satisfy these conditions:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="representative-agent-and-participant-specific-models.html#cb54-1" aria-hidden="true" tabindex="-1"></a>sim <span class="sc">|&gt;</span> <span class="fu">summarize</span>(</span>
<span id="cb54-2"><a href="representative-agent-and-participant-specific-models.html#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">FS1999 =</span> <span class="fu">mean</span>(</span>
<span id="cb54-3"><a href="representative-agent-and-participant-specific-models.html#cb54-3" aria-hidden="true" tabindex="-1"></a>    alpha<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> beta<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> alpha<span class="sc">&gt;</span>beta <span class="sc">&amp;</span> beta<span class="sc">&lt;</span><span class="dv">1</span></span>
<span id="cb54-4"><a href="representative-agent-and-participant-specific-models.html#cb54-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-5"><a href="representative-agent-and-participant-specific-models.html#cb54-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   FS1999
##    &lt;dbl&gt;
## 1  0.233</code></pre>
<p>Since I centered the prior distribution on zero for both of these parameters, 23% is not too different from 25%, the prior probability that these conditions are met. Therefore I would not get too excited about this probability. Furthermore, since we have 4,000 posterior draws, the prior standard deviation of this probability is at least:<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a></p>
<p><span class="math display">\[
\sqrt{\frac{0.25\times0.75}{4000}}\approx 0.007
\]</span></p>
<p>So getting 4,000 draws from the <em>prior</em> that implied that this probability was 23% would not be too unlikely. All of this is to say, we actually don’t learn much about whether this parameter restriction is relevant for this participant. We actually do resolve quite a bit of parameter uncertainty, though. For example, Figure <a href="representative-agent-and-participant-specific-models.html#fig:RepAgentBFS2019Subj1alpha">4.4</a> shows both the prior and posterior distributions of <span class="math inline">\(\alpha\)</span>. We have actually learned quite a bit from these 78 choices, but it is more that we have rules out large values of <span class="math inline">\(\alpha\)</span>, rather than ruled out everything on one side of zero. As such, the uncertainty in whether or not <span class="math inline">\(\alpha&gt;0\)</span> is largely unchanged.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="representative-agent-and-participant-specific-models.html#cb56-1" aria-hidden="true" tabindex="-1"></a>(</span>
<span id="cb56-2"><a href="representative-agent-and-participant-specific-models.html#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()</span>
<span id="cb56-3"><a href="representative-agent-and-participant-specific-models.html#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_density</span>(<span class="at">data=</span>sim,<span class="fu">aes</span>(<span class="at">x=</span>alpha,<span class="at">linetype=</span><span class="st">&quot;posterior&quot;</span>))</span>
<span id="cb56-4"><a href="representative-agent-and-participant-specific-models.html#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>(<span class="at">data=</span><span class="fu">tibble</span>(<span class="at">alpha=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="at">length=</span><span class="dv">1000</span>)) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">den=</span><span class="fu">dnorm</span>(alpha,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="fl">0.67</span>)),<span class="fu">aes</span>(<span class="at">x=</span>alpha,<span class="at">y=</span>den,<span class="at">linetype=</span><span class="st">&quot;prior&quot;</span>))</span>
<span id="cb56-5"><a href="representative-agent-and-participant-specific-models.html#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb56-6"><a href="representative-agent-and-participant-specific-models.html#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(alpha))<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;density&quot;</span>)</span>
<span id="cb56-7"><a href="representative-agent-and-participant-specific-models.html#cb56-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:RepAgentBFS2019Subj1alpha"></span>
<img src="index_files/figure-html/RepAgentBFS2019Subj1alpha-1.png" alt="Prior and posterior distributions of parameter $\alpha$ for the first particiapnt in @BFS2019." width="672" />
<p class="caption">
Figure 4.4: Prior and posterior distributions of parameter <span class="math inline">\(\alpha\)</span> for the first particiapnt in <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span>.
</p>
</div>
</div>
<div id="estimating-the-model-for-all-participants" class="section level3 hasAnchor" number="4.1.6">
<h3><span class="header-section-number">4.1.6</span> Estimating the model for all participants<a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Of course, once we have a model that we can estimate for one participant, we can also use it with the others. So here we go:<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a></p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="representative-agent-and-participant-specific-models.html#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_ALL.rds&quot;</span>))) {</span>
<span id="cb57-2"><a href="representative-agent-and-participant-specific-models.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-3"><a href="representative-agent-and-participant-specific-models.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create an empty dataset to dump the posterior draws into</span></span>
<span id="cb57-4"><a href="representative-agent-and-participant-specific-models.html#cb57-4" aria-hidden="true" tabindex="-1"></a>  ESTIMATES<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb57-5"><a href="representative-agent-and-participant-specific-models.html#cb57-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-6"><a href="representative-agent-and-participant-specific-models.html#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (ii <span class="cf">in</span> (D<span class="sc">$</span>sid <span class="sc">|&gt;</span> <span class="fu">unique</span>())) {</span>
<span id="cb57-7"><a href="representative-agent-and-participant-specific-models.html#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(ii)</span>
<span id="cb57-8"><a href="representative-agent-and-participant-specific-models.html#cb57-8" aria-hidden="true" tabindex="-1"></a>    d<span class="ot">&lt;-</span>D<span class="sc">|&gt;</span> <span class="fu">filter</span>(sid<span class="sc">==</span>ii)</span>
<span id="cb57-9"><a href="representative-agent-and-participant-specific-models.html#cb57-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-10"><a href="representative-agent-and-participant-specific-models.html#cb57-10" aria-hidden="true" tabindex="-1"></a>    dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb57-11"><a href="representative-agent-and-participant-specific-models.html#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span><span class="fu">dim</span>(d)[<span class="dv">1</span>],</span>
<span id="cb57-12"><a href="representative-agent-and-participant-specific-models.html#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">self_x=</span>d<span class="sc">$</span>self_x,</span>
<span id="cb57-13"><a href="representative-agent-and-participant-specific-models.html#cb57-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_x=</span>d<span class="sc">$</span>other_x,</span>
<span id="cb57-14"><a href="representative-agent-and-participant-specific-models.html#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">self_y=</span>d<span class="sc">$</span>self_y,</span>
<span id="cb57-15"><a href="representative-agent-and-participant-specific-models.html#cb57-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_y=</span>d<span class="sc">$</span>other_y,</span>
<span id="cb57-16"><a href="representative-agent-and-participant-specific-models.html#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">choice_x=</span>d<span class="sc">$</span>choice_x,</span>
<span id="cb57-17"><a href="representative-agent-and-participant-specific-models.html#cb57-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-18"><a href="representative-agent-and-participant-specific-models.html#cb57-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stan (and R for that matter) deal with standard deviations, </span></span>
<span id="cb57-19"><a href="representative-agent-and-participant-specific-models.html#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not variances for a normal distribution</span></span>
<span id="cb57-20"><a href="representative-agent-and-participant-specific-models.html#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.76</span>,<span class="fl">2.11</span>),</span>
<span id="cb57-21"><a href="representative-agent-and-participant-specific-models.html#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_alpha=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.67</span>),</span>
<span id="cb57-22"><a href="representative-agent-and-participant-specific-models.html#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.67</span>)</span>
<span id="cb57-23"><a href="representative-agent-and-participant-specific-models.html#cb57-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb57-24"><a href="representative-agent-and-participant-specific-models.html#cb57-24" aria-hidden="true" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">stan</span>(<span class="fu">paste0</span>(<span class="st">&quot;Code/&quot;</span>,file,<span class="st">&quot;.stan&quot;</span>),</span>
<span id="cb57-25"><a href="representative-agent-and-participant-specific-models.html#cb57-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>dStan,</span>
<span id="cb57-26"><a href="representative-agent-and-participant-specific-models.html#cb57-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb57-27"><a href="representative-agent-and-participant-specific-models.html#cb57-27" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Here I am running into a few &quot;divergent transitions&quot;</span></span>
<span id="cb57-28"><a href="representative-agent-and-participant-specific-models.html#cb57-28" aria-hidden="true" tabindex="-1"></a>            <span class="co"># errors. One of the solutions to this is to increase </span></span>
<span id="cb57-29"><a href="representative-agent-and-participant-specific-models.html#cb57-29" aria-hidden="true" tabindex="-1"></a>            <span class="co"># the &quot;adapt_delta&quot; control parameter</span></span>
<span id="cb57-30"><a href="representative-agent-and-participant-specific-models.html#cb57-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">control=</span><span class="fu">list</span>(<span class="at">adapt_delta=</span><span class="fl">0.999</span>)</span>
<span id="cb57-31"><a href="representative-agent-and-participant-specific-models.html#cb57-31" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb57-32"><a href="representative-agent-and-participant-specific-models.html#cb57-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-33"><a href="representative-agent-and-participant-specific-models.html#cb57-33" aria-hidden="true" tabindex="-1"></a>  tmp<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">lambda =</span> <span class="fu">extract</span>(Fit)<span class="sc">$</span>lambda,</span>
<span id="cb57-34"><a href="representative-agent-and-participant-specific-models.html#cb57-34" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha  =</span> <span class="fu">extract</span>(Fit)<span class="sc">$</span>alpha,</span>
<span id="cb57-35"><a href="representative-agent-and-participant-specific-models.html#cb57-35" aria-hidden="true" tabindex="-1"></a>              <span class="at">beta   =</span> <span class="fu">extract</span>(Fit)<span class="sc">$</span>beta,</span>
<span id="cb57-36"><a href="representative-agent-and-participant-specific-models.html#cb57-36" aria-hidden="true" tabindex="-1"></a>              <span class="at">sid    =</span> ii</span>
<span id="cb57-37"><a href="representative-agent-and-participant-specific-models.html#cb57-37" aria-hidden="true" tabindex="-1"></a>              )</span>
<span id="cb57-38"><a href="representative-agent-and-participant-specific-models.html#cb57-38" aria-hidden="true" tabindex="-1"></a>  ESTIMATES<span class="ot">&lt;-</span><span class="fu">rbind</span>(ESTIMATES,tmp)</span>
<span id="cb57-39"><a href="representative-agent-and-participant-specific-models.html#cb57-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-40"><a href="representative-agent-and-participant-specific-models.html#cb57-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb57-41"><a href="representative-agent-and-participant-specific-models.html#cb57-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb57-42"><a href="representative-agent-and-participant-specific-models.html#cb57-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(ESTIMATES,<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_ALL.rds&quot;</span>))</span>
<span id="cb57-43"><a href="representative-agent-and-participant-specific-models.html#cb57-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>So that’s all very well and good, but what do we <em>do</em> with all of these estimates? We don’t have the time to look at a summary output table for each one of them individually, so things are best summarized in pictures. What I will do here is wrangle the posterior draws into posterior means and 95% Bayesian credible regions,<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> and also the probability that the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> parameter restriction holds.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="representative-agent-and-participant-specific-models.html#cb58-1" aria-hidden="true" tabindex="-1"></a>ESTIMATES<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_ALL.rds&quot;</span>))</span>
<span id="cb58-2"><a href="representative-agent-and-participant-specific-models.html#cb58-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb58-3"><a href="representative-agent-and-participant-specific-models.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a summary of estimates that I could have got from summary(Fit)$summary</span></span>
<span id="cb58-4"><a href="representative-agent-and-participant-specific-models.html#cb58-4" aria-hidden="true" tabindex="-1"></a>EstSum<span class="ot">&lt;-</span>(</span>
<span id="cb58-5"><a href="representative-agent-and-participant-specific-models.html#cb58-5" aria-hidden="true" tabindex="-1"></a>  ESTIMATES</span>
<span id="cb58-6"><a href="representative-agent-and-participant-specific-models.html#cb58-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(lambda,alpha,beta),<span class="at">values_to=</span><span class="st">&quot;value&quot;</span>)</span>
<span id="cb58-7"><a href="representative-agent-and-participant-specific-models.html#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(sid,name)</span>
<span id="cb58-8"><a href="representative-agent-and-participant-specific-models.html#cb58-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">summarize</span>(</span>
<span id="cb58-9"><a href="representative-agent-and-participant-specific-models.html#cb58-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">mean</span>(value),</span>
<span id="cb58-10"><a href="representative-agent-and-participant-specific-models.html#cb58-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">p025 =</span> <span class="fu">quantile</span>(value,<span class="at">probs=</span><span class="fl">0.025</span>),</span>
<span id="cb58-11"><a href="representative-agent-and-participant-specific-models.html#cb58-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">p975 =</span> <span class="fu">quantile</span>(value,<span class="at">probs=</span><span class="fl">0.975</span>)</span>
<span id="cb58-12"><a href="representative-agent-and-participant-specific-models.html#cb58-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-13"><a href="representative-agent-and-participant-specific-models.html#cb58-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-14"><a href="representative-agent-and-participant-specific-models.html#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="representative-agent-and-participant-specific-models.html#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability that the FS restriction holds</span></span>
<span id="cb58-16"><a href="representative-agent-and-participant-specific-models.html#cb58-16" aria-hidden="true" tabindex="-1"></a>ProbFS1999<span class="ot">&lt;-</span>(</span>
<span id="cb58-17"><a href="representative-agent-and-participant-specific-models.html#cb58-17" aria-hidden="true" tabindex="-1"></a>  ESTIMATES</span>
<span id="cb58-18"><a href="representative-agent-and-participant-specific-models.html#cb58-18" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(sid)</span>
<span id="cb58-19"><a href="representative-agent-and-participant-specific-models.html#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">PrFS =</span> <span class="fu">mean</span>(</span>
<span id="cb58-20"><a href="representative-agent-and-participant-specific-models.html#cb58-20" aria-hidden="true" tabindex="-1"></a>    alpha<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> beta<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> alpha<span class="sc">&gt;</span>beta <span class="sc">&amp;</span> beta<span class="sc">&lt;</span><span class="dv">1</span></span>
<span id="cb58-21"><a href="representative-agent-and-participant-specific-models.html#cb58-21" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb58-22"><a href="representative-agent-and-participant-specific-models.html#cb58-22" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb58-23"><a href="representative-agent-and-participant-specific-models.html#cb58-23" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p>First, let’s look at the probability that the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> restriction holds. As before this is just a matter of computing the fraction of times the posterior draws land in the right region. The empirical cumulative density of these posterior probabilities is shown in Figure <a href="representative-agent-and-participant-specific-models.html#fig:RepAgentFS1999">4.5</a>.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> Here we can see a large accumulation of posterior probabilities near zero. About 60% of participants have so few posterior draws of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> in the region implied by the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> restriction that we cannot distinguish between zero and the actual posterior probability. As such, there are in fact very few participants whose parameters are likely to conform to the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> restriction.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="representative-agent-and-participant-specific-models.html#cb59-1" aria-hidden="true" tabindex="-1"></a>(  </span>
<span id="cb59-2"><a href="representative-agent-and-participant-specific-models.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(ProbFS1999,<span class="fu">aes</span>(<span class="at">x=</span>PrFS))</span>
<span id="cb59-3"><a href="representative-agent-and-participant-specific-models.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>()</span>
<span id="cb59-4"><a href="representative-agent-and-participant-specific-models.html#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb59-5"><a href="representative-agent-and-participant-specific-models.html#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Posterior probability that the FS restriction on </span><span class="sc">\n</span><span class="st"> parameters holds&quot;</span>)</span>
<span id="cb59-6"><a href="representative-agent-and-participant-specific-models.html#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;empirical cumulative density&quot;</span>)</span>
<span id="cb59-7"><a href="representative-agent-and-participant-specific-models.html#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:RepAgentFS1999"></span>
<img src="index_files/figure-html/RepAgentFS1999-1.png" alt="Posterior probability that the @FS1999 restrictions hold for each participant." width="672" />
<p class="caption">
Figure 4.5: Posterior probability that the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> restrictions hold for each participant.
</p>
</div>
<p>Now let’s try to visualize the joint distribution of participants’ parameters. It can get really messy in these plots if you try to show a credible region around the point estimates, so here I will just plot the posterior means. These are shown in Figure <a href="representative-agent-and-participant-specific-models.html#fig:RepAgentPostMeans">4.6</a>. The majority of these point estimates fall in the efficiency-loving region (<span class="math inline">\(\alpha&lt;0\)</span>, <span class="math inline">\(\beta&gt;0\)</span>), and within this most estimates have <span class="math inline">\(\beta&gt;|\alpha|\)</span>, meaning that these participants care more about increasing the other person’s earnings when the other person is earning less than themself. The majority of parameters are also less than one in absolute value, meaning that they place more weight on their own earnings than they do on the earnings of others. The obvious exception to this is for three competitive and inequality averse participants with <span class="math inline">\(\alpha&gt;1\)</span>. For these participants, their marginal utility of own wealth is less than their marginal utility of the other person’s wealth when the other person is earning more. There are no particiapnts whose posterior mean estimates are in the inequality loving quadrant of this plot.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="representative-agent-and-participant-specific-models.html#cb60-1" aria-hidden="true" tabindex="-1"></a>regions<span class="ot">&lt;-</span><span class="fu">tibble</span>(</span>
<span id="cb60-2"><a href="representative-agent-and-participant-specific-models.html#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.25</span>,<span class="sc">-</span><span class="fl">0.25</span>,<span class="dv">1</span>),</span>
<span id="cb60-3"><a href="representative-agent-and-participant-specific-models.html#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="fl">0.8</span>,<span class="sc">-</span><span class="fl">0.5</span>),</span>
<span id="cb60-4"><a href="representative-agent-and-participant-specific-models.html#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">label =</span> <span class="fu">c</span>(<span class="st">&quot;inequality averse&quot;</span>,</span>
<span id="cb60-5"><a href="representative-agent-and-participant-specific-models.html#cb60-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;inequality loving&quot;</span>,</span>
<span id="cb60-6"><a href="representative-agent-and-participant-specific-models.html#cb60-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;efficiency loving&quot;</span>,</span>
<span id="cb60-7"><a href="representative-agent-and-participant-specific-models.html#cb60-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;competitive&quot;</span></span>
<span id="cb60-8"><a href="representative-agent-and-participant-specific-models.html#cb60-8" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb60-9"><a href="representative-agent-and-participant-specific-models.html#cb60-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-10"><a href="representative-agent-and-participant-specific-models.html#cb60-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-11"><a href="representative-agent-and-participant-specific-models.html#cb60-11" aria-hidden="true" tabindex="-1"></a>pltInd<span class="ot">&lt;-</span>(  </span>
<span id="cb60-12"><a href="representative-agent-and-participant-specific-models.html#cb60-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb60-13"><a href="representative-agent-and-participant-specific-models.html#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> (ESTIMATES <span class="sc">|&gt;</span> <span class="fu">group_by</span>(sid)</span>
<span id="cb60-14"><a href="representative-agent-and-participant-specific-models.html#cb60-14" aria-hidden="true" tabindex="-1"></a>                      <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">alpha =</span> <span class="fu">mean</span>(alpha),</span>
<span id="cb60-15"><a href="representative-agent-and-participant-specific-models.html#cb60-15" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">beta =</span> <span class="fu">mean</span>(beta),</span>
<span id="cb60-16"><a href="representative-agent-and-participant-specific-models.html#cb60-16" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">lambda =</span> <span class="fu">mean</span>(lambda))</span>
<span id="cb60-17"><a href="representative-agent-and-participant-specific-models.html#cb60-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb60-18"><a href="representative-agent-and-participant-specific-models.html#cb60-18" aria-hidden="true" tabindex="-1"></a>            ),</span>
<span id="cb60-19"><a href="representative-agent-and-participant-specific-models.html#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x=</span>alpha,<span class="at">y=</span>beta,<span class="at">color=</span><span class="fu">log10</span>(lambda))</span>
<span id="cb60-20"><a href="representative-agent-and-participant-specific-models.html#cb60-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-21"><a href="representative-agent-and-participant-specific-models.html#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>()</span>
<span id="cb60-22"><a href="representative-agent-and-participant-specific-models.html#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_text</span>(<span class="at">data=</span>regions,<span class="fu">aes</span>(<span class="at">x=</span>alpha,<span class="at">y=</span>beta,<span class="at">label=</span>label),<span class="at">color=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb60-23"><a href="representative-agent-and-participant-specific-models.html#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb60-24"><a href="representative-agent-and-participant-specific-models.html#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(alpha))<span class="sc">+</span><span class="fu">ylab</span>(<span class="fu">expression</span>(beta))</span>
<span id="cb60-25"><a href="representative-agent-and-participant-specific-models.html#cb60-25" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb60-26"><a href="representative-agent-and-participant-specific-models.html#cb60-26" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb60-27"><a href="representative-agent-and-participant-specific-models.html#cb60-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#+geom_abline(slope=c(-1,1),intercept=0,linetype=&quot;dotted&quot;)</span></span>
<span id="cb60-28"><a href="representative-agent-and-participant-specific-models.html#cb60-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-29"><a href="representative-agent-and-participant-specific-models.html#cb60-29" aria-hidden="true" tabindex="-1"></a>pltInd <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:RepAgentPostMeans"></span>
<img src="index_files/figure-html/RepAgentPostMeans-1.png" alt="Posterior mean estimates for @FS1999 model using data from @BFS2019. Dashed lines show boundaries for the classification of types of preferences." width="672" />
<p class="caption">
Figure 4.6: Posterior mean estimates for <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> model using data from <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span>. Dashed lines show boundaries for the classification of types of preferences.
</p>
</div>
<p>Finally, if we want a deeper dive into the parameters individually, we can plot the empirical cumulative density function of the posterior means, overlaying them with their 95% Bayesian credible regions to show how precise the estimates are. This is done in Figure <a href="representative-agent-and-participant-specific-models.html#fig:RepAgentPostECDF">4.7</a>. I like these plots both for individual estimation and for hierarchical models because they show us a lot of information about the between-participant heterogeneity in the parameter estimates, as well as giving us an idea about how precise our estimates are. Here we can see that there is substantial heterogeneity both in the posterior mean estimates (seen in the empirical cumulative density functions), as well as in the precision of the estimates (seen in the error bars).</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="representative-agent-and-participant-specific-models.html#cb61-1" aria-hidden="true" tabindex="-1"></a>(  </span>
<span id="cb61-2"><a href="representative-agent-and-participant-specific-models.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>(EstSum </span>
<span id="cb61-3"><a href="representative-agent-and-participant-specific-models.html#cb61-3" aria-hidden="true" tabindex="-1"></a>               <span class="sc">|&gt;</span> <span class="fu">filter</span>(name<span class="sc">!=</span><span class="st">&quot;lambda&quot;</span>)</span>
<span id="cb61-4"><a href="representative-agent-and-participant-specific-models.html#cb61-4" aria-hidden="true" tabindex="-1"></a>               <span class="sc">|&gt;</span> <span class="fu">group_by</span>(name) </span>
<span id="cb61-5"><a href="representative-agent-and-participant-specific-models.html#cb61-5" aria-hidden="true" tabindex="-1"></a>               <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">rank=</span><span class="fu">rank</span>(mean)<span class="sc">/</span><span class="fu">length</span>(mean))</span>
<span id="cb61-6"><a href="representative-agent-and-participant-specific-models.html#cb61-6" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb61-7"><a href="representative-agent-and-participant-specific-models.html#cb61-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-8"><a href="representative-agent-and-participant-specific-models.html#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>name,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>)</span>
<span id="cb61-9"><a href="representative-agent-and-participant-specific-models.html#cb61-9" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean))</span>
<span id="cb61-10"><a href="representative-agent-and-participant-specific-models.html#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y=</span>rank,<span class="at">xmin=</span>p025,<span class="at">xmax=</span>p975),<span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb61-11"><a href="representative-agent-and-participant-specific-models.html#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb61-12"><a href="representative-agent-and-participant-specific-models.html#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;empirical cumulative density&quot;</span>)</span>
<span id="cb61-13"><a href="representative-agent-and-participant-specific-models.html#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;posterior estimate&quot;</span>)</span>
<span id="cb61-14"><a href="representative-agent-and-participant-specific-models.html#cb61-14" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:RepAgentPostECDF"></span>
<img src="index_files/figure-html/RepAgentPostECDF-1.png" alt="Empirical cumulative density functions of posterior mean estimates for $\alpha$ and $\beta$. Error bars show 95% Bayesain credible regions for the parameter." width="672" />
<p class="caption">
Figure 4.7: Empirical cumulative density functions of posterior mean estimates for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span>. Error bars show 95% Bayesain credible regions for the parameter.
</p>
</div>
</div>
<div id="but-we-could-be-learning-more" class="section level3 hasAnchor" number="4.1.7">
<h3><span class="header-section-number">4.1.7</span> But we could be learning more!<a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Hopefully the above analysis is leaving you somewhat disappointed. OK, we have estimated some individual-specific parameters, but they are still quite imprecise. From a practical perspective, why even bother doing Bayesian estimation for this when there is a pre-packaged Frequentist logit function in every statistical package?<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> Perhaps more annoyingly (for me at least), we haven’t yet got a way of estimating a <em>distribution</em> of parameters and then commenting on the population of these preferences in any meaningful way. We might have been able to do some scatter plots of our parameters and made qualitative comments about any patterns or clusters that we might see, but what we really need is a way to organize the data of the whole experiment, rather than just for one participant at a time. This will be the focus especially of the next chapter (hierarchical models), and many others to follow will build on this. For the remainder of this chapter, though, we will continue to learn a bit more about representative agent models.</p>
</div>
</div>
<div id="actual-representative-agent-models-pooled-models" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Actual representative agent models (pooled models)<a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can always take our representative agent model to our entire dataset. The real question is: <em>should</em> we? As I alluded to in the previous section, the representative agent does not exist unless our models meet oddly specific criteria. Therefore, it is likely that the results we get from pooling all of our data in this way will be misleading. One big concern is heterogeneity bias: models, especially nonlinear models, can be biased in favor of one conclusion over another if the underlying parameters are heterogeneous at the participant level. See <span class="citation">Wilcox (<a href="#ref-Wilcox2006" role="doc-biblioref">2006</a>)</span> for an excellent example of this. Furthermore, pooled models may overstate the certainty we have in our estimates. A pooled model does not understand that we have <span class="math inline">\(n\)</span> participants each making <span class="math inline">\(T\)</span> decisions. Instead it “thinks” we have <span class="math inline">\(nT\)</span> independent observations.</p>
<p>However there are probably diminishing returns to added heterogeneity in a model, and sometimes the optimal amount of heterogeneity might be zero. For example a simple, portable model of Quantal Response Equilibrium <span class="citation">(<a href="#ref-McKelvey1995" role="doc-biblioref">McKelvey and Palfrey 1995</a>)</span> may organize data in games well enough to provide some insights and make useful predictions. If understanding and quantifying heterogeneity is not one’s top priority, then models with less or no heterogeneity, but perhaps more complex in other dimensions, may be more useful.</p>
<p>For the purposes of continuing this example, I will now estimate the pooled model for the <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span> data. I don’t expect it will provide any more insight than the participant-specific estimates from the previous section, but hopefully it will provide some insight into <em>why</em> it is not going to be particularly useful.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="representative-agent-and-participant-specific-models.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_pooled.rds&quot;</span>))) {</span>
<span id="cb62-2"><a href="representative-agent-and-participant-specific-models.html#cb62-2" aria-hidden="true" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb62-3"><a href="representative-agent-and-participant-specific-models.html#cb62-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">n=</span><span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb62-4"><a href="representative-agent-and-participant-specific-models.html#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">self_x=</span>D<span class="sc">$</span>self_x,</span>
<span id="cb62-5"><a href="representative-agent-and-participant-specific-models.html#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_x=</span>D<span class="sc">$</span>other_x,</span>
<span id="cb62-6"><a href="representative-agent-and-participant-specific-models.html#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">self_y=</span>D<span class="sc">$</span>self_y,</span>
<span id="cb62-7"><a href="representative-agent-and-participant-specific-models.html#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">other_y=</span>D<span class="sc">$</span>other_y,</span>
<span id="cb62-8"><a href="representative-agent-and-participant-specific-models.html#cb62-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">choice_x=</span>D<span class="sc">$</span>choice_x,</span>
<span id="cb62-9"><a href="representative-agent-and-participant-specific-models.html#cb62-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb62-10"><a href="representative-agent-and-participant-specific-models.html#cb62-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Stan (and R for that matter) deal with standard deviations, </span></span>
<span id="cb62-11"><a href="representative-agent-and-participant-specific-models.html#cb62-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># not variances for a normal distribution</span></span>
<span id="cb62-12"><a href="representative-agent-and-participant-specific-models.html#cb62-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">5.76</span>,<span class="fl">2.11</span>),</span>
<span id="cb62-13"><a href="representative-agent-and-participant-specific-models.html#cb62-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_alpha=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.67</span>),</span>
<span id="cb62-14"><a href="representative-agent-and-participant-specific-models.html#cb62-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.67</span>)</span>
<span id="cb62-15"><a href="representative-agent-and-participant-specific-models.html#cb62-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb62-16"><a href="representative-agent-and-participant-specific-models.html#cb62-16" aria-hidden="true" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">stan</span>(<span class="fu">paste0</span>(<span class="st">&quot;Code/&quot;</span>,file,<span class="st">&quot;.stan&quot;</span>),</span>
<span id="cb62-17"><a href="representative-agent-and-participant-specific-models.html#cb62-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">data=</span>dStan,</span>
<span id="cb62-18"><a href="representative-agent-and-participant-specific-models.html#cb62-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb62-19"><a href="representative-agent-and-participant-specific-models.html#cb62-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">saveRDS</span>(Fit,<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_pooled.rds&quot;</span>))</span>
<span id="cb62-20"><a href="representative-agent-and-participant-specific-models.html#cb62-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb62-21"><a href="representative-agent-and-participant-specific-models.html#cb62-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-22"><a href="representative-agent-and-participant-specific-models.html#cb62-22" aria-hidden="true" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="fu">paste0</span>(<span class="st">&quot;Outputs/&quot;</span>,file,<span class="st">&quot;_pooled.rds&quot;</span>))</span>
<span id="cb62-23"><a href="representative-agent-and-participant-specific-models.html#cb62-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-24"><a href="representative-agent-and-participant-specific-models.html#cb62-24" aria-hidden="true" tabindex="-1"></a>rstan<span class="sc">::</span><span class="fu">summary</span>(Fit)<span class="sc">$</span>summary <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">caption=</span><span class="st">&quot;Estimates pooling all data in @BFS2019&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:RepAgentPooled">Table 4.2: </span>Estimates pooling all data in <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019" role="doc-biblioref">2019</a>)</span></caption>
<colgroup>
<col width="5%" />
<col width="10%" />
<col width="7%" />
<col width="7%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="6%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">se_mean</th>
<th align="right">sd</th>
<th align="right">2.5%</th>
<th align="right">25%</th>
<th align="right">50%</th>
<th align="right">75%</th>
<th align="right">97.5%</th>
<th align="right">n_eff</th>
<th align="right">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha</td>
<td align="right">-0.0505990</td>
<td align="right">0.0001204</td>
<td align="right">0.0076189</td>
<td align="right">-0.0651262</td>
<td align="right">-0.0558035</td>
<td align="right">-0.0505947</td>
<td align="right">-0.0453162</td>
<td align="right">-0.0358557</td>
<td align="right">4007.291</td>
<td align="right">0.9997049</td>
</tr>
<tr class="even">
<td align="left">beta</td>
<td align="right">0.2622539</td>
<td align="right">0.0001331</td>
<td align="right">0.0076152</td>
<td align="right">0.2471614</td>
<td align="right">0.2572358</td>
<td align="right">0.2622196</td>
<td align="right">0.2673445</td>
<td align="right">0.2773552</td>
<td align="right">3272.100</td>
<td align="right">1.0015409</td>
</tr>
<tr class="odd">
<td align="left">lambda</td>
<td align="right">0.0155982</td>
<td align="right">0.0000042</td>
<td align="right">0.0002505</td>
<td align="right">0.0151177</td>
<td align="right">0.0154292</td>
<td align="right">0.0155959</td>
<td align="right">0.0157644</td>
<td align="right">0.0161031</td>
<td align="right">3603.171</td>
<td align="right">1.0003600</td>
</tr>
<tr class="even">
<td align="left">lp__</td>
<td align="right">-4022.7625528</td>
<td align="right">0.0295697</td>
<td align="right">1.2356555</td>
<td align="right">-4025.9640038</td>
<td align="right">-4023.3252946</td>
<td align="right">-4022.4349407</td>
<td align="right">-4021.8617346</td>
<td align="right">-4021.3531591</td>
<td align="right">1746.229</td>
<td align="right">1.0011554</td>
</tr>
</tbody>
</table>
<p>These estimates are summarized in Table <a href="representative-agent-and-participant-specific-models.html#tab:RepAgentPooled">4.2</a>. Especially note that the posterior distributions of <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are <em>much</em> more precise than any of the distributions we get from the individual estimates: the posterior standard deviations are two orders of magnitude smaller. This is because have 174 times as many observations compared to when we were doing the participant-specific estimates. Our model thinks that every single decision is a statistically independent observation, and we have a lot of decisions! In reality there is obvious dependence that we are not accounting for within the data for each participant, evidenced by the large variety of parameter estimates. As such, we should not be as confident in those estimates as the posterior standard deviations would have us believe.</p>
<!--
## Representative agent models with participant characteristics (are still pooled models)

-->
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bland2020" class="csl-entry">
———. 2022. <span>“Bayesian Inference for Quantal Response Equilibrium in Normal-Form Games.”</span> <em>Available at SSRN 3748586</em>. <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3748586">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3748586</a>.
</div>
<div id="ref-BFS2019" class="csl-entry">
Bruhin, Adrian, Ernst Fehr, and Daniel Schunk. 2019. <span>“The Many Faces of Human Sociality: Uncovering the Distribution and Stability of Social Preferences.”</span> <em>Journal of the European Economic Association</em> 17 (4): 1025–69.
</div>
<div id="ref-FS1999" class="csl-entry">
Fehr, Ernst, and Klaus M Schmidt. 1999. <span>“A Theory of Fairness, Competition, and Cooperation.”</span> <em>The Quarterly Journal of Economics</em> 114 (3): 817–68.
</div>
<div id="ref-McKelvey1995" class="csl-entry">
McKelvey, Richard D, and Thomas R Palfrey. 1995. <span>“Quantal Response Equilibria for Normal Form Games.”</span> <em>Games and Economic Behavior</em> 10 (1): 6–38. <a href="https://doi.org/10.1006/game.1995.1023">https://doi.org/10.1006/game.1995.1023</a>.
</div>
<div id="ref-Wilcox2006" class="csl-entry">
Wilcox, Nathaniel T. 2006. <span>“Theories of Learning in Games and Heterogeneity Bias.”</span> <em>Econometrica</em> 74 (5): 1271–92.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>This also helps with my observation that choice precision happens roughly on a log scale. We can express the distribution as a mean of the logged variable, and a relative scale of the distribution.<a href="representative-agent-and-participant-specific-models.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>Since the posterior draws come from a Markov Chain, they will likely be correlated, so the standard error on this probability assuming that the draws are independent will likely be an over-estimate.<a href="representative-agent-and-participant-specific-models.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>This one may take a while, so put on a pot of coffee, get off the plateau, or something.<a href="representative-agent-and-participant-specific-models.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>you can also get these from the summary tables <em>RStan</em> can give you, but since I wanted to compute the probability that the <span class="citation">Fehr and Schmidt (<a href="#ref-FS1999" role="doc-biblioref">1999</a>)</span> parameter restriction holds, I needed the whole distribution.<a href="representative-agent-and-participant-specific-models.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>As I often visualize my results as empirical cumulative distribution functions (ECDF), it may help here to remember that steep parts of a cumulative density function show regions of large probability mass or density, while flat parts are regions where the variable is less likely to occur.<a href="representative-agent-and-participant-specific-models.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>One of the reasons is that for other economic models, the following probabilistic model does not lend itself to a simple representation in our usual reduced-form toolbox of econometric techniques. Once these models become nonlinear, you <em>will</em> have to code them up yourself. Hopefully through this book I can show you that there is not much more effort in doing this within a Bayesian framework.<a href="representative-agent-and-participant-specific-models.html#fnref15" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="building-blocks.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hierarchical-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
