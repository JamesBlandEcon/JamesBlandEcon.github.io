<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Application: Quantal Response Equilibrium and the Volunteer’s Dilemma (Goeree, Holt, and Smith 2017) | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="15 Application: Quantal Response Equilibrium and the Volunteer’s Dilemma (Goeree, Holt, and Smith 2017) | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Application: Quantal Response Equilibrium and the Volunteer’s Dilemma (Goeree, Holt, and Smith 2017) | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Application: Quantal Response Equilibrium and the Volunteer’s Dilemma (Goeree, Holt, and Smith 2017) | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="computing-quantal-response-equilibrium.html"/>
<link rel="next" href="application-a-quantal-response-equilibrium-with-discrete-types.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html"><i class="fa fa-check"></i><b>8</b> Filling in the blanks: Imputation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#example-model-and-dataset-yet-again-with-bfs2019"><i class="fa fa-check"></i><b>8.1</b> Example model and dataset: yet again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a></li>
<li class="chapter" data-level="8.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#how-is-this-going-to-work"><i class="fa fa-check"></i><b>8.2</b> How is this going to work?</a></li>
<li class="chapter" data-level="8.3" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#implementation"><i class="fa fa-check"></i><b>8.3</b> Implementation</a></li>
<li class="chapter" data-level="8.4" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#results"><i class="fa fa-check"></i><b>8.4</b> Results</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#using-the-correlation-matrix"><i class="fa fa-check"></i><b>8.4.1</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="8.4.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#the-correlation-matrix-is-doing-a-lot-of-heavy-lifting-here"><i class="fa fa-check"></i><b>8.4.2</b> The correlation matrix is doing a lot of heavy lifting here</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#conclusion"><i class="fa fa-check"></i><b>8.5</b> Conclusion</a></li>
<li class="chapter" data-level="8.6" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#r-code-used-for-this-chapter-1"><i class="fa fa-check"></i><b>8.6</b> <em>R</em> code used for this chapter</a></li>
<li class="chapter" data-level="" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#acknowedgements"><i class="fa fa-check"></i>Acknowedgements</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>9</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="model-evaluation.html"><a href="model-evaluation.html#example-dataset-and-models"><i class="fa fa-check"></i><b>9.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="9.2" data-path="model-evaluation.html"><a href="model-evaluation.html#model-posterior-probabilities"><i class="fa fa-check"></i><b>9.2</b> Model posterior probabilities</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="model-evaluation.html"><a href="model-evaluation.html#implementation-using-bridge-sampling-and-the-bridgesampling-library"><i class="fa fa-check"></i><b>9.2.1</b> Implementation using bridge sampling and the <code>bridgesampling</code> library</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="model-evaluation.html"><a href="model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>9.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="model-evaluation.html"><a href="model-evaluation.html#expected-log-predicted-density-elpd-and-other-measures-of-goodness-of-fit"><i class="fa fa-check"></i><b>9.3.1</b> Expected Log Predicted Density (ELPD) and other measures of goodness of fit</a></li>
<li class="chapter" data-level="9.3.2" data-path="model-evaluation.html"><a href="model-evaluation.html#round-cross-validation"><i class="fa fa-check"></i><b>9.3.2</b> 1-round cross-validation</a></li>
<li class="chapter" data-level="9.3.3" data-path="model-evaluation.html"><a href="model-evaluation.html#leave-one-out-cross-validation-loo"><i class="fa fa-check"></i><b>9.3.3</b> Leave-one-out cross-validation (LOO)</a></li>
<li class="chapter" data-level="9.3.4" data-path="model-evaluation.html"><a href="model-evaluation.html#approximate-loo"><i class="fa fa-check"></i><b>9.3.4</b> Approximate LOO</a></li>
<li class="chapter" data-level="9.3.5" data-path="model-evaluation.html"><a href="model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>9.3.5</b> <span class="math inline">\(k\)</span>-fold cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>10</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="10.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>10.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="10.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>10.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="10.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>10.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="10.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>10.4</b> Vectorization</a></li>
<li class="chapter" data-level="10.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>10.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="10.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>10.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>10.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="10.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>10.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>10.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>10.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="10.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>10.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="11" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>11</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="11.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>11.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="11.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>11.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="11.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>11.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>11.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="11.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>11.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="11.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>11.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>11.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>11.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="11.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>11.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="11.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-2"><i class="fa fa-check"></i><b>11.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>11.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>11.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="11.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>11.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="11.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>11.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>12</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>12.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="12.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>12.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>12.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="12.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>12.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>12.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>13</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>13.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="13.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>13.2</b> The likelihood function</a></li>
<li class="chapter" data-level="13.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>13.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="13.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-3"><i class="fa fa-check"></i><b>13.4</b> Results</a></li>
<li class="chapter" data-level="13.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>13.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>14</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="14.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>14.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="14.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>14.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>14.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="14.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>14.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="14.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>14.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="14.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>14.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>14.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="14.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>14.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>14.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="14.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>14.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="14.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>14.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>15</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>15.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="15.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>15.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>15.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="15.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>15.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="15.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>15.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="15.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-4"><i class="fa fa-check"></i><b>15.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>15.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>16</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1"><i class="fa fa-check"></i><b>16.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="16.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>16.2</b> A note on replication</a></li>
<li class="chapter" data-level="16.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>16.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>16.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="16.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>16.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="16.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>16.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-5"><i class="fa fa-check"></i><b>16.4</b> Results</a></li>
<li class="chapter" data-level="16.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>16.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><i class="fa fa-check"></i><b>17</b> Application: QRE in a Bayesian game and cursed equilibrium</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#example-game-and-dataset"><i class="fa fa-check"></i><b>17.1</b> Example game and dataset</a></li>
<li class="chapter" data-level="17.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#solving-for-qre"><i class="fa fa-check"></i><b>17.2</b> Solving for QRE</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#baseline-model"><i class="fa fa-check"></i><b>17.2.1</b> Baseline model</a></li>
<li class="chapter" data-level="17.2.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cursed-equilibrium"><i class="fa fa-check"></i><b>17.2.2</b> Cursed equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#a-quick-prior-calibration-1"><i class="fa fa-check"></i><b>17.3</b> A quick prior calibration</a></li>
<li class="chapter" data-level="17.4" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-results"><i class="fa fa-check"></i><b>17.4</b> Model results</a></li>
<li class="chapter" data-level="17.5" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-evaluation-1"><i class="fa fa-check"></i><b>17.5</b> Model evaluation</a></li>
<li class="chapter" data-level="17.6" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#r-code-used-in-this-chapter"><i class="fa fa-check"></i><b>17.6</b> <em>R</em> code used in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>18</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>18.1</b> Data and game</a></li>
<li class="chapter" data-level="18.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>18.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>18.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="18.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>18.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>18.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>18.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="18.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>18.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="18.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>18.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>18.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>18.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="18.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>18.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>18.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="18.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>18.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="18.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>18.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="18.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>18.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="18.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>18.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="18.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>18.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="18.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>18.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="18.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>18.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="18.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>18.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="18.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>18.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="18.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-10"><i class="fa fa-check"></i><b>18.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="18.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>18.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="18.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>18.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="18.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>18.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="18.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>18.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="18.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>18.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="18.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>18.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="19" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>19</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="19.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>19.1</b> Example dataset</a></li>
<li class="chapter" data-level="19.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>19.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="19.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>19.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>19.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="19.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>19.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="19.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>19.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>19.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>19.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="19.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>19.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>19.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>20</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="20.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>20.1</b> Data</a></li>
<li class="chapter" data-level="20.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>20.2</b> A basic model</a></li>
<li class="chapter" data-level="20.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>20.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="20.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>20.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="20.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>20.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="20.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>20.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html"><i class="fa fa-check"></i><b>21</b> Application: choice bracketing</a>
<ul>
<li class="chapter" data-level="21.1" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#data-and-model"><i class="fa fa-check"></i><b>21.1</b> Data and model</a></li>
<li class="chapter" data-level="21.2" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#representative-agent-and-individual-estimation"><i class="fa fa-check"></i><b>21.2</b> Representative agent and individual estimation</a></li>
<li class="chapter" data-level="21.3" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#hierarchical-model-2"><i class="fa fa-check"></i><b>21.3</b> Hierarchical model</a></li>
<li class="chapter" data-level="21.4" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#a-mixture-model-1"><i class="fa fa-check"></i><b>21.4</b> A mixture model</a></li>
<li class="chapter" data-level="21.5" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#what-do-we-get-out-of-the-structural-models-and-what-could-we-miss"><i class="fa fa-check"></i><b>21.5</b> What do we get out of the structural models, and what could we miss?</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>22</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="22.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>22.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="22.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>22.2</b> Computational issues</a></li>
<li class="chapter" data-level="22.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>22.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="22.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>22.4</b> A representative agent model</a></li>
<li class="chapter" data-level="22.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>22.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="22.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>22.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(<a href="#ref-Goeree2017">Goeree, Holt, and Smith 2017</a>)</span><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>With what we have learned in the previous chapter about <em>computing</em> a quantal response equilibrium, we can now go and <em>estimate</em> one! Mechanically, this will just mean translating the <em>R</em> code I had in the previous chapter into <em>Stan</em>, and then combining the log probabilities that we get out of the predictor-corrector algorithm with choice frequencies to get our likelihood. As always, we will also need to have a good think about priors. This is especially important in this case, where the model is highly non-linear, and it may not be too easy to interpret the choice precision parameter without some carefully thought-out context.</p>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:QRE2VolunteersDilemma">Table 15.1: </span>Payoffs for the Volunteer’s Dilemma
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
At least one other player volunteers
</th>
<th style="text-align:left;">
Nobody else volunteers
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Volunteer
</td>
<td style="text-align:left;">
V-c
</td>
<td style="text-align:left;">
V-c
</td>
</tr>
<tr>
<td style="text-align:left;">
Don’t volunteer
</td>
<td style="text-align:left;">
V
</td>
<td style="text-align:left;">
L
</td>
</tr>
</tbody>
</table>
<p>For this chapter, I will show you my Bayesian take on the quantal response equilibrium analysis in <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>, which studies the effect of group size in a Volunteer’s Dilemma. The game is described in Table <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#tab:QRE2VolunteersDilemma">15.1</a>. Importantly, note that this is <em>not</em> a payoff matrix: instead of a second player’s actions being the columns of the table, these columns refer to a <em>summary</em> of one’s opponents’ actions. In the Volunteer’s dilemma, there is a task that the <span class="math inline">\(n\)</span> players can either volunteer (<span class="math inline">\(V\)</span>) for at cost <span class="math inline">\(c\)</span>, or not volunteer (<span class="math inline">\(N\)</span>) for at no cost. If at least one player volunteers, then <em>all</em> players get a large benefit <span class="math inline">\(V\)</span>, and if nobody volunteers all players get a smaller payoff <span class="math inline">\(L\)</span>. While there are many pure strategy Nash equilibria of this game that involve exactly one player volunteering and all other not volunteering, it is natural here to focus on the symmetric mixed-strategy Nash equilibrium, where players all volunteer with probability:</p>
<p><span class="math display">\[
\sigma_V^*=1-\left(\frac{c}{V-L}\right)^{\frac{1}{n-1}}
\]</span></p>
<p><span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span> hold constant <span class="math inline">\(V=1\)</span> and <span class="math inline">\(L=c=0.2\)</span>, and vary the group size <span class="math inline">\(n\)</span>. The data from their main treatments, along with the Nash equilibrium prediction is shown in Figure <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#fig:QRE2NashComparison">15.1</a></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-1" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;Data/GHS2017VD.csv&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb185-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GroupSize =</span> <span class="fu">str_count</span>(Other.Id., <span class="st">&quot;ID&quot;</span>)<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb185-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-3" tabindex="-1"></a>         <span class="at">GroupSize =</span> <span class="fu">ifelse</span>(SessionID<span class="sc">==</span><span class="dv">10</span>,<span class="dv">9</span>,GroupSize),</span>
<span id="cb185-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-4" tabindex="-1"></a>         <span class="at">GroupSize =</span> <span class="fu">ifelse</span>(SessionID<span class="sc">==</span><span class="dv">11</span>,<span class="dv">12</span>,GroupSize)</span>
<span id="cb185-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-5" tabindex="-1"></a>         ) <span class="sc">|&gt;</span></span>
<span id="cb185-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-6" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Volunteer =</span> Decision..<span class="fl">1.</span>vol..) <span class="sc">|&gt;</span></span>
<span id="cb185-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">paste0</span>(SessionID,<span class="st">&quot;-&quot;</span>,ID) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>() ) <span class="sc">|&gt;</span></span>
<span id="cb185-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,GroupSize,Volunteer) <span class="sc">|&gt;</span></span>
<span id="cb185-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-9" tabindex="-1"></a>  <span class="co"># all I need are the counts of actions for each participant:</span></span>
<span id="cb185-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-10" tabindex="-1"></a>  <span class="fu">group_by</span>(ID,GroupSize) <span class="sc">|&gt;</span></span>
<span id="cb185-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb185-11" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">Volunteer =</span> <span class="fu">sum</span>(Volunteer),<span class="at">count=</span><span class="fu">n</span>())</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-1" tabindex="-1"></a>V<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb186-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-2" tabindex="-1"></a>L<span class="ot">&lt;-</span><span class="fl">0.2</span></span>
<span id="cb186-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-3" tabindex="-1"></a>c<span class="ot">&lt;-</span><span class="fl">0.2</span></span>
<span id="cb186-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-4" tabindex="-1"></a></span>
<span id="cb186-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-5" tabindex="-1"></a>Nash<span class="ot">&lt;-</span><span class="fu">tibble</span>(</span>
<span id="cb186-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-6" tabindex="-1"></a>  <span class="at">GroupSize =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>,</span>
<span id="cb186-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-7" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb186-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Nash =</span> <span class="dv">1</span><span class="sc">-</span>(c<span class="sc">/</span>(V<span class="sc">-</span>L))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(GroupSize<span class="dv">-1</span>)))</span>
<span id="cb186-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-9" tabindex="-1"></a></span>
<span id="cb186-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-10" tabindex="-1"></a>(</span>
<span id="cb186-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-11" tabindex="-1"></a>  <span class="fu">ggplot</span>()</span>
<span id="cb186-12"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_boxplot</span>(<span class="at">data=</span>D,<span class="fu">aes</span>(<span class="at">x=</span>GroupSize,<span class="at">y=</span>Volunteer<span class="sc">/</span><span class="dv">20</span>,<span class="at">group=</span>GroupSize))</span>
<span id="cb186-13"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">data=</span>Nash,<span class="fu">aes</span>(GroupSize,<span class="at">y=</span>Nash),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb186-14"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb186-15"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Group size&quot;</span>)</span>
<span id="cb186-16"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Volunteer rate&quot;</span>)</span>
<span id="cb186-17"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb186-17" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:QRE2NashComparison"></span>
<img src="index_files/figure-html/QRE2NashComparison-1.png" alt="Nash prediction (red line) and participant-specific volunteer rates (black box plots)" width="672" />
<p class="caption">
Figure 15.1: Nash prediction (red line) and participant-specific volunteer rates (black box plots)
</p>
</div>
<div id="solving-logit-qre-and-estimating-the-model" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Solving logit QRE and estimating the model<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>From the previous chapter, the system of equations that we are trying to solve is:</p>
<p><span class="math display">\[
\begin{aligned}
H(\lambda,\rho)
&amp;=\begin{pmatrix}
\rho_V - \rho_N
-\lambda(V-c-V(1-\exp((n-1)\rho_N))-L\exp((n-1)\rho_N)))\\
\exp(\rho_V)+\exp(\rho_N)-1
\end{pmatrix}\\
\frac{\partial H(\lambda,\rho)}{\partial \rho^\top}
&amp;=\begin{bmatrix}
1 &amp; -1-\lambda(n-1)\exp((n-1)\rho_N)\left(V-L\right)\\
1 &amp; 1
\end{bmatrix}
\\
\frac{\partial H(\rho,\lambda)}{\partial \lambda}
&amp;=\begin{pmatrix}
-(V-c-V(1-\exp((n-1)\rho_N))-L\exp((n-1)\rho_N)))\\
0
\end{pmatrix}
\end{aligned}
\]</span></p>
<p>Below you can see my <em>Stan</em> program that implements the predictor-corrector algorithm in the <code>functions</code> block. One issue I came across was that the algorithm as it is written in the previous chapter stops when <span class="math inline">\(\lambda^t&gt;\lambda\)</span>, where <span class="math inline">\(\lambda\)</span> is the choice precision for which we want to compute the equilibrium. This is a problem for estimation, because we need the quantal response equilibrium probabilities at <span class="math inline">\(\lambda\)</span> <em>exactly</em>, not for some <span class="math inline">\(\lambda^t&gt;\lambda\)</span> (but nevertheless somewhat “close” to <span class="math inline">\(\lambda\)</span>). To fix this, I add in some constant-<span class="math inline">\(\lambda\)</span> corrector steps at the end of the algorithm to backtrack to the desired probabilities. These steps use Newton’s method to find solution <span class="math inline">\(\rho\)</span> to <span class="math inline">\(H(\lambda,\rho)=0\)</span>:<a href="#fn67" class="footnote-ref" id="fnref67"><sup>67</sup></a></p>
<p><span class="math display">\[
\rho^{t+1}=\rho^t-\left[\frac{\partial H(\lambda,\rho^t)}{\partial \rho^\top}\right]^{-1}H(\lambda,\rho^t)
\]</span></p>
<p>For quantal response equilibrium models, it is especially important to translate the choice precision parameter <span class="math inline">\(\lambda\)</span> into something easier to interpret. Following <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>, I therefore also compute the implied probabilities of volunteering in the <code>generated quantities</code> block.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb187-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-1" tabindex="-1"></a></span>
<span id="cb187-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-2" tabindex="-1"></a><span class="co">/* Homogeneous quantal response equilibrium model for the Volunteer&#39;s Dilemma</span></span>
<span id="cb187-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-3" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb187-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-4" tabindex="-1"></a></span>
<span id="cb187-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-5" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb187-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-6" tabindex="-1"></a>  </span>
<span id="cb187-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-7" tabindex="-1"></a>  vector Hfun<span class="op">(</span>vector x<span class="op">,</span></span>
<span id="cb187-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-8" tabindex="-1"></a>  data real n<span class="op">,</span> data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-9" tabindex="-1"></a>    </span>
<span id="cb187-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-10" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span>x<span class="op">[</span><span class="dv">1</span><span class="op">]-</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]-</span>x<span class="op">[</span><span class="dv">3</span><span class="op">]*(</span>V<span class="op">-</span>c<span class="op">-</span>V<span class="op">*(</span><span class="dv">1</span><span class="op">-</span>exp<span class="op">((</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]))-</span>L<span class="op">*</span>exp<span class="op">((</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">])),</span></span>
<span id="cb187-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-11" tabindex="-1"></a>    exp<span class="op">(</span>x<span class="op">[</span><span class="dv">1</span><span class="op">])+</span>exp<span class="op">(</span>x<span class="op">[</span><span class="dv">2</span><span class="op">])-</span><span class="fl">1.0</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb187-12"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-12" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-13"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-13" tabindex="-1"></a>  </span>
<span id="cb187-14"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-14" tabindex="-1"></a>  matrix jac<span class="op">(</span>vector x<span class="op">,</span></span>
<span id="cb187-15"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-15" tabindex="-1"></a>  data real n<span class="op">,</span> data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-16"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-16" tabindex="-1"></a>    </span>
<span id="cb187-17"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-17" tabindex="-1"></a>    </span>
<span id="cb187-18"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-18" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span></span>
<span id="cb187-19"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-19" tabindex="-1"></a>      <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">-</span>x<span class="op">[</span><span class="dv">3</span><span class="op">]*(</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>exp<span class="op">((</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">])*(</span>V<span class="op">-</span>L<span class="op">),</span> <span class="op">-(</span>V<span class="op">-</span>c<span class="op">-</span>V<span class="op">*(</span><span class="dv">1</span><span class="op">-</span>exp<span class="op">((</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]))-</span>L<span class="op">*</span>exp<span class="op">((</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]))],</span></span>
<span id="cb187-20"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-20" tabindex="-1"></a>      <span class="op">[</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">]</span></span>
<span id="cb187-21"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-21" tabindex="-1"></a>    <span class="op">];</span></span>
<span id="cb187-22"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-22" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-23"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-23" tabindex="-1"></a>  </span>
<span id="cb187-24"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-24" tabindex="-1"></a>  </span>
<span id="cb187-25"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-25" tabindex="-1"></a>  vector lpQRE<span class="op">(</span></span>
<span id="cb187-26"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-26" tabindex="-1"></a>    real lambda<span class="op">,</span></span>
<span id="cb187-27"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-27" tabindex="-1"></a>    data real n<span class="op">,</span><span class="co">// Group size</span></span>
<span id="cb187-28"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-28" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span></span>
<span id="cb187-29"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-29" tabindex="-1"></a>    data real first_step<span class="op">,</span></span>
<span id="cb187-30"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-30" tabindex="-1"></a>    data real min_step<span class="op">,</span></span>
<span id="cb187-31"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-31" tabindex="-1"></a>    data real max_decel<span class="op">,</span></span>
<span id="cb187-32"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-32" tabindex="-1"></a>    data <span class="dt">int</span> maxiter<span class="op">,</span></span>
<span id="cb187-33"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-33" tabindex="-1"></a>    data real tol</span>
<span id="cb187-34"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-34" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-35"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-35" tabindex="-1"></a>    </span>
<span id="cb187-36"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-36" tabindex="-1"></a>    real max_dist <span class="op">=</span> <span class="fl">0.4</span><span class="op">;</span></span>
<span id="cb187-37"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-37" tabindex="-1"></a>    real max_contr <span class="op">=</span> <span class="fl">0.6</span><span class="op">;</span></span>
<span id="cb187-38"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-38" tabindex="-1"></a>    real eta <span class="op">=</span> <span class="fl">0.1</span><span class="op">;</span></span>
<span id="cb187-39"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-39" tabindex="-1"></a>    </span>
<span id="cb187-40"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-40" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> x <span class="op">=</span> <span class="op">[</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">),</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">),</span><span class="dv">0</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb187-41"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-41" tabindex="-1"></a>    </span>
<span id="cb187-42"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-42" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> t <span class="op">=</span> qr_Q<span class="op">(</span>jac<span class="op">(</span>x<span class="op">,</span>n<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">)</span><span class="ch">&#39;)</span><span class="er">[,3];</span></span>
<span id="cb187-43"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-43" tabindex="-1"></a>    </span>
<span id="cb187-44"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-44" tabindex="-1"></a>    real h <span class="op">=</span> first_step<span class="op">;</span></span>
<span id="cb187-45"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-45" tabindex="-1"></a>    </span>
<span id="cb187-46"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-46" tabindex="-1"></a>    real omega <span class="op">=</span> t<span class="op">[</span><span class="dv">3</span><span class="op">]&gt;=</span><span class="dv">0</span> <span class="op">?</span> <span class="fl">1.0</span> <span class="op">:</span> <span class="op">-</span><span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb187-47"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-47" tabindex="-1"></a>    </span>
<span id="cb187-48"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-48" tabindex="-1"></a>    <span class="co">// Here we are just going from 0 to lambda</span></span>
<span id="cb187-49"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-49" tabindex="-1"></a>    </span>
<span id="cb187-50"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-50" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>x<span class="op">[</span><span class="dv">3</span><span class="op">]&lt;=</span>lambda<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-51"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-51" tabindex="-1"></a>      </span>
<span id="cb187-52"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-52" tabindex="-1"></a>      <span class="dt">int</span> accept <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb187-53"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-53" tabindex="-1"></a>      </span>
<span id="cb187-54"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-54" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>abs<span class="op">(</span>h<span class="op">)&lt;=</span>min_step<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-55"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-55" tabindex="-1"></a>        <span class="co">// step size below minimum step</span></span>
<span id="cb187-56"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-56" tabindex="-1"></a>        print<span class="op">(</span><span class="st">&quot;Step size&quot;</span><span class="op">,</span>h<span class="op">,</span><span class="st">&quot;less than minimum&quot;</span><span class="op">);</span></span>
<span id="cb187-57"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-57" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb187-58"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-58" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb187-59"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-59" tabindex="-1"></a>      </span>
<span id="cb187-60"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-60" tabindex="-1"></a>      <span class="co">// predictor step</span></span>
<span id="cb187-61"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-61" tabindex="-1"></a>      vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> u <span class="op">=</span> x<span class="op">+</span>h<span class="op">*</span>omega<span class="op">*</span>t<span class="op">;</span></span>
<span id="cb187-62"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-62" tabindex="-1"></a>      matrix<span class="op">[</span><span class="dv">3</span><span class="op">,</span><span class="dv">3</span><span class="op">]</span> q <span class="op">=</span> qr_Q<span class="op">(</span>jac<span class="op">(</span>u<span class="op">,</span>n<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">)</span><span class="ch">&#39;)</span><span class="er">;</span></span>
<span id="cb187-63"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-63" tabindex="-1"></a>      </span>
<span id="cb187-64"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-64" tabindex="-1"></a>      real disto <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-65"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-65" tabindex="-1"></a>      real decel <span class="op">=</span> <span class="fl">1.0</span><span class="op">/</span>max_decel<span class="op">;</span></span>
<span id="cb187-66"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-66" tabindex="-1"></a>      </span>
<span id="cb187-67"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-67" tabindex="-1"></a>      <span class="cf">for</span> <span class="op">(</span>it in <span class="dv">1</span><span class="op">:</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-68"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-68" tabindex="-1"></a>        </span>
<span id="cb187-69"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-69" tabindex="-1"></a>        vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> dx <span class="op">=</span> <span class="op">-</span>generalized_inverse<span class="op">(</span>jac<span class="op">(</span>u<span class="op">,</span>n<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">))*</span>Hfun<span class="op">(</span>x<span class="op">,</span>n<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">);</span></span>
<span id="cb187-70"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-70" tabindex="-1"></a>        real dist <span class="op">=</span> sqrt<span class="op">(</span>dx<span class="ch">&#39;*</span><span class="er">dx);</span></span>
<span id="cb187-71"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-71" tabindex="-1"></a>        </span>
<span id="cb187-72"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-72" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dist <span class="op">&gt;=</span> max_dist<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-73"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-73" tabindex="-1"></a>          print<span class="op">(</span><span class="st">&quot;Proposed distance &quot;</span><span class="op">,</span>dist<span class="op">,</span><span class="st">&quot; exceeds max_dist &quot;</span><span class="op">,</span>max_dist<span class="op">);</span></span>
<span id="cb187-74"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-74" tabindex="-1"></a>          accept <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-75"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-75" tabindex="-1"></a>          <span class="cf">break</span><span class="op">;</span></span>
<span id="cb187-76"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-76" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb187-77"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-77" tabindex="-1"></a>        </span>
<span id="cb187-78"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-78" tabindex="-1"></a>        decel <span class="op">=</span> fmax<span class="op">(</span>decel<span class="op">,</span>sqrt<span class="op">(</span>dist<span class="op">/</span>max_dist<span class="op">)*</span>max_decel<span class="op">);</span></span>
<span id="cb187-79"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-79" tabindex="-1"></a>        </span>
<span id="cb187-80"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-80" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>it<span class="op">&gt;</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-81"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-81" tabindex="-1"></a>          real contr <span class="op">=</span> dist<span class="op">/(</span>disto<span class="op">+</span>tol<span class="op">*</span>eta<span class="op">);</span></span>
<span id="cb187-82"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-82" tabindex="-1"></a>          <span class="cf">if</span> <span class="op">(</span>contr<span class="op">&gt;</span>max_contr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-83"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-83" tabindex="-1"></a>            print<span class="op">(</span><span class="st">&quot;Maximum control rate exceeded&quot;</span><span class="op">);</span></span>
<span id="cb187-84"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-84" tabindex="-1"></a>            accept<span class="op">=</span><span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-85"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-85" tabindex="-1"></a>            <span class="cf">break</span><span class="op">;</span></span>
<span id="cb187-86"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-86" tabindex="-1"></a>          <span class="op">}</span></span>
<span id="cb187-87"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-87" tabindex="-1"></a>          decel <span class="op">=</span> fmax<span class="op">(</span>decel<span class="op">,</span>sqrt<span class="op">(</span>contr<span class="op">/</span>max_contr<span class="op">)*</span>max_decel<span class="op">);</span></span>
<span id="cb187-88"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-88" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb187-89"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-89" tabindex="-1"></a>        </span>
<span id="cb187-90"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-90" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>dist<span class="op">&gt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-91"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-91" tabindex="-1"></a>          <span class="co">// success! The corrector step has corrected enough</span></span>
<span id="cb187-92"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-92" tabindex="-1"></a>          <span class="cf">break</span><span class="op">;</span></span>
<span id="cb187-93"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-93" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb187-94"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-94" tabindex="-1"></a>        </span>
<span id="cb187-95"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-95" tabindex="-1"></a>        </span>
<span id="cb187-96"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-96" tabindex="-1"></a>        disto<span class="op">=</span>dist<span class="op">;</span></span>
<span id="cb187-97"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-97" tabindex="-1"></a>        </span>
<span id="cb187-98"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-98" tabindex="-1"></a>      <span class="co">/* if we have got to this point, then:</span></span>
<span id="cb187-99"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-99" tabindex="-1"></a><span class="co">         1. The Newton step has not proposed a too-large change</span></span>
<span id="cb187-100"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-100" tabindex="-1"></a><span class="co">         2. The contraction rate has not been exceeded</span></span>
<span id="cb187-101"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-101" tabindex="-1"></a><span class="co">         3. The proposed Newton step is not so small that we have effectively </span></span>
<span id="cb187-102"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-102" tabindex="-1"></a><span class="co">           found a solution</span></span>
<span id="cb187-103"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-103" tabindex="-1"></a><span class="co">        Therefore, we update u</span></span>
<span id="cb187-104"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-104" tabindex="-1"></a><span class="co">       */</span> </span>
<span id="cb187-105"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-105" tabindex="-1"></a>       </span>
<span id="cb187-106"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-106" tabindex="-1"></a>       u <span class="op">=</span> u<span class="op">+</span>dx<span class="op">;</span></span>
<span id="cb187-107"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-107" tabindex="-1"></a>       </span>
<span id="cb187-108"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-108" tabindex="-1"></a>       <span class="cf">if</span> <span class="op">(</span>it<span class="op">==</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-109"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-109" tabindex="-1"></a>         <span class="co">// we have run out of iterations. Terminate</span></span>
<span id="cb187-110"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-110" tabindex="-1"></a>         print<span class="op">(</span><span class="st">&quot;Maximum number of iterations &quot;</span><span class="op">,</span>maxiter<span class="op">,</span><span class="st">&quot; reached&quot;</span><span class="op">);</span></span>
<span id="cb187-111"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-111" tabindex="-1"></a>         </span>
<span id="cb187-112"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-112" tabindex="-1"></a>       <span class="op">}</span></span>
<span id="cb187-113"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-113" tabindex="-1"></a>       </span>
<span id="cb187-114"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-114" tabindex="-1"></a>        </span>
<span id="cb187-115"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-115" tabindex="-1"></a>        </span>
<span id="cb187-116"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-116" tabindex="-1"></a>      <span class="op">}</span> <span class="co">// </span><span class="re">END</span><span class="co"> OF CORRECTOR STEP</span></span>
<span id="cb187-117"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-117" tabindex="-1"></a>      </span>
<span id="cb187-118"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-118" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>accept<span class="op">!=</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-119"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-119" tabindex="-1"></a>        h <span class="op">=</span> h<span class="op">/</span>max_decel<span class="op">;</span></span>
<span id="cb187-120"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-120" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb187-121"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-121" tabindex="-1"></a>      </span>
<span id="cb187-122"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-122" tabindex="-1"></a>      h <span class="op">=</span> abs<span class="op">(</span>h<span class="op">/</span>fmin<span class="op">(</span>decel<span class="op">,</span>max_decel<span class="op">));</span></span>
<span id="cb187-123"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-123" tabindex="-1"></a>      </span>
<span id="cb187-124"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-124" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">((</span>t<span class="ch">&#39;*</span><span class="er">q[,3])&lt;0) {</span></span>
<span id="cb187-125"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-125" tabindex="-1"></a>        omega <span class="op">=</span> <span class="op">-</span>omega<span class="op">;</span></span>
<span id="cb187-126"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-126" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb187-127"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-127" tabindex="-1"></a>      x <span class="op">=</span> u<span class="op">;</span></span>
<span id="cb187-128"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-128" tabindex="-1"></a>      t <span class="op">=</span> q<span class="op">[,</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb187-129"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-129" tabindex="-1"></a>      </span>
<span id="cb187-130"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-130" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-131"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-131" tabindex="-1"></a>    </span>
<span id="cb187-132"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-132" tabindex="-1"></a>    </span>
<span id="cb187-133"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-133" tabindex="-1"></a>    <span class="co">/* Some constant-lambda corrector steps to get the QRE back from</span></span>
<span id="cb187-134"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-134" tabindex="-1"></a><span class="co">    over-shooting a bit</span></span>
<span id="cb187-135"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-135" tabindex="-1"></a><span class="co">    */</span></span>
<span id="cb187-136"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-136" tabindex="-1"></a>    </span>
<span id="cb187-137"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-137" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-138"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-138" tabindex="-1"></a>      </span>
<span id="cb187-139"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-139" tabindex="-1"></a>      x<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> lambda<span class="op">;</span></span>
<span id="cb187-140"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-140" tabindex="-1"></a>      </span>
<span id="cb187-141"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-141" tabindex="-1"></a>      vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> dx <span class="op">=</span> <span class="op">-</span>jac<span class="op">(</span>x<span class="op">,</span>n<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">)[,</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">]</span>\Hfun<span class="op">(</span>x<span class="op">,</span>n<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">);</span></span>
<span id="cb187-142"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-142" tabindex="-1"></a>      </span>
<span id="cb187-143"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-143" tabindex="-1"></a>      x<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">]</span> <span class="op">+=</span>dx<span class="op">;</span></span>
<span id="cb187-144"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-144" tabindex="-1"></a>      </span>
<span id="cb187-145"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-145" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>sqrt<span class="op">(</span>dx<span class="ch">&#39;*</span><span class="er">dx)&lt;tol) {</span></span>
<span id="cb187-146"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-146" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb187-147"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-147" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb187-148"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-148" tabindex="-1"></a>      </span>
<span id="cb187-149"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-149" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-150"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-150" tabindex="-1"></a>    </span>
<span id="cb187-151"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-151" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb187-152"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-152" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-153"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-153" tabindex="-1"></a>  </span>
<span id="cb187-154"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-154" tabindex="-1"></a>  </span>
<span id="cb187-155"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-155" tabindex="-1"></a>  </span>
<span id="cb187-156"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-156" tabindex="-1"></a>  <span class="co">/* Returns the log-QRE probabilities</span></span>
<span id="cb187-157"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-157" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb187-158"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-158" tabindex="-1"></a><span class="co">  */</span></span>
<span id="cb187-159"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-159" tabindex="-1"></a>  vector lpQREcorrectorOnly<span class="op">(</span></span>
<span id="cb187-160"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-160" tabindex="-1"></a>    real lambda<span class="op">,</span></span>
<span id="cb187-161"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-161" tabindex="-1"></a>    data <span class="dt">int</span> GroupSize<span class="op">,</span></span>
<span id="cb187-162"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-162" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span></span>
<span id="cb187-163"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-163" tabindex="-1"></a>    data real tol</span>
<span id="cb187-164"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-164" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-165"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-165" tabindex="-1"></a>    </span>
<span id="cb187-166"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-166" tabindex="-1"></a>    <span class="co">// initial conditions</span></span>
<span id="cb187-167"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-167" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> x <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">),</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb187-168"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-168" tabindex="-1"></a>    real dist <span class="op">=</span> <span class="fl">1e12</span><span class="op">;</span></span>
<span id="cb187-169"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-169" tabindex="-1"></a>    </span>
<span id="cb187-170"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-170" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>dist<span class="op">&gt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-171"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-171" tabindex="-1"></a>    <span class="co">//for (kk in 1:10) {  </span></span>
<span id="cb187-172"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-172" tabindex="-1"></a>      vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> H <span class="op">=</span> <span class="op">[</span>x<span class="op">[</span><span class="dv">1</span><span class="op">]-</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]-</span>lambda<span class="op">*(</span>V<span class="op">-</span>c<span class="op">-</span>V<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>exp<span class="op">((</span>GroupSize<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]))-</span>L<span class="op">*</span>exp<span class="op">((</span>GroupSize<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>x<span class="op">[</span><span class="dv">2</span><span class="op">])),</span></span>
<span id="cb187-173"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-173" tabindex="-1"></a>      exp<span class="op">(</span>x<span class="op">[</span><span class="dv">1</span><span class="op">])+</span>exp<span class="op">(</span>x<span class="op">[</span><span class="dv">2</span><span class="op">])-</span><span class="fl">1.0</span></span>
<span id="cb187-174"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-174" tabindex="-1"></a>      <span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb187-175"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-175" tabindex="-1"></a>      </span>
<span id="cb187-176"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-176" tabindex="-1"></a>      matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Hrho <span class="op">=</span> </span>
<span id="cb187-177"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-177" tabindex="-1"></a>        <span class="op">[</span></span>
<span id="cb187-178"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-178" tabindex="-1"></a>          <span class="op">[</span><span class="fl">1.0</span><span class="op">,</span> <span class="op">-</span><span class="fl">1.0</span><span class="op">-</span>lambda<span class="op">*(</span>GroupSize<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>exp<span class="op">((</span>GroupSize<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>exp<span class="op">(</span>x<span class="op">[</span><span class="dv">2</span><span class="op">]))*(</span>V<span class="op">-</span>L<span class="op">)],</span></span>
<span id="cb187-179"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-179" tabindex="-1"></a>          <span class="op">[</span><span class="fl">1.0</span><span class="op">,</span> <span class="fl">1.0</span><span class="op">]</span></span>
<span id="cb187-180"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-180" tabindex="-1"></a>        <span class="op">];</span></span>
<span id="cb187-181"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-181" tabindex="-1"></a>        </span>
<span id="cb187-182"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-182" tabindex="-1"></a>      vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> dx <span class="op">=</span> <span class="op">-</span>Hrho\H<span class="op">;</span></span>
<span id="cb187-183"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-183" tabindex="-1"></a>      </span>
<span id="cb187-184"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-184" tabindex="-1"></a>      x <span class="op">=</span> x<span class="op">+</span>dx<span class="op">;</span></span>
<span id="cb187-185"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-185" tabindex="-1"></a>      </span>
<span id="cb187-186"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-186" tabindex="-1"></a>      dist <span class="op">=</span> sqrt<span class="op">(</span>dx<span class="ch">&#39;*</span><span class="er">dx);</span></span>
<span id="cb187-187"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-187" tabindex="-1"></a>      </span>
<span id="cb187-188"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-188" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-189"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-189" tabindex="-1"></a>    </span>
<span id="cb187-190"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-190" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb187-191"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-191" tabindex="-1"></a>    </span>
<span id="cb187-192"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-192" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-193"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-193" tabindex="-1"></a>  </span>
<span id="cb187-194"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-194" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-195"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-195" tabindex="-1"></a></span>
<span id="cb187-196"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-196" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb187-197"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-197" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span> <span class="co">// Number of participants</span></span>
<span id="cb187-198"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-198" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> Volunteer<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb187-199"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-199" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> count<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb187-200"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-200" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">2</span><span class="op">&gt;</span> GroupSize<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb187-201"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-201" tabindex="-1"></a>  </span>
<span id="cb187-202"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-202" tabindex="-1"></a>  <span class="co">// Game parameters</span></span>
<span id="cb187-203"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-203" tabindex="-1"></a>  real V<span class="op">;</span> <span class="co">// Benefit of volunteering</span></span>
<span id="cb187-204"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-204" tabindex="-1"></a>  real c<span class="op">;</span> <span class="co">// Cost of volunteering</span></span>
<span id="cb187-205"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-205" tabindex="-1"></a>  real L<span class="op">;</span> <span class="co">// Benefit if nobody volunteers</span></span>
<span id="cb187-206"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-206" tabindex="-1"></a>  </span>
<span id="cb187-207"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-207" tabindex="-1"></a>  real prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">];</span> <span class="co">// lognormal prior</span></span>
<span id="cb187-208"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-208" tabindex="-1"></a>  </span>
<span id="cb187-209"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-209" tabindex="-1"></a>  </span>
<span id="cb187-210"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-210" tabindex="-1"></a>  </span>
<span id="cb187-211"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-211" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> first_step<span class="op">;</span></span>
<span id="cb187-212"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-212" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> min_step<span class="op">;</span></span>
<span id="cb187-213"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-213" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> max_decel<span class="op">;</span></span>
<span id="cb187-214"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-214" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> maxiter<span class="op">;</span></span>
<span id="cb187-215"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-215" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span> <span class="co">// tolerance for the corrector step</span></span>
<span id="cb187-216"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-216" tabindex="-1"></a>  </span>
<span id="cb187-217"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-217" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-218"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-218" tabindex="-1"></a></span>
<span id="cb187-219"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-219" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb187-220"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-220" tabindex="-1"></a>  <span class="co">// logit choice precision</span></span>
<span id="cb187-221"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-221" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb187-222"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-222" tabindex="-1"></a>  </span>
<span id="cb187-223"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-223" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-224"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-224" tabindex="-1"></a></span>
<span id="cb187-225"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-225" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb187-226"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-226" tabindex="-1"></a>  </span>
<span id="cb187-227"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-227" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii  in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-228"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-228" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> lp <span class="op">=</span> lpQRE<span class="op">(</span></span>
<span id="cb187-229"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-229" tabindex="-1"></a>     lambda<span class="op">,</span></span>
<span id="cb187-230"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-230" tabindex="-1"></a>     GroupSize<span class="op">[</span>ii<span class="op">],</span><span class="co">// Group size</span></span>
<span id="cb187-231"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-231" tabindex="-1"></a>     V<span class="op">,</span>  c<span class="op">,</span>  L<span class="op">,</span></span>
<span id="cb187-232"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-232" tabindex="-1"></a>     first_step<span class="op">,</span></span>
<span id="cb187-233"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-233" tabindex="-1"></a>     min_step<span class="op">,</span></span>
<span id="cb187-234"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-234" tabindex="-1"></a>     max_decel<span class="op">,</span></span>
<span id="cb187-235"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-235" tabindex="-1"></a>     maxiter<span class="op">,</span></span>
<span id="cb187-236"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-236" tabindex="-1"></a>     tol</span>
<span id="cb187-237"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-237" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb187-238"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-238" tabindex="-1"></a>  </span>
<span id="cb187-239"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-239" tabindex="-1"></a>  target<span class="op">+=</span>Volunteer<span class="op">[</span>ii<span class="op">]*</span>lp<span class="op">[</span><span class="dv">1</span><span class="op">]+(</span>count<span class="op">[</span>ii<span class="op">]-</span>Volunteer<span class="op">[</span>ii<span class="op">])*</span>lp<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb187-240"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-240" tabindex="-1"></a>  </span>
<span id="cb187-241"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-241" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-242"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-242" tabindex="-1"></a>  </span>
<span id="cb187-243"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-243" tabindex="-1"></a>  lambda <span class="op">~</span> lognormal<span class="op">(</span>prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb187-244"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-244" tabindex="-1"></a>  </span>
<span id="cb187-245"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-245" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-246"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-246" tabindex="-1"></a></span>
<span id="cb187-247"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-247" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb187-248"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-248" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> pV<span class="op">;</span></span>
<span id="cb187-249"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-249" tabindex="-1"></a>  </span>
<span id="cb187-250"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-250" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-251"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-251" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> lp <span class="op">=</span> lpQRE<span class="op">(</span></span>
<span id="cb187-252"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-252" tabindex="-1"></a>     lambda<span class="op">,</span></span>
<span id="cb187-253"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-253" tabindex="-1"></a>    GroupSize<span class="op">[</span>ii<span class="op">],</span><span class="co">// Group size</span></span>
<span id="cb187-254"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-254" tabindex="-1"></a>    V<span class="op">,</span> c<span class="op">,</span>  L<span class="op">,</span></span>
<span id="cb187-255"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-255" tabindex="-1"></a>    first_step<span class="op">,</span></span>
<span id="cb187-256"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-256" tabindex="-1"></a>    min_step<span class="op">,</span></span>
<span id="cb187-257"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-257" tabindex="-1"></a>    max_decel<span class="op">,</span></span>
<span id="cb187-258"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-258" tabindex="-1"></a>    maxiter<span class="op">,</span></span>
<span id="cb187-259"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-259" tabindex="-1"></a>    tol</span>
<span id="cb187-260"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-260" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb187-261"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-261" tabindex="-1"></a>    </span>
<span id="cb187-262"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-262" tabindex="-1"></a>    pV<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>lp<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb187-263"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-263" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-264"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb187-264" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>As you can see in the <code>model</code> block, I have chosen to use a log-normal prior for <span class="math inline">\(\lambda\)</span>. This ensures that it is positive. In this case, the prior I initially used:</p>
<p><span class="math display">\[
\log\lambda\sim N(\log(10),0.25^2)
\]</span></p>
<p>produced results that were almost identical to the maximum likelihood estimates of <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>. However I was worried about the prior median being 10, which is almost exactly the maximum likelihood estimate for <span class="math inline">\(\lambda\)</span>. In particular, I wanted to show that a prior <em>not</em> centered on the maximum likelihood estimate would also generate similar results. Therefore, I re-estimated the model with:</p>
<p><span class="math display">\[
\log\lambda\sim N(\log(5),1^2)
\]</span>
which halves the prior median for <span class="math inline">\(\lambda\)</span>. As you will see below, this barely changes the results: the posterior distribution must be dominated by the likelihood contribution. For perspective, a 95% prior Bayesian credible region for <span class="math inline">\(\lambda\)</span> is:</p>
<p><span class="math display">\[
\left[\exp(\log 5-1.96),\ \exp(\log 5 + 1.96)\right]\approx
\left[0.70,\ 35.5\right]
\]</span></p>
<p>Without further ado, we can now look at the posterior estimates, which are shown in Table <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#tab:QRE2homogeneousPost">15.2</a>.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-1" tabindex="-1"></a>FitSum<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">readRDS</span>(<span class="st">&quot;Code/QRE2/Estimates_VDQREhomogeneous.rds&quot;</span>))<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb188-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-2" tabindex="-1"></a>  <span class="fu">data.frame</span>()</span>
<span id="cb188-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-3" tabindex="-1"></a></span>
<span id="cb188-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-4" tabindex="-1"></a>TAB <span class="ot">&lt;-</span> FitSum <span class="sc">|&gt;</span> </span>
<span id="cb188-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mean,sd)</span>
<span id="cb188-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-6" tabindex="-1"></a></span>
<span id="cb188-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-7" tabindex="-1"></a><span class="fu">rownames</span>(TAB)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">lambda$&quot;</span>,<span class="st">&quot;n = 2&quot;</span>,<span class="st">&quot;n = 3&quot;</span>,<span class="st">&quot;n = 6&quot;</span>,<span class="st">&quot;n = 9&quot;</span>,<span class="st">&quot;n = 12&quot;</span>,<span class="st">&quot;lp__&quot;</span>)</span>
<span id="cb188-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-8" tabindex="-1"></a></span>
<span id="cb188-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb188-9" tabindex="-1"></a>TAB <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>) <span class="sc">|&gt;</span>  <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">&quot;Posterior moments of the homogeneous model. $</span><span class="sc">\\</span><span class="st">lambda$ is logit choice precision. Rows with $n$ show predictions for the probability of volunteering for each group size&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:QRE2homogeneousPost">Table 15.2: </span>Posterior moments of the homogeneous model. <span class="math inline">\(\lambda\)</span> is logit choice precision. Rows with <span class="math inline">\(n\)</span> show predictions for the probability of volunteering for each group size
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda\)</span>
</td>
<td style="text-align:right;">
11.1159
</td>
<td style="text-align:right;">
1.1923
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 2
</td>
<td style="text-align:right;">
0.6699
</td>
<td style="text-align:right;">
0.0056
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 3
</td>
<td style="text-align:right;">
0.5000
</td>
<td style="text-align:right;">
0.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 6
</td>
<td style="text-align:right;">
0.3084
</td>
<td style="text-align:right;">
0.0057
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 9
</td>
<td style="text-align:right;">
0.2358
</td>
<td style="text-align:right;">
0.0076
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 12
</td>
<td style="text-align:right;">
0.1967
</td>
<td style="text-align:right;">
0.0086
</td>
</tr>
<tr>
<td style="text-align:left;">
lp__
</td>
<td style="text-align:right;">
-2393.1565
</td>
<td style="text-align:right;">
0.7535
</td>
</tr>
</tbody>
</table>
<p>Comparing this Table to Table 3 of <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>, the results are remarkably similar. I estimate a posterior mean <span class="math inline">\(\lambda\approx11.1\)</span>, whereas their MLE estimate is <span class="math inline">\(\lambda=11.0\)</span>. Furthermore, all predicted probabilities of the Bayesian model are accurate to the two decimal places of their counterparts in <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>. Probably the most notable difference between my Table <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#tab:QRE2homogeneousPost">15.2</a> and their Table 3 is that I also have an expression of uncertainty for the predicted probabilities. This is something that is done by default in <em>Stan</em>. For the maximum likelihood implementation, one would either have to use the delta method or bootstrap to get standard errors on these quantities.<a href="#fn68" class="footnote-ref" id="fnref68"><sup>68</sup></a></p>
</div>
<div id="adding-some-heterogeneity-1" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Adding some heterogeneity<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The homogeneous quantal response equilibrium estimated above captures an important feature of the data: volunteer rates are on average pulled toward 50% compared to the mixed-strategy Nash prediction. However <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span> also note that the sample <em>variance</em> of participant-specific volunteer rates is substantially greater than the homogeneous quantal response equilibrium predicts (see their Table 4). This suggests that there could be some participant-specific heterogeneity, and <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span> explore this with two extensions to the homogeneous model: warm glow volunteering, and duplicate aversion. In this section I will show you how to compute the equilibrium for these models, and then estimate them. This will mean modifying the predictor-corrector algorithm, as well as using some Monte Carlo integration. In both situations this will mean solving for the <em>average</em> volunteer rate, which I will denote <span class="math inline">\(\bar\sigma_V\)</span>, and then augmenting the data appropriately to account for the individual-level heterogeneity.</p>
<p>As the steps I use to compute the equilibrium are almost identical for each of these extensions, I will first outline how this is done in general. I will then introduce the two models.</p>
<div id="computing-quantal-response-equilibrium-with-heterogeneous-parameters" class="section level3 hasAnchor" number="15.2.1">
<h3><span class="header-section-number">15.2.1</span> Computing quantal response equilibrium with heterogeneous parameters<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In both of the model extensions, a participant-specific payoff parameter is added to the model. Here I will denote it as <span class="math inline">\(\theta_i\)</span>. We then specify a distribution for <span class="math inline">\(\theta_i\)</span>. Here I will use:<a href="#fn69" class="footnote-ref" id="fnref69"><sup>69</sup></a></p>
<p><span class="math display">\[
\theta_i\sim \mathrm{Truncated \ Normal}(\mu,\tau^2,(\mu-\tau, \mu+\tau))
\]</span></p>
<p>This is slightly different to the implementation in <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>, who assume a <em>discrete</em> truncated normal distribution. Specifically, they assume that <span class="math inline">\(\theta_i\)</span> is evenly spaced along a grid:<a href="#fn70" class="footnote-ref" id="fnref70"><sup>70</sup></a></p>
<p><span class="math display">\[
\theta_i\in\{\mu-\tau,\mu-0.8\tau, \mu-0.6\tau,\ldots,\mu,\ldots,\mu+\tau\}
\]</span></p>
<p>My departure from the original specification, though, will permit us to use data augmentation to estimate the model.</p>
<p>Since <span class="math inline">\(\theta_i\)</span> is participant-specific, we therefore have a participant-specific probabilistic best response function, which I shall denote <span class="math inline">\(\sigma(\lambda,\theta_i,\bar\sigma_V)\)</span>. <span class="math inline">\(\bar\sigma_V\)</span> is the <em>aggregate</em> volunteer rate in the population. We can therefore find it by taking the expectation over <span class="math inline">\(\theta_i\)</span>:</p>
<p><span class="math display">\[
\bar\sigma_V = E_\theta[\sigma(\lambda,\theta,\bar\sigma_V)]
\]</span></p>
<p>Note that on the left-hand side we have the average equilibrium volunteer rate, and on the left-hand side we have the average probabilistic best response. This is the equilibrium condition, as in equilibrium both of these quantities must be equal.</p>
<p>We have two computational issues that we will need to tackle in order to solve this equation. These are computing the expectation, and then solving the equation. For the former, I approximate the expectation using Monte Carlo integration as follows:</p>
<p><span class="math display">\[
\begin{aligned}
E_\theta[\sigma(\lambda,\theta,\bar\sigma_V)]&amp;\approx\frac1S\sum_{s=1}^S\sigma(\lambda,\theta_s,\bar\sigma_V)\\
\theta_s&amp;\sim  \mathrm{Truncated\ Normal}(\mu,\tau^2,(\mu-\tau,\mu+\tau))
\end{aligned}
\]</span></p>
<p>I then need an algorithm that can solve the (approximate) equilibrium condition. For this, I will use constant-<span class="math inline">\(\lambda\)</span> corrector steps, which are basically just solving the problem using Newton’s method. First, in order to solve the problem on the real number line, rather than on the unit interval, I will make the logit transformation <span class="math inline">\(\ell = \log(\bar\sigma_V)-\log(1-\bar\sigma_V)\)</span>. I can then re-write the equilibrium condition as:</p>
<p><span class="math display">\[
\begin{aligned}
H(\ell)&amp;=\ell-\log(E_\theta(\sigma(\lambda,\theta,\Lambda(\ell))))+\log(1-E_\theta(\sigma(\lambda,\theta,\Lambda(\ell))))
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Lambda(x)=(1+\exp(-x))^{-1}\)</span> is the inverse logit function. We can therefore iterate on the following sequence until we reach the desired level of accuracy:</p>
<p><span class="math display">\[
\ell^{t+1}=\ell^t-\frac{H(\ell^t)}{H&#39;(\ell^t)}
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
\begin{aligned}
H&#39;(\ell)&amp;=1-\left[\frac{1}{E_\theta(\sigma(\lambda,\theta,\Lambda(\ell)))}-\frac{1}{1-E_\theta(\sigma(\lambda,\theta,\Lambda(\ell)))}\right]E\left[\frac{\partial \sigma(\lambda,\theta,\Lambda(\ell))}{\partial \Lambda(\ell)}\right]\frac{\partial \Lambda(\ell)}{\partial \ell}
\\
&amp;=1-\frac{\Lambda(\ell)(1-\Lambda(\ell))}{E_\theta(\sigma(\lambda,\theta,\Lambda(\ell)))(1-E_\theta(\sigma(\lambda,\theta,\Lambda(\ell))))}E\left[\frac{\partial \sigma(\lambda,\theta,\Lambda(\ell))}{\partial \Lambda(\ell)}\right]
\end{aligned}
\]</span></p>
<p>Note that we will also have to approximate <span class="math inline">\(E\left[\frac{\partial \sigma(\lambda,\theta,\Lambda(\ell))}{\partial \Lambda(\ell)}\right]\)</span> using Monte Carlo integration.</p>
</div>
<div id="warm-glow-volunteering" class="section level3 hasAnchor" number="15.2.2">
<h3><span class="header-section-number">15.2.2</span> Warm glow volunteering<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first extension is to introduce a participant-specific parameter <span class="math inline">\(\delta_i\)</span> that measures their “warm glow” utility from volunteering. That is, instead of receiving payoff <span class="math inline">\(V-c\)</span> when they volunteer, they receive payoff <span class="math inline">\(V-c+\delta_i\)</span>. We can therefore write participant <span class="math inline">\(i\)</span>’s probabilistic best response to the average volunteer rate <span class="math inline">\(\bar\sigma_V\)</span> as:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma(\lambda,\delta_i,\bar\sigma_V)
&amp;=\frac{\exp(\lambda(V-c+\delta_i))}{\exp(\lambda(V-c+\delta_i))+\exp(\lambda(V(1-(1-\bar\sigma_V)^{n-1})+L(1-\bar\sigma_V)^{n-1}))}\\
&amp;=\Lambda\left(\lambda\left(V-c+\delta_i-V(1-(1-\bar\sigma_V)^{n-1})-L(1-\bar\sigma_V)^{n-1}\right)\right)
\end{aligned}
\]</span></p>
<p>The derivative of the probabilistic best response that we need to evaluate is:<a href="#fn71" class="footnote-ref" id="fnref71"><sup>71</sup></a></p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \sigma(\lambda,\delta_i,\bar\sigma_V)}{\partial \bar\sigma_V}
&amp;=-\lambda(n-1)(1-\bar\sigma_V)^{n-2}(V-L)\sigma(\lambda,\delta_i,\bar\sigma_V)(1-\sigma(\lambda,\delta_i,\bar\sigma_V))
\end{aligned}
\]</span></p>
<p>Here is the <em>Stan</em> program I wrote to estimate the warm glow model:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb189-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-1" tabindex="-1"></a></span>
<span id="cb189-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-2" tabindex="-1"></a><span class="co">/* Warm glow quantal response equilibrium model for the Volunteer&#39;s Dilemma</span></span>
<span id="cb189-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-3" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb189-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-4" tabindex="-1"></a></span>
<span id="cb189-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-5" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb189-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-6" tabindex="-1"></a>  </span>
<span id="cb189-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-7" tabindex="-1"></a>  </span>
<span id="cb189-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-8" tabindex="-1"></a>  <span class="co">/* Here I am using &quot;PBR&quot; (i.e. probabilistic best response) to </span></span>
<span id="cb189-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-9" tabindex="-1"></a><span class="co">  distinguish between \sigma and \bar\sigma_V</span></span>
<span id="cb189-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-10" tabindex="-1"></a><span class="co">  */</span></span>
<span id="cb189-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-11" tabindex="-1"></a>  </span>
<span id="cb189-12"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-12" tabindex="-1"></a>  vector PBR<span class="op">(</span></span>
<span id="cb189-13"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-13" tabindex="-1"></a>    real lambda<span class="op">,</span> vector delta<span class="op">,</span> real sigmaV<span class="op">,</span></span>
<span id="cb189-14"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-14" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb189-15"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-15" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-16"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-16" tabindex="-1"></a>    </span>
<span id="cb189-17"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-17" tabindex="-1"></a>    <span class="cf">return</span> inv_logit<span class="op">(</span>lambda<span class="op">*(</span></span>
<span id="cb189-18"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-18" tabindex="-1"></a>      V<span class="op">-</span>c<span class="op">+</span>delta<span class="op">-</span>V<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">))+</span>L<span class="op">*</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)</span></span>
<span id="cb189-19"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-19" tabindex="-1"></a>    <span class="op">));</span></span>
<span id="cb189-20"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-20" tabindex="-1"></a>    </span>
<span id="cb189-21"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-21" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-22"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-22" tabindex="-1"></a></span>
<span id="cb189-23"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-23" tabindex="-1"></a></span>
<span id="cb189-24"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-24" tabindex="-1"></a> <span class="co">// derivative wrt sigmaV</span></span>
<span id="cb189-25"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-25" tabindex="-1"></a> vector PBR_sigmaV<span class="op">(</span></span>
<span id="cb189-26"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-26" tabindex="-1"></a>    real lambda<span class="op">,</span> vector delta<span class="op">,</span> real sigmaV<span class="op">,</span></span>
<span id="cb189-27"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-27" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb189-28"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-28" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-29"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-29" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>lambda<span class="op">*(</span>V<span class="op">-</span>L<span class="op">)*(</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">).*</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">2.0</span><span class="op">)</span></span>
<span id="cb189-30"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-30" tabindex="-1"></a>    <span class="op">*</span>PBR<span class="op">(</span>lambda<span class="op">,</span>delta<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">)</span> <span class="op">.*(</span><span class="fl">1.0</span><span class="op">-</span>PBR<span class="op">(</span>lambda<span class="op">,</span>delta<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb189-31"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-31" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-32"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-32" tabindex="-1"></a>  </span>
<span id="cb189-33"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-33" tabindex="-1"></a>  </span>
<span id="cb189-34"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-34" tabindex="-1"></a>  <span class="co">// Zero condition for equilibrium</span></span>
<span id="cb189-35"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-35" tabindex="-1"></a>  real Hfun<span class="op">(</span>real l<span class="op">,</span></span>
<span id="cb189-36"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-36" tabindex="-1"></a>    real lambda<span class="op">,</span> vector delta<span class="op">,</span></span>
<span id="cb189-37"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-37" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb189-38"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-38" tabindex="-1"></a>    <span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-39"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-39" tabindex="-1"></a>      real sigmaV <span class="op">=</span> inv_logit<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb189-40"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-40" tabindex="-1"></a>      real meanPBR <span class="op">=</span> mean<span class="op">(</span>PBR<span class="op">(</span>lambda<span class="op">,</span>delta<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb189-41"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-41" tabindex="-1"></a>      <span class="cf">return</span> l <span class="op">-</span> log<span class="op">(</span>meanPBR<span class="op">)+</span>log<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>meanPBR<span class="op">);</span></span>
<span id="cb189-42"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-42" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-43"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-43" tabindex="-1"></a>  </span>
<span id="cb189-44"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-44" tabindex="-1"></a>  <span class="co">// derivative of zero condition</span></span>
<span id="cb189-45"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-45" tabindex="-1"></a>  real Hl<span class="op">(</span>real l<span class="op">,</span></span>
<span id="cb189-46"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-46" tabindex="-1"></a>    real lambda<span class="op">,</span> vector delta<span class="op">,</span></span>
<span id="cb189-47"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-47" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb189-48"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-48" tabindex="-1"></a>    <span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-49"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-49" tabindex="-1"></a>      real sigmaV <span class="op">=</span> inv_logit<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb189-50"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-50" tabindex="-1"></a>      real meanPBR <span class="op">=</span> mean<span class="op">(</span>PBR<span class="op">(</span>lambda<span class="op">,</span>delta<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb189-51"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-51" tabindex="-1"></a>      <span class="cf">return</span> <span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">)/(</span>meanPBR<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>meanPBR<span class="op">))*</span>mean<span class="op">(</span>PBR_sigmaV<span class="op">(</span>lambda<span class="op">,</span>delta<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb189-52"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-52" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-53"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-53" tabindex="-1"></a>  </span>
<span id="cb189-54"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-54" tabindex="-1"></a>  <span class="co">// Compute QRE using constant-lambda corrector steps</span></span>
<span id="cb189-55"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-55" tabindex="-1"></a>  real lpQRE<span class="op">(</span></span>
<span id="cb189-56"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-56" tabindex="-1"></a>    real lambda<span class="op">,</span> vector delta<span class="op">,</span></span>
<span id="cb189-57"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-57" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n<span class="op">,</span></span>
<span id="cb189-58"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-58" tabindex="-1"></a>    data real tol<span class="op">,</span> data <span class="dt">int</span> maxiter</span>
<span id="cb189-59"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-59" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-60"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-60" tabindex="-1"></a>    </span>
<span id="cb189-61"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-61" tabindex="-1"></a>    <span class="co">// start at l=0 (sigmaV=0.5)</span></span>
<span id="cb189-62"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-62" tabindex="-1"></a>    real l <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb189-63"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-63" tabindex="-1"></a>    </span>
<span id="cb189-64"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-64" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>it in <span class="dv">1</span><span class="op">:</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-65"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-65" tabindex="-1"></a>      </span>
<span id="cb189-66"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-66" tabindex="-1"></a>      real dl <span class="op">=</span> <span class="op">-</span>Hfun<span class="op">(</span>l<span class="op">,</span>lambda<span class="op">,</span>delta<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">)/</span>Hl<span class="op">(</span>l<span class="op">,</span>lambda<span class="op">,</span>delta<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">);</span></span>
<span id="cb189-67"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-67" tabindex="-1"></a>      </span>
<span id="cb189-68"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-68" tabindex="-1"></a>      l <span class="op">=</span> l<span class="op">+</span>dl<span class="op">;</span></span>
<span id="cb189-69"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-69" tabindex="-1"></a>      </span>
<span id="cb189-70"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-70" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>abs<span class="op">(</span>dl<span class="op">)&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-71"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-71" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb189-72"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-72" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb189-73"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-73" tabindex="-1"></a>      </span>
<span id="cb189-74"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-74" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>it<span class="op">==</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-75"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-75" tabindex="-1"></a>        print<span class="op">(</span><span class="st">&quot;Maximum iterations error, lambda = &quot;</span><span class="op">,</span>lambda<span class="op">,</span> <span class="st">&quot;, dl = &quot;</span><span class="op">,</span>abs<span class="op">(</span>dl<span class="op">));</span></span>
<span id="cb189-76"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-76" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb189-77"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-77" tabindex="-1"></a>      </span>
<span id="cb189-78"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-78" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-79"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-79" tabindex="-1"></a>    </span>
<span id="cb189-80"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-80" tabindex="-1"></a>    <span class="cf">return</span> inv_logit<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb189-81"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-81" tabindex="-1"></a>    </span>
<span id="cb189-82"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-82" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-83"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-83" tabindex="-1"></a>  </span>
<span id="cb189-84"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-84" tabindex="-1"></a>  </span>
<span id="cb189-85"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-85" tabindex="-1"></a>  </span>
<span id="cb189-86"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-86" tabindex="-1"></a>  </span>
<span id="cb189-87"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-87" tabindex="-1"></a>  </span>
<span id="cb189-88"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-88" tabindex="-1"></a>  </span>
<span id="cb189-89"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-89" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-90"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-90" tabindex="-1"></a></span>
<span id="cb189-91"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-91" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb189-92"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-92" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span> <span class="co">// Number of participants</span></span>
<span id="cb189-93"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-93" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> Volunteer<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-94"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-94" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> count<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-95"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-95" tabindex="-1"></a>  </span>
<span id="cb189-96"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-96" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> nTreatments<span class="op">;</span></span>
<span id="cb189-97"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-97" tabindex="-1"></a>  vector<span class="op">[</span>nTreatments<span class="op">]</span> GroupSize<span class="op">;</span></span>
<span id="cb189-98"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-98" tabindex="-1"></a>  </span>
<span id="cb189-99"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-99" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> GameID<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-100"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-100" tabindex="-1"></a>  </span>
<span id="cb189-101"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-101" tabindex="-1"></a>  </span>
<span id="cb189-102"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-102" tabindex="-1"></a>  <span class="co">// Game parameters</span></span>
<span id="cb189-103"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-103" tabindex="-1"></a>  real V<span class="op">;</span> <span class="co">// Benefit of volunteering</span></span>
<span id="cb189-104"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-104" tabindex="-1"></a>  real c<span class="op">;</span> <span class="co">// Cost of volunteering</span></span>
<span id="cb189-105"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-105" tabindex="-1"></a>  real L<span class="op">;</span> <span class="co">// Benefit if nobody volunteers</span></span>
<span id="cb189-106"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-106" tabindex="-1"></a>  </span>
<span id="cb189-107"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-107" tabindex="-1"></a>  real prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">];</span> <span class="co">// lognormal prior</span></span>
<span id="cb189-108"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-108" tabindex="-1"></a>  real prior_mu<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb189-109"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-109" tabindex="-1"></a>  real prior_tau<span class="op">;</span></span>
<span id="cb189-110"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-110" tabindex="-1"></a>  </span>
<span id="cb189-111"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-111" tabindex="-1"></a>  </span>
<span id="cb189-112"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-112" tabindex="-1"></a>  </span>
<span id="cb189-113"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-113" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> maxiter<span class="op">;</span></span>
<span id="cb189-114"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-114" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span> <span class="co">// tolerance for the corrector step</span></span>
<span id="cb189-115"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-115" tabindex="-1"></a>  </span>
<span id="cb189-116"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-116" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> nSim<span class="op">;</span> <span class="co">// simulation size for Monte Carlo integration</span></span>
<span id="cb189-117"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-117" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=-</span><span class="fl">1.0</span><span class="op">,</span>upper<span class="op">=</span><span class="fl">1.0</span><span class="op">&gt;[</span>nSim<span class="op">]</span> deltaZ<span class="op">;</span> <span class="co">// standard normals truncated to be between -1 and 1</span></span>
<span id="cb189-118"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-118" tabindex="-1"></a>  </span>
<span id="cb189-119"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-119" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-120"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-120" tabindex="-1"></a></span>
<span id="cb189-121"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-121" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb189-122"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-122" tabindex="-1"></a>  <span class="co">// logit choice precision</span></span>
<span id="cb189-123"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-123" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb189-124"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-124" tabindex="-1"></a>  </span>
<span id="cb189-125"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-125" tabindex="-1"></a>  <span class="co">// Distribution of delta</span></span>
<span id="cb189-126"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-126" tabindex="-1"></a>  real mu<span class="op">;</span></span>
<span id="cb189-127"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-127" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tau<span class="op">;</span></span>
<span id="cb189-128"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-128" tabindex="-1"></a>  </span>
<span id="cb189-129"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-129" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower <span class="op">=</span> mu<span class="op">-</span>tau<span class="op">,</span>upper<span class="op">=</span>mu<span class="op">+</span>tau<span class="op">&gt;[</span>N<span class="op">]</span> delta_i<span class="op">;</span></span>
<span id="cb189-130"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-130" tabindex="-1"></a>  </span>
<span id="cb189-131"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-131" tabindex="-1"></a>  </span>
<span id="cb189-132"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-132" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-133"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-133" tabindex="-1"></a></span>
<span id="cb189-134"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-134" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb189-135"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-135" tabindex="-1"></a>  </span>
<span id="cb189-136"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-136" tabindex="-1"></a>  </span>
<span id="cb189-137"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-137" tabindex="-1"></a>  </span>
<span id="cb189-138"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-138" tabindex="-1"></a>  vector<span class="op">[</span>nSim<span class="op">]</span> deltaSim <span class="op">=</span> mu<span class="op">+</span>tau<span class="op">*</span>deltaZ<span class="op">;</span></span>
<span id="cb189-139"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-139" tabindex="-1"></a>  </span>
<span id="cb189-140"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-140" tabindex="-1"></a>  vector<span class="op">[</span>nTreatments<span class="op">]</span> sigmaV<span class="op">;</span></span>
<span id="cb189-141"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-141" tabindex="-1"></a>  </span>
<span id="cb189-142"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-142" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt  in <span class="dv">1</span><span class="op">:</span>nTreatments<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-143"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-143" tabindex="-1"></a>    sigmaV<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> lpQRE<span class="op">(</span></span>
<span id="cb189-144"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-144" tabindex="-1"></a>    lambda<span class="op">,</span>deltaSim<span class="op">,</span></span>
<span id="cb189-145"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-145" tabindex="-1"></a>    V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>GroupSize<span class="op">[</span>tt<span class="op">],</span></span>
<span id="cb189-146"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-146" tabindex="-1"></a>    tol<span class="op">,</span>maxiter</span>
<span id="cb189-147"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-147" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb189-148"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-148" tabindex="-1"></a>  </span>
<span id="cb189-149"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-149" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-150"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-150" tabindex="-1"></a>  </span>
<span id="cb189-151"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-151" tabindex="-1"></a>  Volunteer <span class="op">~</span> binomial_logit<span class="op">(</span>count<span class="op">,</span>lambda<span class="op">*(</span></span>
<span id="cb189-152"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-152" tabindex="-1"></a>      V<span class="op">-</span>c<span class="op">+</span>delta_i<span class="op">-</span>V<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">[</span>GameID<span class="op">],</span>GroupSize<span class="op">[</span>GameID<span class="op">]-</span><span class="fl">1.0</span><span class="op">))+</span>L<span class="op">*</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">[</span>GameID<span class="op">],</span>GroupSize<span class="op">[</span>GameID<span class="op">]-</span><span class="fl">1.0</span><span class="op">)</span></span>
<span id="cb189-153"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-153" tabindex="-1"></a>    <span class="op">));</span></span>
<span id="cb189-154"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-154" tabindex="-1"></a>  </span>
<span id="cb189-155"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-155" tabindex="-1"></a>  delta_i <span class="op">~</span> normal<span class="op">(</span>mu<span class="op">,</span>tau<span class="op">);</span></span>
<span id="cb189-156"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-156" tabindex="-1"></a>  </span>
<span id="cb189-157"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-157" tabindex="-1"></a>  lambda <span class="op">~</span> lognormal<span class="op">(</span>prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-158"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-158" tabindex="-1"></a>  mu <span class="op">~</span> normal<span class="op">(</span>prior_mu<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mu<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-159"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-159" tabindex="-1"></a>  tau <span class="op">~</span> cauchy<span class="op">(</span><span class="dv">0</span><span class="op">,</span>prior_tau<span class="op">);</span></span>
<span id="cb189-160"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-160" tabindex="-1"></a>  </span>
<span id="cb189-161"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-161" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-162"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-162" tabindex="-1"></a></span>
<span id="cb189-163"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-163" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb189-164"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-164" tabindex="-1"></a>  </span>
<span id="cb189-165"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-165" tabindex="-1"></a>  </span>
<span id="cb189-166"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-166" tabindex="-1"></a>  vector<span class="op">[</span>nTreatments<span class="op">]</span> sigmaV<span class="op">;</span></span>
<span id="cb189-167"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-167" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb189-168"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-168" tabindex="-1"></a>  vector<span class="op">[</span>nSim<span class="op">]</span> deltaSim <span class="op">=</span> mu<span class="op">+</span>tau<span class="op">*</span>deltaZ<span class="op">;</span></span>
<span id="cb189-169"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-169" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt  in <span class="dv">1</span><span class="op">:</span>nTreatments<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-170"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-170" tabindex="-1"></a>    sigmaV<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> lpQRE<span class="op">(</span></span>
<span id="cb189-171"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-171" tabindex="-1"></a>    lambda<span class="op">,</span>deltaSim<span class="op">,</span></span>
<span id="cb189-172"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-172" tabindex="-1"></a>    V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>GroupSize<span class="op">[</span>tt<span class="op">],</span></span>
<span id="cb189-173"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-173" tabindex="-1"></a>    tol<span class="op">,</span>maxiter</span>
<span id="cb189-174"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-174" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb189-175"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-175" tabindex="-1"></a>  </span>
<span id="cb189-176"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-176" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-177"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-177" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-178"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-178" tabindex="-1"></a>  </span>
<span id="cb189-179"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb189-179" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="duplicate-aversion" class="section level3 hasAnchor" number="15.2.3">
<h3><span class="header-section-number">15.2.3</span> Duplicate aversion<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span> also extend the homogeneous quantal response equilibrium model to allow for participant-specific “duplicate aversion”. That is, participants suffer disutility <span class="math inline">\(\gamma_i\)</span> if more than one person volunteers. This modifies the expected payoff of volunteering from <span class="math inline">\(V-c\)</span> to <span class="math inline">\(V-c-\gamma_i(1-(1-\bar\sigma_V)^{n-1})\)</span>, and so the probabilistic best response function for a participant with duplicate aversion <span class="math inline">\(\gamma_i\)</span> is:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma(\lambda,\gamma_i,\bar\sigma_V)&amp;=\Lambda\left(\lambda\left(
V-c-\gamma_i(1-(1-\bar\sigma_V)^{n-1})-V(1-(1-\bar\sigma_V)^{n-1})
-L(1-\bar\sigma_V)^{n-1}
\right)\right)
\end{aligned}
\]</span></p>
<p>and the derivative we need to evaluate is:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \sigma(\lambda,\gamma_i,\bar\sigma_V)}{\partial \bar\sigma_V}
&amp;=-\lambda(n-1)(1-\bar\sigma_V)^{n-2}\left(\gamma_i+V-L\right)
\sigma(\lambda,\gamma_i,\bar\sigma_V)(1-\sigma(\lambda,\gamma_i,\bar\sigma_V))
\end{aligned}
\]</span></p>
<p>Here is the <em>Stan</em> program I wrote to estimate the duplicate aversion model:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb190-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-1" tabindex="-1"></a></span>
<span id="cb190-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-2" tabindex="-1"></a><span class="co">/* Duplicate aversion quantal response equilibrium model for the Volunteer&#39;s Dilemma</span></span>
<span id="cb190-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-3" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb190-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-4" tabindex="-1"></a></span>
<span id="cb190-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-5" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb190-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-6" tabindex="-1"></a>  </span>
<span id="cb190-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-7" tabindex="-1"></a>  </span>
<span id="cb190-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-8" tabindex="-1"></a>  <span class="co">/* Here I am using &quot;PBR&quot; (i.e. probabilistic best response) to </span></span>
<span id="cb190-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-9" tabindex="-1"></a><span class="co">  distinguish between \sigma and \bar\sigma_V</span></span>
<span id="cb190-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-10" tabindex="-1"></a><span class="co">  */</span></span>
<span id="cb190-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-11" tabindex="-1"></a>  </span>
<span id="cb190-12"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-12" tabindex="-1"></a>  vector PBR<span class="op">(</span></span>
<span id="cb190-13"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-13" tabindex="-1"></a>    real lambda<span class="op">,</span> vector gamma<span class="op">,</span> real sigmaV<span class="op">,</span></span>
<span id="cb190-14"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-14" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb190-15"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-15" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-16"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-16" tabindex="-1"></a>    </span>
<span id="cb190-17"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-17" tabindex="-1"></a>    <span class="cf">return</span> inv_logit<span class="op">(</span>lambda<span class="op">*(</span></span>
<span id="cb190-18"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-18" tabindex="-1"></a>      V<span class="op">-</span>c<span class="op">-</span>gamma<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">))-</span>V<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">))+</span>L<span class="op">*</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)</span></span>
<span id="cb190-19"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-19" tabindex="-1"></a>    <span class="op">));</span></span>
<span id="cb190-20"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-20" tabindex="-1"></a>    </span>
<span id="cb190-21"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-21" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-22"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-22" tabindex="-1"></a></span>
<span id="cb190-23"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-23" tabindex="-1"></a></span>
<span id="cb190-24"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-24" tabindex="-1"></a> <span class="co">// derivative wrt sigmaV</span></span>
<span id="cb190-25"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-25" tabindex="-1"></a> vector PBR_sigmaV<span class="op">(</span></span>
<span id="cb190-26"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-26" tabindex="-1"></a>    real lambda<span class="op">,</span> vector gamma<span class="op">,</span> real sigmaV<span class="op">,</span></span>
<span id="cb190-27"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-27" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb190-28"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-28" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-29"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-29" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span>lambda<span class="op">*(</span>n<span class="op">-</span><span class="fl">1.0</span><span class="op">)*</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">,</span>n<span class="op">-</span><span class="fl">2.0</span><span class="op">)*(</span>gamma<span class="op">+</span>V<span class="op">-</span>L<span class="op">)</span></span>
<span id="cb190-30"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-30" tabindex="-1"></a>    <span class="op">.*</span>PBR<span class="op">(</span>lambda<span class="op">,</span>gamma<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">)</span> <span class="op">.*(</span><span class="fl">1.0</span><span class="op">-</span>PBR<span class="op">(</span>lambda<span class="op">,</span>gamma<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb190-31"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-31" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-32"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-32" tabindex="-1"></a>  </span>
<span id="cb190-33"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-33" tabindex="-1"></a>  </span>
<span id="cb190-34"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-34" tabindex="-1"></a>  <span class="co">// Zero condition for equilibrium</span></span>
<span id="cb190-35"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-35" tabindex="-1"></a>  real Hfun<span class="op">(</span>real l<span class="op">,</span></span>
<span id="cb190-36"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-36" tabindex="-1"></a>    real lambda<span class="op">,</span> vector gamma<span class="op">,</span></span>
<span id="cb190-37"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-37" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb190-38"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-38" tabindex="-1"></a>    <span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-39"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-39" tabindex="-1"></a>      real sigmaV <span class="op">=</span> inv_logit<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb190-40"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-40" tabindex="-1"></a>      real meanPBR <span class="op">=</span> mean<span class="op">(</span>PBR<span class="op">(</span>lambda<span class="op">,</span>gamma<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb190-41"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-41" tabindex="-1"></a>      <span class="cf">return</span> l <span class="op">-</span> log<span class="op">(</span>meanPBR<span class="op">)+</span>log<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>meanPBR<span class="op">);</span></span>
<span id="cb190-42"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-42" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-43"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-43" tabindex="-1"></a>  </span>
<span id="cb190-44"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-44" tabindex="-1"></a>  <span class="co">// derivative of zero condition</span></span>
<span id="cb190-45"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-45" tabindex="-1"></a>  real Hl<span class="op">(</span>real l<span class="op">,</span></span>
<span id="cb190-46"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-46" tabindex="-1"></a>    real lambda<span class="op">,</span> vector gamma<span class="op">,</span></span>
<span id="cb190-47"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-47" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n</span>
<span id="cb190-48"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-48" tabindex="-1"></a>    <span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-49"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-49" tabindex="-1"></a>      real sigmaV <span class="op">=</span> inv_logit<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb190-50"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-50" tabindex="-1"></a>      real meanPBR <span class="op">=</span> mean<span class="op">(</span>PBR<span class="op">(</span>lambda<span class="op">,</span>gamma<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb190-51"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-51" tabindex="-1"></a>      <span class="cf">return</span> <span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">)/(</span>meanPBR<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>meanPBR<span class="op">))*</span>mean<span class="op">(</span>PBR_sigmaV<span class="op">(</span>lambda<span class="op">,</span>gamma<span class="op">,</span>sigmaV<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">));</span></span>
<span id="cb190-52"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-52" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-53"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-53" tabindex="-1"></a>  </span>
<span id="cb190-54"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-54" tabindex="-1"></a>  <span class="co">// Compute QRE using constant-lambda corrector steps</span></span>
<span id="cb190-55"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-55" tabindex="-1"></a>  real lpQRE<span class="op">(</span></span>
<span id="cb190-56"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-56" tabindex="-1"></a>    real lambda<span class="op">,</span> vector gamma<span class="op">,</span></span>
<span id="cb190-57"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-57" tabindex="-1"></a>    data real V<span class="op">,</span> data real c<span class="op">,</span> data real L<span class="op">,</span> data real n<span class="op">,</span></span>
<span id="cb190-58"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-58" tabindex="-1"></a>    data real tol<span class="op">,</span> data <span class="dt">int</span> maxiter</span>
<span id="cb190-59"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-59" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-60"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-60" tabindex="-1"></a>    </span>
<span id="cb190-61"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-61" tabindex="-1"></a>    <span class="co">// start at l=0 (sigmaV=0.5)</span></span>
<span id="cb190-62"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-62" tabindex="-1"></a>    real l <span class="op">=</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb190-63"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-63" tabindex="-1"></a>    </span>
<span id="cb190-64"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-64" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>it in <span class="dv">1</span><span class="op">:</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-65"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-65" tabindex="-1"></a>      </span>
<span id="cb190-66"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-66" tabindex="-1"></a>      real dl <span class="op">=</span> <span class="op">-</span>Hfun<span class="op">(</span>l<span class="op">,</span>lambda<span class="op">,</span>gamma<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">)/</span>Hl<span class="op">(</span>l<span class="op">,</span>lambda<span class="op">,</span>gamma<span class="op">,</span>V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>n<span class="op">);</span></span>
<span id="cb190-67"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-67" tabindex="-1"></a>      </span>
<span id="cb190-68"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-68" tabindex="-1"></a>      l <span class="op">=</span> l<span class="op">+</span>dl<span class="op">;</span></span>
<span id="cb190-69"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-69" tabindex="-1"></a>      </span>
<span id="cb190-70"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-70" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>abs<span class="op">(</span>dl<span class="op">)&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-71"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-71" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb190-72"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-72" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb190-73"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-73" tabindex="-1"></a>      </span>
<span id="cb190-74"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-74" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>it<span class="op">==</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-75"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-75" tabindex="-1"></a>        print<span class="op">(</span><span class="st">&quot;Maximum iterations error, lambda = &quot;</span><span class="op">,</span>lambda<span class="op">,</span> <span class="st">&quot;, dl = &quot;</span><span class="op">,</span>abs<span class="op">(</span>dl<span class="op">));</span></span>
<span id="cb190-76"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-76" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb190-77"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-77" tabindex="-1"></a>      </span>
<span id="cb190-78"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-78" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-79"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-79" tabindex="-1"></a>    </span>
<span id="cb190-80"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-80" tabindex="-1"></a>    <span class="cf">return</span> inv_logit<span class="op">(</span>l<span class="op">);</span></span>
<span id="cb190-81"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-81" tabindex="-1"></a>    </span>
<span id="cb190-82"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-82" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-83"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-83" tabindex="-1"></a>  </span>
<span id="cb190-84"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-84" tabindex="-1"></a>  </span>
<span id="cb190-85"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-85" tabindex="-1"></a>  </span>
<span id="cb190-86"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-86" tabindex="-1"></a>  </span>
<span id="cb190-87"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-87" tabindex="-1"></a>  </span>
<span id="cb190-88"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-88" tabindex="-1"></a>  </span>
<span id="cb190-89"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-89" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-90"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-90" tabindex="-1"></a></span>
<span id="cb190-91"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-91" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb190-92"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-92" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span> <span class="co">// Number of participants</span></span>
<span id="cb190-93"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-93" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> Volunteer<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-94"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-94" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> count<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-95"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-95" tabindex="-1"></a>  </span>
<span id="cb190-96"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-96" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> nTreatments<span class="op">;</span></span>
<span id="cb190-97"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-97" tabindex="-1"></a>  vector<span class="op">[</span>nTreatments<span class="op">]</span> GroupSize<span class="op">;</span></span>
<span id="cb190-98"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-98" tabindex="-1"></a>  </span>
<span id="cb190-99"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-99" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> GameID<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-100"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-100" tabindex="-1"></a>  </span>
<span id="cb190-101"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-101" tabindex="-1"></a>  </span>
<span id="cb190-102"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-102" tabindex="-1"></a>  <span class="co">// Game parameters</span></span>
<span id="cb190-103"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-103" tabindex="-1"></a>  real V<span class="op">;</span> <span class="co">// Benefit of volunteering</span></span>
<span id="cb190-104"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-104" tabindex="-1"></a>  real c<span class="op">;</span> <span class="co">// Cost of volunteering</span></span>
<span id="cb190-105"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-105" tabindex="-1"></a>  real L<span class="op">;</span> <span class="co">// Benefit if nobody volunteers</span></span>
<span id="cb190-106"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-106" tabindex="-1"></a>  </span>
<span id="cb190-107"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-107" tabindex="-1"></a>  real prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">];</span> <span class="co">// lognormal prior</span></span>
<span id="cb190-108"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-108" tabindex="-1"></a>  real prior_mu<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb190-109"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-109" tabindex="-1"></a>  real prior_tau<span class="op">;</span></span>
<span id="cb190-110"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-110" tabindex="-1"></a>  </span>
<span id="cb190-111"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-111" tabindex="-1"></a>  </span>
<span id="cb190-112"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-112" tabindex="-1"></a>  </span>
<span id="cb190-113"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-113" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> maxiter<span class="op">;</span></span>
<span id="cb190-114"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-114" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span> <span class="co">// tolerance for the corrector step</span></span>
<span id="cb190-115"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-115" tabindex="-1"></a>  </span>
<span id="cb190-116"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-116" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> nSim<span class="op">;</span> <span class="co">// simulation size for Monte Carlo integration</span></span>
<span id="cb190-117"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-117" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=-</span><span class="fl">1.0</span><span class="op">,</span>upper<span class="op">=</span><span class="fl">1.0</span><span class="op">&gt;[</span>nSim<span class="op">]</span> deltaZ<span class="op">;</span> <span class="co">// standard normals truncated to be between -1 and 1</span></span>
<span id="cb190-118"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-118" tabindex="-1"></a>  </span>
<span id="cb190-119"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-119" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-120"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-120" tabindex="-1"></a></span>
<span id="cb190-121"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-121" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb190-122"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-122" tabindex="-1"></a>  <span class="co">// logit choice precision</span></span>
<span id="cb190-123"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-123" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb190-124"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-124" tabindex="-1"></a>  </span>
<span id="cb190-125"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-125" tabindex="-1"></a>  <span class="co">// Distribution of delta</span></span>
<span id="cb190-126"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-126" tabindex="-1"></a>  real mu<span class="op">;</span></span>
<span id="cb190-127"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-127" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tau<span class="op">;</span></span>
<span id="cb190-128"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-128" tabindex="-1"></a>  </span>
<span id="cb190-129"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-129" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower <span class="op">=</span> mu<span class="op">-</span>tau<span class="op">,</span>upper<span class="op">=</span>mu<span class="op">+</span>tau<span class="op">&gt;[</span>N<span class="op">]</span> gamma_i<span class="op">;</span></span>
<span id="cb190-130"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-130" tabindex="-1"></a>  </span>
<span id="cb190-131"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-131" tabindex="-1"></a>  </span>
<span id="cb190-132"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-132" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-133"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-133" tabindex="-1"></a></span>
<span id="cb190-134"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-134" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb190-135"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-135" tabindex="-1"></a>  </span>
<span id="cb190-136"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-136" tabindex="-1"></a>  </span>
<span id="cb190-137"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-137" tabindex="-1"></a>  </span>
<span id="cb190-138"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-138" tabindex="-1"></a>  vector<span class="op">[</span>nSim<span class="op">]</span> gammaSim <span class="op">=</span> mu<span class="op">+</span>tau<span class="op">*</span>deltaZ<span class="op">;</span></span>
<span id="cb190-139"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-139" tabindex="-1"></a>  </span>
<span id="cb190-140"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-140" tabindex="-1"></a>  vector<span class="op">[</span>nTreatments<span class="op">]</span> sigmaV<span class="op">;</span></span>
<span id="cb190-141"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-141" tabindex="-1"></a>  </span>
<span id="cb190-142"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-142" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt  in <span class="dv">1</span><span class="op">:</span>nTreatments<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-143"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-143" tabindex="-1"></a>    sigmaV<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> lpQRE<span class="op">(</span></span>
<span id="cb190-144"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-144" tabindex="-1"></a>    lambda<span class="op">,</span>gammaSim<span class="op">,</span></span>
<span id="cb190-145"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-145" tabindex="-1"></a>    V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>GroupSize<span class="op">[</span>tt<span class="op">],</span></span>
<span id="cb190-146"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-146" tabindex="-1"></a>    tol<span class="op">,</span>maxiter</span>
<span id="cb190-147"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-147" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb190-148"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-148" tabindex="-1"></a>  </span>
<span id="cb190-149"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-149" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-150"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-150" tabindex="-1"></a>  </span>
<span id="cb190-151"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-151" tabindex="-1"></a>  Volunteer <span class="op">~</span> binomial_logit<span class="op">(</span>count<span class="op">,</span>lambda<span class="op">*(</span></span>
<span id="cb190-152"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-152" tabindex="-1"></a>      V<span class="op">-</span>c<span class="op">-</span>gamma_i<span class="op">.*(</span><span class="fl">1.0</span><span class="op">-</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">[</span>GameID<span class="op">],</span>GroupSize<span class="op">[</span>GameID<span class="op">]-</span><span class="fl">1.0</span><span class="op">))-</span>V<span class="op">*(</span><span class="fl">1.0</span><span class="op">-</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">[</span>GameID<span class="op">],</span>GroupSize<span class="op">[</span>GameID<span class="op">]-</span><span class="fl">1.0</span><span class="op">))+</span>L<span class="op">*</span>pow<span class="op">(</span><span class="fl">1.0</span><span class="op">-</span>sigmaV<span class="op">[</span>GameID<span class="op">],</span>GroupSize<span class="op">[</span>GameID<span class="op">]-</span><span class="fl">1.0</span><span class="op">)</span></span>
<span id="cb190-153"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-153" tabindex="-1"></a>    <span class="op">));</span></span>
<span id="cb190-154"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-154" tabindex="-1"></a>  </span>
<span id="cb190-155"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-155" tabindex="-1"></a>  gamma_i <span class="op">~</span> normal<span class="op">(</span>mu<span class="op">,</span>tau<span class="op">);</span></span>
<span id="cb190-156"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-156" tabindex="-1"></a>  </span>
<span id="cb190-157"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-157" tabindex="-1"></a>  lambda <span class="op">~</span> lognormal<span class="op">(</span>prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-158"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-158" tabindex="-1"></a>  mu <span class="op">~</span> normal<span class="op">(</span>prior_mu<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mu<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-159"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-159" tabindex="-1"></a>  tau <span class="op">~</span> cauchy<span class="op">(</span><span class="dv">0</span><span class="op">,</span>prior_tau<span class="op">);</span></span>
<span id="cb190-160"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-160" tabindex="-1"></a>  </span>
<span id="cb190-161"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-161" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-162"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-162" tabindex="-1"></a></span>
<span id="cb190-163"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-163" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb190-164"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-164" tabindex="-1"></a>  </span>
<span id="cb190-165"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-165" tabindex="-1"></a>  </span>
<span id="cb190-166"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-166" tabindex="-1"></a>  vector<span class="op">[</span>nTreatments<span class="op">]</span> sigmaV<span class="op">;</span></span>
<span id="cb190-167"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-167" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb190-168"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-168" tabindex="-1"></a>  vector<span class="op">[</span>nSim<span class="op">]</span> gammaSim <span class="op">=</span> mu<span class="op">+</span>tau<span class="op">*</span>deltaZ<span class="op">;</span></span>
<span id="cb190-169"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-169" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt  in <span class="dv">1</span><span class="op">:</span>nTreatments<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-170"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-170" tabindex="-1"></a>    sigmaV<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> lpQRE<span class="op">(</span></span>
<span id="cb190-171"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-171" tabindex="-1"></a>    lambda<span class="op">,</span>gammaSim<span class="op">,</span></span>
<span id="cb190-172"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-172" tabindex="-1"></a>    V<span class="op">,</span>c<span class="op">,</span>L<span class="op">,</span>GroupSize<span class="op">[</span>tt<span class="op">],</span></span>
<span id="cb190-173"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-173" tabindex="-1"></a>    tol<span class="op">,</span>maxiter</span>
<span id="cb190-174"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-174" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb190-175"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-175" tabindex="-1"></a>  </span>
<span id="cb190-176"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-176" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-177"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-177" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-178"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-178" tabindex="-1"></a>  </span>
<span id="cb190-179"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb190-179" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="results-4" class="section level3 hasAnchor" number="15.2.4">
<h3><span class="header-section-number">15.2.4</span> Results<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-1" tabindex="-1"></a>RowNames<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">lambda$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">mu$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">tau$&quot;</span>,<span class="st">&quot;n = 2&quot;</span>, <span class="st">&quot;n = 3&quot;</span>, <span class="st">&quot;n = 6&quot;</span>,<span class="st">&quot;n = 9&quot;</span>, <span class="st">&quot;n = 12&quot;</span>,<span class="st">&quot;lp__&quot;</span>)</span>
<span id="cb191-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-2" tabindex="-1"></a></span>
<span id="cb191-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-3" tabindex="-1"></a>WarmGlow<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">readRDS</span>(<span class="st">&quot;Code/QRE2/Estimates_VDQREwarmglow.rds&quot;</span>))<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb191-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-4" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-5" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb191-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mean,sd)</span>
<span id="cb191-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-7" tabindex="-1"></a></span>
<span id="cb191-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-8" tabindex="-1"></a>DuplicateAversion<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="fu">readRDS</span>(<span class="st">&quot;Code/QRE2/Estimates_VDQREduplicateAversion.rds&quot;</span>))<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb191-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-9" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-10" tabindex="-1"></a>  <span class="fu">round</span>(<span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb191-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-11" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mean,sd)</span>
<span id="cb191-12"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-12" tabindex="-1"></a></span>
<span id="cb191-13"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-13" tabindex="-1"></a><span class="fu">rownames</span>(WarmGlow)<span class="ot">&lt;-</span>RowNames</span>
<span id="cb191-14"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-14" tabindex="-1"></a><span class="fu">rownames</span>(DuplicateAversion)<span class="ot">&lt;-</span>RowNames</span>
<span id="cb191-15"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-15" tabindex="-1"></a></span>
<span id="cb191-16"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb191-16" tabindex="-1"></a><span class="fu">cbind</span>(WarmGlow,DuplicateAversion)  <span class="sc">|&gt;</span> <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Posterior moments from the heterogeneous models. Rows with $n$ show predictions for the probability of volunteering for each group size&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span> <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Warm Glow&quot;</span><span class="ot">=</span><span class="dv">2</span>,<span class="st">&quot;Duplicate aversion&quot;</span><span class="ot">=</span><span class="dv">2</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:QRE2HeterogeneousTable">Table 15.3: </span>Posterior moments from the heterogeneous models. Rows with <span class="math inline">\(n\)</span> show predictions for the probability of volunteering for each group size
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Warm Glow
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Duplicate aversion
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda\)</span>
</td>
<td style="text-align:right;">
4.1356
</td>
<td style="text-align:right;">
1.1268
</td>
<td style="text-align:right;">
6.0312
</td>
<td style="text-align:right;">
1.5625
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mu\)</span>
</td>
<td style="text-align:right;">
-0.3643
</td>
<td style="text-align:right;">
0.0874
</td>
<td style="text-align:right;">
0.4723
</td>
<td style="text-align:right;">
0.1104
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\tau\)</span>
</td>
<td style="text-align:right;">
0.5456
</td>
<td style="text-align:right;">
0.3621
</td>
<td style="text-align:right;">
0.7411
</td>
<td style="text-align:right;">
0.1916
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 2
</td>
<td style="text-align:right;">
0.5236
</td>
<td style="text-align:right;">
0.0317
</td>
<td style="text-align:right;">
0.5619
</td>
<td style="text-align:right;">
0.0272
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 3
</td>
<td style="text-align:right;">
0.4098
</td>
<td style="text-align:right;">
0.0201
</td>
<td style="text-align:right;">
0.4099
</td>
<td style="text-align:right;">
0.0199
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 6
</td>
<td style="text-align:right;">
0.2814
</td>
<td style="text-align:right;">
0.0162
</td>
<td style="text-align:right;">
0.2552
</td>
<td style="text-align:right;">
0.0173
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 9
</td>
<td style="text-align:right;">
0.2315
</td>
<td style="text-align:right;">
0.0186
</td>
<td style="text-align:right;">
0.1987
</td>
<td style="text-align:right;">
0.0186
</td>
</tr>
<tr>
<td style="text-align:left;">
n = 12
</td>
<td style="text-align:right;">
0.2048
</td>
<td style="text-align:right;">
0.0211
</td>
<td style="text-align:right;">
0.1683
</td>
<td style="text-align:right;">
0.0201
</td>
</tr>
<tr>
<td style="text-align:left;">
lp__
</td>
<td style="text-align:right;">
-2187.5674
</td>
<td style="text-align:right;">
254.7857
</td>
<td style="text-align:right;">
-2049.4131
</td>
<td style="text-align:right;">
16.4658
</td>
</tr>
</tbody>
</table>
<p>Table <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#tab:QRE2HeterogeneousTable">15.3</a> shows the posterior estimates of the two heterogeneous-participants quantal response equilibrium models. These can be compared to the middle two panels of Table 5 of <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>. While the models’ fundamental parameters <span class="math inline">\(\lambda\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\tau\)</span> are noticeably different, the predictions for <span class="math inline">\(\bar\sigma_V\)</span> for each group size are in agreement to within a couple of percentage points.</p>
</div>
</div>
<div id="r-code-to-run-estimations" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> <em>R</em> code to run estimations<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-1" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb192-2"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-2" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb192-3"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-3" tabindex="-1"></a><span class="fu">library</span>(mnorm)</span>
<span id="cb192-4"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-4" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb192-5"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-5" tabindex="-1"></a>  <span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-6"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-6" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb192-7"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-7" tabindex="-1"></a>  <span class="fu">rstan_options</span>(<span class="at">threads_per_chain =</span> <span class="dv">1</span>)</span>
<span id="cb192-8"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-8" tabindex="-1"></a>  </span>
<span id="cb192-9"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-9" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;Data/GHS2017VD.csv&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb192-10"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-10" tabindex="-1"></a>    <span class="co"># This dataset does not explicitly store the group size</span></span>
<span id="cb192-11"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-11" tabindex="-1"></a>    <span class="co"># I can infer it from the &quot;Other.Id.&quot; variable, but</span></span>
<span id="cb192-12"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-12" tabindex="-1"></a>    <span class="co"># this is not consistent with the experiment description</span></span>
<span id="cb192-13"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-13" tabindex="-1"></a>    <span class="co"># in the &quot;Procedures&quot; section of the paper. Specifically,</span></span>
<span id="cb192-14"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-14" tabindex="-1"></a>    <span class="co"># it looked like there were two GroupSize=7 session, when</span></span>
<span id="cb192-15"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-15" tabindex="-1"></a>    <span class="co"># in reality there should have been one with 9, and one</span></span>
<span id="cb192-16"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-16" tabindex="-1"></a>    <span class="co"># with 12. This fixes things</span></span>
<span id="cb192-17"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-17" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">GroupSize =</span> <span class="fu">str_count</span>(Other.Id., <span class="st">&quot;ID&quot;</span>)<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb192-18"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-18" tabindex="-1"></a>           <span class="at">GroupSize =</span> <span class="fu">ifelse</span>(SessionID<span class="sc">==</span><span class="dv">10</span>,<span class="dv">9</span>,GroupSize),</span>
<span id="cb192-19"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-19" tabindex="-1"></a>           <span class="at">GroupSize =</span> <span class="fu">ifelse</span>(SessionID<span class="sc">==</span><span class="dv">11</span>,<span class="dv">12</span>,GroupSize)</span>
<span id="cb192-20"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-20" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb192-21"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-21" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">Volunteer =</span> Decision..<span class="fl">1.</span>vol..) <span class="sc">|&gt;</span></span>
<span id="cb192-22"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-22" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ID =</span> <span class="fu">paste0</span>(SessionID,<span class="st">&quot;-&quot;</span>,ID) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>() ) <span class="sc">|&gt;</span></span>
<span id="cb192-23"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-23" tabindex="-1"></a>    <span class="fu">select</span>(ID,GroupSize,Volunteer) <span class="sc">|&gt;</span></span>
<span id="cb192-24"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-24" tabindex="-1"></a>    <span class="co"># all I need are the counts of actions for each participant:</span></span>
<span id="cb192-25"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-25" tabindex="-1"></a>    <span class="fu">group_by</span>(ID,GroupSize) <span class="sc">|&gt;</span></span>
<span id="cb192-26"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-26" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Volunteer =</span> <span class="fu">sum</span>(Volunteer),<span class="at">count=</span><span class="fu">n</span>())</span>
<span id="cb192-27"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-27" tabindex="-1"></a>  </span>
<span id="cb192-28"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-28" tabindex="-1"></a><span class="do">######################################################</span></span>
<span id="cb192-29"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-29" tabindex="-1"></a><span class="co"># Homogeneous model</span></span>
<span id="cb192-30"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-30" tabindex="-1"></a><span class="do">######################################################</span></span>
<span id="cb192-31"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-31" tabindex="-1"></a></span>
<span id="cb192-32"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-32" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/QRE2/Estimates_VDQREhomogeneous.rds&quot;</span></span>
<span id="cb192-33"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-33" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file)) {</span>
<span id="cb192-34"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-34" tabindex="-1"></a>  model<span class="ot">&lt;-</span><span class="fu">stan_model</span>(<span class="st">&quot;Code/QRE2/VDQREhomogeneous.stan&quot;</span>)</span>
<span id="cb192-35"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-35" tabindex="-1"></a>  </span>
<span id="cb192-36"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-36" tabindex="-1"></a>  d<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span></span>
<span id="cb192-37"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-37" tabindex="-1"></a>    <span class="fu">group_by</span>(GroupSize) <span class="sc">|&gt;</span></span>
<span id="cb192-38"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-38" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Volunteer =</span> <span class="fu">sum</span>(Volunteer),</span>
<span id="cb192-39"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-39" tabindex="-1"></a>              <span class="at">count =</span> <span class="fu">sum</span>(count))</span>
<span id="cb192-40"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-40" tabindex="-1"></a>  </span>
<span id="cb192-41"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-41" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb192-42"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-42" tabindex="-1"></a>    <span class="at">N=</span><span class="fu">dim</span>(d)[<span class="dv">1</span>],</span>
<span id="cb192-43"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-43" tabindex="-1"></a>    <span class="at">Volunteer =</span> d<span class="sc">$</span>Volunteer,</span>
<span id="cb192-44"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-44" tabindex="-1"></a>    <span class="at">count =</span> d<span class="sc">$</span>count,</span>
<span id="cb192-45"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-45" tabindex="-1"></a>    <span class="at">GroupSize =</span> d<span class="sc">$</span>GroupSize,</span>
<span id="cb192-46"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-46" tabindex="-1"></a>    <span class="at">V =</span> <span class="fl">1.0</span>,</span>
<span id="cb192-47"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-47" tabindex="-1"></a>    <span class="at">c =</span> <span class="fl">0.2</span>,</span>
<span id="cb192-48"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-48" tabindex="-1"></a>    <span class="at">L =</span> <span class="fl">0.2</span>,</span>
<span id="cb192-49"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-49" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">5</span>),<span class="dv">1</span>),</span>
<span id="cb192-50"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-50" tabindex="-1"></a>    </span>
<span id="cb192-51"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-51" tabindex="-1"></a>    <span class="at">first_step =</span> <span class="fl">0.1</span>,</span>
<span id="cb192-52"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-52" tabindex="-1"></a>    <span class="at">min_step =</span> <span class="fl">1e-4</span>,</span>
<span id="cb192-53"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-53" tabindex="-1"></a>    <span class="at">max_decel =</span> <span class="fl">1.1</span>,</span>
<span id="cb192-54"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-54" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">1000</span>,</span>
<span id="cb192-55"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-55" tabindex="-1"></a>    <span class="at">tol =</span> <span class="fl">1e-4</span></span>
<span id="cb192-56"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-56" tabindex="-1"></a>  )</span>
<span id="cb192-57"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-57" tabindex="-1"></a>  </span>
<span id="cb192-58"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-58" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span></span>
<span id="cb192-59"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-59" tabindex="-1"></a>                  )</span>
<span id="cb192-60"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-60" tabindex="-1"></a>  Fit <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(file)</span>
<span id="cb192-61"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-61" tabindex="-1"></a>}</span>
<span id="cb192-62"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-62" tabindex="-1"></a></span>
<span id="cb192-63"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-63" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb192-64"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-64" tabindex="-1"></a><span class="co"># Warm glow volunteering heterogeneous model</span></span>
<span id="cb192-65"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-65" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb192-66"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-66" tabindex="-1"></a></span>
<span id="cb192-67"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-67" tabindex="-1"></a></span>
<span id="cb192-68"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-68" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/QRE2/Estimates_VDQREwarmglow.rds&quot;</span></span>
<span id="cb192-69"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-69" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file)) {</span>
<span id="cb192-70"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-70" tabindex="-1"></a>  model<span class="ot">&lt;-</span><span class="fu">stan_model</span>(<span class="st">&quot;Code/QRE2/VDQREwarmglow.stan&quot;</span>)</span>
<span id="cb192-71"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-71" tabindex="-1"></a>  <span class="co">#stop()</span></span>
<span id="cb192-72"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-72" tabindex="-1"></a>  </span>
<span id="cb192-73"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-73" tabindex="-1"></a>  D<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span></span>
<span id="cb192-74"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-74" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb192-75"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-75" tabindex="-1"></a>      <span class="at">GameID =</span> <span class="fu">ifelse</span>(</span>
<span id="cb192-76"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-76" tabindex="-1"></a>        GroupSize<span class="sc">==</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-77"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-77" tabindex="-1"></a>          GroupSize<span class="sc">==</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-78"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-78" tabindex="-1"></a>            GroupSize<span class="sc">==</span><span class="dv">6</span>,<span class="dv">3</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-79"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-79" tabindex="-1"></a>              GroupSize<span class="sc">==</span><span class="dv">9</span>,<span class="dv">4</span>,<span class="dv">5</span></span>
<span id="cb192-80"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-80" tabindex="-1"></a>            )</span>
<span id="cb192-81"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-81" tabindex="-1"></a>          )</span>
<span id="cb192-82"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-82" tabindex="-1"></a>        )</span>
<span id="cb192-83"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-83" tabindex="-1"></a>      )</span>
<span id="cb192-84"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-84" tabindex="-1"></a>    )</span>
<span id="cb192-85"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-85" tabindex="-1"></a>  </span>
<span id="cb192-86"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-86" tabindex="-1"></a>  </span>
<span id="cb192-87"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-87" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb192-88"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-88" tabindex="-1"></a>    <span class="at">N=</span><span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb192-89"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-89" tabindex="-1"></a>    <span class="at">Volunteer =</span> D<span class="sc">$</span>Volunteer,</span>
<span id="cb192-90"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-90" tabindex="-1"></a>    <span class="at">count =</span> D<span class="sc">$</span>count,</span>
<span id="cb192-91"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-91" tabindex="-1"></a>    </span>
<span id="cb192-92"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-92" tabindex="-1"></a>    <span class="at">nTreatments =</span> <span class="dv">5</span>,</span>
<span id="cb192-93"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-93" tabindex="-1"></a>    <span class="at">GroupSize =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">12</span>),</span>
<span id="cb192-94"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-94" tabindex="-1"></a>    </span>
<span id="cb192-95"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-95" tabindex="-1"></a>    <span class="at">GameID =</span> D<span class="sc">$</span>GameID,</span>
<span id="cb192-96"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-96" tabindex="-1"></a>    </span>
<span id="cb192-97"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-97" tabindex="-1"></a>    <span class="at">V =</span> <span class="fl">1.0</span>,</span>
<span id="cb192-98"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-98" tabindex="-1"></a>    <span class="at">c =</span> <span class="fl">0.2</span>,</span>
<span id="cb192-99"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-99" tabindex="-1"></a>    <span class="at">L =</span> <span class="fl">0.2</span>,</span>
<span id="cb192-100"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-100" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">5</span>),<span class="dv">1</span>),</span>
<span id="cb192-101"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-101" tabindex="-1"></a>    <span class="at">prior_mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb192-102"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-102" tabindex="-1"></a>    <span class="at">prior_tau =</span> <span class="fl">0.05</span>,</span>
<span id="cb192-103"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-103" tabindex="-1"></a>    </span>
<span id="cb192-104"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-104" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">1000</span>,</span>
<span id="cb192-105"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-105" tabindex="-1"></a>    <span class="at">tol =</span> <span class="fl">1e-4</span>,</span>
<span id="cb192-106"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-106" tabindex="-1"></a>    </span>
<span id="cb192-107"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-107" tabindex="-1"></a>    <span class="at">nSim =</span> <span class="dv">100</span>,</span>
<span id="cb192-108"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-108" tabindex="-1"></a>    <span class="co"># This gets me Halton draws, transformed to be from the</span></span>
<span id="cb192-109"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-109" tabindex="-1"></a>    <span class="co"># standard normal, truncated to lie between -1 and 1</span></span>
<span id="cb192-110"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-110" tabindex="-1"></a>    <span class="at">deltaZ =</span> (<span class="fu">pnorm</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="fu">halton</span>(<span class="dv">100</span>)<span class="sc">*</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="dv">1</span>))) <span class="sc">|&gt;</span> <span class="fu">qnorm</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb192-111"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-111" tabindex="-1"></a>  )</span>
<span id="cb192-112"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-112" tabindex="-1"></a>  </span>
<span id="cb192-113"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-113" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb192-114"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-114" tabindex="-1"></a>                <span class="at">control=</span><span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.8</span>,<span class="at">max_treedepth=</span><span class="dv">15</span>),</span>
<span id="cb192-115"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-115" tabindex="-1"></a>                <span class="at">pars =</span> <span class="st">&quot;delta_i&quot;</span>,<span class="at">include=</span><span class="cn">FALSE</span></span>
<span id="cb192-116"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-116" tabindex="-1"></a>  )</span>
<span id="cb192-117"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-117" tabindex="-1"></a>  Fit <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(file)</span>
<span id="cb192-118"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-118" tabindex="-1"></a>}</span>
<span id="cb192-119"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-119" tabindex="-1"></a></span>
<span id="cb192-120"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-120" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb192-121"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-121" tabindex="-1"></a><span class="co"># Duplicate aversion heterogeneous model</span></span>
<span id="cb192-122"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-122" tabindex="-1"></a><span class="do">#############################################</span></span>
<span id="cb192-123"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-123" tabindex="-1"></a></span>
<span id="cb192-124"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-124" tabindex="-1"></a></span>
<span id="cb192-125"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-125" tabindex="-1"></a></span>
<span id="cb192-126"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-126" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/QRE2/Estimates_VDQREduplicateaversion.rds&quot;</span></span>
<span id="cb192-127"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-127" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file)) {</span>
<span id="cb192-128"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-128" tabindex="-1"></a>  model<span class="ot">&lt;-</span><span class="fu">stan_model</span>(<span class="st">&quot;Code/QRE2/VDQREduplicateaversion.stan&quot;</span>)</span>
<span id="cb192-129"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-129" tabindex="-1"></a>  <span class="co">#stop()</span></span>
<span id="cb192-130"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-130" tabindex="-1"></a>  </span>
<span id="cb192-131"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-131" tabindex="-1"></a>  D<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span></span>
<span id="cb192-132"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-132" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb192-133"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-133" tabindex="-1"></a>      <span class="at">GameID =</span> <span class="fu">ifelse</span>(</span>
<span id="cb192-134"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-134" tabindex="-1"></a>        GroupSize<span class="sc">==</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-135"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-135" tabindex="-1"></a>          GroupSize<span class="sc">==</span><span class="dv">3</span>,<span class="dv">2</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-136"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-136" tabindex="-1"></a>            GroupSize<span class="sc">==</span><span class="dv">6</span>,<span class="dv">3</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-137"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-137" tabindex="-1"></a>              GroupSize<span class="sc">==</span><span class="dv">9</span>,<span class="dv">4</span>,<span class="dv">5</span></span>
<span id="cb192-138"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-138" tabindex="-1"></a>            )</span>
<span id="cb192-139"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-139" tabindex="-1"></a>          )</span>
<span id="cb192-140"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-140" tabindex="-1"></a>        )</span>
<span id="cb192-141"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-141" tabindex="-1"></a>      )</span>
<span id="cb192-142"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-142" tabindex="-1"></a>    )</span>
<span id="cb192-143"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-143" tabindex="-1"></a>  </span>
<span id="cb192-144"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-144" tabindex="-1"></a>  </span>
<span id="cb192-145"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-145" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb192-146"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-146" tabindex="-1"></a>    <span class="at">N=</span><span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb192-147"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-147" tabindex="-1"></a>    <span class="at">Volunteer =</span> D<span class="sc">$</span>Volunteer,</span>
<span id="cb192-148"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-148" tabindex="-1"></a>    <span class="at">count =</span> D<span class="sc">$</span>count,</span>
<span id="cb192-149"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-149" tabindex="-1"></a>    </span>
<span id="cb192-150"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-150" tabindex="-1"></a>    <span class="at">nTreatments =</span> <span class="dv">5</span>,</span>
<span id="cb192-151"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-151" tabindex="-1"></a>    <span class="at">GroupSize =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">9</span>,<span class="dv">12</span>),</span>
<span id="cb192-152"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-152" tabindex="-1"></a>    </span>
<span id="cb192-153"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-153" tabindex="-1"></a>    <span class="at">GameID =</span> D<span class="sc">$</span>GameID,</span>
<span id="cb192-154"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-154" tabindex="-1"></a>    </span>
<span id="cb192-155"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-155" tabindex="-1"></a>    <span class="at">V =</span> <span class="fl">1.0</span>,</span>
<span id="cb192-156"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-156" tabindex="-1"></a>    <span class="at">c =</span> <span class="fl">0.2</span>,</span>
<span id="cb192-157"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-157" tabindex="-1"></a>    <span class="at">L =</span> <span class="fl">0.2</span>,</span>
<span id="cb192-158"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-158" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">5</span>),<span class="dv">1</span>),</span>
<span id="cb192-159"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-159" tabindex="-1"></a>    <span class="at">prior_mu =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb192-160"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-160" tabindex="-1"></a>    <span class="at">prior_tau =</span> <span class="fl">0.05</span>,</span>
<span id="cb192-161"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-161" tabindex="-1"></a>    </span>
<span id="cb192-162"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-162" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">1000</span>,</span>
<span id="cb192-163"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-163" tabindex="-1"></a>    <span class="at">tol =</span> <span class="fl">1e-4</span>,</span>
<span id="cb192-164"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-164" tabindex="-1"></a>    </span>
<span id="cb192-165"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-165" tabindex="-1"></a>    <span class="at">nSim =</span> <span class="dv">100</span>,</span>
<span id="cb192-166"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-166" tabindex="-1"></a>    <span class="co"># This gets me Halton draws, transformed to be from the</span></span>
<span id="cb192-167"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-167" tabindex="-1"></a>    <span class="co"># standard normal, truncated to lie between -1 and 1</span></span>
<span id="cb192-168"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-168" tabindex="-1"></a>    <span class="at">deltaZ =</span> (<span class="fu">pnorm</span>(<span class="dv">1</span>)<span class="sc">+</span><span class="fu">halton</span>(<span class="dv">100</span>)<span class="sc">*</span>(<span class="dv">1-2</span><span class="sc">*</span><span class="fu">pnorm</span>(<span class="dv">1</span>))) <span class="sc">|&gt;</span> <span class="fu">qnorm</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb192-169"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-169" tabindex="-1"></a>  )</span>
<span id="cb192-170"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-170" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb192-171"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-171" tabindex="-1"></a>                <span class="at">control=</span><span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.8</span>,<span class="at">max_treedepth=</span><span class="dv">15</span>),</span>
<span id="cb192-172"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-172" tabindex="-1"></a>                <span class="at">pars =</span> <span class="st">&quot;gamma_i&quot;</span>,<span class="at">include=</span><span class="cn">FALSE</span></span>
<span id="cb192-173"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-173" tabindex="-1"></a>  )</span>
<span id="cb192-174"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-174" tabindex="-1"></a>  Fit <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(file) </span>
<span id="cb192-175"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-175" tabindex="-1"></a>    </span>
<span id="cb192-176"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-176" tabindex="-1"></a>  </span>
<span id="cb192-177"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-177" tabindex="-1"></a> </span>
<span id="cb192-178"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#cb192-178" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bland2023QRE" class="csl-entry">
———. 2023a. <span>“Bayesian Inference for Quantal Response Equilibrium in Normal-Form Games.”</span> <em>Games and Economic Behavior</em>. https://doi.org/<a href="https://doi.org/10.1016/j.geb.2023.05.005">https://doi.org/10.1016/j.geb.2023.05.005</a>.
</div>
<div id="ref-Goeree2002" class="csl-entry">
Goeree, Jacob K, Charles A Holt, and Susan K Laury. 2002. <span>“Private Costs and Public Benefits: Unraveling the Effects of Altruism and Noisy Behavior.”</span> <em>Journal of Public Economics</em> 83 (2): 255–76.
</div>
<div id="ref-Goeree2017" class="csl-entry">
Goeree, Jacob K, Charles A Holt, and Angela M Smith. 2017. <span>“An Experimental Examination of the Volunteer’s Dilemma.”</span> <em>Games and Economic Behavior</em> 102: 303–15.
</div>
<div id="ref-Holt2022" class="csl-entry">
Holt, Charles A, Ricky Sahu, and Angela M Smith. 2022. <span>“An Experimental Analysis of Risk Effects in Attacker-Defender Games.”</span> <em>Southern Economic Journal</em> 89 (1): 185–215.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="67">
<li id="fn67"><p>For some games, these constant-<span class="math inline">\(\lambda\)</span> corrector steps may be sufficient on their own to solve for the quantal response equilibrium. For example, in <span class="citation">Bland (<a href="#ref-Bland2023QRE">2023a</a>)</span> I find that corrector steps starting at the centroid are just fine for computing equilibrium in some generalized matching pennies games. <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#fnref67" class="footnote-back">↩︎</a></p></li>
<li id="fn68"><p>You can see some standard errors on predicted QRE probabilities in <span class="citation">Holt, Sahu, and Smith (<a href="#ref-Holt2022">2022</a>)</span> using the delta method. See their Table 6 and footnote 10.<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#fnref68" class="footnote-back">↩︎</a></p></li>
<li id="fn69"><p>An earlier attempt at using the un-truncated version of the normal distribution resulted in a host of errors from <em>Stan</em>, mainly the <code>BFMI low</code> error. I suspect that when using this distribution, the likelihood is having trouble with extreme values of <span class="math inline">\(\theta_i\)</span> in the data augmentation part of the model. <a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#fnref69" class="footnote-back">↩︎</a></p></li>
<li id="fn70"><p>This discretization is also used in <span class="citation">Goeree, Holt, and Laury (<a href="#ref-Goeree2002">2002</a>)</span>.<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#fnref70" class="footnote-back">↩︎</a></p></li>
<li id="fn71"><p>Here I am using the following result for the derivative of the inverse logit function <span class="math inline">\(\Lambda&#39;(x)=\Lambda(x)(1-\Lambda(x))\)</span><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#fnref71" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="computing-quantal-response-equilibrium.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-a-quantal-response-equilibrium-with-discrete-types.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
