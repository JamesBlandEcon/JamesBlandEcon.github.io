<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 More filling in the blanks: data augmentation | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="9 More filling in the blanks: data augmentation | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="9 More filling in the blanks: data augmentation | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 More filling in the blanks: data augmentation | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2026-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="filling-in-the-blanks-imputation.html"/>
<link rel="next" href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html"><i class="fa fa-check"></i><b>8</b> Filling in the blanks: Imputation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#example-model-and-dataset-yet-again-with-bfs2019"><i class="fa fa-check"></i><b>8.1</b> Example model and dataset: yet again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a></li>
<li class="chapter" data-level="8.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#how-is-this-going-to-work"><i class="fa fa-check"></i><b>8.2</b> How is this going to work?</a></li>
<li class="chapter" data-level="8.3" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#implementation"><i class="fa fa-check"></i><b>8.3</b> Implementation</a></li>
<li class="chapter" data-level="8.4" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#results"><i class="fa fa-check"></i><b>8.4</b> Results</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#using-the-correlation-matrix"><i class="fa fa-check"></i><b>8.4.1</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="8.4.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#the-correlation-matrix-is-doing-a-lot-of-heavy-lifting-here"><i class="fa fa-check"></i><b>8.4.2</b> The correlation matrix is doing a lot of heavy lifting here</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#conclusion"><i class="fa fa-check"></i><b>8.5</b> Conclusion</a></li>
<li class="chapter" data-level="8.6" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#r-code-used-for-this-chapter-1"><i class="fa fa-check"></i><b>8.6</b> <em>R</em> code used for this chapter</a></li>
<li class="chapter" data-level="" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#acknowedgements"><i class="fa fa-check"></i>Acknowedgements</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html"><i class="fa fa-check"></i><b>9</b> More filling in the blanks: data augmentation</a>
<ul>
<li class="chapter" data-level="9.1" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#example-1-two-ways-to-estimate-a-probit-model"><i class="fa fa-check"></i><b>9.1</b> Example 1: two ways to estimate a probit model</a></li>
<li class="chapter" data-level="9.2" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#example-2-accounting-for-rounded-answers"><i class="fa fa-check"></i><b>9.2</b> Example 2: accounting for rounded answers</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#the-hs2016-task"><i class="fa fa-check"></i><b>9.2.1</b> The <span class="citation">Holt and Smith (2016)</span> task</a></li>
<li class="chapter" data-level="9.2.2" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#a-model-for-behavior-in-hs2016"><i class="fa fa-check"></i><b>9.2.2</b> A model for behavior in <span class="citation">Holt and Smith (2016)</span></a></li>
<li class="chapter" data-level="9.2.3" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#a-note-on-replication"><i class="fa fa-check"></i><b>9.2.3</b> A note on replication</a></li>
<li class="chapter" data-level="9.2.4" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#augmenting-the-data"><i class="fa fa-check"></i><b>9.2.4</b> Augmenting the data</a></li>
<li class="chapter" data-level="9.2.5" data-path="more-filling-in-the-blanks-data-augmentation.html"><a href="more-filling-in-the-blanks-data-augmentation.html#results-1"><i class="fa fa-check"></i><b>9.2.5</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><i class="fa fa-check"></i><b>10</b> Using your structural estimates as explanatory variables in regression models</a>
<ul>
<li class="chapter" data-level="10.1" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1-a-probit-model-with-risk-preferences-measured-by-holt2002."><i class="fa fa-check"></i><b>10.1</b> Example 1: a probit model with risk preferences measured by <span class="citation">Holt and Laury (2002)</span>.</a></li>
<li class="chapter" data-level="10.2" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2-a-random-effects-logit-model-with-risk-and-time-preferences."><i class="fa fa-check"></i><b>10.2</b> Example 2: A random effects logit model with risk and time preferences.</a></li>
<li class="chapter" data-level="10.3" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3-logit-and-ordered-logit-with-risk-preferences-from-gneezy1997"><i class="fa fa-check"></i><b>10.3</b> Example 3: Logit and ordered logit with risk preferences from <span class="citation">Gneezy and Potters (1997)</span></a></li>
<li class="chapter" data-level="10.4" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#a-note-of-caution"><i class="fa fa-check"></i><b>10.4</b> A note of caution</a></li>
<li class="chapter" data-level="10.5" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#conclusion-1"><i class="fa fa-check"></i><b>10.5</b> Conclusion</a></li>
<li class="chapter" data-level="10.6" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#r-code-used-for-this-chapter-2"><i class="fa fa-check"></i><b>10.6</b> <em>R</em> code used for this chapter</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1"><i class="fa fa-check"></i><b>10.6.1</b> Example 1</a></li>
<li class="chapter" data-level="10.6.2" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2"><i class="fa fa-check"></i><b>10.6.2</b> Example 2</a></li>
<li class="chapter" data-level="10.6.3" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3"><i class="fa fa-check"></i><b>10.6.3</b> Example 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>11</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model-evaluation.html"><a href="model-evaluation.html#example-dataset-and-models"><i class="fa fa-check"></i><b>11.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="11.2" data-path="model-evaluation.html"><a href="model-evaluation.html#model-posterior-probabilities"><i class="fa fa-check"></i><b>11.2</b> Model posterior probabilities</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model-evaluation.html"><a href="model-evaluation.html#implementation-using-bridge-sampling-and-the-bridgesampling-library"><i class="fa fa-check"></i><b>11.2.1</b> Implementation using bridge sampling and the <code>bridgesampling</code> library</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model-evaluation.html"><a href="model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>11.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="model-evaluation.html"><a href="model-evaluation.html#expected-log-predicted-density-elpd-and-other-measures-of-goodness-of-fit"><i class="fa fa-check"></i><b>11.3.1</b> Expected Log Predicted Density (ELPD) and other measures of goodness of fit</a></li>
<li class="chapter" data-level="11.3.2" data-path="model-evaluation.html"><a href="model-evaluation.html#round-cross-validation"><i class="fa fa-check"></i><b>11.3.2</b> 1-round cross-validation</a></li>
<li class="chapter" data-level="11.3.3" data-path="model-evaluation.html"><a href="model-evaluation.html#leave-one-out-cross-validation-loo"><i class="fa fa-check"></i><b>11.3.3</b> Leave-one-out cross-validation (LOO)</a></li>
<li class="chapter" data-level="11.3.4" data-path="model-evaluation.html"><a href="model-evaluation.html#approximate-loo"><i class="fa fa-check"></i><b>11.3.4</b> Approximate LOO</a></li>
<li class="chapter" data-level="11.3.5" data-path="model-evaluation.html"><a href="model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>11.3.5</b> <span class="math inline">\(k\)</span>-fold cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>12</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="12.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>12.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="12.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>12.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="12.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>12.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="12.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>12.4</b> Vectorization</a></li>
<li class="chapter" data-level="12.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>12.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="12.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>12.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>12.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="12.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>12.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>12.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>12.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="12.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>12.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="13" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>13</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>13.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="13.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>13.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="13.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>13.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>13.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="13.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>13.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="13.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-2"><i class="fa fa-check"></i><b>13.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>13.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>13.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="13.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>13.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="13.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-3"><i class="fa fa-check"></i><b>13.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>13.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="13.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>13.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="13.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>13.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="13.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>13.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>14</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>14.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="14.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>14.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>14.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="14.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>14.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>14.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>15</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>15.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="15.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>15.2</b> The likelihood function</a></li>
<li class="chapter" data-level="15.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>15.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="15.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-4"><i class="fa fa-check"></i><b>15.4</b> Results</a></li>
<li class="chapter" data-level="15.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>15.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>16</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="16.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>16.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="16.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>16.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>16.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="16.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>16.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="16.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>16.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="16.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>16.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>16.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="16.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>16.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>16.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="16.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>16.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="16.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>16.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>17</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>17.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="17.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>17.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>17.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="17.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>17.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="17.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>17.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="17.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-5"><i class="fa fa-check"></i><b>17.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>17.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>18</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1"><i class="fa fa-check"></i><b>18.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="18.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication-1"><i class="fa fa-check"></i><b>18.2</b> A note on replication</a></li>
<li class="chapter" data-level="18.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>18.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>18.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="18.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>18.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="18.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>18.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-6"><i class="fa fa-check"></i><b>18.4</b> Results</a></li>
<li class="chapter" data-level="18.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>18.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><i class="fa fa-check"></i><b>19</b> Application: QRE in a Bayesian game and cursed equilibrium</a>
<ul>
<li class="chapter" data-level="19.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#example-game-and-dataset"><i class="fa fa-check"></i><b>19.1</b> Example game and dataset</a></li>
<li class="chapter" data-level="19.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#solving-for-qre"><i class="fa fa-check"></i><b>19.2</b> Solving for QRE</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#baseline-model"><i class="fa fa-check"></i><b>19.2.1</b> Baseline model</a></li>
<li class="chapter" data-level="19.2.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cursed-equilibrium"><i class="fa fa-check"></i><b>19.2.2</b> Cursed equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#a-quick-prior-calibration-1"><i class="fa fa-check"></i><b>19.3</b> A quick prior calibration</a></li>
<li class="chapter" data-level="19.4" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-results"><i class="fa fa-check"></i><b>19.4</b> Model results</a></li>
<li class="chapter" data-level="19.5" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-evaluation-1"><i class="fa fa-check"></i><b>19.5</b> Model evaluation</a></li>
<li class="chapter" data-level="19.6" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#r-code-used-in-this-chapter"><i class="fa fa-check"></i><b>19.6</b> <em>R</em> code used in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>20</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="20.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>20.1</b> Data and game</a></li>
<li class="chapter" data-level="20.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>20.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="20.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>20.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="20.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>20.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="20.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>20.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>20.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="20.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>20.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="20.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>20.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>20.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>20.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="20.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>20.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>20.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>20.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="20.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>20.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="20.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>20.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>20.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="20.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>20.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="20.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>20.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="20.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-10"><i class="fa fa-check"></i><b>20.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="20.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>20.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="20.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>20.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="20.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-11"><i class="fa fa-check"></i><b>20.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="20.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>20.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="20.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>20.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="20.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>20.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="20.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>20.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="20.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>20.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="20.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>20.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="21" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>21</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="21.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>21.1</b> Example dataset</a></li>
<li class="chapter" data-level="21.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>21.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="21.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>21.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="21.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>21.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="21.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>21.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="21.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>21.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="21.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>21.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="21.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>21.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="21.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>21.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="21.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>21.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>22</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="22.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>22.1</b> Data</a></li>
<li class="chapter" data-level="22.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>22.2</b> A basic model</a></li>
<li class="chapter" data-level="22.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>22.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="22.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>22.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="22.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>22.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="22.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>22.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html"><i class="fa fa-check"></i><b>23</b> Application: choice bracketing</a>
<ul>
<li class="chapter" data-level="23.1" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#data-and-model"><i class="fa fa-check"></i><b>23.1</b> Data and model</a></li>
<li class="chapter" data-level="23.2" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#representative-agent-and-individual-estimation"><i class="fa fa-check"></i><b>23.2</b> Representative agent and individual estimation</a></li>
<li class="chapter" data-level="23.3" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#hierarchical-model-2"><i class="fa fa-check"></i><b>23.3</b> Hierarchical model</a></li>
<li class="chapter" data-level="23.4" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#a-mixture-model-1"><i class="fa fa-check"></i><b>23.4</b> A mixture model</a></li>
<li class="chapter" data-level="23.5" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#what-do-we-get-out-of-the-structural-models-and-what-could-we-miss"><i class="fa fa-check"></i><b>23.5</b> What do we get out of the structural models, and what could we miss?</a></li>
</ul></li>
<li class="chapter" data-level="24" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>24</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="24.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>24.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="24.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>24.2</b> Computational issues</a></li>
<li class="chapter" data-level="24.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>24.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="24.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>24.4</b> A representative agent model</a></li>
<li class="chapter" data-level="24.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>24.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="24.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>24.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="more-filling-in-the-blanks-data-augmentation" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> More filling in the blanks: data augmentation<a href="more-filling-in-the-blanks-data-augmentation.html#more-filling-in-the-blanks-data-augmentation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Sometimes in Bayesian computation, we can benefit from a technique called <em>data augmentation</em>. Here, we recognize that we can represent our model as a function of some latent variables, and estimate these latent variables alongside the parameters of interest.
In fact, we have been doing this already in our hierarchical models. Here the latent variables are the individual-level parameters (which I usually denote <span class="math inline">\(\{\theta_i\}_{i=1}^N\)</span> unless there is any other context for them), and we estimate these alongside the population-level parameters of our model. If we are estimating a hierarchical model, then we might actually be interested in these parameters. After all, in our structural models they often represent the parameters of interest if we want to make inference about the individual. On the other hand, there may be other situations where we can find a representation of our data-generating process that includes latent “nuisance” parameters that we don’t directly care about, but aid in the estimation process.</p>
<div id="example-1-two-ways-to-estimate-a-probit-model" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Example 1: two ways to estimate a probit model<a href="more-filling-in-the-blanks-data-augmentation.html#example-1-two-ways-to-estimate-a-probit-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To fix ideas, consider estimating a simple probit model, which we can write as:</p>
<p><span class="math display">\[
\begin{aligned}
y&amp;\sim \mathrm{Bernoulli}\Phi(X\beta) &amp; \quad \text{(likelihood)}\\
\beta_k &amp;\sim N(m_k,s_k^2)&amp;\quad\text{(prior)}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Phi(\cdot)\)</span> is the standard normal cdf. While I <em>have</em> been trained in the classic Bayesian arts,<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a> this is how I mostly think of a probit. For me, this is because it directly encodes the model’s prediction in the likelihood: the probability of a success given <span class="math inline">\(X_i\)</span> is <span class="math inline">\(\Phi(X_i\beta)\)</span>. Furthermore, this is how I would code it up in <em>Stan</em>:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb110-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-1" tabindex="-1"></a></span>
<span id="cb110-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb110-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-3" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb110-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-4" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> k<span class="op">;</span> <span class="co">// number of explanatory variables</span></span>
<span id="cb110-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-5" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X<span class="op">;</span> <span class="co">// explanatory variables</span></span>
<span id="cb110-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-6" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> y<span class="op">;</span> <span class="co">// binary outcome</span></span>
<span id="cb110-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-7" tabindex="-1"></a>  </span>
<span id="cb110-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-8" tabindex="-1"></a>  array<span class="op">[</span>k<span class="op">]</span> vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_beta<span class="op">;</span> </span>
<span id="cb110-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-9" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-10" tabindex="-1"></a></span>
<span id="cb110-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-11" tabindex="-1"></a></span>
<span id="cb110-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-12" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb110-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-13" tabindex="-1"></a>  </span>
<span id="cb110-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-14" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> beta<span class="op">;</span></span>
<span id="cb110-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-15" tabindex="-1"></a></span>
<span id="cb110-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-16" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-17" tabindex="-1"></a></span>
<span id="cb110-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-18" tabindex="-1"></a></span>
<span id="cb110-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-19" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb110-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-20" tabindex="-1"></a>  </span>
<span id="cb110-21"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-21" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb110-22"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-22" tabindex="-1"></a>  </span>
<span id="cb110-23"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-23" tabindex="-1"></a>  y <span class="op">~</span> bernoulli<span class="op">(</span>Phi<span class="op">(</span>X<span class="op">*</span>beta<span class="op">));</span></span>
<span id="cb110-24"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-24" tabindex="-1"></a>  </span>
<span id="cb110-25"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-25" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb110-26"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-26" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>kk in <span class="dv">1</span><span class="op">:</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-27"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-27" tabindex="-1"></a>    beta<span class="op">[</span>kk<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>prior_beta<span class="op">[</span>kk<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_beta<span class="op">[</span>kk<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb110-28"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-28" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb110-29"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-29" tabindex="-1"></a>  </span>
<span id="cb110-30"><a href="more-filling-in-the-blanks-data-augmentation.html#cb110-30" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>However not so long ago, this representation was much less efficient to sample from than the following <em>latent variable</em> representation:</p>
<p><span class="math display">\[
\begin{aligned}
y^*&amp;\sim N(X\beta,1^2)&amp;\quad \text{(latent process)}\\
y_i&amp;=\begin{cases}
1&amp;\text{if } y_i^*\geq 0\\
0&amp;\text{if } y_i^*&lt;0
\end{cases} &amp; \quad \text{(observed outcome variable)}\\
\beta_k &amp;\sim N(m_k,s_k^2)&amp;\quad\text{(prior)}
\end{aligned}
\]</span></p>
<p>Here, we recognize that we can represent the observed data-generating process by a latent variable <span class="math inline">\(y^*\)</span> which is greater than zero if we observe a one, and less than zero if we observe a zero. In essence, our binary outcome variable tells us the sign of <span class="math inline">\(y^*\)</span>. The reason this representation was really useful is because</p>
<ol style="list-style-type: decimal">
<li>Conditional on the data and <span class="math inline">\(\beta\)</span>, it is really easy to sample from the posterior distribution of <span class="math inline">\(y^*\)</span> because it is a truncated normal.</li>
<li>Conditional on <span class="math inline">\(y^*\)</span>, the problem of sampling from the posterior distribution of <span class="math inline">\(\beta\)</span> is exactly the same as if <span class="math inline">\(y^*\)</span> were observed. Since this is just a linear regression model (with standard normal errors), this is really easy too.</li>
</ol>
<p>As such, this fits nicely into a Gibbs sampler.
We can estimate this version of the probit model in <em>Stan</em> as follows:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb111-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-1" tabindex="-1"></a></span>
<span id="cb111-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb111-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-3" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb111-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-4" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> k<span class="op">;</span> <span class="co">// number of explanatory variables</span></span>
<span id="cb111-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-5" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X<span class="op">;</span> <span class="co">// explanatory variables</span></span>
<span id="cb111-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-6" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> y<span class="op">;</span> <span class="co">// binary outcome</span></span>
<span id="cb111-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-7" tabindex="-1"></a>  </span>
<span id="cb111-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-8" tabindex="-1"></a>  array<span class="op">[</span>k<span class="op">]</span> vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_beta<span class="op">;</span> </span>
<span id="cb111-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-9" tabindex="-1"></a>  </span>
<span id="cb111-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-10" tabindex="-1"></a>  <span class="co">// pass a really large and positive number in here</span></span>
<span id="cb111-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-11" tabindex="-1"></a>  real Inf<span class="op">;</span></span>
<span id="cb111-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-12" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb111-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-13" tabindex="-1"></a></span>
<span id="cb111-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-14" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb111-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-15" tabindex="-1"></a>  </span>
<span id="cb111-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-16" tabindex="-1"></a>  <span class="co">// lower and upper bounds for the latent variables</span></span>
<span id="cb111-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-17" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> y_lb<span class="op">;</span></span>
<span id="cb111-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-18" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> y_ub<span class="op">;</span></span>
<span id="cb111-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-19" tabindex="-1"></a>  </span>
<span id="cb111-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-20" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb111-21"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-21" tabindex="-1"></a>    </span>
<span id="cb111-22"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-22" tabindex="-1"></a>    y_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> y<span class="op">[</span>ii<span class="op">]==</span><span class="dv">1</span> <span class="op">?</span> <span class="fl">0.0</span> <span class="op">:</span> <span class="op">-</span>Inf<span class="op">;</span></span>
<span id="cb111-23"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-23" tabindex="-1"></a>    y_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> y<span class="op">[</span>ii<span class="op">]==</span><span class="dv">1</span> <span class="op">?</span> Inf <span class="op">:</span> <span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb111-24"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-24" tabindex="-1"></a>    </span>
<span id="cb111-25"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-25" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb111-26"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-26" tabindex="-1"></a>  </span>
<span id="cb111-27"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-27" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb111-28"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-28" tabindex="-1"></a></span>
<span id="cb111-29"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-29" tabindex="-1"></a></span>
<span id="cb111-30"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-30" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb111-31"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-31" tabindex="-1"></a>  </span>
<span id="cb111-32"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-32" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> beta<span class="op">;</span></span>
<span id="cb111-33"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-33" tabindex="-1"></a>  </span>
<span id="cb111-34"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-34" tabindex="-1"></a>  <span class="co">// augmented data</span></span>
<span id="cb111-35"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-35" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>y_lb<span class="op">,</span>upper<span class="op">=</span>y_ub<span class="op">&gt;[</span>N<span class="op">]</span> ystar<span class="op">;</span></span>
<span id="cb111-36"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-36" tabindex="-1"></a></span>
<span id="cb111-37"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-37" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb111-38"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-38" tabindex="-1"></a></span>
<span id="cb111-39"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-39" tabindex="-1"></a></span>
<span id="cb111-40"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-40" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb111-41"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-41" tabindex="-1"></a>  </span>
<span id="cb111-42"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-42" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb111-43"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-43" tabindex="-1"></a>  </span>
<span id="cb111-44"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-44" tabindex="-1"></a>  ystar <span class="op">~</span> normal<span class="op">(</span>X<span class="op">*</span>beta<span class="op">,</span> <span class="fl">1.0</span><span class="op">);</span></span>
<span id="cb111-45"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-45" tabindex="-1"></a>  </span>
<span id="cb111-46"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-46" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb111-47"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-47" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>kk in <span class="dv">1</span><span class="op">:</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb111-48"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-48" tabindex="-1"></a>    beta<span class="op">[</span>kk<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>prior_beta<span class="op">[</span>kk<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_beta<span class="op">[</span>kk<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb111-49"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-49" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb111-50"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-50" tabindex="-1"></a>  </span>
<span id="cb111-51"><a href="more-filling-in-the-blanks-data-augmentation.html#cb111-51" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>However since <em>Stan</em> doesn’t do Gibbs sampling, it will probably just give you the same results as the first implementation (without the latent variable), but with a longer runtime and a bigger RAM and CPU requirement. This isn’t to say that data augmentation is useless with modern Bayesian computing. Rather, the useful applications of data-augmentation just look a little different.</p>
</div>
<div id="example-2-accounting-for-rounded-answers" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Example 2: accounting for rounded answers<a href="more-filling-in-the-blanks-data-augmentation.html#example-2-accounting-for-rounded-answers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In many economic experiments, we ask participants to choose a number between zero and one hundred. In these situations, participants might round their answers to the nearest (say) five or ten, and sometimes experiment programs might <em>force</em> the participant to round to the nearest one. As such, participants’ data cannot be interpreted as <em>point-valued</em>, and it is probably better to treat them as <em>interval-valued</em>. To illustrate this, consider Figure <a href="more-filling-in-the-blanks-data-augmentation.html#fig:HS2016rounding">9.1</a>, which shows the distribution of the last digit of percentage reported beliefs in the four treatments of <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span>. Here we can see that the modal last digit is zero, indicating that a participant’s answer was a multiple of ten percentage points, and the next most common answer was a multiple of five percentage points. Here I distinguish between boundary decisions (red, i.e. reporting 100% or 0%) and interior decisions (gray, everything else).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-1" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="st">&quot;Code/HS2016/cleaneddata.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb112-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb112-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb112-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-4" tabindex="-1"></a>    <span class="at">uid =</span> <span class="fu">paste</span>(treatment, Session, ID)</span>
<span id="cb112-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-5" tabindex="-1"></a>  )</span>
<span id="cb112-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-6" tabindex="-1"></a></span>
<span id="cb112-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-7" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span> </span>
<span id="cb112-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-8" tabindex="-1"></a>  <span class="co"># remove observations where the prior was elicited</span></span>
<span id="cb112-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-9" tabindex="-1"></a>  <span class="fu">filter</span>((red.draws<span class="sc">+</span>blue.draws)<span class="sc">!=</span><span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb112-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-10" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb112-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-11" tabindex="-1"></a>    <span class="at">last.digit =</span> Actual.Prediction <span class="sc">%%</span> <span class="dv">10</span>,</span>
<span id="cb112-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-12" tabindex="-1"></a>    <span class="at">boundary =</span> <span class="fu">ifelse</span>(Actual.Prediction<span class="sc">==</span><span class="dv">100</span> <span class="sc">|</span> Actual.Prediction<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;boundary&quot;</span>,<span class="st">&quot;interior&quot;</span>)</span>
<span id="cb112-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-13" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb112-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-14" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment,last.digit,boundary) <span class="sc">|&gt;</span></span>
<span id="cb112-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-15" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb112-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-16" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb112-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-17" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb112-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-18" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span></span>
<span id="cb112-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-19" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb112-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-20" tabindex="-1"></a>    <span class="at">fraction =</span> count<span class="sc">/</span><span class="fu">sum</span>(count)</span>
<span id="cb112-21"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-21" tabindex="-1"></a>  )</span>
<span id="cb112-22"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-22" tabindex="-1"></a></span>
<span id="cb112-23"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-23" tabindex="-1"></a>(</span>
<span id="cb112-24"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-24" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt,<span class="fu">aes</span>(<span class="at">x=</span>last.digit,<span class="at">y=</span>fraction,<span class="at">fill=</span>boundary))</span>
<span id="cb112-25"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-25" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>)</span>
<span id="cb112-26"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-26" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment)</span>
<span id="cb112-27"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-27" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb112-28"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-28" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_fill_discrete</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;gray&quot;</span>), <span class="at">name=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb112-29"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-29" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;last digit of percentage reported belief&quot;</span>)</span>
<span id="cb112-30"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-30" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">9</span>,<span class="at">by=</span><span class="dv">1</span>))</span>
<span id="cb112-31"><a href="more-filling-in-the-blanks-data-augmentation.html#cb112-31" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:HS2016rounding"></span>
<img src="index_files/figure-html/HS2016rounding-1.png" alt="Last digit of reported belief in @HS2016" width="672" />
<p class="caption">
Figure 9.1: Last digit of reported belief in <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span>
</p>
</div>
<p>An important question when analyzing these data is how we should treat these data now that we know that there are lots of multiples of five and ten. One approach, which we (Yaroslav and I) have taken very seriously in <span class="citation">Bland and Rosokha (<a href="#ref-BR2024">2025</a>)</span>, is to treat the data as <em>interval-valued</em>. That is, if a participant (say) reported their answer as 60%, then we interpret it as having been <em>rounded</em> to 60%. As such, for this datum, we know that the participant’s actual answer (had they not rounded) was somewhere between 55% and 65%. We can motivate this as a “cost of decision-making” story: if the participant round to the nearest one (as they were forced to in <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span>), then they have to choose between 101 different things. On the other hand, if they round to the nearest ten, then they are only choosing between eleven different things. Somewhere in the middle is rounding to five, where they chose between 21 different things. If we want to be really conservative (in <span class="citation">Bland and Rosokha (<a href="#ref-BR2024">2025</a>)</span> we find that people are in fact <em>more</em> precise than this, particularly at the boundary) about what the data are telling us, we might adopt the following convention:</p>
<ol style="list-style-type: decimal">
<li>If a participant’s decision is a multiple of ten, then it is assumed to be rounded to the nearest ten</li>
<li>If a participant’s decision is a multiple of five (but not ten), then it is assumed to be rounded to the nearest five, and</li>
<li>All other decisions are (forced by the experiment program) rounded to the nearest one.</li>
</ol>
<p>And so a report of (say) <span class="math inline">\(x_{i,t}=60\)</span> really only tells us that their real answer (if they didn’t round) was somewhere in the range <span class="math inline">\(x_{i,t}^*\in(55,65)\)</span>.</p>
<div id="the-hs2016-task" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> The <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span> task<a href="more-filling-in-the-blanks-data-augmentation.html#the-hs2016-task" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you want to <em>really</em> understand this experiment, go and set yourself up on <a href="www.veconlab.com"><em>Veconlab</em></a> and experiment on yourself with the “Bayes’ rule” experiment. For those of you who didn’t do this, here is a short explanation of the experiment:</p>
<blockquote>
<p>A red cup conatins two red balls and one blue ball. A blue cup contains two blue balls and one red ball. Each cup is equally likely to be selected. We show you a number of draws with replacement from the selected cup, and you are incetivized to report your belief that the red cup is being used.</p>
</blockquote>
<p><span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span> investigate four different incentive schemes (between subjects) for eliciting beliefs. Each of them involves payoffs that depend on whether or not the red cup is being used.</p>
<ol style="list-style-type: decimal">
<li>BDM “Becker-DeGroot-Marschak”: This mechanism binarizes the participant’s payoff. That is, they either earn $2 or $0 from their decision. Given the participant’s reported belief <span class="math inline">\(q\)</span>, the computer generates a random uniform number <span class="math inline">\(x\)</span>. If <span class="math inline">\(x\leq q\)</span> then the participant is paid if the red cup is being used, otherwise the participant is paid if another random uniform number <span class="math inline">\(y&lt;x\)</span>. This mechanism incentivizes truth-telling up to expected utility preferences (but does not incentivize truth-telling with (say) rank-dependent utility preferences).<br />
</li>
<li>LC “Lottery choice”: Here, the participant is offered a series of binary choices between (i) a lottery that pays $2 with probability <span class="math inline">\(p\)</span>, and (ii) a lottery that pays $2 if the red cup was used. This mechanism elicits an indifference point (up to a coarsening of one percentage point) between options (i) and (ii).</li>
<li>QSR-chances: This mechanism uses a quadratic scoring rule. The participant is paid a fixed amount, minus a quadratic loss function for placing probability on the incorrect event. That is, suppose the participant reports a belief of <span class="math inline">\(q\)</span> that the red cup is being used. The loss term is proportional to <span class="math inline">\((1-q)^2\)</span> if the red cup was actually used, and proportional to <span class="math inline">\(q^2\)</span> if the blue cup was used. QSR incentivizes truth-telling if the participant has risk-neutral expected utility preferences. In the QSR-chances treatment, the decision problem was framed in terms of reporting probabilities.</li>
<li>QSR-numbers: The same payoffs as the QSR-chances treatment, except the decision problem was not framed in terms of reporting probabilities.</li>
</ol>
</div>
<div id="a-model-for-behavior-in-hs2016" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> A model for behavior in <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span><a href="more-filling-in-the-blanks-data-augmentation.html#a-model-for-behavior-in-hs2016" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here I will show you how to estimate a cut-down version of the <span class="citation">Grether (<a href="#ref-Grether1980">1980</a>)</span> model.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> First, note that we can write the Bayesian belief in the red cup after observing signals (draws from the cup) <span class="math inline">\(s\)</span> as:</p>
<p><span class="math display">\[
\begin{aligned}
p(R\mid s)&amp;=\frac{p(s\mid R)p(R)}{p(s)}
\end{aligned}
\]</span></p>
<p>Similarly, we can write the Bayesian belief in the blue cup after observing the same signals <span class="math inline">\(s\)</span> as:</p>
<p><span class="math display">\[
\begin{aligned}
p(B\mid s)&amp;=\frac{p(s\mid B)p(B)}{p(s)}
\end{aligned}
\]</span></p>
<p>Taking the ratios of these, the pesky marginal likelihood <span class="math inline">\(p(s)\)</span> cancels and we get:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{p(R\mid s)}{p(B\mid s)}&amp;=\frac{p(s\mid R)p(R)}{p(s\mid B)p(B)}
\end{aligned}
\]</span></p>
<p>Now, in <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span> <span class="math inline">\(p(R)=p(B)=0.5\)</span>, so we can write this as:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{p(R\mid s)}{p(B\mid s)}&amp;=\frac{p(s\mid R)}{p(s\mid B)}
\end{aligned}
\]</span></p>
<p>And now we can put in a behavioral parameter <span class="math inline">\(\beta\)</span> that measures how much the participant reacts to the the signal:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{p(R\mid s)}{p(B\mid s)}&amp;=\left(\frac{p(s\mid R)}{p(s\mid B)}\right)^\beta
\end{aligned}
\]</span></p>
<p>Taking natural logs of both sides yields:</p>
<p><span class="math display">\[
\begin{aligned}
\log p(R\mid s)-\log p(B\mid s)&amp;=\beta\left[\log p(s\mid R)-\log p(s\mid B)\right]
\end{aligned}
\]</span></p>
<p>Finally, we add in an econometric error term:</p>
<p><span class="math display">\[
\begin{aligned}
\overbrace{\log p(R\mid s)-\log p(B\mid s)}^{y_{i,t}}&amp;=\beta\overbrace{\left[\log p(s\mid R)-\log p(s\mid B)\right]}^{\lambda_{i,t}} +\epsilon_{i,t}
\end{aligned}
\]</span></p>
<p>Therefore, <span class="math inline">\(\lambda_{i,t}\)</span> is the (log) signal information associated with signal <span class="math inline">\(s_{i,t}\)</span>, and <span class="math inline">\(\beta\)</span> measures departures from Bayesian updating, with <span class="math inline">\(\beta=1\)</span> (and <span class="math inline">\(\epsilon_{i,t}=0\)</span>) corresponding to the Bayesian benchmark. Here <span class="math inline">\(y_{i,t}\)</span> is the “logit” of the participant’s belief. That is, <span class="math inline">\(\mathrm{logit}(x)=\log(x)-\log(1-x)\)</span>.</p>
<p>Note that this is a linear relationship, so in principle we <em>could</em> estimate this <span class="math inline">\(\beta\)</span> using OLS (i.e. without a constant). However since our data are interval-valued, we would be violating an assumption needed for OLS to be valid. Instead, we will augment our data by the un-rounded latent beliefs.<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a></p>
<p>We will focus on estimating <span class="math inline">\(\beta\)</span> for each participant in the experiment using a hierarchical model.</p>
</div>
<div id="a-note-on-replication" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> A note on replication<a href="more-filling-in-the-blanks-data-augmentation.html#a-note-on-replication" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this chapter, I am not trying to replicate <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span>. Neither am I trying to give you a “Bayesian version of <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span>”. Rather, I am trying to use this dataset to show you how you can account for rounding and estimate the (cut-down version of the) <span class="citation">Grether (<a href="#ref-Grether1980">1980</a>)</span> model using data augmentation. I have not run simulations (as we do in <span class="citation">Bland and Rosokha (<a href="#ref-BR2024">2025</a>)</span>) to show (or not) that rounding is an important factor in this experiment, and my prior is that it won’t affect their conclusions substantially.<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a></p>
</div>
<div id="augmenting-the-data" class="section level3 hasAnchor" number="9.2.4">
<h3><span class="header-section-number">9.2.4</span> Augmenting the data<a href="more-filling-in-the-blanks-data-augmentation.html#augmenting-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are going to augment our data in almost exactly the same way as we did with the probit model above. We will assume that participant <span class="math inline">\(i\)</span>’s (logit) beliefs after seeing signal <span class="math inline">\(s_{i,t}\)</span>, but before any rounding, are represented by:</p>
<p><span class="math display">\[
\begin{aligned}
y_{i,t}\mid s_{i,t}&amp;\sim N(\beta_i \lambda_{i,t},\sigma_i^2)
\end{aligned}
\]</span></p>
<p>When we condition on the data, we truncate <span class="math inline">\(y_{i,t}\)</span> to the bounds specified by the interval-valued data. For example, if our participant reported a belief of 60%, then we assume that this was rounded from the range of beliefs <span class="math inline">\([55%,65%]\)</span>, and since <span class="math inline">\(y_{i,t}\)</span> is on the logit scale, we restrict it to <span class="math inline">\(y_{i,t}\in[\mathrm{logit}(0.55),\mathrm{logit}(0.65)]\approx[0.20,0.62]\)</span>. In <em>Stan</em> this is really easy: we just specify the <code>lower</code> and <code>upper</code> of <code>y</code> in the <code>parameters</code> block:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb113-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb113-1" tabindex="-1"></a>vector<span class="op">&lt;</span>lower<span class="op">=</span>y_lb<span class="op">,</span>upper<span class="op">=</span>y_ub<span class="op">&gt;[</span>N<span class="op">]</span> y<span class="op">;</span></span></code></pre></div>
<p>where <code>y_lb</code> and <code>y_ub</code> are these bounds (each are <code>vector[N]</code> data types), declared in the <code>data</code> block. From here, all we have to do is treat <code>y</code> as if it is data and give it a sampling statement in the <code>model</code> block, just as we would if we actually observed <code>y</code>:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb114-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb114-1" tabindex="-1"></a>y <span class="op">~</span> normal<span class="op">(</span>lambda<span class="op">.*</span>beta<span class="op">[</span>participantID<span class="op">],</span>sigma<span class="op">[</span>participantID<span class="op">]);</span></span></code></pre></div>
<p>Here is the hierarchical model I coded up in <em>Stan</em> to estimate this model:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb115-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-1" tabindex="-1"></a></span>
<span id="cb115-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb115-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-3" tabindex="-1"></a>  </span>
<span id="cb115-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-4" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations in dataset</span></span>
<span id="cb115-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-5" tabindex="-1"></a>  <span class="dt">int</span> nParticipants<span class="op">;</span> </span>
<span id="cb115-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-6" tabindex="-1"></a>  </span>
<span id="cb115-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-7" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span> participantID<span class="op">;</span> <span class="co">// participant ID</span></span>
<span id="cb115-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-8" tabindex="-1"></a>  </span>
<span id="cb115-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-9" tabindex="-1"></a>  <span class="co">// lower and upper bounds of logit beliefs</span></span>
<span id="cb115-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-10" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> y_lb<span class="op">;</span></span>
<span id="cb115-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-11" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> y_ub<span class="op">;</span></span>
<span id="cb115-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-12" tabindex="-1"></a>  </span>
<span id="cb115-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-13" tabindex="-1"></a>  <span class="co">// log signal information</span></span>
<span id="cb115-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-14" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> lambda<span class="op">;</span></span>
<span id="cb115-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-15" tabindex="-1"></a>  </span>
<span id="cb115-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-16" tabindex="-1"></a>  array<span class="op">[</span><span class="dv">2</span><span class="op">]</span> vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_MU<span class="op">;</span></span>
<span id="cb115-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-17" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_TAU<span class="op">;</span></span>
<span id="cb115-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-18" tabindex="-1"></a>  real prior_Omega<span class="op">;</span></span>
<span id="cb115-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-19" tabindex="-1"></a>  </span>
<span id="cb115-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-20" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-21"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-21" tabindex="-1"></a></span>
<span id="cb115-22"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-22" tabindex="-1"></a></span>
<span id="cb115-23"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-23" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb115-24"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-24" tabindex="-1"></a>  </span>
<span id="cb115-25"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-25" tabindex="-1"></a>  <span class="co">// population-level parameters -- one for each treatment</span></span>
<span id="cb115-26"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-26" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> MU<span class="op">;</span></span>
<span id="cb115-27"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-27" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;[</span><span class="dv">2</span><span class="op">]</span> TAU<span class="op">;</span></span>
<span id="cb115-28"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-28" tabindex="-1"></a>  cholesky_factor_corr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> L_Omega<span class="op">;</span></span>
<span id="cb115-29"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-29" tabindex="-1"></a>  </span>
<span id="cb115-30"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-30" tabindex="-1"></a>  <span class="co">// normalized participant-specific parameters</span></span>
<span id="cb115-31"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-31" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span>nParticipants<span class="op">]</span> z<span class="op">;</span></span>
<span id="cb115-32"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-32" tabindex="-1"></a>  </span>
<span id="cb115-33"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-33" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>y_lb<span class="op">,</span>upper<span class="op">=</span>y_ub<span class="op">&gt;[</span>N<span class="op">]</span> y<span class="op">;</span> <span class="co">// augmented data</span></span>
<span id="cb115-34"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-34" tabindex="-1"></a>  </span>
<span id="cb115-35"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-35" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-36"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-36" tabindex="-1"></a></span>
<span id="cb115-37"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-37" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb115-38"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-38" tabindex="-1"></a>  </span>
<span id="cb115-39"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-39" tabindex="-1"></a>  vector<span class="op">[</span>nParticipants<span class="op">]</span> beta<span class="op">;</span></span>
<span id="cb115-40"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-40" tabindex="-1"></a>  vector<span class="op">[</span>nParticipants<span class="op">]</span> sigma<span class="op">;</span></span>
<span id="cb115-41"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-41" tabindex="-1"></a>  </span>
<span id="cb115-42"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-42" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb115-43"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-43" tabindex="-1"></a>    </span>
<span id="cb115-44"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-44" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span>nParticipants<span class="op">]</span> theta <span class="op">=</span> rep_matrix<span class="op">(</span>MU<span class="op">,</span>nParticipants<span class="op">)</span></span>
<span id="cb115-45"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-45" tabindex="-1"></a>          <span class="op">+</span> diag_pre_multiply<span class="op">(</span>TAU<span class="op">,</span>L_Omega<span class="op">)*</span>z<span class="op">;</span></span>
<span id="cb115-46"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-46" tabindex="-1"></a>    </span>
<span id="cb115-47"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-47" tabindex="-1"></a>    beta <span class="op">=</span> theta<span class="op">[</span><span class="dv">1</span><span class="op">,]</span><span class="ch">&#39;;</span></span>
<span id="cb115-48"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-48" tabindex="-1"></a>    sigma <span class="op">=</span> exp<span class="op">(</span>theta<span class="op">[</span><span class="dv">2</span><span class="op">,]</span><span class="ch">&#39;)</span><span class="er">;</span></span>
<span id="cb115-49"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-49" tabindex="-1"></a>    </span>
<span id="cb115-50"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-50" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb115-51"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-51" tabindex="-1"></a>  </span>
<span id="cb115-52"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-52" tabindex="-1"></a>  </span>
<span id="cb115-53"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-53" tabindex="-1"></a>  </span>
<span id="cb115-54"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-54" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-55"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-55" tabindex="-1"></a></span>
<span id="cb115-56"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-56" tabindex="-1"></a></span>
<span id="cb115-57"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-57" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb115-58"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-58" tabindex="-1"></a>  </span>
<span id="cb115-59"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-59" tabindex="-1"></a>  <span class="co">//  hyper-prior --------------------------------------------------------------</span></span>
<span id="cb115-60"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-60" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>pp in <span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb115-61"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-61" tabindex="-1"></a>    MU<span class="op">[</span>pp<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>prior_MU<span class="op">[</span>pp<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_MU<span class="op">[</span>pp<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb115-62"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-62" tabindex="-1"></a>    TAU<span class="op">[</span>pp<span class="op">]</span> <span class="op">~</span> cauchy<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_TAU<span class="op">[</span>pp<span class="op">]);</span></span>
<span id="cb115-63"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-63" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb115-64"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-64" tabindex="-1"></a>  L_Omega <span class="op">~</span> lkj_corr_cholesky<span class="op">(</span>prior_Omega<span class="op">);</span></span>
<span id="cb115-65"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-65" tabindex="-1"></a>  </span>
<span id="cb115-66"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-66" tabindex="-1"></a>  <span class="co">// hierarchical structure, non-centered parameterization ---------------------</span></span>
<span id="cb115-67"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-67" tabindex="-1"></a>  </span>
<span id="cb115-68"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-68" tabindex="-1"></a>  to_vector<span class="op">(</span>z<span class="op">)</span> <span class="op">~</span> std_normal<span class="op">();</span></span>
<span id="cb115-69"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-69" tabindex="-1"></a>  </span>
<span id="cb115-70"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-70" tabindex="-1"></a>  <span class="co">// likelihood (augmented data) -----------------------------------------------</span></span>
<span id="cb115-71"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-71" tabindex="-1"></a>  </span>
<span id="cb115-72"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-72" tabindex="-1"></a>  y <span class="op">~</span> normal<span class="op">(</span>lambda<span class="op">.*</span>beta<span class="op">[</span>participantID<span class="op">],</span>sigma<span class="op">[</span>participantID<span class="op">]);</span></span>
<span id="cb115-73"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-73" tabindex="-1"></a>  </span>
<span id="cb115-74"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-74" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-75"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-75" tabindex="-1"></a></span>
<span id="cb115-76"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-76" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb115-77"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-77" tabindex="-1"></a>  </span>
<span id="cb115-78"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-78" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Omega <span class="op">=</span> L_Omega<span class="op">*</span>L_Omega<span class="ch">&#39;;</span></span>
<span id="cb115-79"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-79" tabindex="-1"></a>  </span>
<span id="cb115-80"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-80" tabindex="-1"></a>  <span class="co">// convert the latent logit belief y variable into a probability</span></span>
<span id="cb115-81"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-81" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> belief <span class="op">=</span> inv_logit<span class="op">(</span>y<span class="op">);</span></span>
<span id="cb115-82"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-82" tabindex="-1"></a>  </span>
<span id="cb115-83"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-83" tabindex="-1"></a>  </span>
<span id="cb115-84"><a href="more-filling-in-the-blanks-data-augmentation.html#cb115-84" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>A word of caution might be worth making here. Note that this model has a <em>lot</em> of parameters. These are:</p>
<ul>
<li>2 elements of <code>MU</code>, the population mean vector</li>
<li>2 elements of <code>TAU</code>, the population standard deviation vector</li>
<li>1 element of <code>L_Omega</code>, the (Cholesky-factored) correlation matrix</li>
<li><code>nParticipants</code><span class="math inline">\(\times 2\)</span> participant-level parameters</li>
<li><code>N</code> elements of the augmented data <code>y</code></li>
</ul>
<p>It is the last one of these that we might want to worry about. <code>N</code> (the total number of decisions in the experiment) is typically large, so this means storing all of these latent quantities will take up a lot of RAM, and a lot of hard disk space if you save the results. I would argue, though, that we are not actually interested in these latent variables (what we really care about in are the estimates of <span class="math inline">\(\beta_i\)</span>), and so we can just tell <em>Stan</em> to not store them using the <code>par = "y", include = FALSE</code> options when we call <code>sampling</code> in <code>rstan</code>. This also applies to the variable <code>belief</code> in the <code>generated quantities</code> block: there are <code>N</code> of these as well. However I want to save these so I can compare estimated un-rounded beliefs to reported beliefs in the experiment. My solution to avoid storing the entire posterior on my hard drive here is to just save <em>Stan</em>’s <em>summary</em> of the posterior distribution. In a lot of cases I have found that if you are forward-looking enough to get everything you want computed in the <code>generated quantities</code> block, this summary object is sufficient for most analysis.</p>
</div>
<div id="results-1" class="section level3 hasAnchor" number="9.2.5">
<h3><span class="header-section-number">9.2.5</span> Results<a href="more-filling-in-the-blanks-data-augmentation.html#results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I estimate this model for each of the four treatments separately.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-1" tabindex="-1"></a>FitSum<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb116-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-2" tabindex="-1"></a>D.beliefs<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb116-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-3" tabindex="-1"></a></span>
<span id="cb116-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-4" tabindex="-1"></a>file.list<span class="ot">&lt;-</span><span class="fu">list.files</span>(<span class="at">path=</span><span class="st">&quot;Code/HS2016&quot;</span>,<span class="at">pattern=</span><span class="st">&quot;fit_&quot;</span>)</span>
<span id="cb116-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-5" tabindex="-1"></a></span>
<span id="cb116-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-6" tabindex="-1"></a><span class="cf">for</span> (ff <span class="cf">in</span> file.list) {</span>
<span id="cb116-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-7" tabindex="-1"></a>  </span>
<span id="cb116-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-8" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">paste0</span>(<span class="st">&quot;Code/HS2016/&quot;</span>,ff) <span class="sc">|&gt;</span> <span class="fu">read.csv</span>()</span>
<span id="cb116-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-9" tabindex="-1"></a>  </span>
<span id="cb116-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-10" tabindex="-1"></a>  treat<span class="ot">&lt;-</span>ff <span class="sc">|&gt;</span> <span class="fu">str_replace</span>(<span class="st">&quot;fit_&quot;</span>,<span class="st">&quot;&quot;</span>) <span class="sc">|&gt;</span> <span class="fu">str_replace</span>(<span class="st">&quot;.csv&quot;</span>,<span class="st">&quot;&quot;</span>)</span>
<span id="cb116-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-11" tabindex="-1"></a>  </span>
<span id="cb116-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-12" tabindex="-1"></a>  </span>
<span id="cb116-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-13" tabindex="-1"></a>  FitSum<span class="ot">&lt;-</span><span class="fu">rbind</span>(FitSum, d)</span>
<span id="cb116-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-14" tabindex="-1"></a>  </span>
<span id="cb116-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-15" tabindex="-1"></a>  d.beliefs<span class="ot">&lt;-</span>d <span class="sc">|&gt;</span><span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;belief&quot;</span>,par)) <span class="sc">|&gt;</span></span>
<span id="cb116-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-16" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb116-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-17" tabindex="-1"></a>      <span class="at">reported.belief =</span>  (D <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span>treat))<span class="sc">$</span>Actual.Prediction<span class="sc">/</span><span class="dv">100</span>,</span>
<span id="cb116-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-18" tabindex="-1"></a>      <span class="at">Actual.Prediction =</span> (D <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span>treat))<span class="sc">$</span>Actual.Prediction,</span>
<span id="cb116-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-19" tabindex="-1"></a>      <span class="at">Bayes..Prediction =</span> (D <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span>treat))<span class="sc">$</span>Bayes..Prediction,</span>
<span id="cb116-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-20" tabindex="-1"></a>      <span class="at">red.draws =</span> (D <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span>treat))<span class="sc">$</span>red.draws,</span>
<span id="cb116-21"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-21" tabindex="-1"></a>      <span class="at">blue.draws =</span> (D <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span>treat))<span class="sc">$</span>blue.draws,</span>
<span id="cb116-22"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-22" tabindex="-1"></a>      <span class="at">uid =</span> (D <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span>treat))<span class="sc">$</span>uid</span>
<span id="cb116-23"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-23" tabindex="-1"></a>    )</span>
<span id="cb116-24"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-24" tabindex="-1"></a>  </span>
<span id="cb116-25"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-25" tabindex="-1"></a>  D.beliefs<span class="ot">&lt;-</span><span class="fu">rbind</span>(D.beliefs,d.beliefs)</span>
<span id="cb116-26"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-26" tabindex="-1"></a>  </span>
<span id="cb116-27"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-27" tabindex="-1"></a>  </span>
<span id="cb116-28"><a href="more-filling-in-the-blanks-data-augmentation.html#cb116-28" tabindex="-1"></a>}</span></code></pre></div>
<p>First, let’s compare the distribution of <span class="math inline">\(\beta_i\)</span> between treatments. Here I will just plot the empirical cumulative density functions of the posterior means so that we can compare them in Figure <a href="more-filling-in-the-blanks-data-augmentation.html#fig:HS2016betaCDF">9.2</a>:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-1" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>FitSum <span class="sc">|&gt;</span></span>
<span id="cb117-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;beta&quot;</span>,par))</span>
<span id="cb117-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-3" tabindex="-1"></a></span>
<span id="cb117-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-4" tabindex="-1"></a>(</span>
<span id="cb117-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt,<span class="fu">aes</span>(<span class="at">x=</span>mean,<span class="at">color=</span>treatment))</span>
<span id="cb117-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb117-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb117-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">1</span>, <span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb117-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(beta))</span>
<span id="cb117-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Empirical cumulative density of posterior means&quot;</span>)</span>
<span id="cb117-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb117-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:HS2016betaCDF"></span>
<img src="index_files/figure-html/HS2016betaCDF-1.png" alt="Empirical cumulative distribution functions of posterior means of $\beta_i$ by treatment. The vertical dashed line is at $\beta=1$, which is the Bayesian benchmark. " width="672" />
<p class="caption">
Figure 9.2: Empirical cumulative distribution functions of posterior means of <span class="math inline">\(\beta_i\)</span> by treatment. The vertical dashed line is at <span class="math inline">\(\beta=1\)</span>, which is the Bayesian benchmark.
</p>
</div>
<p>Overall, Figure <a href="more-filling-in-the-blanks-data-augmentation.html#fig:HS2016betaCDF">9.2</a> shows a wide range of updating behavior, including conservative (<span class="math inline">\(\beta&lt;1\)</span>, under-reacting to the signal) and over-reaction <span class="math inline">\(\beta&gt;1\)</span>, although the steepest part of the distributions (and hence their modes) seem to be at the Bayesian benchmark of <span class="math inline">\(\beta=1\)</span>. It looks like there is a longer tail at the “overreaction” end for the quadratic scoring rule (QSR, blue and purple) treatments.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-1" tabindex="-1"></a>param.names<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">beta$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">log</span><span class="sc">\\</span><span class="st">sigma$&quot;</span>)</span>
<span id="cb118-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-2" tabindex="-1"></a></span>
<span id="cb118-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-3" tabindex="-1"></a>fmt<span class="ot">&lt;-</span><span class="st">&quot;%.3f&quot;</span></span>
<span id="cb118-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-4" tabindex="-1"></a></span>
<span id="cb118-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-5" tabindex="-1"></a>TAB<span class="ot">&lt;-</span>FitSum <span class="sc">|&gt;</span></span>
<span id="cb118-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-6" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb118-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-7" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">&quot;MU&quot;</span>,par) <span class="sc">|</span> <span class="fu">grepl</span>(<span class="st">&quot;TAU&quot;</span>,par) <span class="sc">|</span> par<span class="sc">==</span><span class="st">&quot;Omega[2,1]&quot;</span></span>
<span id="cb118-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-8" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-9" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb118-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-10" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;MU&quot;</span>,par),<span class="st">&quot;mean ($</span><span class="sc">\\</span><span class="st">mu$)&quot;</span>,</span>
<span id="cb118-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-11" tabindex="-1"></a>                       <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;TAU&quot;</span>,par),<span class="st">&quot;sd ($</span><span class="sc">\\</span><span class="st">tau$)&quot;</span>,<span class="st">&quot;correlation ($</span><span class="sc">\\</span><span class="st">Omega$)&quot;</span>)</span>
<span id="cb118-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-12" tabindex="-1"></a>                       ),</span>
<span id="cb118-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-13" tabindex="-1"></a>    <span class="at">par.ind =</span> par <span class="sc">|&gt;</span> <span class="fu">parse_number</span>()</span>
<span id="cb118-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-14" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-15" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb118-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-16" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">c</span>(mean,sd),</span>
<span id="cb118-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-17" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;name&quot;</span>,</span>
<span id="cb118-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-18" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span></span>
<span id="cb118-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-19" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-20" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb118-21"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-21" tabindex="-1"></a>    <span class="at">value =</span> <span class="fu">ifelse</span>(name<span class="sc">==</span><span class="st">&quot;mean&quot;</span>,<span class="fu">sprintf</span>(fmt,value),<span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>,<span class="fu">sprintf</span>(fmt,value),<span class="st">&quot;)&quot;</span>))</span>
<span id="cb118-22"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-22" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-23"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-23" tabindex="-1"></a>  <span class="fu">arrange</span>(treatment, par.ind,parameter,name) <span class="sc">|&gt;</span></span>
<span id="cb118-24"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-24" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb118-25"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-25" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(par.ind,name,parameter),</span>
<span id="cb118-26"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-26" tabindex="-1"></a>    <span class="at">names_from =</span> treatment,</span>
<span id="cb118-27"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-27" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb118-28"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-28" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-29"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-29" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb118-30"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-30" tabindex="-1"></a>    <span class="at">par.ind =</span> param.names[par.ind]</span>
<span id="cb118-31"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-31" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-32"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-32" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>name) <span class="sc">|&gt;</span></span>
<span id="cb118-33"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-33" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb118-34"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-34" tabindex="-1"></a>    <span class="st">`</span><span class="at">population quantity</span><span class="st">`</span><span class="ot">=</span>parameter,</span>
<span id="cb118-35"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-35" tabindex="-1"></a>    <span class="at">parameter =</span> par.ind</span>
<span id="cb118-36"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-36" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-37"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-37" tabindex="-1"></a>  <span class="fu">group_by</span>(parameter,<span class="st">`</span><span class="at">population quantity</span><span class="st">`</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-38"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-38" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb118-39"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-39" tabindex="-1"></a>    <span class="st">`</span><span class="at">population quantity</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>,<span class="st">`</span><span class="at">population quantity</span><span class="st">`</span>,<span class="st">&quot;&quot;</span>)</span>
<span id="cb118-40"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-40" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb118-41"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-41" tabindex="-1"></a>  <span class="fu">group_by</span>(parameter) <span class="sc">|&gt;</span></span>
<span id="cb118-42"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-42" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb118-43"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-43" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">ifelse</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">1</span>,parameter,<span class="st">&quot;&quot;</span>)</span>
<span id="cb118-44"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-44" tabindex="-1"></a>  )</span>
<span id="cb118-45"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-45" tabindex="-1"></a></span>
<span id="cb118-46"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-46" tabindex="-1"></a>TAB[<span class="fu">is.na</span>(TAB)]<span class="ot">&lt;-</span><span class="st">&quot;&quot;</span></span>
<span id="cb118-47"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-47" tabindex="-1"></a></span>
<span id="cb118-48"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-48" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb118-49"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-49" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Population-level estimates from the hierarchical models. Posterior means with posetrior standard deviations in parentheses.&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-50"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-50" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb118-51"><a href="more-filling-in-the-blanks-data-augmentation.html#cb118-51" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;treatment&quot;</span><span class="ot">=</span><span class="dv">4</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:HS2016table">Table 9.1: </span>Population-level estimates from the hierarchical models. Posterior means with posetrior standard deviations in parentheses.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="4">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
treatment
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
population quantity
</th>
<th style="text-align:left;">
BDM
</th>
<th style="text-align:left;">
LC
</th>
<th style="text-align:left;">
QSR-chances
</th>
<th style="text-align:left;">
QSR-numbers
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\beta\)</span>
</td>
<td style="text-align:left;">
mean (<span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:left;">
1.135
</td>
<td style="text-align:left;">
1.018
</td>
<td style="text-align:left;">
1.508
</td>
<td style="text-align:left;">
1.293
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.172)
</td>
<td style="text-align:left;">
(0.092)
</td>
<td style="text-align:left;">
(0.129)
</td>
<td style="text-align:left;">
(0.127)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd (<span class="math inline">\(\tau\)</span>)
</td>
<td style="text-align:left;">
0.972
</td>
<td style="text-align:left;">
0.493
</td>
<td style="text-align:left;">
0.673
</td>
<td style="text-align:left;">
0.671
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.141)
</td>
<td style="text-align:left;">
(0.076)
</td>
<td style="text-align:left;">
(0.125)
</td>
<td style="text-align:left;">
(0.110)
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\log\sigma\)</span>
</td>
<td style="text-align:left;">
mean (<span class="math inline">\(\mu\)</span>)
</td>
<td style="text-align:left;">
-0.717
</td>
<td style="text-align:left;">
-1.012
</td>
<td style="text-align:left;">
-0.465
</td>
<td style="text-align:left;">
-0.412
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.183)
</td>
<td style="text-align:left;">
(0.185)
</td>
<td style="text-align:left;">
(0.153)
</td>
<td style="text-align:left;">
(0.173)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
sd (<span class="math inline">\(\tau\)</span>)
</td>
<td style="text-align:left;">
1.070
</td>
<td style="text-align:left;">
1.085
</td>
<td style="text-align:left;">
0.877
</td>
<td style="text-align:left;">
1.013
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.150)
</td>
<td style="text-align:left;">
(0.148)
</td>
<td style="text-align:left;">
(0.131)
</td>
<td style="text-align:left;">
(0.140)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
correlation (<span class="math inline">\(\Omega\)</span>)
</td>
<td style="text-align:left;">
0.025
</td>
<td style="text-align:left;">
0.342
</td>
<td style="text-align:left;">
0.359
</td>
<td style="text-align:left;">
0.212
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.181)
</td>
<td style="text-align:left;">
(0.156)
</td>
<td style="text-align:left;">
(0.152)
</td>
<td style="text-align:left;">
(0.169)
</td>
</tr>
</tbody>
</table>
<p>Table <a href="more-filling-in-the-blanks-data-augmentation.html#tab:HS2016table">9.1</a> shows the posterior estimates of the population-level parameters for each treatment. Probably the ones of most interest are the ones that correspond to the distribution of <span class="math inline">\(\beta\)</span>, which are shown at the top of the table. Here we can see that the “LC” treatment has the closest mean to the Bayesian benchmark of <span class="math inline">\(\beta=1\)</span>, and it also the smallest standard deviation. The other treatments on average are in the overreaction direction (<span class="math inline">\(\beta&gt;1\)</span>), especially for the quadratic scoring rule treatments.</p>
<p>While the main goal of this example was to show you how we could estimate <span class="math inline">\(\beta_i\)</span> and its population distribution using data augmentation, it is important to note that the augmented data itself may be useful in some circumstances, too. In our case, the inverse logit of the augmented <code>y</code>s are our models’ estimates of the participants’ un-rounded beliefs. One might wonder how much information these estimates are actually telling us. To see this, I plot the posterior interquartile ranges of the latent beliefs in Figure <a href="more-filling-in-the-blanks-data-augmentation.html#fig:HS2016IQR">9.3</a>. This gives us an idea of how informative the model is for beliefs beyond the lower and upper bounds we passed to it for estimation. For example, for a decision that was rounded to ten percentage points, if the model was not particularly good at estimating these latent quantities, then the posterior for this latent belief might be uniformly distributed in the allowable range. In this case the interquartile range would be 0.05.<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a> The dashed vertical lines show the interquartile range we would see if the posterior distribution of latent beliefs are uniformly distributed in the allowable range. In fact, we see that almost all posteriors are <em>at least</em> as informative as this benchmark, showing that the model is somewhat able to pin down participants’ beliefs beyond just the range we provided <em>Stan</em> to begin with.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-1" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>D.beliefs <span class="sc">|&gt;</span></span>
<span id="cb119-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-2" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb119-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-3" tabindex="-1"></a>    <span class="at">rounding =</span> <span class="fu">ifelse</span>((Actual.Prediction<span class="sc">%%</span><span class="dv">10</span>)<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;0.10&quot;</span>,</span>
<span id="cb119-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-4" tabindex="-1"></a>                      <span class="fu">ifelse</span>((Actual.Prediction<span class="sc">%%</span><span class="dv">5</span>)<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;0.05&quot;</span>,<span class="st">&quot;0.01&quot;</span>)),</span>
<span id="cb119-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-5" tabindex="-1"></a>    <span class="at">IQR =</span> X75.<span class="sc">-</span>X25.</span>
<span id="cb119-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-6" tabindex="-1"></a>  )</span>
<span id="cb119-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-7" tabindex="-1"></a></span>
<span id="cb119-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-8" tabindex="-1"></a>vlines<span class="ot">&lt;-</span><span class="fu">tibble</span>(</span>
<span id="cb119-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-9" tabindex="-1"></a>  <span class="at">rounding =</span> <span class="fu">c</span>(<span class="st">&quot;0.10&quot;</span>,<span class="st">&quot;0.05&quot;</span>,<span class="st">&quot;0.01&quot;</span>),</span>
<span id="cb119-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-10" tabindex="-1"></a>  <span class="at">IQR =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.025</span>, <span class="fl">0.005</span>)</span>
<span id="cb119-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-11" tabindex="-1"></a>)</span>
<span id="cb119-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-12" tabindex="-1"></a></span>
<span id="cb119-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-13" tabindex="-1"></a>(</span>
<span id="cb119-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt,<span class="fu">aes</span>(<span class="at">x=</span>IQR,<span class="at">color=</span>treatment))</span>
<span id="cb119-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb119-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">data=</span>vlines,<span class="fu">aes</span>(<span class="at">xintercept=</span>IQR),<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb119-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-17" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb119-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-18" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>rounding,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>)</span>
<span id="cb119-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-19" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;posterior interquartile range of latent belief&quot;</span>)</span>
<span id="cb119-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb119-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:HS2016IQR"></span>
<img src="index_files/figure-html/HS2016IQR-1.png" alt="Posterior interquartile range of latent beliefs by rounding category. Vertical lines show the interquartile range if the posterior was uniformly distributed in the interval. " width="672" />
<p class="caption">
Figure 9.3: Posterior interquartile range of latent beliefs by rounding category. Vertical lines show the interquartile range if the posterior was uniformly distributed in the interval.
</p>
</div>
<p>We can also look at the slice of the data corresponding to decisions where the participant made a particular rounded prediction of (say) 80%.<a href="#fn44" class="footnote-ref" id="fnref44"><sup>44</sup></a> For these decisions, we told our model that actual beliefs were somewhere between 75% and 85%. Figure <a href="more-filling-in-the-blanks-data-augmentation.html#fig:HS2016y80">9.4</a> shows the distribution of these individual-level latent beliefs (the black line shows the empirical cumulative density of the posterior mean, and the red error bars show 50% Bayesian credible regions). While there is quite a range for these estimates, we can see that for some decisions participants’ latent beliefs were actually substantially different to 80% (based on their credible regions not overlapping with 80%).</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-1" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>D.beliefs <span class="sc">|&gt;</span> </span>
<span id="cb120-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-2" tabindex="-1"></a>  <span class="fu">filter</span>(Actual.Prediction<span class="sc">==</span><span class="dv">80</span>) <span class="sc">|&gt;</span></span>
<span id="cb120-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-3" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span></span>
<span id="cb120-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb120-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-5" tabindex="-1"></a>    <span class="at">cumul =</span> <span class="fu">rank</span>(mean)<span class="sc">/</span><span class="fu">n</span>()<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="fu">n</span>()</span>
<span id="cb120-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-6" tabindex="-1"></a>  )</span>
<span id="cb120-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-7" tabindex="-1"></a></span>
<span id="cb120-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-8" tabindex="-1"></a>(</span>
<span id="cb120-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt)</span>
<span id="cb120-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean),<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb120-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y=</span>cumul,<span class="at">xmin=</span>X25., <span class="at">xmax=</span>X75.),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb120-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlim</span>(<span class="fu">c</span>(<span class="fl">0.75</span>,<span class="fl">0.85</span>))</span>
<span id="cb120-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment)</span>
<span id="cb120-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb120-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Latent belief&quot;</span>)</span>
<span id="cb120-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Empirical cumulative density of posterior mean&quot;</span>)</span>
<span id="cb120-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb120-17" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:HS2016y80"></span>
<img src="index_files/figure-html/HS2016y80-1.png" alt="Posterior distribution of latent beliefs conditional on reporting a belief of 80%. Black line shows the empirical cumulative density of postterior means, and the red error bars show 50% Bayesian credible regions (25th-75th percentiles). " width="672" />
<p class="caption">
Figure 9.4: Posterior distribution of latent beliefs conditional on reporting a belief of 80%. Black line shows the empirical cumulative density of postterior means, and the red error bars show 50% Bayesian credible regions (25th-75th percentiles).
</p>
</div>
<p>Finally, we can look at estimated beliefs after (say) observing one red ball and zero blue draws. In this case Bayes’ rule says that participants’ belief in the red cup being used should be <span class="math inline">\(\frac{2}{3}\)</span>. This is shows in Figure <a href="more-filling-in-the-blanks-data-augmentation.html#fig:HS2016onered">9.5</a> as the black vertical dashed line. Here we can see that in all treatments there is some spread around this true value, although there is less spread in the BDM and LC treatments, with a substantial mass choosing very close to the correct number.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-1" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>D.beliefs <span class="sc">|&gt;</span></span>
<span id="cb121-2"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-2" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb121-3"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-3" tabindex="-1"></a>    red.draws<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> blue.draws<span class="sc">==</span><span class="dv">0</span></span>
<span id="cb121-4"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-4" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb121-5"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-5" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span></span>
<span id="cb121-6"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-6" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb121-7"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-7" tabindex="-1"></a>    <span class="at">cumul =</span> <span class="fu">rank</span>(mean)<span class="sc">/</span><span class="fu">n</span>()<span class="sc">-</span><span class="fl">0.5</span><span class="sc">/</span><span class="fu">n</span>()</span>
<span id="cb121-8"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-8" tabindex="-1"></a>  )</span>
<span id="cb121-9"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-9" tabindex="-1"></a></span>
<span id="cb121-10"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-10" tabindex="-1"></a>(</span>
<span id="cb121-11"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt)</span>
<span id="cb121-12"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean))</span>
<span id="cb121-13"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>treatment)</span>
<span id="cb121-14"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>reported.belief,<span class="at">y=</span>cumul),<span class="at">size=</span><span class="dv">1</span>,<span class="at">color=</span><span class="st">&quot;blue&quot;</span>)</span>
<span id="cb121-15"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">y=</span>cumul,<span class="at">xmin =</span> X25., <span class="at">xmax=</span>X75.),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb121-16"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">2</span><span class="sc">/</span><span class="dv">3</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb121-17"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-17" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb121-18"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-18" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Belief in red cup&quot;</span>)</span>
<span id="cb121-19"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-19" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Empirical cumulative density of posterior mean&quot;</span>)</span>
<span id="cb121-20"><a href="more-filling-in-the-blanks-data-augmentation.html#cb121-20" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:HS2016onered"></span>
<img src="index_files/figure-html/HS2016onered-1.png" alt="Distribution of latent beliefs after observing one red ball. Black line shows the empirical cumulative density function of posterior means. Red error bars show 25% Bayesian credible regions (25th-75th percentiles). Blue dots show reported belief. " width="672" />
<p class="caption">
Figure 9.5: Distribution of latent beliefs after observing one red ball. Black line shows the empirical cumulative density function of posterior means. Red error bars show 25% Bayesian credible regions (25th-75th percentiles). Blue dots show reported belief.
</p>
</div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-BR2024" class="csl-entry">
———. 2025. <span>“Rounding the (Non) Bayesian Curve: Unraveling the Effects of Rounding Errors in Belief Updating.”</span> <em>Available at SSRN</em>.
</div>
<div id="ref-Grether1980" class="csl-entry">
Grether, D. M. 1980. <span>“Bayes Rule as a Descriptive Model: The Representativeness Heuristic.”</span> <em>The Quarterly Journal of Economics</em> 95 (3): 537.
</div>
<div id="ref-HS2016" class="csl-entry">
Holt, Charles A, and Angela M. Smith. 2016. <span>“Belief Elicitation with a Synchronized Lottery Choice Menu That Is Invariant to Risk Attitudes.”</span> <em>American Economic Journal: Microeconomics</em> 8 (1): 110–39. <a href="https://doi.org/10.1257/mic.20130274">https://doi.org/10.1257/mic.20130274</a>.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="39">
<li id="fn39"><p>By this, I mean the art of deriving conjugate priors for everything and coding up one’s own Gibbs sampler.<a href="more-filling-in-the-blanks-data-augmentation.html#fnref39" class="footnote-back">↩︎</a></p></li>
<li id="fn40"><p>Go and read <span class="citation">Bland and Rosokha (<a href="#ref-BR2024">2025</a>)</span> for how to do the full thing, complete with how to implement it in <em>Stan</em>. <a href="more-filling-in-the-blanks-data-augmentation.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>We could, however, estimate this with interval regression. <a href="more-filling-in-the-blanks-data-augmentation.html#fnref41" class="footnote-back">↩︎</a></p></li>
<li id="fn42"><p>This is because in <span class="citation">Bland and Rosokha (<a href="#ref-BR2024">2025</a>)</span> we find that rounding <em>at the boundary</em> is really important. There just aren’t that many boundary decisions in <span class="citation">Holt and Smith (<a href="#ref-HS2016">2016</a>)</span>, and so I don’t think our treatment of rounding is going to change their conclusions. <a href="more-filling-in-the-blanks-data-augmentation.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>For example, if a participant reports beliefs of 70%, then we pass bounds for their latent beliefs to <em>Stan</em> as (the logit of) <span class="math inline">\([0.65,0.75]\)</span>. If the posterior latent belief is uniformly distributed in this range, then the posterior interquartile range will be 0.05.<a href="more-filling-in-the-blanks-data-augmentation.html#fnref43" class="footnote-back">↩︎</a></p></li>
<li id="fn44"><p>I chose this because these reports were fairly common in the data. The most common report was 50%, but I wanted to focus on data that were not associated with just eliciting the prior probability of the red cup. <a href="more-filling-in-the-blanks-data-augmentation.html#fnref44" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="filling-in-the-blanks-imputation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
