<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Using your structural estimates as explanatory variables in regression models | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="9 Using your structural estimates as explanatory variables in regression models | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Using your structural estimates as explanatory variables in regression models | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Using your structural estimates as explanatory variables in regression models | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="filling-in-the-blanks-imputation.html"/>
<link rel="next" href="model-evaluation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html"><i class="fa fa-check"></i><b>8</b> Filling in the blanks: Imputation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#example-model-and-dataset-yet-again-with-bfs2019"><i class="fa fa-check"></i><b>8.1</b> Example model and dataset: yet again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a></li>
<li class="chapter" data-level="8.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#how-is-this-going-to-work"><i class="fa fa-check"></i><b>8.2</b> How is this going to work?</a></li>
<li class="chapter" data-level="8.3" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#implementation"><i class="fa fa-check"></i><b>8.3</b> Implementation</a></li>
<li class="chapter" data-level="8.4" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#results"><i class="fa fa-check"></i><b>8.4</b> Results</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#using-the-correlation-matrix"><i class="fa fa-check"></i><b>8.4.1</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="8.4.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#the-correlation-matrix-is-doing-a-lot-of-heavy-lifting-here"><i class="fa fa-check"></i><b>8.4.2</b> The correlation matrix is doing a lot of heavy lifting here</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#conclusion"><i class="fa fa-check"></i><b>8.5</b> Conclusion</a></li>
<li class="chapter" data-level="8.6" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#r-code-used-for-this-chapter-1"><i class="fa fa-check"></i><b>8.6</b> <em>R</em> code used for this chapter</a></li>
<li class="chapter" data-level="" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#acknowedgements"><i class="fa fa-check"></i>Acknowedgements</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><i class="fa fa-check"></i><b>9</b> Using your structural estimates as explanatory variables in regression models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1-a-probit-model-with-risk-preferences-measured-by-holt2002."><i class="fa fa-check"></i><b>9.1</b> Example 1: a probit model with risk preferences measured by <span class="citation">Holt and Laury (2002)</span>.</a></li>
<li class="chapter" data-level="9.2" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2-a-random-effects-logit-model-with-risk-and-time-preferences."><i class="fa fa-check"></i><b>9.2</b> Example 2: A random effects logit model with risk and time preferences.</a></li>
<li class="chapter" data-level="9.3" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3-logit-and-ordered-logit-with-risk-preferences-from-gneezy1997"><i class="fa fa-check"></i><b>9.3</b> Example 3: Logit and ordered logit with risk preferences from <span class="citation">Gneezy and Potters (1997)</span></a></li>
<li class="chapter" data-level="9.4" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#a-note-of-caution"><i class="fa fa-check"></i><b>9.4</b> A note of caution</a></li>
<li class="chapter" data-level="9.5" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#conclusion-1"><i class="fa fa-check"></i><b>9.5</b> Conclusion</a></li>
<li class="chapter" data-level="9.6" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#r-code-used-for-this-chapter-2"><i class="fa fa-check"></i><b>9.6</b> <em>R</em> code used for this chapter</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1"><i class="fa fa-check"></i><b>9.6.1</b> Example 1</a></li>
<li class="chapter" data-level="9.6.2" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2"><i class="fa fa-check"></i><b>9.6.2</b> Example 2</a></li>
<li class="chapter" data-level="9.6.3" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3"><i class="fa fa-check"></i><b>9.6.3</b> Example 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>10</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-evaluation.html"><a href="model-evaluation.html#example-dataset-and-models"><i class="fa fa-check"></i><b>10.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="10.2" data-path="model-evaluation.html"><a href="model-evaluation.html#model-posterior-probabilities"><i class="fa fa-check"></i><b>10.2</b> Model posterior probabilities</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-evaluation.html"><a href="model-evaluation.html#implementation-using-bridge-sampling-and-the-bridgesampling-library"><i class="fa fa-check"></i><b>10.2.1</b> Implementation using bridge sampling and the <code>bridgesampling</code> library</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-evaluation.html"><a href="model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>10.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-evaluation.html"><a href="model-evaluation.html#expected-log-predicted-density-elpd-and-other-measures-of-goodness-of-fit"><i class="fa fa-check"></i><b>10.3.1</b> Expected Log Predicted Density (ELPD) and other measures of goodness of fit</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-evaluation.html"><a href="model-evaluation.html#round-cross-validation"><i class="fa fa-check"></i><b>10.3.2</b> 1-round cross-validation</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-evaluation.html"><a href="model-evaluation.html#leave-one-out-cross-validation-loo"><i class="fa fa-check"></i><b>10.3.3</b> Leave-one-out cross-validation (LOO)</a></li>
<li class="chapter" data-level="10.3.4" data-path="model-evaluation.html"><a href="model-evaluation.html#approximate-loo"><i class="fa fa-check"></i><b>10.3.4</b> Approximate LOO</a></li>
<li class="chapter" data-level="10.3.5" data-path="model-evaluation.html"><a href="model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>10.3.5</b> <span class="math inline">\(k\)</span>-fold cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>11</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="11.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>11.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="11.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>11.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="11.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>11.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="11.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>11.4</b> Vectorization</a></li>
<li class="chapter" data-level="11.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>11.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="11.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>11.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>11.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="11.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>11.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>11.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>11.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="11.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>11.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="12" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>12</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>12.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="12.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>12.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="12.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>12.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>12.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="12.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>12.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="12.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>12.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>12.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>12.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="12.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>12.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="12.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-2"><i class="fa fa-check"></i><b>12.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>12.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>12.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="12.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>12.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="12.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>12.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>13</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>13.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="13.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>13.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>13.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="13.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>13.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>13.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>14</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>14.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="14.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>14.2</b> The likelihood function</a></li>
<li class="chapter" data-level="14.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>14.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="14.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-3"><i class="fa fa-check"></i><b>14.4</b> Results</a></li>
<li class="chapter" data-level="14.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>14.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>15</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="15.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>15.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="15.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>15.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>15.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="15.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>15.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="15.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>15.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="15.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>15.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>15.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="15.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>15.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>15.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="15.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>15.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="15.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>15.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>16</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>16.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="16.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>16.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>16.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="16.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>16.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="16.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>16.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="16.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-4"><i class="fa fa-check"></i><b>16.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>16.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>17</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1"><i class="fa fa-check"></i><b>17.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="17.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>17.2</b> A note on replication</a></li>
<li class="chapter" data-level="17.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>17.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>17.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="17.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>17.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="17.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>17.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-5"><i class="fa fa-check"></i><b>17.4</b> Results</a></li>
<li class="chapter" data-level="17.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>17.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><i class="fa fa-check"></i><b>18</b> Application: QRE in a Bayesian game and cursed equilibrium</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#example-game-and-dataset"><i class="fa fa-check"></i><b>18.1</b> Example game and dataset</a></li>
<li class="chapter" data-level="18.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#solving-for-qre"><i class="fa fa-check"></i><b>18.2</b> Solving for QRE</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#baseline-model"><i class="fa fa-check"></i><b>18.2.1</b> Baseline model</a></li>
<li class="chapter" data-level="18.2.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cursed-equilibrium"><i class="fa fa-check"></i><b>18.2.2</b> Cursed equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#a-quick-prior-calibration-1"><i class="fa fa-check"></i><b>18.3</b> A quick prior calibration</a></li>
<li class="chapter" data-level="18.4" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-results"><i class="fa fa-check"></i><b>18.4</b> Model results</a></li>
<li class="chapter" data-level="18.5" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-evaluation-1"><i class="fa fa-check"></i><b>18.5</b> Model evaluation</a></li>
<li class="chapter" data-level="18.6" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#r-code-used-in-this-chapter"><i class="fa fa-check"></i><b>18.6</b> <em>R</em> code used in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>19</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="19.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>19.1</b> Data and game</a></li>
<li class="chapter" data-level="19.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>19.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>19.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="19.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>19.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>19.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>19.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>19.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="19.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>19.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>19.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>19.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>19.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>19.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>19.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>19.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="19.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>19.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>19.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>19.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="19.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>19.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>19.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>19.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>19.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-10"><i class="fa fa-check"></i><b>19.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>19.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>19.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="19.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>19.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="19.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>19.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="19.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>19.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="19.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>19.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>20</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="20.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>20.1</b> Example dataset</a></li>
<li class="chapter" data-level="20.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>20.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="20.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>20.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>20.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="20.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>20.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="20.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>20.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>20.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>20.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="20.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>20.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>20.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>21</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="21.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>21.1</b> Data</a></li>
<li class="chapter" data-level="21.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>21.2</b> A basic model</a></li>
<li class="chapter" data-level="21.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>21.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="21.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>21.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="21.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>21.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="21.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>21.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html"><i class="fa fa-check"></i><b>22</b> Application: choice bracketing</a>
<ul>
<li class="chapter" data-level="22.1" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#data-and-model"><i class="fa fa-check"></i><b>22.1</b> Data and model</a></li>
<li class="chapter" data-level="22.2" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#representative-agent-and-individual-estimation"><i class="fa fa-check"></i><b>22.2</b> Representative agent and individual estimation</a></li>
<li class="chapter" data-level="22.3" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#hierarchical-model-2"><i class="fa fa-check"></i><b>22.3</b> Hierarchical model</a></li>
<li class="chapter" data-level="22.4" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#a-mixture-model-1"><i class="fa fa-check"></i><b>22.4</b> A mixture model</a></li>
<li class="chapter" data-level="22.5" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#what-do-we-get-out-of-the-structural-models-and-what-could-we-miss"><i class="fa fa-check"></i><b>22.5</b> What do we get out of the structural models, and what could we miss?</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>23</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="23.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>23.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="23.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>23.2</b> Computational issues</a></li>
<li class="chapter" data-level="23.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>23.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="23.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>23.4</b> A representative agent model</a></li>
<li class="chapter" data-level="23.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>23.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="23.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>23.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="using-your-structural-estimates-as-explanatory-variables-in-regression-models" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">9</span> Using your structural estimates as explanatory variables in regression models<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#using-your-structural-estimates-as-explanatory-variables-in-regression-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One thing we see a lot of in experiments is <strong>estimates</strong> of structural parameters being used as explanatory variables on the right-hand-side of regressions. This is either because we want to explicitly comment on the coefficients or marginal effects associated with these parameters, or because we want to include them as control variables (so that we can comment on other coefficients). While it is natural to want to do this, and it can answer some interesting research questions, we need to be careful. In particular, we need to use models that respect that these estimates are measured imprecisely, and that this measurement error may be non-classical. By “non-classical” here I mean that we cannot represent the measurement error as an iid shock to the measured quantity. If measurement error is classical, then there are other ways to deal with the problem (such as using an instrumental variables approach, see <span class="citation">Gillen, Snowberg, and Yariv (<a href="#ref-Gillen2019">2019</a>)</span> for an example), but the kind of measurement error we deal with is rarely classical, so having a structural model for that measurement error becomes really important.</p>
<p>Take for example the <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span> risk preference elicitation task. In just a few decisions we can gauge the amount of risk-aversion a participant has. However since this task (usually) elicits a switching point over a discrete list of lottery pairs, all we can really conclude from a participant’s choice is that risk aversion falls within a range.<a href="#fn39" class="footnote-ref" id="fnref39"><sup>39</sup></a> That is, we can conclude that <span class="math inline">\(r_i\in(a_i,b_i)\)</span>, but we cannot narrow down this range further: the data are <em>interval-valued</em> (rather than real- or point-valued). Proper treatment of these data would respect this, and carry through this uncertainty in our estimation. Yet it is <em>very</em> common to “control” for (say) risk preferences just using the implied midpoints of these ranges, or just by counting the number of safe choices the participant makes. In practice, it is either difficult or impossible (depending on the type of measurement error) to carry through appropriate uncertainty in the structural estimates to the regression we would like to run, unless we estimate both the structural model and the regression <em>jointly</em>. This is what we will be doing in this chapter. We will explicitly model right-hand-side variables that are interval-valued, or imprecisely estimated.</p>
<div id="example-1-a-probit-model-with-risk-preferences-measured-by-holt2002." class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Example 1: a probit model with risk preferences measured by <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span>.<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1-a-probit-model-with-risk-preferences-measured-by-holt2002." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Saccardo, Pietrasz, and Gneezy (<a href="#ref-SPG2018">2018</a>)</span> investigate the gender gap in competitiveness using a piece rate/tournament experiment. In investigating the extensive margin (do people choose to compete?), they use a probit model to estimate the difference between men and women’s decision to enter this tournament. The right-hand-side variable of interest is a <code>female</code> dummy variable, and in some specifications they also include decisions from a <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span> task on the right-hand side as a control for risk preferences. The point of this is to account for how much of the competitiveness gender gap can be “explained” by differences in risk preferences between men and women. While <span class="citation">Saccardo, Pietrasz, and Gneezy (<a href="#ref-SPG2018">2018</a>)</span> just include an integer for the switching point in the <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span> task on the right-hand side, I will investigate an alternative model with a structural estimate of the coefficient of absolute risk-aversion on the right-hand side instead. That is, I will structurally estimate an expected utility model with CRRA utility from the risk elicitation task, and jointly estimate its effect on competitiveness. My probit model will therefore be:</p>
<p><span class="math display">\[
\begin{aligned}
\Pr(\text{EnterTournament}_i=1\mid \mathrm{Female}_i, r)&amp;=\Phi\left(\beta_0+\beta_1\mathrm{Female}_i+\alpha r_i\right)
\end{aligned}
\]</span>
where <span class="math inline">\(r_i\)</span> is the CRRA coefficient, and <span class="math inline">\(\Phi(\cdot)\)</span> is the standard normal cdf.</p>
<p>The trick here is to <em>jointly</em> estimate this model alongside estimating <span class="math inline">\(r_i\)</span> for each subject. That way, the posterior uncertainty in <span class="math inline">\(r_i\)</span> is carried through to the posterior uncertainty in <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\alpha\)</span>. Also, since this is a non-linear model, I will of course translate these coefficients into marginal effects so we can actually understand the effect sizes. Here we are primarily interested in the marginal effect of <code>Female</code>, which measures the difference in probability between female and male competitiveness.</p>
<p>Here is the <em>Stan</em> program I came up with for writing this:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb110-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-1" tabindex="-1"></a><span class="co">/* A probit model that includes CRRA risk-aversion on the RHS as</span></span>
<span id="cb110-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-2" tabindex="-1"></a><span class="co">estimated from a Holt &amp; Laury (2002) task. This accounts for the </span></span>
<span id="cb110-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-3" tabindex="-1"></a><span class="co">fact that HL2002 data are interval-valued. </span></span>
<span id="cb110-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-4" tabindex="-1"></a></span>
<span id="cb110-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-5" tabindex="-1"></a><span class="co">*/</span></span>
<span id="cb110-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-6" tabindex="-1"></a></span>
<span id="cb110-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-7" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb110-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-8" tabindex="-1"></a>  </span>
<span id="cb110-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-9" tabindex="-1"></a>  </span>
<span id="cb110-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-10" tabindex="-1"></a>  vector HLindiff<span class="op">(</span>vector r<span class="op">,</span> real pr1<span class="op">,</span> vector prizeA<span class="op">,</span> vector prizeB<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-11" tabindex="-1"></a>    </span>
<span id="cb110-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-12" tabindex="-1"></a>    real uA <span class="op">=</span> <span class="op">[</span>pr1<span class="op">,</span> <span class="fl">1.0</span><span class="op">-</span>pr1<span class="op">]*</span>pow<span class="op">(</span>prizeA<span class="op">,</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">])/(</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb110-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-13" tabindex="-1"></a>    real uB <span class="op">=</span> <span class="op">[</span>pr1<span class="op">,</span> <span class="fl">1.0</span><span class="op">-</span>pr1<span class="op">]*</span>pow<span class="op">(</span>prizeB<span class="op">,</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">])/(</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb110-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-14" tabindex="-1"></a>    </span>
<span id="cb110-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-15" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span>uA<span class="op">-</span>uB<span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb110-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-16" tabindex="-1"></a>    </span>
<span id="cb110-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-17" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb110-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-18" tabindex="-1"></a>  </span>
<span id="cb110-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-19" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-20" tabindex="-1"></a></span>
<span id="cb110-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-21" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb110-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-22" tabindex="-1"></a>  </span>
<span id="cb110-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-23" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb110-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-24" tabindex="-1"></a>  <span class="dt">int</span> k<span class="op">;</span> <span class="co">// number of covariates</span></span>
<span id="cb110-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-25" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X<span class="op">;</span> <span class="co">// covariates</span></span>
<span id="cb110-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-26" tabindex="-1"></a>  </span>
<span id="cb110-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-27" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span> Y<span class="op">;</span> <span class="co">// outcome variable.</span></span>
<span id="cb110-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-28" tabindex="-1"></a>  </span>
<span id="cb110-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-29" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span> HL<span class="op">;</span> <span class="co">// HL2002 choices</span></span>
<span id="cb110-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-30" tabindex="-1"></a>  </span>
<span id="cb110-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-31" tabindex="-1"></a>  </span>
<span id="cb110-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-32" tabindex="-1"></a>  </span>
<span id="cb110-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-33" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r_mean<span class="op">;</span></span>
<span id="cb110-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-34" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> prior_r_sd<span class="op">;</span></span>
<span id="cb110-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-35" tabindex="-1"></a>  </span>
<span id="cb110-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-36" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_beta<span class="op">;</span></span>
<span id="cb110-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-37" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_alpha<span class="op">;</span></span>
<span id="cb110-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-38" tabindex="-1"></a>  </span>
<span id="cb110-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-39" tabindex="-1"></a>  array<span class="op">[</span>k<span class="op">]</span> <span class="dt">int</span> is_discrete<span class="op">;</span></span>
<span id="cb110-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-40" tabindex="-1"></a>  </span>
<span id="cb110-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-41" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-42" tabindex="-1"></a></span>
<span id="cb110-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-43" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb110-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-44" tabindex="-1"></a>  </span>
<span id="cb110-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-45" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">10</span><span class="op">]</span> pr1 <span class="op">=</span> <span class="op">[</span><span class="fl">0.1</span><span class="op">,</span><span class="fl">0.2</span><span class="op">,</span><span class="fl">0.3</span><span class="op">,</span><span class="fl">0.4</span><span class="op">,</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.6</span><span class="op">,</span><span class="fl">0.7</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="fl">0.9</span><span class="op">,</span><span class="fl">1.0</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb110-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-46" tabindex="-1"></a>  </span>
<span id="cb110-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-47" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prizeA <span class="op">=</span> <span class="op">[</span><span class="dv">200</span><span class="op">,</span> <span class="dv">160</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb110-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-48" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prizeB <span class="op">=</span> <span class="op">[</span><span class="dv">385</span><span class="op">,</span><span class="dv">10</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb110-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-49" tabindex="-1"></a>  </span>
<span id="cb110-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-50" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">10</span><span class="op">]</span> r_indiff<span class="op">;</span></span>
<span id="cb110-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-51" tabindex="-1"></a>  </span>
<span id="cb110-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-52" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>pp in <span class="dv">1</span><span class="op">:</span><span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-53" tabindex="-1"></a>    </span>
<span id="cb110-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-54" tabindex="-1"></a>    </span>
<span id="cb110-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-55" tabindex="-1"></a>    <span class="co">// it needs a bit of hand-holding to find the critical points</span></span>
<span id="cb110-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-56" tabindex="-1"></a>    real start<span class="op">;</span></span>
<span id="cb110-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-57" tabindex="-1"></a>    </span>
<span id="cb110-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-58" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>pp<span class="op">&lt;=</span><span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-59" tabindex="-1"></a>      start <span class="op">=</span> <span class="op">-</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb110-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-60" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb110-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-61" tabindex="-1"></a>      start <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb110-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-62" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb110-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-63" tabindex="-1"></a>    </span>
<span id="cb110-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-64" tabindex="-1"></a>    r_indiff<span class="op">[</span>pp<span class="op">]</span> <span class="op">=</span>  solve_newton<span class="op">(</span>HLindiff<span class="op">,</span> <span class="op">[</span>start<span class="op">]</span><span class="ch">&#39;,</span><span class="er"> pr1[pp], prizeA, prizeB)[1];</span></span>
<span id="cb110-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-65" tabindex="-1"></a>    </span>
<span id="cb110-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-66" tabindex="-1"></a>    <span class="co">//print(HLindiff([r_indiff[pp]]&#39;, pr1[pp], prizeA, prizeB));</span></span>
<span id="cb110-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-67" tabindex="-1"></a>    </span>
<span id="cb110-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-68" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb110-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-69" tabindex="-1"></a>  </span>
<span id="cb110-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-70" tabindex="-1"></a>  <span class="co">// check that we get something reasonable here</span></span>
<span id="cb110-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-71" tabindex="-1"></a>  print<span class="op">(</span>r_indiff<span class="op">);</span></span>
<span id="cb110-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-72" tabindex="-1"></a>  </span>
<span id="cb110-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-73" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> HL_lb<span class="op">;</span></span>
<span id="cb110-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-74" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> HL_ub<span class="op">;</span></span>
<span id="cb110-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-75" tabindex="-1"></a>  </span>
<span id="cb110-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-76" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-77" tabindex="-1"></a>    </span>
<span id="cb110-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-78" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>HL<span class="op">[</span>ii<span class="op">]==</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-79" tabindex="-1"></a>      HL_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">999.999</span><span class="op">;</span></span>
<span id="cb110-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-80" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb110-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-81" tabindex="-1"></a>      HL_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> r_indiff<span class="op">[</span>HL<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb110-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-82" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb110-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-83" tabindex="-1"></a>    </span>
<span id="cb110-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-84" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>HL<span class="op">[</span>ii<span class="op">]==</span><span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-85" tabindex="-1"></a>      HL_ub<span class="op">[</span>ii<span class="op">]=</span><span class="fl">999.999</span><span class="op">;</span></span>
<span id="cb110-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-86" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb110-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-87" tabindex="-1"></a>      HL_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> r_indiff<span class="op">[</span>HL<span class="op">[</span>ii<span class="op">]+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb110-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-88" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb110-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-89" tabindex="-1"></a>    </span>
<span id="cb110-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-90" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb110-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-91" tabindex="-1"></a>  </span>
<span id="cb110-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-92" tabindex="-1"></a>  </span>
<span id="cb110-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-93" tabindex="-1"></a>  </span>
<span id="cb110-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-94" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-95" tabindex="-1"></a></span>
<span id="cb110-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-96" tabindex="-1"></a></span>
<span id="cb110-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-97" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb110-98"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-98" tabindex="-1"></a>  </span>
<span id="cb110-99"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-99" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> r_mean<span class="op">;</span></span>
<span id="cb110-100"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-100" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r_sd<span class="op">;</span></span>
<span id="cb110-101"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-101" tabindex="-1"></a>  </span>
<span id="cb110-102"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-102" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>HL_lb<span class="op">,</span>upper<span class="op">=</span>HL_ub<span class="op">&gt;[</span>N<span class="op">]</span> r<span class="op">;</span></span>
<span id="cb110-103"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-103" tabindex="-1"></a>  </span>
<span id="cb110-104"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-104" tabindex="-1"></a>  real alpha<span class="op">;</span></span>
<span id="cb110-105"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-105" tabindex="-1"></a>  </span>
<span id="cb110-106"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-106" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> beta<span class="op">;</span></span>
<span id="cb110-107"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-107" tabindex="-1"></a>  </span>
<span id="cb110-108"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-108" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-109"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-109" tabindex="-1"></a></span>
<span id="cb110-110"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-110" tabindex="-1"></a></span>
<span id="cb110-111"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-111" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb110-112"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-112" tabindex="-1"></a>  </span>
<span id="cb110-113"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-113" tabindex="-1"></a>  <span class="co">// prior ---------------------------------------------------------------------</span></span>
<span id="cb110-114"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-114" tabindex="-1"></a>  r_mean <span class="op">~</span> normal<span class="op">(</span>prior_r_mean<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r_mean<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb110-115"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-115" tabindex="-1"></a>  r_sd <span class="op">~</span> cauchy<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_r_sd<span class="op">);</span></span>
<span id="cb110-116"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-116" tabindex="-1"></a>  </span>
<span id="cb110-117"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-117" tabindex="-1"></a>  beta <span class="op">~</span> normal<span class="op">(</span>prior_beta<span class="op">[</span><span class="dv">1</span><span class="op">],</span> prior_beta<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb110-118"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-118" tabindex="-1"></a>  alpha <span class="op">~</span> normal<span class="op">(</span>prior_alpha<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb110-119"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-119" tabindex="-1"></a>  </span>
<span id="cb110-120"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-120" tabindex="-1"></a>  <span class="co">// augmented data</span></span>
<span id="cb110-121"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-121" tabindex="-1"></a>  r <span class="op">~</span> normal<span class="op">(</span>X<span class="op">*</span>r_mean<span class="op">,</span> r_sd<span class="op">);</span></span>
<span id="cb110-122"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-122" tabindex="-1"></a>  </span>
<span id="cb110-123"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-123" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb110-124"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-124" tabindex="-1"></a>  Y <span class="op">~</span> bernoulli<span class="op">(</span>Phi_approx<span class="op">(</span>X<span class="op">*</span>beta<span class="op">+</span>alpha<span class="op">*</span>r<span class="op">));</span></span>
<span id="cb110-125"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-125" tabindex="-1"></a>  </span>
<span id="cb110-126"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-126" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb110-127"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-127" tabindex="-1"></a></span>
<span id="cb110-128"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-128" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb110-129"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-129" tabindex="-1"></a>  </span>
<span id="cb110-130"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-130" tabindex="-1"></a>  <span class="co">// marginal effects ----------------------------------------------------------</span></span>
<span id="cb110-131"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-131" tabindex="-1"></a>  </span>
<span id="cb110-132"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-132" tabindex="-1"></a>  <span class="co">// since beta[1] is for the constant, we don&#39;t do that one</span></span>
<span id="cb110-133"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-133" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">-</span><span class="dv">1</span><span class="op">]</span> MFX_X<span class="op">;</span></span>
<span id="cb110-134"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-134" tabindex="-1"></a>  </span>
<span id="cb110-135"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-135" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>kk in <span class="dv">2</span><span class="op">:</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-136"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-136" tabindex="-1"></a>    </span>
<span id="cb110-137"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-137" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_discrete<span class="op">[</span>kk<span class="op">]&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb110-138"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-138" tabindex="-1"></a>      </span>
<span id="cb110-139"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-139" tabindex="-1"></a>      matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X0 <span class="op">=</span> X<span class="op">;</span></span>
<span id="cb110-140"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-140" tabindex="-1"></a>        X0<span class="op">[,</span>kk<span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span>N<span class="op">);</span></span>
<span id="cb110-141"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-141" tabindex="-1"></a>      matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X1 <span class="op">=</span> X<span class="op">;</span></span>
<span id="cb110-142"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-142" tabindex="-1"></a>        X1<span class="op">[,</span>kk<span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span>N<span class="op">);</span></span>
<span id="cb110-143"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-143" tabindex="-1"></a>        </span>
<span id="cb110-144"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-144" tabindex="-1"></a>        MFX_X<span class="op">[</span>kk<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> mean<span class="op">(</span>Phi_approx<span class="op">(</span>X1<span class="op">*</span>beta<span class="op">+</span>alpha<span class="op">*</span>r<span class="op">)-</span>Phi_approx<span class="op">(</span>X0<span class="op">*</span>beta<span class="op">+</span>alpha<span class="op">*</span>r<span class="op">));</span></span>
<span id="cb110-145"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-145" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb110-146"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-146" tabindex="-1"></a>      </span>
<span id="cb110-147"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-147" tabindex="-1"></a>      MFX_X<span class="op">[</span>kk<span class="op">-</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> mean<span class="op">(</span></span>
<span id="cb110-148"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-148" tabindex="-1"></a>        beta<span class="op">[</span>kk<span class="op">]*</span><span class="fl">1.0</span><span class="op">/</span>sqrt<span class="op">(</span><span class="fl">2.0</span><span class="op">*</span>pi<span class="op">())*</span>exp<span class="op">(-</span><span class="fl">0.5</span><span class="op">*</span>pow<span class="op">(</span>X<span class="op">*</span>beta<span class="op">+</span>alpha<span class="op">*</span>r<span class="op">,</span><span class="fl">2.0</span><span class="op">))</span></span>
<span id="cb110-149"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-149" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb110-150"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-150" tabindex="-1"></a>      </span>
<span id="cb110-151"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-151" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb110-152"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-152" tabindex="-1"></a>    </span>
<span id="cb110-153"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-153" tabindex="-1"></a>    </span>
<span id="cb110-154"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-154" tabindex="-1"></a>    </span>
<span id="cb110-155"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-155" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb110-156"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-156" tabindex="-1"></a>  real MFX_r <span class="op">=</span> mean<span class="op">(</span></span>
<span id="cb110-157"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-157" tabindex="-1"></a>      alpha<span class="op">*</span><span class="fl">1.0</span><span class="op">/</span>sqrt<span class="op">(</span><span class="fl">2.0</span><span class="op">*</span>pi<span class="op">())*</span>exp<span class="op">(-</span><span class="fl">0.5</span><span class="op">*</span>pow<span class="op">(</span>X<span class="op">*</span>beta<span class="op">+</span>alpha<span class="op">*</span>r<span class="op">,</span><span class="fl">2.0</span><span class="op">))</span></span>
<span id="cb110-158"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-158" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb110-159"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-159" tabindex="-1"></a>  </span>
<span id="cb110-160"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-160" tabindex="-1"></a>  </span>
<span id="cb110-161"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb110-161" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Here I pass the choice made by participants in the <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span> task in as an integer identifying their switching point. In the <code>transformed data</code> block I get <em>Stan</em> to calculate the critical values of <span class="math inline">\(r_i\)</span> that pin down the switching points, then generate <code>HL_lb</code> and <code>HL_ub</code>, which are the upper and lower bounds for <span class="math inline">\(r_i\)</span> implied by the switch point. Then, in the <code>parameters</code> block, I explicitly tell <em>Stan</em> that each participant’s <span class="math inline">\(r_i\)</span> falls in this range:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb111-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb111-1" tabindex="-1"></a>vector<span class="op">&lt;</span>lower<span class="op">=</span>HL_lb<span class="op">,</span>upper<span class="op">=</span>HL_ub<span class="op">&gt;[</span>N<span class="op">]</span> r<span class="op">;</span></span></code></pre></div>
<p>I use a hierarchical model to tame the distribution of <span class="math inline">\(r\)</span>. Specifically, in the <code>model</code> block I assume that <span class="math inline">\(r_i\)</span> follows a normal distribution whose mean depends on the explanatory variables of the probit model (<code>X</code>):</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb112-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb112-1" tabindex="-1"></a>r <span class="op">~</span> normal<span class="op">(</span>X<span class="op">*</span>r_mean<span class="op">,</span> r_sd<span class="op">);</span></span></code></pre></div>
<p>Since <code>X</code> includes our other explanatory variable <code>Female</code>, this allows the distribution of <span class="math inline">\(r_i\)</span> to be different between men and women (at least in that they can have different means).</p>
<p>Finally, in the <code>generated quantities</code> block, I calculate the marginal effects of <code>X</code> and <code>r</code>. Note here that I pass through an integer data variable <code>is_discrete</code> so that the model knows when to take the difference for a discrete RHS variable (i.e. for <code>Female</code>), and when it can take the derivative for a continuous variable.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb113-1" tabindex="-1"></a><span class="st">&quot;Code/SPG2018/Fit_probit.csv&quot;</span> <span class="sc">|&gt;</span> </span>
<span id="cb113-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb113-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb113-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb113-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">|&gt;</span></span>
<span id="cb113-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb113-4" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits=</span><span class="dv">2</span>, <span class="at">caption=</span><span class="st">&quot;Posterior summary of the joinly-estimated probit model&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb113-5" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb113-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb113-6" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;Percentiles&quot;</span><span class="ot">=</span><span class="dv">5</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:regressionRHSprobit">Table 9.1: </span>Posterior summary of the joinly-estimated probit model
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Percentiles
</div>
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X25.
</th>
<th style="text-align:right;">
X50.
</th>
<th style="text-align:right;">
X75.
</th>
<th style="text-align:right;">
X97.5.
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r_mean[1]
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
0.43
</td>
<td style="text-align:right;">
0.67
</td>
<td style="text-align:right;">
0.78
</td>
<td style="text-align:right;">
0.91
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
4490.80
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
r_mean[2]
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.23
</td>
<td style="text-align:right;">
-0.16
</td>
<td style="text-align:right;">
0.14
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
0.45
</td>
<td style="text-align:right;">
0.76
</td>
<td style="text-align:right;">
4348.20
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
r_sd
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
0.90
</td>
<td style="text-align:right;">
0.99
</td>
<td style="text-align:right;">
1.05
</td>
<td style="text-align:right;">
1.12
</td>
<td style="text-align:right;">
1.27
</td>
<td style="text-align:right;">
5402.67
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
alpha
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.15
</td>
<td style="text-align:right;">
-0.22
</td>
<td style="text-align:right;">
-0.03
</td>
<td style="text-align:right;">
0.07
</td>
<td style="text-align:right;">
0.17
</td>
<td style="text-align:right;">
0.36
</td>
<td style="text-align:right;">
6839.76
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[1]
</td>
<td style="text-align:right;">
0.79
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.25
</td>
<td style="text-align:right;">
0.31
</td>
<td style="text-align:right;">
0.61
</td>
<td style="text-align:right;">
0.80
</td>
<td style="text-align:right;">
0.96
</td>
<td style="text-align:right;">
1.30
</td>
<td style="text-align:right;">
4896.86
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
beta[2]
</td>
<td style="text-align:right;">
-1.28
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.29
</td>
<td style="text-align:right;">
-1.85
</td>
<td style="text-align:right;">
-1.47
</td>
<td style="text-align:right;">
-1.27
</td>
<td style="text-align:right;">
-1.09
</td>
<td style="text-align:right;">
-0.70
</td>
<td style="text-align:right;">
5523.82
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MFX_X[1]
</td>
<td style="text-align:right;">
-0.45
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.09
</td>
<td style="text-align:right;">
-0.62
</td>
<td style="text-align:right;">
-0.52
</td>
<td style="text-align:right;">
-0.46
</td>
<td style="text-align:right;">
-0.40
</td>
<td style="text-align:right;">
-0.26
</td>
<td style="text-align:right;">
5569.16
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
MFX_r
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.00
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
-0.07
</td>
<td style="text-align:right;">
-0.01
</td>
<td style="text-align:right;">
0.02
</td>
<td style="text-align:right;">
0.05
</td>
<td style="text-align:right;">
0.11
</td>
<td style="text-align:right;">
6700.16
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
lp__
</td>
<td style="text-align:right;">
-329.27
</td>
<td style="text-align:right;">
0.21
</td>
<td style="text-align:right;">
7.82
</td>
<td style="text-align:right;">
-345.27
</td>
<td style="text-align:right;">
-334.55
</td>
<td style="text-align:right;">
-328.97
</td>
<td style="text-align:right;">
-323.81
</td>
<td style="text-align:right;">
-314.92
</td>
<td style="text-align:right;">
1351.82
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<p>Table <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#tab:regressionRHSprobit">9.1</a> summarizes the posterior distribution of this model. Here the <code>MFX_X[1]</code> parameter is the marginal effect of the <code>Female</code> variable in the probit model. We can interpret this as female participants are about 45 percentage points less likely to compete than male participants with the same risk preferences.</p>
</div>
<div id="example-2-a-random-effects-logit-model-with-risk-and-time-preferences." class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Example 2: A random effects logit model with risk and time preferences.<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2-a-random-effects-logit-model-with-risk-and-time-preferences." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Davis, Ivanov, and Korenok (<a href="#ref-DIK2016">2016</a>)</span> investigate the role of various individual characteristics in explaining behavior in some indefinitely-repeated games. Here I will focus on first-round cooperation in an indefinitely-repeated Prisoner’s Dilemma game. I will take a random effects logit model to the data, where the imprecisely-measured right-hand-side variables are risk and time preferece parameters. Both of these preferences were measured using a multiple price list, with the risk task looking exactly the same as the previous example (except for scaling the payoffs, i.e. it is a <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span> task), and time preferences were elicited by asking participants to choose between <span class="math inline">\(\$18\)</span> now and <span class="math inline">\(\$ x\)</span> in a week’s time, for ten values of <span class="math inline">\(x&gt;18\)</span>.</p>
<p>I will approach this problem exactly the same as the previous example in that I will assume that the risk and time preference tasks should be treated as interval-valued.<a href="#fn40" class="footnote-ref" id="fnref40"><sup>40</sup></a> I then impose a hierarchical structure on the joint distribution of <span class="math inline">\(r_i\)</span> (risk preference, CRRA coefficient), and <span class="math inline">\(\delta_i\)</span> (time preference, weekly discount rate), assuming that:</p>
<p><span class="math display">\[
\begin{pmatrix}
r_i\\ \log\delta_i
\end{pmatrix}\sim N(\mu,\Sigma)
\]</span></p>
<p><span class="math inline">\(r_i\)</span> and <span class="math inline">\(\delta_i\)</span> then become right-hand-side variables in the random effects logit regression model:</p>
<p><span class="math display">\[
\begin{aligned}
Y_{i,t} &amp;\sim\mathrm{Bernoulli\ Logit}\left(\alpha_1 r_i+\alpha_2 \delta_i + x_i^\top\beta+u_i\right)\\
u_i&amp;\sim iid N(0,\sigma^2_u)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(x_{i}\)</span> are participant-specific characteristics that were elicited in the experiment (plus a constant),<a href="#fn41" class="footnote-ref" id="fnref41"><sup>41</sup></a>
and the <span class="math inline">\(u_i\)</span>s are the participant-specific random effects. Note that the random effects specification is itself a hierarchical model.</p>
<p>Here is the <em>Stan</em> program I wrote to estimate the model and calculate marginal effects. Hopefully you can see that I’ve borrowed a lot of code from my first example. There’s no need to re-invent the wheel here!</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb114-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-1" tabindex="-1"></a></span>
<span id="cb114-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-2" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb114-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-3" tabindex="-1"></a>  </span>
<span id="cb114-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-4" tabindex="-1"></a>   vector HLindiff<span class="op">(</span>vector r<span class="op">,</span> real pr1<span class="op">,</span> vector prizeA<span class="op">,</span> vector prizeB<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-5" tabindex="-1"></a>    </span>
<span id="cb114-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-6" tabindex="-1"></a>    real uA <span class="op">=</span> <span class="op">[</span>pr1<span class="op">,</span> <span class="fl">1.0</span><span class="op">-</span>pr1<span class="op">]*</span>pow<span class="op">(</span>prizeA<span class="op">,</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">])/(</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb114-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-7" tabindex="-1"></a>    real uB <span class="op">=</span> <span class="op">[</span>pr1<span class="op">,</span> <span class="fl">1.0</span><span class="op">-</span>pr1<span class="op">]*</span>pow<span class="op">(</span>prizeB<span class="op">,</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">])/(</span><span class="fl">1.0</span><span class="op">-</span>r<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb114-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-8" tabindex="-1"></a>    </span>
<span id="cb114-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-9" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">[</span>uA<span class="op">-</span>uB<span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb114-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-10" tabindex="-1"></a>    </span>
<span id="cb114-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-11" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-12" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-13" tabindex="-1"></a></span>
<span id="cb114-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-14" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb114-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-15" tabindex="-1"></a>  </span>
<span id="cb114-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-16" tabindex="-1"></a>  <span class="dt">int</span> nparticipants<span class="op">;</span></span>
<span id="cb114-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-17" tabindex="-1"></a>  </span>
<span id="cb114-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-18" tabindex="-1"></a>  <span class="co">// data from risk and time preference elicitation task -----------------------</span></span>
<span id="cb114-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-19" tabindex="-1"></a>  array<span class="op">[</span>nparticipants<span class="op">]</span> <span class="dt">int</span> nrisky<span class="op">;</span></span>
<span id="cb114-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-20" tabindex="-1"></a>  array<span class="op">[</span>nparticipants<span class="op">]</span> <span class="dt">int</span> npatient<span class="op">;</span></span>
<span id="cb114-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-21" tabindex="-1"></a>  </span>
<span id="cb114-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-22" tabindex="-1"></a>  array<span class="op">[</span><span class="dv">2</span><span class="op">]</span> vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_MU<span class="op">;</span></span>
<span id="cb114-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-23" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_TAU<span class="op">;</span></span>
<span id="cb114-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-24" tabindex="-1"></a>  real prior_Omega<span class="op">;</span></span>
<span id="cb114-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-25" tabindex="-1"></a>  </span>
<span id="cb114-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-26" tabindex="-1"></a>  <span class="co">// data for logit ------------------------------------------------------------</span></span>
<span id="cb114-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-27" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb114-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-28" tabindex="-1"></a>  <span class="dt">int</span> k<span class="op">;</span> <span class="co">// number of explainatory variables</span></span>
<span id="cb114-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-29" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span> Y<span class="op">;</span> <span class="co">// outcome variable</span></span>
<span id="cb114-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-30" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X<span class="op">;</span> <span class="co">// explanatory variables</span></span>
<span id="cb114-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-31" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span> id<span class="op">;</span> <span class="co">// participant id</span></span>
<span id="cb114-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-32" tabindex="-1"></a>  array<span class="op">[</span>k<span class="op">]</span> <span class="dt">int</span> is_discrete<span class="op">;</span> <span class="co">// indicator for whather or not an x-variable is discrete. </span></span>
<span id="cb114-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-33" tabindex="-1"></a>  </span>
<span id="cb114-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-34" tabindex="-1"></a>  array<span class="op">[</span>k<span class="op">]</span> vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_beta<span class="op">;</span></span>
<span id="cb114-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-35" tabindex="-1"></a>  array<span class="op">[</span><span class="dv">2</span><span class="op">]</span> vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_alpha<span class="op">;</span></span>
<span id="cb114-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-36" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> prior_REsd<span class="op">;</span></span>
<span id="cb114-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-37" tabindex="-1"></a>  </span>
<span id="cb114-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-38" tabindex="-1"></a>  </span>
<span id="cb114-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-39" tabindex="-1"></a>  </span>
<span id="cb114-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-40" tabindex="-1"></a>  </span>
<span id="cb114-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-41" tabindex="-1"></a>  </span>
<span id="cb114-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-42" tabindex="-1"></a>  </span>
<span id="cb114-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-43" tabindex="-1"></a>  </span>
<span id="cb114-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-44" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-45" tabindex="-1"></a></span>
<span id="cb114-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-46" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb114-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-47" tabindex="-1"></a>  </span>
<span id="cb114-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-48" tabindex="-1"></a>  </span>
<span id="cb114-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-49" tabindex="-1"></a>  <span class="co">// bounds for HL task --------------------------------------------------------</span></span>
<span id="cb114-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-50" tabindex="-1"></a>  </span>
<span id="cb114-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-51" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">10</span><span class="op">]</span> pr1 <span class="op">=</span> <span class="op">[</span><span class="fl">0.1</span><span class="op">,</span><span class="fl">0.2</span><span class="op">,</span><span class="fl">0.3</span><span class="op">,</span><span class="fl">0.4</span><span class="op">,</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.6</span><span class="op">,</span><span class="fl">0.7</span><span class="op">,</span><span class="fl">0.8</span><span class="op">,</span><span class="fl">0.9</span><span class="op">,</span><span class="fl">1.0</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb114-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-52" tabindex="-1"></a>  </span>
<span id="cb114-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-53" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prizeA <span class="op">=</span> <span class="op">[</span><span class="dv">20</span><span class="op">,</span> <span class="dv">16</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb114-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-54" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prizeB <span class="op">=</span> <span class="op">[</span><span class="fl">38.5</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb114-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-55" tabindex="-1"></a>  </span>
<span id="cb114-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-56" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">10</span><span class="op">]</span> r_indiff<span class="op">;</span></span>
<span id="cb114-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-57" tabindex="-1"></a>  </span>
<span id="cb114-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-58" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>pp in <span class="dv">1</span><span class="op">:</span><span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-59" tabindex="-1"></a>    </span>
<span id="cb114-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-60" tabindex="-1"></a>    </span>
<span id="cb114-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-61" tabindex="-1"></a>    <span class="co">// it needs a bit of hand-holding to find the critical points</span></span>
<span id="cb114-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-62" tabindex="-1"></a>    real start<span class="op">;</span></span>
<span id="cb114-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-63" tabindex="-1"></a>    </span>
<span id="cb114-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-64" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>pp<span class="op">&lt;=</span><span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-65" tabindex="-1"></a>      start <span class="op">=</span> <span class="op">-</span><span class="dv">2</span><span class="op">;</span></span>
<span id="cb114-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-66" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-67" tabindex="-1"></a>      start <span class="op">=</span> <span class="fl">0.5</span><span class="op">;</span></span>
<span id="cb114-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-68" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-69" tabindex="-1"></a>    </span>
<span id="cb114-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-70" tabindex="-1"></a>    r_indiff<span class="op">[</span>pp<span class="op">]</span> <span class="op">=</span>  solve_newton<span class="op">(</span>HLindiff<span class="op">,</span> <span class="op">[</span>start<span class="op">]</span><span class="ch">&#39;,</span><span class="er"> pr1[pp], prizeA, prizeB)[1];</span></span>
<span id="cb114-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-71" tabindex="-1"></a>    </span>
<span id="cb114-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-72" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-73" tabindex="-1"></a>  </span>
<span id="cb114-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-74" tabindex="-1"></a>  <span class="co">// check that we get something reasonable here</span></span>
<span id="cb114-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-75" tabindex="-1"></a>  print<span class="op">(</span>r_indiff<span class="op">);</span></span>
<span id="cb114-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-76" tabindex="-1"></a>  </span>
<span id="cb114-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-77" tabindex="-1"></a>  vector<span class="op">[</span>nparticipants<span class="op">]</span> HL_lb<span class="op">;</span></span>
<span id="cb114-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-78" tabindex="-1"></a>  vector<span class="op">[</span>nparticipants<span class="op">]</span> HL_ub<span class="op">;</span></span>
<span id="cb114-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-79" tabindex="-1"></a>  </span>
<span id="cb114-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-80" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nparticipants<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-81" tabindex="-1"></a>    </span>
<span id="cb114-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-82" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>nrisky<span class="op">[</span>ii<span class="op">]==</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-83" tabindex="-1"></a>      HL_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">999.999</span><span class="op">;</span></span>
<span id="cb114-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-84" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-85" tabindex="-1"></a>      HL_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> r_indiff<span class="op">[</span>nrisky<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb114-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-86" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-87" tabindex="-1"></a>    </span>
<span id="cb114-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-88" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>nrisky<span class="op">[</span>ii<span class="op">]==</span><span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-89" tabindex="-1"></a>      HL_ub<span class="op">[</span>ii<span class="op">]=</span><span class="fl">999.999</span><span class="op">;</span></span>
<span id="cb114-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-90" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-91" tabindex="-1"></a>      HL_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> r_indiff<span class="op">[</span>nrisky<span class="op">[</span>ii<span class="op">]+</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb114-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-92" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-93" tabindex="-1"></a>    </span>
<span id="cb114-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-94" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-95" tabindex="-1"></a>  </span>
<span id="cb114-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-96" tabindex="-1"></a>  <span class="co">// bounds for time preference task -------------------------------------------</span></span>
<span id="cb114-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-97" tabindex="-1"></a>  </span>
<span id="cb114-98"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-98" tabindex="-1"></a>  real payA <span class="op">=</span> <span class="fl">18.0</span><span class="op">;</span></span>
<span id="cb114-99"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-99" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">10</span><span class="op">]</span> payB <span class="op">=</span> <span class="op">[</span><span class="fl">18.09</span><span class="op">,</span> <span class="fl">18.35</span><span class="op">,</span> <span class="fl">18.52</span><span class="op">,</span> <span class="fl">18.69</span><span class="op">,</span> <span class="fl">19.04</span><span class="op">,</span> <span class="fl">20.08</span><span class="op">,</span> <span class="fl">21.12</span><span class="op">,</span> <span class="fl">22.15</span><span class="op">,</span> <span class="fl">23.19</span><span class="op">,</span> <span class="fl">24.23</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb114-100"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-100" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">10</span><span class="op">]</span> time_indiff <span class="op">=</span> payB<span class="op">/</span>payA<span class="op">-</span><span class="fl">1.0</span><span class="op">;</span></span>
<span id="cb114-101"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-101" tabindex="-1"></a>  </span>
<span id="cb114-102"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-102" tabindex="-1"></a>  print<span class="op">(</span>time_indiff<span class="op">);</span></span>
<span id="cb114-103"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-103" tabindex="-1"></a>  </span>
<span id="cb114-104"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-104" tabindex="-1"></a>  vector<span class="op">[</span>nparticipants<span class="op">]</span> time_lb<span class="op">;</span></span>
<span id="cb114-105"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-105" tabindex="-1"></a>  vector<span class="op">[</span>nparticipants<span class="op">]</span> time_ub<span class="op">;</span></span>
<span id="cb114-106"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-106" tabindex="-1"></a>  </span>
<span id="cb114-107"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-107" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nparticipants<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-108"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-108" tabindex="-1"></a>    </span>
<span id="cb114-109"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-109" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>npatient<span class="op">[</span>ii<span class="op">]==</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-110"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-110" tabindex="-1"></a>      time_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> <span class="fl">999.999</span><span class="op">;</span></span>
<span id="cb114-111"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-111" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-112"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-112" tabindex="-1"></a>      time_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> time_indiff<span class="op">[</span><span class="dv">11</span><span class="op">-</span>npatient<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb114-113"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-113" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-114"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-114" tabindex="-1"></a>    </span>
<span id="cb114-115"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-115" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>npatient<span class="op">[</span>ii<span class="op">]==</span><span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-116"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-116" tabindex="-1"></a>      time_lb<span class="op">[</span>ii<span class="op">]=</span><span class="fl">0.0</span><span class="op">;</span></span>
<span id="cb114-117"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-117" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-118"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-118" tabindex="-1"></a>      time_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> time_indiff<span class="op">[</span><span class="dv">10</span><span class="op">-</span>npatient<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb114-119"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-119" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-120"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-120" tabindex="-1"></a>    </span>
<span id="cb114-121"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-121" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-122"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-122" tabindex="-1"></a>  </span>
<span id="cb114-123"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-123" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-124"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-124" tabindex="-1"></a></span>
<span id="cb114-125"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-125" tabindex="-1"></a></span>
<span id="cb114-126"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-126" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb114-127"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-127" tabindex="-1"></a>  </span>
<span id="cb114-128"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-128" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> alpha<span class="op">;</span> <span class="co">// coefficients on risk and time</span></span>
<span id="cb114-129"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-129" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> beta<span class="op">;</span> <span class="co">// coefficients on X</span></span>
<span id="cb114-130"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-130" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> REsd<span class="op">;</span> <span class="co">// sd of random effects;</span></span>
<span id="cb114-131"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-131" tabindex="-1"></a>  vector<span class="op">[</span>nparticipants<span class="op">]</span> RE<span class="op">;</span> <span class="co">// random effects</span></span>
<span id="cb114-132"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-132" tabindex="-1"></a>  </span>
<span id="cb114-133"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-133" tabindex="-1"></a>  </span>
<span id="cb114-134"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-134" tabindex="-1"></a>  </span>
<span id="cb114-135"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-135" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> MU<span class="op">;</span></span>
<span id="cb114-136"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-136" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;[</span><span class="dv">2</span><span class="op">]</span> TAU<span class="op">;</span></span>
<span id="cb114-137"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-137" tabindex="-1"></a>  cholesky_factor_corr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> L_Omega<span class="op">;</span></span>
<span id="cb114-138"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-138" tabindex="-1"></a>  </span>
<span id="cb114-139"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-139" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>HL_lb<span class="op">,</span>upper<span class="op">=</span>HL_ub<span class="op">&gt;[</span>nparticipants<span class="op">]</span> risk<span class="op">;</span></span>
<span id="cb114-140"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-140" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>time_lb<span class="op">,</span> upper<span class="op">=</span>time_ub<span class="op">&gt;[</span>nparticipants<span class="op">]</span> time<span class="op">;</span></span>
<span id="cb114-141"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-141" tabindex="-1"></a>  </span>
<span id="cb114-142"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-142" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-143"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-143" tabindex="-1"></a></span>
<span id="cb114-144"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-144" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb114-145"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-145" tabindex="-1"></a>  </span>
<span id="cb114-146"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-146" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> SIGMA <span class="op">=</span> diag_matrix<span class="op">(</span>TAU<span class="op">)*</span>L_Omega<span class="op">*</span>L_Omega<span class="ch">&#39;*</span><span class="er">diag_matrix(TAU);</span></span>
<span id="cb114-147"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-147" tabindex="-1"></a>  </span>
<span id="cb114-148"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-148" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-149"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-149" tabindex="-1"></a></span>
<span id="cb114-150"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-150" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb114-151"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-151" tabindex="-1"></a>  </span>
<span id="cb114-152"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-152" tabindex="-1"></a>  <span class="co">// RE logit model ------------------------------------------------------------</span></span>
<span id="cb114-153"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-153" tabindex="-1"></a>  </span>
<span id="cb114-154"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-154" tabindex="-1"></a>  Y <span class="op">~</span> bernoulli_logit<span class="op">(</span>alpha<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>risk<span class="op">[</span>id<span class="op">]+</span>alpha<span class="op">[</span><span class="dv">2</span><span class="op">]*</span>time<span class="op">[</span>id<span class="op">]+</span>X<span class="op">*</span>beta<span class="op">+</span>RE<span class="op">[</span>id<span class="op">]);</span></span>
<span id="cb114-155"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-155" tabindex="-1"></a>  </span>
<span id="cb114-156"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-156" tabindex="-1"></a>  <span class="co">// prior ---------------------------------------------------------------------</span></span>
<span id="cb114-157"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-157" tabindex="-1"></a>  </span>
<span id="cb114-158"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-158" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>pp in <span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-159"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-159" tabindex="-1"></a>    MU <span class="op">~</span> normal<span class="op">(</span>prior_MU<span class="op">[</span>pp<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_MU<span class="op">[</span>pp<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb114-160"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-160" tabindex="-1"></a>    TAU <span class="op">~</span> cauchy<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_TAU<span class="op">[</span>pp<span class="op">]);</span></span>
<span id="cb114-161"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-161" tabindex="-1"></a>    alpha<span class="op">[</span>pp<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>prior_alpha<span class="op">[</span>pp<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span>pp<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb114-162"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-162" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-163"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-163" tabindex="-1"></a>  L_Omega <span class="op">~</span> lkj_corr_cholesky<span class="op">(</span>prior_Omega<span class="op">);</span></span>
<span id="cb114-164"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-164" tabindex="-1"></a>  </span>
<span id="cb114-165"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-165" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>kk in <span class="dv">1</span><span class="op">:</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-166"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-166" tabindex="-1"></a>    beta<span class="op">[</span>kk<span class="op">]</span> <span class="op">~</span> normal<span class="op">(</span>prior_beta<span class="op">[</span>kk<span class="op">][</span><span class="dv">1</span><span class="op">],</span>prior_beta<span class="op">[</span>kk<span class="op">][</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb114-167"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-167" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-168"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-168" tabindex="-1"></a>  </span>
<span id="cb114-169"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-169" tabindex="-1"></a>  REsd <span class="op">~</span> cauchy<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span>prior_REsd<span class="op">);</span> </span>
<span id="cb114-170"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-170" tabindex="-1"></a>  </span>
<span id="cb114-171"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-171" tabindex="-1"></a>  <span class="co">// Augmented data ------------------------------------------------------------</span></span>
<span id="cb114-172"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-172" tabindex="-1"></a>  </span>
<span id="cb114-173"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-173" tabindex="-1"></a>  RE <span class="op">~</span> normal<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span>REsd<span class="op">);</span></span>
<span id="cb114-174"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-174" tabindex="-1"></a>  </span>
<span id="cb114-175"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-175" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nparticipants<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-176"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-176" tabindex="-1"></a>    </span>
<span id="cb114-177"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-177" tabindex="-1"></a>    <span class="op">[</span>risk<span class="op">[</span>ii<span class="op">],</span>log<span class="op">(</span>time<span class="op">[</span>ii<span class="op">])]</span> <span class="op">~</span> multi_normal<span class="op">(</span>MU<span class="op">,</span> SIGMA<span class="op">);</span></span>
<span id="cb114-178"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-178" tabindex="-1"></a>    </span>
<span id="cb114-179"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-179" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-180"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-180" tabindex="-1"></a>  </span>
<span id="cb114-181"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-181" tabindex="-1"></a>  </span>
<span id="cb114-182"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-182" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb114-183"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-183" tabindex="-1"></a></span>
<span id="cb114-184"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-184" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb114-185"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-185" tabindex="-1"></a>  </span>
<span id="cb114-186"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-186" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> MFX_risktime<span class="op">;</span></span>
<span id="cb114-187"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-187" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> MFX_X<span class="op">;</span></span>
<span id="cb114-188"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-188" tabindex="-1"></a>  </span>
<span id="cb114-189"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-189" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb114-190"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-190" tabindex="-1"></a>    </span>
<span id="cb114-191"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-191" tabindex="-1"></a>    <span class="co">// needed for marginal effects for continuous RHS variables</span></span>
<span id="cb114-192"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-192" tabindex="-1"></a>    vector<span class="op">[</span>N<span class="op">]</span> XB <span class="op">=</span> alpha<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>risk<span class="op">[</span>id<span class="op">]+</span>alpha<span class="op">[</span><span class="dv">2</span><span class="op">]*</span>time<span class="op">[</span>id<span class="op">]+</span>X<span class="op">*</span>beta<span class="op">+</span>RE<span class="op">[</span>id<span class="op">];</span></span>
<span id="cb114-193"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-193" tabindex="-1"></a>    real dlXB <span class="op">=</span> mean<span class="op">(</span>inv_logit<span class="op">(</span>XB<span class="op">).*(</span><span class="fl">1.0</span><span class="op">-</span>inv_logit<span class="op">(</span>XB<span class="op">)));</span></span>
<span id="cb114-194"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-194" tabindex="-1"></a>    </span>
<span id="cb114-195"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-195" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>aa in <span class="dv">1</span><span class="op">:</span><span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-196"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-196" tabindex="-1"></a>      MFX_risktime<span class="op">[</span>aa<span class="op">]</span> <span class="op">=</span> alpha<span class="op">[</span>aa<span class="op">]*</span>dlXB<span class="op">;</span></span>
<span id="cb114-197"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-197" tabindex="-1"></a>    <span class="op">}</span> </span>
<span id="cb114-198"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-198" tabindex="-1"></a>    </span>
<span id="cb114-199"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-199" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>kk in <span class="dv">1</span><span class="op">:</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-200"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-200" tabindex="-1"></a>      </span>
<span id="cb114-201"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-201" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>is_discrete<span class="op">[</span>kk<span class="op">]&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-202"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-202" tabindex="-1"></a>        matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X0 <span class="op">=</span> X<span class="op">;</span></span>
<span id="cb114-203"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-203" tabindex="-1"></a>        matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X1 <span class="op">=</span> X<span class="op">;</span></span>
<span id="cb114-204"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-204" tabindex="-1"></a>          X0<span class="op">[,</span>kk<span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span>N<span class="op">);</span></span>
<span id="cb114-205"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-205" tabindex="-1"></a>          X1<span class="op">[,</span>kk<span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span>N<span class="op">);</span></span>
<span id="cb114-206"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-206" tabindex="-1"></a>          </span>
<span id="cb114-207"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-207" tabindex="-1"></a>        MFX_X<span class="op">[</span>kk<span class="op">]</span> <span class="op">=</span> mean<span class="op">(</span></span>
<span id="cb114-208"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-208" tabindex="-1"></a>            inv_logit<span class="op">(</span>alpha<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>risk<span class="op">[</span>id<span class="op">]+</span>alpha<span class="op">[</span><span class="dv">2</span><span class="op">]*</span>time<span class="op">[</span>id<span class="op">]+</span>X1<span class="op">*</span>beta<span class="op">+</span>RE<span class="op">[</span>id<span class="op">])</span></span>
<span id="cb114-209"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-209" tabindex="-1"></a>            <span class="op">-</span>inv_logit<span class="op">(</span>alpha<span class="op">[</span><span class="dv">1</span><span class="op">]*</span>risk<span class="op">[</span>id<span class="op">]+</span>alpha<span class="op">[</span><span class="dv">2</span><span class="op">]*</span>time<span class="op">[</span>id<span class="op">]+</span>X0<span class="op">*</span>beta<span class="op">+</span>RE<span class="op">[</span>id<span class="op">])</span></span>
<span id="cb114-210"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-210" tabindex="-1"></a>            <span class="op">);</span></span>
<span id="cb114-211"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-211" tabindex="-1"></a>        </span>
<span id="cb114-212"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-212" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-213"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-213" tabindex="-1"></a>        MFX_X<span class="op">[</span>kk<span class="op">]</span> <span class="op">=</span> beta<span class="op">[</span>kk<span class="op">]*</span>dlXB<span class="op">;</span></span>
<span id="cb114-214"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-214" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb114-215"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-215" tabindex="-1"></a>      </span>
<span id="cb114-216"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-216" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-217"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-217" tabindex="-1"></a>    </span>
<span id="cb114-218"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-218" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb114-219"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-219" tabindex="-1"></a>  </span>
<span id="cb114-220"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-220" tabindex="-1"></a>  </span>
<span id="cb114-221"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-221" tabindex="-1"></a>  </span>
<span id="cb114-222"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-222" tabindex="-1"></a>  </span>
<span id="cb114-223"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb114-223" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>At this point we need to acknowedge a problem with the <span class="citation">Davis, Ivanov, and Korenok (<a href="#ref-DIK2016">2016</a>)</span> dataset: attrition. The data for the indefinitely-repeated Prisoner’s Dilemma (i.e. <span class="math inline">\(Y_{i,t}\)</span>) were collected on the first day of the experiment, and the participant characteristics (i.e. the right-hand-side variables) were collected on a subsequent day. Not all participants who showed up to the lab on the first day also showed up on this subsequent day, and so there are some missing data. Here I will just drop these observations, but it should be noted that this is a situation where imputation could be used. That is, we could explicitly model the missing data from the second day. However since handling missing data should be at least a whole chapter in itself, I am going to leave this as an exercise for my future self.</p>
<p>So to summarize, the data that go into this estimation are from the eighty-seven participants who showed up to both days of the experiment.<a href="#fn42" class="footnote-ref" id="fnref42"><sup>42</sup></a> From this, I also cull the first five rounds of the indefinitely repeated Prisoner’s dilemma (to mitigate initial learning effects). This leaves me with eight observations per participant for the random effects logit (since they played a total of thirteen indefinitely-repeated Prisoner’s Dilemma games).</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-1" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="st">&quot;Code/DIK2016/RElogit.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb115-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb115-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>X) <span class="sc">|&gt;</span> </span>
<span id="cb115-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-4" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb115-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-5" tabindex="-1"></a>    <span class="fu">grepl</span>(<span class="st">&quot;MFX&quot;</span>,par)</span>
<span id="cb115-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-6" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb115-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb115-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-8" tabindex="-1"></a>    <span class="at">variable =</span> <span class="fu">c</span>(<span class="st">&quot;$r$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">delta$&quot;</span>,<span class="st">&quot;Trusted in Trust Game (D)&quot;</span>, <span class="st">&quot;Trustworthy in the Trust Game (D)&quot;</span>, <span class="st">&quot;Contribution to charity (0-1)&quot;</span>, <span class="st">&quot;Chose a dominant action (D)&quot;</span>, <span class="st">&quot;Best responded to a dominant action (D)&quot;</span>, <span class="st">&quot;Decisions respect FOSD (D)&quot;</span>, <span class="st">&quot;Plans ahead (D)&quot;</span>, <span class="st">&quot;Male (D)&quot;</span>,<span class="st">&quot;constant&quot;</span>)</span>
<span id="cb115-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-9" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb115-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-10" tabindex="-1"></a>  <span class="fu">filter</span>(variable<span class="sc">!=</span><span class="st">&quot;constant&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb115-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-11" tabindex="-1"></a>  <span class="fu">select</span>(variable,mean,,sd,<span class="fu">contains</span>(<span class="st">&quot;X&quot;</span>)) </span>
<span id="cb115-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-12" tabindex="-1"></a></span>
<span id="cb115-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-13" tabindex="-1"></a>Fit <span class="sc">|&gt;</span> </span>
<span id="cb115-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-14" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits=</span><span class="fl">3.</span>, <span class="at">caption =</span> <span class="st">&quot;Marginal effects from random effects logit model. (D) indicates dunny variable. &quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb115-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-15" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb115-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-16" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;Percentiles&quot;</span><span class="ot">=</span><span class="dv">5</span>)) <span class="sc">|&gt;</span></span>
<span id="cb115-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb115-17" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Dependent variable $=$ first-round cooperation in IRPD&quot;</span><span class="ot">=</span><span class="dv">7</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:regressionRElogit">Table 9.2: </span>Marginal effects from random effects logit model. (D) indicates dunny variable.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="7">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Dependent variable <span class="math inline">\(=\)</span> first-round cooperation in IRPD
</div>
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="5">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Percentiles
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
variable
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X25.
</th>
<th style="text-align:right;">
X50.
</th>
<th style="text-align:right;">
X75.
</th>
<th style="text-align:right;">
X97.5.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(r\)</span>
</td>
<td style="text-align:right;">
0.029
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
0.011
</td>
<td style="text-align:right;">
0.028
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.081
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\delta\)</span>
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
-0.004
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.026
</td>
</tr>
<tr>
<td style="text-align:left;">
Trusted in Trust Game (D)
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
0.032
</td>
<td style="text-align:right;">
-0.036
</td>
<td style="text-align:right;">
-0.006
</td>
<td style="text-align:right;">
0.015
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
0.089
</td>
</tr>
<tr>
<td style="text-align:left;">
Trustworthy in the Trust Game (D)
</td>
<td style="text-align:right;">
0.016
</td>
<td style="text-align:right;">
0.031
</td>
<td style="text-align:right;">
-0.036
</td>
<td style="text-align:right;">
-0.006
</td>
<td style="text-align:right;">
0.013
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
0.084
</td>
</tr>
<tr>
<td style="text-align:left;">
Contribution to charity (0-1)
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
0.009
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
-0.011
</td>
<td style="text-align:right;">
-0.005
</td>
<td style="text-align:right;">
0.002
</td>
<td style="text-align:right;">
0.015
</td>
</tr>
<tr>
<td style="text-align:left;">
Chose a dominant action (D)
</td>
<td style="text-align:right;">
0.049
</td>
<td style="text-align:right;">
0.041
</td>
<td style="text-align:right;">
-0.017
</td>
<td style="text-align:right;">
0.019
</td>
<td style="text-align:right;">
0.044
</td>
<td style="text-align:right;">
0.073
</td>
<td style="text-align:right;">
0.143
</td>
</tr>
<tr>
<td style="text-align:left;">
Best responded to a dominant action (D)
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
0.034
</td>
<td style="text-align:right;">
-0.037
</td>
<td style="text-align:right;">
-0.002
</td>
<td style="text-align:right;">
0.018
</td>
<td style="text-align:right;">
0.042
</td>
<td style="text-align:right;">
0.100
</td>
</tr>
<tr>
<td style="text-align:left;">
Decisions respect FOSD (D)
</td>
<td style="text-align:right;">
0.024
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
-0.032
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.020
</td>
<td style="text-align:right;">
0.046
</td>
<td style="text-align:right;">
0.107
</td>
</tr>
<tr>
<td style="text-align:left;">
Plans ahead (D)
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
-0.049
</td>
<td style="text-align:right;">
-0.018
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.022
</td>
<td style="text-align:right;">
0.070
</td>
</tr>
<tr>
<td style="text-align:left;">
Male (D)
</td>
<td style="text-align:right;">
0.039
</td>
<td style="text-align:right;">
0.038
</td>
<td style="text-align:right;">
-0.023
</td>
<td style="text-align:right;">
0.012
</td>
<td style="text-align:right;">
0.035
</td>
<td style="text-align:right;">
0.062
</td>
<td style="text-align:right;">
0.127
</td>
</tr>
</tbody>
</table>
<p>Table <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#tab:regressionRElogit">9.2</a> shows the posterior distribution of the random effects logit model’s marginal effects. Here we can see that all of the effects are small and we can’t be particulary sure that they are positive or negative. Taking a closer look at the posterrior distribution of the marginal effects for our imprecisely-estimated parameters <span class="math inline">\(r_i\)</span> and <span class="math inline">\(\delta_i\)</span>, Figure <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#fig:regressionRElogitalpha">9.1</a> shows the kernel-smoothed posterior density for these marginal effects. We cannot be particularly certain that these marginal effects are positive, although on balance of probabilities they are.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-1" tabindex="-1"></a>ALPHA<span class="ot">&lt;-</span><span class="st">&quot;Code/DIK2016/RElogit_MFX.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb116-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb116-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-3" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">r =</span> V1, <span class="at">delta =</span> V2) <span class="sc">|&gt;</span></span>
<span id="cb116-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb116-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-5" tabindex="-1"></a>    <span class="at">cols =</span> r<span class="sc">:</span>delta</span>
<span id="cb116-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-6" tabindex="-1"></a>  )</span>
<span id="cb116-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-7" tabindex="-1"></a></span>
<span id="cb116-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-8" tabindex="-1"></a>(</span>
<span id="cb116-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(ALPHA,<span class="fu">aes</span>(<span class="at">x=</span>value))</span>
<span id="cb116-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_density</span>()</span>
<span id="cb116-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>name,<span class="at">scales=</span><span class="st">&quot;free&quot;</span>, <span class="at">labeller =</span> label_parsed)</span>
<span id="cb116-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb116-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;marginal effect&quot;</span>)</span>
<span id="cb116-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb116-14" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:regressionRElogitalpha"></span>
<img src="index_files/figure-html/regressionRElogitalpha-1.png" alt="Kernal-smoothed posterior distribution of marginal effects for imprecicely-measured variables. " width="672" />
<p class="caption">
Figure 9.1: Kernal-smoothed posterior distribution of marginal effects for imprecicely-measured variables.
</p>
</div>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb117-1" tabindex="-1"></a>ALPHA <span class="sc">|&gt;</span> </span>
<span id="cb117-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb117-2" tabindex="-1"></a>  <span class="fu">group_by</span>(name) <span class="sc">|&gt;</span></span>
<span id="cb117-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb117-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb117-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb117-4" tabindex="-1"></a>    <span class="st">`</span><span class="at">prob positive</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(value<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb117-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb117-5" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   name  `prob positive`
##   &lt;chr&gt;           &lt;dbl&gt;
## 1 delta           0.701
## 2 r               0.865</code></pre>
</div>
<div id="example-3-logit-and-ordered-logit-with-risk-preferences-from-gneezy1997" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Example 3: Logit and ordered logit with risk preferences from <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3-logit-and-ordered-logit-with-risk-preferences-from-gneezy1997" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Montoya Herrera and Willinger (<a href="#ref-MW2025">2025</a>)</span> investigate the relationship between risk tolerance and trust. In one of their specifications (see their Table 3), they estimate the effect of risk preferences estimated in a <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> task on the probability of agreeing with the first part of this question: “Generally speaking, would you say that most people can be trusted or that you can’t be too careful in dealing with people?” They answer this question using various specifications of a logit model. Other control variables in their model included highest degree earned, a 0-10 political orientation score, age, and gender. They also use an ordered logit model to understand the effect of these explanatory variables on a 0-10 Likert scale response describing how trusting the respondent is.</p>
<p>To begin with, let’s take a refresher on the <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> task (which I use as an example in the first chapter of this book). In this instance, the participant is endowed with 100 tokens, and they can invest any number of these tokens in an asset that triples the investment with probability 50%, and pays nothing with probability 50%. If <span class="math inline">\(x\)</span> is their invested amount, their final payoff is:</p>
<p><span class="math display">\[
\begin{cases}
100+2x &amp; \text{with probability }50\% \\
100-x &amp; \text{otherwise}
\end{cases}
\]</span>
Let’s assume CRRA expected utility preferences, so we can write down the expected utility of investing <span class="math inline">\(x\in[0,100]\)</span> as:</p>
<p><span class="math display">\[
U_i(x)=0.5\frac{(100+2x)^{1-r_i}}{1-r_i}+0.5\frac{(100-x)^{1-r_i}}{1-r_i}
\]</span></p>
<p>We can find the optimal choice <span class="math inline">\(x^*_i\)</span> by taking the derivative:</p>
<p><span class="math display">\[
\begin{aligned}
0=U&#39;_i(x_i^*)&amp;=(100+2x_i^*)^{-r_i}-0.5(100-x_i^*)^{-r_i}
\end{aligned}
\]</span>
Note here that we are trying to solve for <span class="math inline">\(r_i\)</span>, not <span class="math inline">\(x_i^*\)</span>, becuase we are trying to use the data (<span class="math inline">\(x_i\)</span>) to put bounds on <span class="math inline">\(r_i\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}
-\log(0.5)-r_i\log(100-x_i^*)&amp;=-r_i\log(100+2x_i^*)\\
r_i&amp;=\frac{-\log(0.5)}{\log(100+2x_i^*)-\log(100-x_i^*)}
\end{aligned}
\]</span></p>
<p>Which gives us the following mapping between choices <span class="math inline">\(x\)</span> and risk-aversion <span class="math inline">\(r\)</span>:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-1" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">tibble</span>(</span>
<span id="cb119-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-2" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">99.9</span>,<span class="at">by=</span><span class="fl">0.1</span>)</span>
<span id="cb119-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-3" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb119-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb119-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-5" tabindex="-1"></a>    <span class="at">r =</span> <span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.5</span>)<span class="sc">/</span>(<span class="fu">log</span>(<span class="dv">100</span><span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>x)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">100</span><span class="sc">-</span>x))</span>
<span id="cb119-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-6" tabindex="-1"></a>  )</span>
<span id="cb119-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-7" tabindex="-1"></a></span>
<span id="cb119-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-8" tabindex="-1"></a>(</span>
<span id="cb119-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(d,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>r))</span>
<span id="cb119-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="at">linewidth=</span><span class="dv">1</span>)</span>
<span id="cb119-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">3</span>))</span>
<span id="cb119-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb119-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;choice (x)&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;risk aversion (r)&quot;</span>)</span>
<span id="cb119-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb119-14" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:regressionGP1997"></span>
<img src="index_files/figure-html/regressionGP1997-1.png" alt="Relationship between risk-aversion and choice in @Gneezy1997 task. " width="672" />
<p class="caption">
Figure 9.2: Relationship between risk-aversion and choice in <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> task.
</p>
</div>
<p>Here we are going to run into a (solvable) problem with the data: people usually don’t like to choose between 101 different things, and so will likely round off their answers to the nearest 5 or 10. As such, and like the <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span> data we had in the previous section, we need to treat our data as <em>interval-valued</em>. Also, since the experiment <em>forced</em> people to round to the nearest integer, we really need to be treating this as interval valued anyway, even if they did not round. For this, I will adopt the following convention:</p>
<ol style="list-style-type: decimal">
<li>If <span class="math inline">\(x=0\)</span> then the response is assumed to have been rounded from somewhere in the range <span class="math inline">\((0,10)\)</span>,</li>
<li>If <span class="math inline">\(x=100\)</span>, then the response is assumed to be rounded from somewhere in the range <span class="math inline">\((90,100)\)</span>,</li>
<li>If <span class="math inline">\(x\)</span> is an integer multiple of 10, then the response is assumed to have been rounded to there from somewhere in the range <span class="math inline">\(x\pm 5\)</span>,</li>
<li>If <span class="math inline">\(x\)</span> is an integer multiple of 5 (but not 10), then the response is assumed to have been rounded to there from somewhere in the range <span class="math inline">\(x\pm2.5\)</span>, and</li>
<li>If <span class="math inline">\(x\)</span> is an integer multiple of 1 (but not 5 or 10) then the response is assumed to have been rounded to there from somewhere in the range <span class="math inline">\(x\pm0.5\)</span></li>
</ol>
<p>Hence, the data I pass to <em>Stan</em> will be the lower and upper bounds of these intervals. Then I get <em>Stan</em> to compute the intervals for each <span class="math inline">\(r_i\)</span>. Note here that since the relationship between <span class="math inline">\(x\)</span> and <span class="math inline">\(r\)</span> is negative, the upper bound for <span class="math inline">\(x_i\)</span> maps into the <em>lower</em> bound for <span class="math inline">\(r_i\)</span>.</p>
<p>Here is the <em>Stan</em> program I came up with for this application:</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb120-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-1" tabindex="-1"></a></span>
<span id="cb120-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb120-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-3" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span></span>
<span id="cb120-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-4" tabindex="-1"></a>  </span>
<span id="cb120-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-5" tabindex="-1"></a>  <span class="pp"># </span><span class="er">Gneezy &amp; Potters 1997 data, lower and upper bound</span></span>
<span id="cb120-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-6" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">100</span><span class="op">&gt;[</span>N<span class="op">]</span> GP_lb<span class="op">;</span></span>
<span id="cb120-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-7" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">100</span><span class="op">&gt;[</span>N<span class="op">]</span> GP_ub<span class="op">;</span></span>
<span id="cb120-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-8" tabindex="-1"></a>  </span>
<span id="cb120-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-9" tabindex="-1"></a>  </span>
<span id="cb120-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-10" tabindex="-1"></a>  <span class="co">// explanatory variables (other than r)</span></span>
<span id="cb120-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-11" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> k<span class="op">;</span></span>
<span id="cb120-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-12" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X<span class="op">;</span></span>
<span id="cb120-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-13" tabindex="-1"></a>  array<span class="op">[</span>k<span class="op">]</span> <span class="dt">int</span> is_discrete<span class="op">;</span></span>
<span id="cb120-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-14" tabindex="-1"></a>  </span>
<span id="cb120-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-15" tabindex="-1"></a>  <span class="co">// LHS binary variable</span></span>
<span id="cb120-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-16" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> Y<span class="op">;</span></span>
<span id="cb120-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-17" tabindex="-1"></a>  </span>
<span id="cb120-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-18" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb120-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-19" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_alpha<span class="op">;</span></span>
<span id="cb120-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-20" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_beta<span class="op">;</span></span>
<span id="cb120-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-21" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r_mean<span class="op">;</span></span>
<span id="cb120-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-22" tabindex="-1"></a>  real prior_r_nu<span class="op">;</span></span>
<span id="cb120-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-23" tabindex="-1"></a>  real prior_r_sd<span class="op">;</span></span>
<span id="cb120-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-24" tabindex="-1"></a>  </span>
<span id="cb120-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-25" tabindex="-1"></a>  <span class="dt">int</span> estimateLogit<span class="op">;</span></span>
<span id="cb120-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-26" tabindex="-1"></a>  </span>
<span id="cb120-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-27" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb120-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-28" tabindex="-1"></a></span>
<span id="cb120-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-29" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb120-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-30" tabindex="-1"></a>  </span>
<span id="cb120-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-31" tabindex="-1"></a>  real tol <span class="op">=</span> <span class="fl">1e-6</span><span class="op">;</span></span>
<span id="cb120-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-32" tabindex="-1"></a>  real realMax <span class="op">=</span> <span class="fl">1e3</span><span class="op">;</span></span>
<span id="cb120-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-33" tabindex="-1"></a>  </span>
<span id="cb120-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-34" tabindex="-1"></a>  <span class="co">// transform the GP data into crra coefficient ranges</span></span>
<span id="cb120-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-35" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> r_lb<span class="op">;</span></span>
<span id="cb120-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-36" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> r_ub<span class="op">;</span></span>
<span id="cb120-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-37" tabindex="-1"></a>  </span>
<span id="cb120-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-38" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-39" tabindex="-1"></a>    <span class="co">// note that an upper bound for x is a *lower* bound for r</span></span>
<span id="cb120-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-40" tabindex="-1"></a>    r_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> GP_lb<span class="op">[</span>ii<span class="op">]&lt;</span>tol <span class="op">?</span> realMax <span class="op">:-</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">)/(</span>log<span class="op">(</span><span class="dv">100</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>GP_lb<span class="op">[</span>ii<span class="op">])-</span>log<span class="op">(</span><span class="dv">100</span><span class="op">-</span>GP_lb<span class="op">[</span>ii<span class="op">]));</span></span>
<span id="cb120-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-41" tabindex="-1"></a>    r_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> GP_ub<span class="op">[</span>ii<span class="op">]&gt;(</span><span class="fl">100.0</span><span class="op">-</span>tol<span class="op">)</span> <span class="op">?</span> <span class="op">-</span>realMax <span class="op">:-</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">)/(</span>log<span class="op">(</span><span class="dv">100</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>GP_ub<span class="op">[</span>ii<span class="op">])-</span>log<span class="op">(</span><span class="dv">100</span><span class="op">-</span>GP_ub<span class="op">[</span>ii<span class="op">]));</span></span>
<span id="cb120-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-42" tabindex="-1"></a>    </span>
<span id="cb120-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-43" tabindex="-1"></a>    </span>
<span id="cb120-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-44" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb120-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-45" tabindex="-1"></a>  </span>
<span id="cb120-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-46" tabindex="-1"></a>  print<span class="op">(</span><span class="st">&quot;This program will calculate marginal effects. Make sure to ignore whichever one corresponds to the constant&quot;</span><span class="op">);</span></span>
<span id="cb120-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-47" tabindex="-1"></a>  </span>
<span id="cb120-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-48" tabindex="-1"></a>  </span>
<span id="cb120-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-49" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb120-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-50" tabindex="-1"></a></span>
<span id="cb120-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-51" tabindex="-1"></a></span>
<span id="cb120-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-52" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb120-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-53" tabindex="-1"></a>  </span>
<span id="cb120-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-54" tabindex="-1"></a>  </span>
<span id="cb120-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-55" tabindex="-1"></a>  <span class="co">// parameters for the logit coefficients</span></span>
<span id="cb120-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-56" tabindex="-1"></a>  real alpha<span class="op">;</span> <span class="co">// coefficient on r</span></span>
<span id="cb120-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-57" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> beta<span class="op">;</span></span>
<span id="cb120-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-58" tabindex="-1"></a>  </span>
<span id="cb120-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-59" tabindex="-1"></a>  <span class="co">// parameters for the distribution of risk preferences</span></span>
<span id="cb120-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-60" tabindex="-1"></a>  real r_mean<span class="op">;</span></span>
<span id="cb120-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-61" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r_sd<span class="op">;</span></span>
<span id="cb120-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-62" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r_nu<span class="op">;</span></span>
<span id="cb120-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-63" tabindex="-1"></a></span>
<span id="cb120-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-64" tabindex="-1"></a>  <span class="co">// augmented data</span></span>
<span id="cb120-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-65" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>r_lb<span class="op">,</span>upper<span class="op">=</span>r_ub<span class="op">&gt;[</span>N<span class="op">]</span> r<span class="op">;</span></span>
<span id="cb120-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-66" tabindex="-1"></a>  </span>
<span id="cb120-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-67" tabindex="-1"></a>  </span>
<span id="cb120-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-68" tabindex="-1"></a>  </span>
<span id="cb120-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-69" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb120-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-70" tabindex="-1"></a></span>
<span id="cb120-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-71" tabindex="-1"></a></span>
<span id="cb120-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-72" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb120-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-73" tabindex="-1"></a>  </span>
<span id="cb120-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-74" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb120-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-75" tabindex="-1"></a>  r_mean <span class="op">~</span> normal<span class="op">(</span>prior_r_mean<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r_mean<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb120-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-76" tabindex="-1"></a>  r_sd <span class="op">~</span> normal<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_r_sd<span class="op">);</span></span>
<span id="cb120-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-77" tabindex="-1"></a>  r_nu <span class="op">~</span> normal<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_r_nu<span class="op">);</span></span>
<span id="cb120-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-78" tabindex="-1"></a>  alpha <span class="op">~</span> normal<span class="op">(</span>prior_alpha<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb120-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-79" tabindex="-1"></a>  beta <span class="op">~</span> normal<span class="op">(</span>prior_beta<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_beta<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb120-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-80" tabindex="-1"></a>  </span>
<span id="cb120-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-81" tabindex="-1"></a>  <span class="co">// likelihood for the logit model</span></span>
<span id="cb120-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-82" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>estimateLogit<span class="op">&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-83" tabindex="-1"></a>    Y <span class="op">~</span> bernoulli_logit<span class="op">(</span>alpha<span class="op">*</span>r<span class="op">+</span>X<span class="op">*</span>beta<span class="op">);</span></span>
<span id="cb120-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-84" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb120-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-85" tabindex="-1"></a>  </span>
<span id="cb120-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-86" tabindex="-1"></a>  <span class="co">// augmented data for the GP task</span></span>
<span id="cb120-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-87" tabindex="-1"></a>  r <span class="op">~</span> student_t<span class="op">(</span>r_nu<span class="op">,</span>r_mean<span class="op">,</span> r_sd<span class="op">);</span></span>
<span id="cb120-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-88" tabindex="-1"></a>  </span>
<span id="cb120-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-89" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb120-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-90" tabindex="-1"></a></span>
<span id="cb120-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-91" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb120-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-92" tabindex="-1"></a>  </span>
<span id="cb120-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-93" tabindex="-1"></a>  real MFX_r<span class="op">;</span></span>
<span id="cb120-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-94" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> MFX_X<span class="op">;</span></span>
<span id="cb120-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-95" tabindex="-1"></a>  </span>
<span id="cb120-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-96" tabindex="-1"></a>  <span class="op">{</span></span>
<span id="cb120-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-97" tabindex="-1"></a>    </span>
<span id="cb120-98"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-98" tabindex="-1"></a>    vector<span class="op">[</span>N<span class="op">]</span> XB <span class="op">=</span> alpha<span class="op">*</span>r<span class="op">+</span>X<span class="op">*</span>beta<span class="op">;</span></span>
<span id="cb120-99"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-99" tabindex="-1"></a>    real dlXB <span class="op">=</span> mean<span class="op">(</span>inv_logit<span class="op">(</span>XB<span class="op">).*(</span><span class="fl">1.0</span><span class="op">-</span>inv_logit<span class="op">(</span>XB<span class="op">)));</span></span>
<span id="cb120-100"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-100" tabindex="-1"></a>    </span>
<span id="cb120-101"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-101" tabindex="-1"></a>    MFX_r <span class="op">=</span> alpha<span class="op">*</span>dlXB<span class="op">;</span></span>
<span id="cb120-102"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-102" tabindex="-1"></a>    </span>
<span id="cb120-103"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-103" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>kk in <span class="dv">1</span><span class="op">:</span>k<span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-104"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-104" tabindex="-1"></a>      </span>
<span id="cb120-105"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-105" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>is_discrete<span class="op">[</span>kk<span class="op">]&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-106"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-106" tabindex="-1"></a>        </span>
<span id="cb120-107"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-107" tabindex="-1"></a>        matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X0 <span class="op">=</span> X<span class="op">;</span></span>
<span id="cb120-108"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-108" tabindex="-1"></a>          X0<span class="op">[,</span>kk<span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span>N<span class="op">);</span></span>
<span id="cb120-109"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-109" tabindex="-1"></a>        matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X1 <span class="op">=</span> X<span class="op">;</span></span>
<span id="cb120-110"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-110" tabindex="-1"></a>          X0<span class="op">[,</span>kk<span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span>N<span class="op">);</span></span>
<span id="cb120-111"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-111" tabindex="-1"></a>          </span>
<span id="cb120-112"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-112" tabindex="-1"></a>          MFX_X<span class="op">[</span>kk<span class="op">]</span> <span class="op">=</span> mean<span class="op">(</span>inv_logit<span class="op">(</span>alpha<span class="op">*</span>r <span class="op">+</span> X1<span class="op">*</span>beta<span class="op">)-</span>inv_logit<span class="op">(</span>alpha<span class="op">*</span>r <span class="op">+</span> X0<span class="op">*</span>beta<span class="op">));</span></span>
<span id="cb120-113"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-113" tabindex="-1"></a>        </span>
<span id="cb120-114"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-114" tabindex="-1"></a>        </span>
<span id="cb120-115"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-115" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb120-116"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-116" tabindex="-1"></a>        MFX_X<span class="op">[</span>kk<span class="op">]</span> <span class="op">=</span> beta<span class="op">[</span>kk<span class="op">]*</span>dlXB<span class="op">;</span></span>
<span id="cb120-117"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-117" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb120-118"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-118" tabindex="-1"></a>      </span>
<span id="cb120-119"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-119" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb120-120"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-120" tabindex="-1"></a>    </span>
<span id="cb120-121"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-121" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb120-122"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-122" tabindex="-1"></a>  </span>
<span id="cb120-123"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-123" tabindex="-1"></a>  </span>
<span id="cb120-124"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb120-124" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And you can see the marginal effects in Table <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#tab:regrssionLogitMFX">9.3</a>. Here we can interpret the negative (even at the 97.5th percentile) marginal effect on <span class="math inline">\(r\)</span> as meaning that people who are more risk-averse are less likely to trust people.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-1" tabindex="-1"></a><span class="st">&quot;Code/HW2025/GPlogit.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb121-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb121-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb121-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-4" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(varname),<span class="st">&quot;$r$&quot;</span>,varname) </span>
<span id="cb121-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-5" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb121-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-6" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;MFX&quot;</span>,par)) <span class="sc">|&gt;</span></span>
<span id="cb121-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-7" tabindex="-1"></a>  <span class="fu">filter</span>(varname<span class="sc">!=</span><span class="st">&quot;(constant)&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb121-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-8" tabindex="-1"></a>  <span class="fu">select</span>(varname, mean,sd, X2.<span class="fl">5.</span>, X97.<span class="fl">5.</span>) <span class="sc">|&gt;</span></span>
<span id="cb121-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-9" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">&quot;Marginal effects from the logit model&quot;</span>, <span class="at">digits=</span><span class="dv">4</span>) <span class="sc">|&gt;</span></span>
<span id="cb121-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-10" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">|&gt;</span></span>
<span id="cb121-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb121-11" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;percentiles&quot;</span><span class="ot">=</span><span class="dv">2</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:regrssionLogitMFX">Table 9.3: </span>Marginal effects from the logit model
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
percentiles
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
varname
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X97.5.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(r\)</span>
</td>
<td style="text-align:right;">
-0.0409
</td>
<td style="text-align:right;">
0.0092
</td>
<td style="text-align:right;">
-0.0590
</td>
<td style="text-align:right;">
-0.0233
</td>
</tr>
<tr>
<td style="text-align:left;">
Highest degree earned
</td>
<td style="text-align:right;">
0.0309
</td>
<td style="text-align:right;">
0.0046
</td>
<td style="text-align:right;">
0.0219
</td>
<td style="text-align:right;">
0.0397
</td>
</tr>
<tr>
<td style="text-align:left;">
Political orientation (0-10)
</td>
<td style="text-align:right;">
-0.0539
</td>
<td style="text-align:right;">
0.0054
</td>
<td style="text-align:right;">
-0.0643
</td>
<td style="text-align:right;">
-0.0433
</td>
</tr>
<tr>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
-0.0003
</td>
<td style="text-align:right;">
0.0079
</td>
<td style="text-align:right;">
-0.0157
</td>
<td style="text-align:right;">
0.0151
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.0024
</td>
<td style="text-align:right;">
0.0007
</td>
<td style="text-align:right;">
0.0011
</td>
<td style="text-align:right;">
0.0037
</td>
</tr>
</tbody>
</table>
<p>Now we can turn to the ordered Likert scale survey question on trust. This model is going to look almost exactly the same as the logit (and <em>will</em> look exactly the same for the model for <span class="math inline">\(r_i\)</span>), except that the dependent variable follows an ordered logit process. Here is the <em>Stan</em> file for doing this:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb122-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-1" tabindex="-1"></a></span>
<span id="cb122-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb122-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-3" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> N<span class="op">;</span></span>
<span id="cb122-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-4" tabindex="-1"></a>  </span>
<span id="cb122-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-5" tabindex="-1"></a>  <span class="pp"># </span><span class="er">Gneezy &amp; Potters 1997 data, lower and upper bound</span></span>
<span id="cb122-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-6" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">100</span><span class="op">&gt;[</span>N<span class="op">]</span> GP_lb<span class="op">;</span></span>
<span id="cb122-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-7" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">100</span><span class="op">&gt;[</span>N<span class="op">]</span> GP_ub<span class="op">;</span></span>
<span id="cb122-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-8" tabindex="-1"></a>  </span>
<span id="cb122-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-9" tabindex="-1"></a>  </span>
<span id="cb122-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-10" tabindex="-1"></a>  <span class="co">// explanatory variables (other than r)</span></span>
<span id="cb122-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-11" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> k<span class="op">;</span></span>
<span id="cb122-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-12" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>k<span class="op">]</span> X<span class="op">;</span></span>
<span id="cb122-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-13" tabindex="-1"></a>  </span>
<span id="cb122-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-14" tabindex="-1"></a>  <span class="co">// LHS ordered variable</span></span>
<span id="cb122-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-15" tabindex="-1"></a>  <span class="dt">int</span> ncat<span class="op">;</span></span>
<span id="cb122-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-16" tabindex="-1"></a>  array<span class="op">[</span>N<span class="op">]</span> <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">,</span>upper<span class="op">=</span>ncat<span class="op">&gt;</span> Y<span class="op">;</span></span>
<span id="cb122-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-17" tabindex="-1"></a>  </span>
<span id="cb122-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-18" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb122-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-19" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_alpha<span class="op">;</span></span>
<span id="cb122-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-20" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_beta<span class="op">;</span></span>
<span id="cb122-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-21" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r_mean<span class="op">;</span></span>
<span id="cb122-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-22" tabindex="-1"></a>  real prior_r_nu<span class="op">;</span></span>
<span id="cb122-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-23" tabindex="-1"></a>  real prior_r_sd<span class="op">;</span></span>
<span id="cb122-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-24" tabindex="-1"></a>  </span>
<span id="cb122-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-25" tabindex="-1"></a>  <span class="dt">int</span> estimateLogit<span class="op">;</span></span>
<span id="cb122-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-26" tabindex="-1"></a>  </span>
<span id="cb122-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-27" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-28" tabindex="-1"></a></span>
<span id="cb122-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-29" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb122-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-30" tabindex="-1"></a>  </span>
<span id="cb122-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-31" tabindex="-1"></a>  real tol <span class="op">=</span> <span class="fl">1e-6</span><span class="op">;</span></span>
<span id="cb122-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-32" tabindex="-1"></a>  real realMax <span class="op">=</span> <span class="fl">1e3</span><span class="op">;</span></span>
<span id="cb122-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-33" tabindex="-1"></a>  </span>
<span id="cb122-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-34" tabindex="-1"></a>  <span class="co">// transform the GP data into crra coefficient ranges</span></span>
<span id="cb122-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-35" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> r_lb<span class="op">;</span></span>
<span id="cb122-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-36" tabindex="-1"></a>  vector<span class="op">[</span>N<span class="op">]</span> r_ub<span class="op">;</span></span>
<span id="cb122-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-37" tabindex="-1"></a>  </span>
<span id="cb122-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-38" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-39" tabindex="-1"></a>    <span class="co">// note that an upper bound for x is a *lower* bound for r</span></span>
<span id="cb122-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-40" tabindex="-1"></a>    r_ub<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> GP_lb<span class="op">[</span>ii<span class="op">]&lt;</span>tol <span class="op">?</span> realMax <span class="op">:-</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">)/(</span>log<span class="op">(</span><span class="dv">100</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>GP_lb<span class="op">[</span>ii<span class="op">])-</span>log<span class="op">(</span><span class="dv">100</span><span class="op">-</span>GP_lb<span class="op">[</span>ii<span class="op">]));</span></span>
<span id="cb122-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-41" tabindex="-1"></a>    r_lb<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> GP_ub<span class="op">[</span>ii<span class="op">]&gt;(</span><span class="fl">100.0</span><span class="op">-</span>tol<span class="op">)</span> <span class="op">?</span> <span class="op">-</span>realMax <span class="op">:-</span>log<span class="op">(</span><span class="fl">0.5</span><span class="op">)/(</span>log<span class="op">(</span><span class="dv">100</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>GP_ub<span class="op">[</span>ii<span class="op">])-</span>log<span class="op">(</span><span class="dv">100</span><span class="op">-</span>GP_ub<span class="op">[</span>ii<span class="op">]));</span></span>
<span id="cb122-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-42" tabindex="-1"></a>    </span>
<span id="cb122-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-43" tabindex="-1"></a>    </span>
<span id="cb122-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-44" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb122-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-45" tabindex="-1"></a>  </span>
<span id="cb122-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-46" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-47" tabindex="-1"></a></span>
<span id="cb122-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-48" tabindex="-1"></a></span>
<span id="cb122-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-49" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb122-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-50" tabindex="-1"></a>  </span>
<span id="cb122-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-51" tabindex="-1"></a>  </span>
<span id="cb122-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-52" tabindex="-1"></a>  <span class="co">// parameters for the logit coefficients</span></span>
<span id="cb122-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-53" tabindex="-1"></a>  real alpha<span class="op">;</span> <span class="co">// coefficient on r</span></span>
<span id="cb122-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-54" tabindex="-1"></a>  vector<span class="op">[</span>k<span class="op">]</span> beta<span class="op">;</span></span>
<span id="cb122-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-55" tabindex="-1"></a>  </span>
<span id="cb122-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-56" tabindex="-1"></a>  <span class="co">// parameters for the distribution of risk preferences</span></span>
<span id="cb122-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-57" tabindex="-1"></a>  real r_mean<span class="op">;</span></span>
<span id="cb122-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-58" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r_sd<span class="op">;</span></span>
<span id="cb122-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-59" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r_nu<span class="op">;</span></span>
<span id="cb122-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-60" tabindex="-1"></a></span>
<span id="cb122-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-61" tabindex="-1"></a>  <span class="co">// augmented data</span></span>
<span id="cb122-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-62" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span>r_lb<span class="op">,</span>upper<span class="op">=</span>r_ub<span class="op">&gt;[</span>N<span class="op">]</span> r<span class="op">;</span></span>
<span id="cb122-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-63" tabindex="-1"></a>  </span>
<span id="cb122-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-64" tabindex="-1"></a>  <span class="co">// ordered logit cutoffs</span></span>
<span id="cb122-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-65" tabindex="-1"></a>  ordered<span class="op">[</span>ncat<span class="op">-</span><span class="dv">1</span><span class="op">]</span> cut<span class="op">;</span></span>
<span id="cb122-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-66" tabindex="-1"></a>  </span>
<span id="cb122-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-67" tabindex="-1"></a>  </span>
<span id="cb122-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-68" tabindex="-1"></a>  </span>
<span id="cb122-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-69" tabindex="-1"></a>  </span>
<span id="cb122-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-70" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-71" tabindex="-1"></a></span>
<span id="cb122-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-72" tabindex="-1"></a></span>
<span id="cb122-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-73" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb122-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-74" tabindex="-1"></a>  </span>
<span id="cb122-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-75" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb122-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-76" tabindex="-1"></a>  r_mean <span class="op">~</span> normal<span class="op">(</span>prior_r_mean<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r_mean<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb122-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-77" tabindex="-1"></a>  r_sd <span class="op">~</span> normal<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_r_sd<span class="op">);</span></span>
<span id="cb122-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-78" tabindex="-1"></a>  r_nu <span class="op">~</span> normal<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span> prior_r_nu<span class="op">);</span></span>
<span id="cb122-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-79" tabindex="-1"></a>  alpha <span class="op">~</span> normal<span class="op">(</span>prior_alpha<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb122-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-80" tabindex="-1"></a>  beta <span class="op">~</span> normal<span class="op">(</span>prior_beta<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_beta<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb122-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-81" tabindex="-1"></a>  </span>
<span id="cb122-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-82" tabindex="-1"></a>  <span class="co">// likelihood for the logit model</span></span>
<span id="cb122-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-83" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>estimateLogit<span class="op">&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-84" tabindex="-1"></a>    Y <span class="op">~</span> ordered_logistic<span class="op">(</span>alpha<span class="op">*</span>r<span class="op">+</span>X<span class="op">*</span>beta<span class="op">,</span>cut<span class="op">);</span></span>
<span id="cb122-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-85" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb122-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-86" tabindex="-1"></a>  </span>
<span id="cb122-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-87" tabindex="-1"></a>  <span class="co">// augmented data for the GP task</span></span>
<span id="cb122-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-88" tabindex="-1"></a>  r <span class="op">~</span> student_t<span class="op">(</span>r_nu<span class="op">,</span>r_mean<span class="op">,</span> r_sd<span class="op">);</span></span>
<span id="cb122-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-89" tabindex="-1"></a>  </span>
<span id="cb122-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-90" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-91" tabindex="-1"></a></span>
<span id="cb122-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-92" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb122-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-93" tabindex="-1"></a>  </span>
<span id="cb122-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-94" tabindex="-1"></a>  </span>
<span id="cb122-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-95" tabindex="-1"></a>  </span>
<span id="cb122-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-96" tabindex="-1"></a>  </span>
<span id="cb122-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb122-97" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And Table <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#tab:regressionOrderedLogit">9.4</a> the estimates for this model (as much as I am a fan of marginal effects, I leave the computation of them in this case as an exercise for the reader).</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-1" tabindex="-1"></a><span class="st">&quot;Code/HW2025/GP_ordered_logit.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb123-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;_&quot;</span>,par)) <span class="sc">|&gt;</span> </span>
<span id="cb123-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb123-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-5" tabindex="-1"></a>    <span class="at">varname =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(varname),<span class="st">&quot;$r$&quot;</span>,varname) </span>
<span id="cb123-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-6" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb123-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-7" tabindex="-1"></a>  <span class="fu">select</span>(varname, mean,sd, X2.<span class="fl">5.</span>, X97.<span class="fl">5.</span>) <span class="sc">|&gt;</span></span>
<span id="cb123-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-8" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">&quot;Coefficients from the ordered logit model&quot;</span>, <span class="at">digits=</span><span class="dv">3</span>) <span class="sc">|&gt;</span></span>
<span id="cb123-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-9" tabindex="-1"></a>  <span class="fu">kable_classic</span>() <span class="sc">|&gt;</span></span>
<span id="cb123-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb123-10" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;&quot;</span>,<span class="st">&quot;percentiles&quot;</span><span class="ot">=</span><span class="dv">2</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:regressionOrderedLogit">Table 9.4: </span>Coefficients from the ordered logit model
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
percentiles
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
varname
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X97.5.
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(r\)</span>
</td>
<td style="text-align:right;">
-0.048
</td>
<td style="text-align:right;">
0.036
</td>
<td style="text-align:right;">
-0.120
</td>
<td style="text-align:right;">
0.024
</td>
</tr>
<tr>
<td style="text-align:left;">
(constant)
</td>
<td style="text-align:right;">
-0.001
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
-0.197
</td>
<td style="text-align:right;">
0.195
</td>
</tr>
<tr>
<td style="text-align:left;">
Highest degree earned
</td>
<td style="text-align:right;">
0.167
</td>
<td style="text-align:right;">
0.021
</td>
<td style="text-align:right;">
0.126
</td>
<td style="text-align:right;">
0.209
</td>
</tr>
<tr>
<td style="text-align:left;">
Political orientation (0-10)
</td>
<td style="text-align:right;">
-0.112
</td>
<td style="text-align:right;">
0.026
</td>
<td style="text-align:right;">
-0.163
</td>
<td style="text-align:right;">
-0.061
</td>
</tr>
<tr>
<td style="text-align:left;">
Male
</td>
<td style="text-align:right;">
0.071
</td>
<td style="text-align:right;">
0.074
</td>
<td style="text-align:right;">
-0.074
</td>
<td style="text-align:right;">
0.215
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:right;">
0.014
</td>
<td style="text-align:right;">
0.003
</td>
<td style="text-align:right;">
0.008
</td>
<td style="text-align:right;">
0.021
</td>
</tr>
</tbody>
</table>
</div>
<div id="a-note-of-caution" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> A note of caution<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#a-note-of-caution" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Especially with the open-ended intervals in the previous example, we need to be careful what we’re doing here. In the <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> task, many people chose to invest nothing in the asset, indicating possibly infinite risk-aversion.<a href="#fn43" class="footnote-ref" id="fnref43"><sup>43</sup></a> In this instance, when a lot of the instances of <span class="math inline">\(r_i\)</span> could take on a wide range of values, these instances will start acting as fixed effects in the model. Since this application only had one observation per participant, the prior (both the hyper-prior for <span class="math inline">\(r_i\)</span> and the prior for <span class="math inline">\(\alpha\)</span>) will be doing a <em>lot</em> of heavy lifting! To illustrate, suppose to the contrary that <em>nobody</em> invested anything in the <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> asset. Then all we know is that <span class="math inline">\(r_i&gt;\underline r\)</span> for everyone. Then there is nothing stopping all of the <span class="math inline">\(r_i\)</span>s acting as fixed effects in the linear model. In a Frequentist setting the model is not identified, becuase these fixed effects will perfectly predict success or failure. In our Bayesian setting they are tamed somewhat by the prior, and so we can still estimate the model. But is the posterior simulation we get out of it actually <em>useful</em>? I would suggest not.</p>
<p>These <span class="math inline">\(r_i\)</span>s are estimated so imprecisely in the <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> task, especially with rounding, that there is a lot of freedom for them to move around and “explain” anything. What we especially don’t want is the <span class="math inline">\(r_i\)</span>s being too informed by the survey response data. We want <span class="math inline">\(\alpha\)</span> to be informed by it, but to have that we need the <span class="math inline">\(r_i\)</span>’s to be (and I wave my hands a bit here) fairly well pinned down.</p>
<p>In short, we can overcome <em>some</em> non-classical measurement error by modeling the error. But if that error is huge, then the structural parameters just become fixed effects. This suggests that if we want to include a strucural parameter on the right-hand side of a regression, we need to make sure it is well-identified in the measurement task. I would suggest that the <span class="citation">Gneezy and Potters (<a href="#ref-Gneezy1997">1997</a>)</span> task does not achieve this.</p>
</div>
<div id="conclusion-1" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Conclusion<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#conclusion-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>So what can we take away from this? I think the main point is that carrying through the uncertainty in your right-hand-side estimates is doable, but somewhat difficult and maybe not very meaningful (if you have too much measurement error). If anything, this calls for better measurement of right-hand-side variables of interest, so that we can experimentally mitigate the non-classical measurement error problem. The solution is to jointly estimate the regression model alongside the structural model.</p>
</div>
<div id="r-code-used-for-this-chapter-2" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> <em>R</em> code used for this chapter<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#r-code-used-for-this-chapter-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="example-1" class="section level3 hasAnchor" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Example 1<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb124-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb124-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-3" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb124-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb124-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-5" tabindex="-1"></a></span>
<span id="cb124-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-6" tabindex="-1"></a>Extensive<span class="ot">&lt;-</span><span class="st">&quot;Data/SPG2018/Extensive margin data.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb124-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-7" tabindex="-1"></a>  <span class="fu">read.csv</span>() </span>
<span id="cb124-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-8" tabindex="-1"></a></span>
<span id="cb124-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-9" tabindex="-1"></a>logit<span class="ot">&lt;-</span><span class="cf">function</span>(x) {</span>
<span id="cb124-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-10" tabindex="-1"></a>  </span>
<span id="cb124-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-11" tabindex="-1"></a>  <span class="fu">log</span>(x)<span class="sc">-</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>x)</span>
<span id="cb124-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-12" tabindex="-1"></a>  </span>
<span id="cb124-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-13" tabindex="-1"></a>}</span>
<span id="cb124-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-14" tabindex="-1"></a></span>
<span id="cb124-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb124-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-16" tabindex="-1"></a></span>
<span id="cb124-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-17" tabindex="-1"></a>Intensive<span class="ot">&lt;-</span><span class="st">&quot;Data/SPG2018/Intensive margin data.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb124-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-18" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span> </span>
<span id="cb124-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-19" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb124-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-20" tabindex="-1"></a>    <span class="at">Bpts.last.digit =</span> Bpts <span class="sc">%%</span> <span class="dv">10</span>,</span>
<span id="cb124-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-21" tabindex="-1"></a>    <span class="at">Y_LB =</span> <span class="fu">ifelse</span>(Bpts.last.digit<span class="sc">==</span><span class="dv">0</span>, Bpts<span class="sc">/</span><span class="dv">100</span><span class="fl">-0.05</span>,</span>
<span id="cb124-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-22" tabindex="-1"></a>                  <span class="fu">ifelse</span>(Bpts.last.digit<span class="sc">==</span><span class="dv">5</span>, Bpts<span class="sc">/</span><span class="dv">100</span><span class="fl">-0.025</span>, Bpts<span class="sc">/</span><span class="dv">100</span><span class="fl">-0.005</span>) </span>
<span id="cb124-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-23" tabindex="-1"></a>                  )<span class="sc">|&gt;</span> <span class="fu">logit</span>(),</span>
<span id="cb124-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-24" tabindex="-1"></a>    <span class="at">Y_UB =</span> <span class="fu">ifelse</span>(Bpts.last.digit<span class="sc">==</span><span class="dv">0</span>, Bpts<span class="sc">/</span><span class="dv">100</span><span class="fl">+0.05</span>,</span>
<span id="cb124-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-25" tabindex="-1"></a>                  <span class="fu">ifelse</span>(Bpts.last.digit<span class="sc">==</span><span class="dv">5</span>, Bpts<span class="sc">/</span><span class="dv">100</span><span class="fl">+0.025</span>, Bpts<span class="sc">/</span><span class="dv">100</span><span class="fl">+0.005</span>) </span>
<span id="cb124-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-26" tabindex="-1"></a>    )<span class="sc">|&gt;</span> <span class="fu">logit</span>(),</span>
<span id="cb124-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-27" tabindex="-1"></a>    <span class="at">Y_LB =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Y_LB), <span class="sc">-</span><span class="cn">Inf</span>, Y_LB),</span>
<span id="cb124-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-28" tabindex="-1"></a>    <span class="at">Y_UB =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(Y_UB), <span class="sc">+</span><span class="cn">Inf</span>, Y_UB),</span>
<span id="cb124-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-29" tabindex="-1"></a>    <span class="at">constant =</span> <span class="dv">1</span>,</span>
<span id="cb124-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-30" tabindex="-1"></a>    <span class="at">female =</span> Gender<span class="sc">==</span><span class="st">&quot;F&quot;</span></span>
<span id="cb124-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-31" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb124-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-32" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Task.H..risk.))</span>
<span id="cb124-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-33" tabindex="-1"></a></span>
<span id="cb124-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-34" tabindex="-1"></a></span>
<span id="cb124-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-35" tabindex="-1"></a></span>
<span id="cb124-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-36" tabindex="-1"></a>model_tobit<span class="ot">&lt;-</span><span class="st">&quot;Code/SPG2018/HLtobit.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb124-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-37" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb124-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-38" tabindex="-1"></a></span>
<span id="cb124-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-39" tabindex="-1"></a>X<span class="ot">&lt;-</span>Intensive <span class="sc">|&gt;</span> <span class="fu">select</span>(constant,female)</span>
<span id="cb124-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-40" tabindex="-1"></a></span>
<span id="cb124-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-41" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb124-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-42" tabindex="-1"></a>  </span>
<span id="cb124-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-43" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">dim</span>(Intensive)[<span class="dv">1</span>],</span>
<span id="cb124-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-44" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>],</span>
<span id="cb124-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-45" tabindex="-1"></a>  </span>
<span id="cb124-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-46" tabindex="-1"></a>  <span class="at">HL =</span> Intensive<span class="sc">$</span>Task.H..risk,</span>
<span id="cb124-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-47" tabindex="-1"></a>  </span>
<span id="cb124-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-48" tabindex="-1"></a>  <span class="at">prior_r_mean =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-49" tabindex="-1"></a>  <span class="at">prior_r_sd =</span> <span class="dv">1</span>,</span>
<span id="cb124-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-50" tabindex="-1"></a>  </span>
<span id="cb124-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-51" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-52" tabindex="-1"></a>  <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-53" tabindex="-1"></a>  <span class="at">prior_sigma =</span> <span class="dv">1</span>,</span>
<span id="cb124-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-54" tabindex="-1"></a>  </span>
<span id="cb124-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-55" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb124-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-56" tabindex="-1"></a>  <span class="at">Y_LB =</span> Intensive<span class="sc">$</span>Y_LB,</span>
<span id="cb124-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-57" tabindex="-1"></a>  <span class="at">Y_UB =</span> Intensive<span class="sc">$</span>Y_UB,</span>
<span id="cb124-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-58" tabindex="-1"></a>  <span class="at">is_discrete =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-59" tabindex="-1"></a>  </span>
<span id="cb124-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-60" tabindex="-1"></a>  <span class="at">zsim=</span><span class="fu">rnorm</span>(<span class="dv">1000</span>),</span>
<span id="cb124-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-61" tabindex="-1"></a>  <span class="at">nz=</span><span class="dv">1000</span></span>
<span id="cb124-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-62" tabindex="-1"></a>  </span>
<span id="cb124-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-63" tabindex="-1"></a>  </span>
<span id="cb124-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-64" tabindex="-1"></a>  </span>
<span id="cb124-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-65" tabindex="-1"></a>  </span>
<span id="cb124-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-66" tabindex="-1"></a>)</span>
<span id="cb124-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-67" tabindex="-1"></a></span>
<span id="cb124-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-68" tabindex="-1"></a>Fit_tobit<span class="ot">&lt;-</span>model_tobit <span class="sc">|&gt;</span> </span>
<span id="cb124-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-69" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb124-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-70" tabindex="-1"></a>    <span class="at">data=</span>dStan,</span>
<span id="cb124-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-71" tabindex="-1"></a>    <span class="co">#init_r = 0.1,</span></span>
<span id="cb124-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-72" tabindex="-1"></a>    <span class="at">chains=</span><span class="dv">4</span>,</span>
<span id="cb124-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-73" tabindex="-1"></a>    <span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb124-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-74" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>,<span class="st">&quot;Y&quot;</span>), <span class="at">include=</span><span class="cn">FALSE</span></span>
<span id="cb124-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-75" tabindex="-1"></a>  )</span>
<span id="cb124-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-76" tabindex="-1"></a></span>
<span id="cb124-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-77" tabindex="-1"></a></span>
<span id="cb124-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-78" tabindex="-1"></a>model_probit<span class="ot">&lt;-</span><span class="st">&quot;Code/SPG2018/HLprobit.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb124-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-79" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb124-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-80" tabindex="-1"></a></span>
<span id="cb124-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-81" tabindex="-1"></a></span>
<span id="cb124-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-82" tabindex="-1"></a>ext<span class="ot">&lt;-</span>Extensive <span class="sc">|&gt;</span></span>
<span id="cb124-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-83" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Task.H)) <span class="sc">|&gt;</span></span>
<span id="cb124-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-84" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb124-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-85" tabindex="-1"></a>    <span class="at">constant =</span> <span class="dv">1</span>,</span>
<span id="cb124-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-86" tabindex="-1"></a>    <span class="at">female =</span> Gender<span class="sc">==</span><span class="st">&quot;F&quot;</span></span>
<span id="cb124-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-87" tabindex="-1"></a>  )</span>
<span id="cb124-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-88" tabindex="-1"></a></span>
<span id="cb124-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-89" tabindex="-1"></a>X <span class="ot">=</span> ext <span class="sc">|&gt;</span> <span class="fu">select</span>(constant,female)</span>
<span id="cb124-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-90" tabindex="-1"></a></span>
<span id="cb124-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-91" tabindex="-1"></a></span>
<span id="cb124-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-92" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb124-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-93" tabindex="-1"></a>  </span>
<span id="cb124-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-94" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">dim</span>(ext)[<span class="dv">1</span>],</span>
<span id="cb124-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-95" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>],</span>
<span id="cb124-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-96" tabindex="-1"></a>  </span>
<span id="cb124-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-97" tabindex="-1"></a>  <span class="at">HL =</span> ext<span class="sc">$</span>Task.H,</span>
<span id="cb124-98"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-98" tabindex="-1"></a>  </span>
<span id="cb124-99"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-99" tabindex="-1"></a>  <span class="at">prior_r_mean =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-100"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-100" tabindex="-1"></a>  <span class="at">prior_r_sd =</span> <span class="dv">1</span>,</span>
<span id="cb124-101"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-101" tabindex="-1"></a>  </span>
<span id="cb124-102"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-102" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-103"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-103" tabindex="-1"></a>  <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb124-104"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-104" tabindex="-1"></a>  </span>
<span id="cb124-105"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-105" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb124-106"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-106" tabindex="-1"></a>  <span class="at">Y =</span> ext<span class="sc">$</span>Scheme<span class="sc">==</span><span class="st">&quot;T&quot;</span>,</span>
<span id="cb124-107"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-107" tabindex="-1"></a>  </span>
<span id="cb124-108"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-108" tabindex="-1"></a>  <span class="at">is_discrete =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb124-109"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-109" tabindex="-1"></a>  </span>
<span id="cb124-110"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-110" tabindex="-1"></a>  </span>
<span id="cb124-111"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-111" tabindex="-1"></a>  </span>
<span id="cb124-112"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-112" tabindex="-1"></a>  </span>
<span id="cb124-113"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-113" tabindex="-1"></a>)</span>
<span id="cb124-114"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-114" tabindex="-1"></a></span>
<span id="cb124-115"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-115" tabindex="-1"></a>Fit_probit<span class="ot">&lt;-</span>model_probit <span class="sc">|&gt;</span> </span>
<span id="cb124-116"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-116" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb124-117"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-117" tabindex="-1"></a>    <span class="at">data=</span>dStan,</span>
<span id="cb124-118"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-118" tabindex="-1"></a>    <span class="at">init_r =</span> <span class="fl">0.1</span>,</span>
<span id="cb124-119"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-119" tabindex="-1"></a>    <span class="at">chains=</span><span class="dv">4</span>,</span>
<span id="cb124-120"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-120" tabindex="-1"></a>    <span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb124-121"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-121" tabindex="-1"></a>    <span class="at">par =</span> <span class="st">&quot;r&quot;</span>, <span class="at">include=</span><span class="cn">FALSE</span></span>
<span id="cb124-122"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-122" tabindex="-1"></a>  )</span>
<span id="cb124-123"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-123" tabindex="-1"></a></span>
<span id="cb124-124"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-124" tabindex="-1"></a><span class="fu">summary</span>(Fit_probit)<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb124-125"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-125" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb124-126"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-126" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb124-127"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb124-127" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="st">&quot;Code/SPG2018/Fit_probit.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="example-2" class="section level3 hasAnchor" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Example 2<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb125-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-2" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb125-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-3" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb125-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb125-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-5" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb125-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-6" tabindex="-1"></a></span>
<span id="cb125-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-7" tabindex="-1"></a>Elicit<span class="ot">&lt;-</span><span class="st">&quot;Data/DIK2016.xlsx&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb125-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-8" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="at">sheet=</span><span class="st">&quot;Elicitation Tasks&quot;</span>, <span class="at">range =</span> <span class="st">&quot;A2:U106&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-9" tabindex="-1"></a>  <span class="fu">filter</span>(N_risky<span class="sc">!=</span><span class="st">&quot;.&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-10" tabindex="-1"></a>  <span class="fu">filter</span>(Cohort<span class="sc">!=</span><span class="st">&quot;Pilot&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-11" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb125-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-12" tabindex="-1"></a>    <span class="at">id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()</span>
<span id="cb125-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-13" tabindex="-1"></a>  )</span>
<span id="cb125-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-14" tabindex="-1"></a></span>
<span id="cb125-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-15" tabindex="-1"></a>RMB<span class="ot">&lt;-</span><span class="st">&quot;Data/DIK2016.xlsx&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb125-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-16" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="at">sheet=</span><span class="st">&quot;RMB&quot;</span>, <span class="at">range =</span> <span class="st">&quot;A2:M13106&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-17" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SubjectID=</span>Subject) <span class="sc">|&gt;</span></span>
<span id="cb125-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-18" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb125-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-19" tabindex="-1"></a>    Elicit,</span>
<span id="cb125-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-20" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;SubjectID&quot;</span></span>
<span id="cb125-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-21" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb125-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-22" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id))</span>
<span id="cb125-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-23" tabindex="-1"></a></span>
<span id="cb125-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-24" tabindex="-1"></a>RPD<span class="ot">&lt;-</span><span class="st">&quot;Data/DIK2016.xlsx&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb125-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-25" tabindex="-1"></a>  <span class="fu">read_excel</span>(<span class="at">sheet=</span><span class="st">&quot;RPD&quot;</span>, <span class="at">range =</span> <span class="st">&quot;A2:M14042&quot;</span>)<span class="sc">|&gt;</span></span>
<span id="cb125-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-26" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SubjectID=</span>Subject) <span class="sc">|&gt;</span></span>
<span id="cb125-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-27" tabindex="-1"></a>  <span class="fu">full_join</span>(</span>
<span id="cb125-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-28" tabindex="-1"></a>    Elicit,</span>
<span id="cb125-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-29" tabindex="-1"></a>    <span class="at">by =</span> <span class="st">&quot;SubjectID&quot;</span></span>
<span id="cb125-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-30" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb125-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-31" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(id))</span>
<span id="cb125-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-32" tabindex="-1"></a></span>
<span id="cb125-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-33" tabindex="-1"></a>rpd.firstround<span class="ot">&lt;-</span>RPD <span class="sc">|&gt;</span></span>
<span id="cb125-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-34" tabindex="-1"></a>  <span class="fu">filter</span>(Match<span class="sc">&gt;</span><span class="dv">5</span>, Round<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb125-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-35" tabindex="-1"></a></span>
<span id="cb125-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-36" tabindex="-1"></a></span>
<span id="cb125-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-37" tabindex="-1"></a></span>
<span id="cb125-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-38" tabindex="-1"></a></span>
<span id="cb125-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-39" tabindex="-1"></a>model_logit<span class="ot">&lt;-</span><span class="st">&quot;Code/DIK2016/RiskTimeRELogit.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb125-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-40" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb125-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-41" tabindex="-1"></a></span>
<span id="cb125-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-42" tabindex="-1"></a>X<span class="ot">&lt;-</span>rpd.firstround <span class="sc">|&gt;</span></span>
<span id="cb125-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-43" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb125-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-44" tabindex="-1"></a>    Trust, Trustworthy, Alt, Dom, Str, FOSD, PA, Male</span>
<span id="cb125-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-45" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb125-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-46" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb125-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-47" tabindex="-1"></a>    <span class="at">constant =</span> <span class="dv">1</span></span>
<span id="cb125-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-48" tabindex="-1"></a>  )</span>
<span id="cb125-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-49" tabindex="-1"></a></span>
<span id="cb125-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-50" tabindex="-1"></a></span>
<span id="cb125-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-51" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb125-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-52" tabindex="-1"></a>  <span class="at">N=</span><span class="fu">dim</span>(rpd.firstround)[<span class="dv">1</span>],</span>
<span id="cb125-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-53" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb125-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-54" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>],</span>
<span id="cb125-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-55" tabindex="-1"></a>  <span class="at">Y =</span> rpd.firstround<span class="sc">$</span>Action,</span>
<span id="cb125-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-56" tabindex="-1"></a>  <span class="at">id =</span> rpd.firstround<span class="sc">$</span>id,</span>
<span id="cb125-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-57" tabindex="-1"></a>  <span class="at">is_discrete =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb125-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-58" tabindex="-1"></a>  </span>
<span id="cb125-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-59" tabindex="-1"></a>  <span class="at">prior_beta =</span> <span class="fu">list</span>(</span>
<span id="cb125-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-60" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># Trust</span></span>
<span id="cb125-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-61" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># Trustworthy</span></span>
<span id="cb125-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-62" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># Alt</span></span>
<span id="cb125-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-63" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># Dom</span></span>
<span id="cb125-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-64" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># Str</span></span>
<span id="cb125-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-65" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># FOSD</span></span>
<span id="cb125-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-66" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># PA</span></span>
<span id="cb125-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-67" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># Male</span></span>
<span id="cb125-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-68" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)  <span class="co"># constant</span></span>
<span id="cb125-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-69" tabindex="-1"></a>  ),</span>
<span id="cb125-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-70" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">list</span>(</span>
<span id="cb125-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-71" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co"># risk</span></span>
<span id="cb125-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-72" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)  <span class="co"># time</span></span>
<span id="cb125-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-73" tabindex="-1"></a>  ),</span>
<span id="cb125-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-74" tabindex="-1"></a>  </span>
<span id="cb125-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-75" tabindex="-1"></a>  <span class="at">prior_REsd =</span> <span class="fl">0.1</span>,</span>
<span id="cb125-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-76" tabindex="-1"></a>  </span>
<span id="cb125-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-77" tabindex="-1"></a>  </span>
<span id="cb125-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-78" tabindex="-1"></a>  <span class="at">nparticipants =</span> <span class="fu">dim</span>(Elicit)[<span class="dv">1</span>],</span>
<span id="cb125-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-79" tabindex="-1"></a>  <span class="at">nrisky =</span> Elicit<span class="sc">$</span>N_risky <span class="sc">|&gt;</span> <span class="fu">parse_number</span>(),</span>
<span id="cb125-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-80" tabindex="-1"></a>  <span class="at">npatient =</span> Elicit<span class="sc">$</span>N_patient <span class="sc">|&gt;</span> <span class="fu">parse_number</span>(),</span>
<span id="cb125-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-81" tabindex="-1"></a>  </span>
<span id="cb125-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-82" tabindex="-1"></a>  <span class="at">prior_MU =</span> <span class="fu">list</span>(</span>
<span id="cb125-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-83" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>),</span>
<span id="cb125-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-84" tabindex="-1"></a>    <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.05</span><span class="sc">/</span><span class="dv">365</span><span class="sc">*</span><span class="dv">52</span>),<span class="fl">0.1</span>)</span>
<span id="cb125-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-85" tabindex="-1"></a>  ),</span>
<span id="cb125-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-86" tabindex="-1"></a>  <span class="at">prior_TAU =</span> <span class="fu">rep</span>(<span class="fl">0.1</span>,<span class="dv">2</span>),</span>
<span id="cb125-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-87" tabindex="-1"></a>  <span class="at">prior_Omega =</span> <span class="dv">2</span></span>
<span id="cb125-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-88" tabindex="-1"></a>)</span>
<span id="cb125-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-89" tabindex="-1"></a></span>
<span id="cb125-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-90" tabindex="-1"></a>Fit<span class="ot">&lt;-</span>model_logit <span class="sc">|&gt;</span></span>
<span id="cb125-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-91" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,</span>
<span id="cb125-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-92" tabindex="-1"></a>           <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>),</span>
<span id="cb125-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-93" tabindex="-1"></a>           <span class="co"># Here I&#39;m getting some ESS issues with the default options</span></span>
<span id="cb125-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-94" tabindex="-1"></a>           <span class="at">iter =</span> <span class="dv">10000</span>, <span class="at">chains =</span> <span class="dv">8</span>,</span>
<span id="cb125-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-95" tabindex="-1"></a>           <span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb125-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-96" tabindex="-1"></a></span>
<span id="cb125-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-97" tabindex="-1"></a><span class="fu">summary</span>(Fit)<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb125-98"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-98" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb125-99"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-99" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;par&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb125-100"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-100" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="st">&quot;Code/DIK2016/RElogit.csv&quot;</span>)</span>
<span id="cb125-101"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-101" tabindex="-1"></a></span>
<span id="cb125-102"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-102" tabindex="-1"></a><span class="fu">extract</span>(Fit)<span class="sc">$</span>MFX_risktime <span class="sc">|&gt;</span></span>
<span id="cb125-103"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-103" tabindex="-1"></a>  <span class="fu">write.csv</span>(</span>
<span id="cb125-104"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-104" tabindex="-1"></a>    <span class="st">&quot;Code/DIK2016/RElogit_MFX.csv&quot;</span></span>
<span id="cb125-105"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb125-105" tabindex="-1"></a>  )</span></code></pre></div>
</div>
<div id="example-3" class="section level3 hasAnchor" number="9.6.3">
<h3><span class="header-section-number">9.6.3</span> Example 3<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb126-2"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-2" tabindex="-1"></a><span class="fu">library</span>(haven)</span>
<span id="cb126-3"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-3" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb126-4"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb126-5"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-5" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb126-6"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-6" tabindex="-1"></a></span>
<span id="cb126-7"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-7" tabindex="-1"></a></span>
<span id="cb126-8"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-8" tabindex="-1"></a></span>
<span id="cb126-9"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-9" tabindex="-1"></a></span>
<span id="cb126-10"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-10" tabindex="-1"></a></span>
<span id="cb126-11"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-11" tabindex="-1"></a>diploma.name <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;No diploma&quot;</span>,<span class="st">&quot;CEP / Brevet de collèges&quot;</span>,<span class="st">&quot;BEP/CAP&quot;</span>, <span class="st">&quot;Baccalauréat&quot;</span>,</span>
<span id="cb126-12"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-12" tabindex="-1"></a>                 <span class="st">&quot;Bac+1&quot;</span>,<span class="st">&quot;Bac+2&quot;</span>,<span class="st">&quot;Bac+3&quot;</span>,<span class="st">&quot;Bac+4&quot;</span>,<span class="st">&quot;Bac+5&quot;</span>,<span class="st">&quot;Bac+8&quot;</span>)</span>
<span id="cb126-13"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-13" tabindex="-1"></a></span>
<span id="cb126-14"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-14" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="st">&quot;Data/HW2025/Dataset/confinobs_all_clean_2.dta&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb126-15"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-15" tabindex="-1"></a>  <span class="fu">read_dta</span>() <span class="sc">|&gt;</span></span>
<span id="cb126-16"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-16" tabindex="-1"></a>  <span class="co"># following along with the replication .do file, I am dropping some observations</span></span>
<span id="cb126-17"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-17" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb126-18"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-18" tabindex="-1"></a>    <span class="sc">!</span>(charge_moins_quatorze<span class="sc">==</span><span class="dv">20</span>), <span class="co"># 2 obs. dropped. We suppose that these participants did a typo while answering to the amount of children of whom they have the custody.</span></span>
<span id="cb126-19"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-19" tabindex="-1"></a>    <span class="sc">!</span>(genre<span class="sc">==</span><span class="dv">2</span>), <span class="co"># obs. dropped because this pool is not large enough</span></span>
<span id="cb126-20"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-20" tabindex="-1"></a>    <span class="sc">!</span>(departement<span class="sc">==</span><span class="st">&quot;0&quot;</span>),<span class="co"># 16 obs. dropped.</span></span>
<span id="cb126-21"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-21" tabindex="-1"></a>    <span class="sc">!</span>(region<span class="sc">==</span><span class="st">&quot;CORSE&quot;</span>) <span class="co"># 7 obs dropped</span></span>
<span id="cb126-22"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-22" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb126-23"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-23" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb126-24"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-24" tabindex="-1"></a>    <span class="at">diploma =</span> diploma.name[diplome<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb126-25"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-25" tabindex="-1"></a>    <span class="at">age=</span><span class="dv">2020</span><span class="sc">-</span> year_of_birth</span>
<span id="cb126-26"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-26" tabindex="-1"></a>    </span>
<span id="cb126-27"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-27" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb126-28"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-28" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb126-29"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-29" tabindex="-1"></a>    <span class="co"># get bounds for GP task</span></span>
<span id="cb126-30"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-30" tabindex="-1"></a>    <span class="at">GP_lb =</span> <span class="fu">ifelse</span>(GPInvestment<span class="sc">==</span><span class="dv">100</span>, <span class="dv">90</span> ,</span>
<span id="cb126-31"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-31" tabindex="-1"></a>      <span class="fu">ifelse</span>(</span>
<span id="cb126-32"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-32" tabindex="-1"></a>      (GPInvestment <span class="sc">%%</span> <span class="dv">10</span>)<span class="sc">==</span><span class="dv">0</span>, GPInvestment<span class="dv">-5</span>,</span>
<span id="cb126-33"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-33" tabindex="-1"></a>      <span class="fu">ifelse</span>(</span>
<span id="cb126-34"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-34" tabindex="-1"></a>        (GPInvestment <span class="sc">%%</span> <span class="dv">5</span>)<span class="sc">==</span><span class="dv">0</span>, GPInvestment<span class="fl">-2.5</span>,</span>
<span id="cb126-35"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-35" tabindex="-1"></a>        GPInvestment<span class="fl">-0.5</span></span>
<span id="cb126-36"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-36" tabindex="-1"></a>      )</span>
<span id="cb126-37"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-37" tabindex="-1"></a>      )</span>
<span id="cb126-38"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-38" tabindex="-1"></a>    ),</span>
<span id="cb126-39"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-39" tabindex="-1"></a>    <span class="at">GP_ub =</span><span class="fu">ifelse</span>(GPInvestment<span class="sc">==</span><span class="dv">0</span>, <span class="dv">10</span>, </span>
<span id="cb126-40"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-40" tabindex="-1"></a>      <span class="fu">ifelse</span>(</span>
<span id="cb126-41"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-41" tabindex="-1"></a>      (GPInvestment <span class="sc">%%</span> <span class="dv">10</span>)<span class="sc">==</span><span class="dv">0</span>, GPInvestment<span class="sc">+</span><span class="dv">5</span>,</span>
<span id="cb126-42"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-42" tabindex="-1"></a>      <span class="fu">ifelse</span>(</span>
<span id="cb126-43"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-43" tabindex="-1"></a>        (GPInvestment <span class="sc">%%</span> <span class="dv">5</span>)<span class="sc">==</span><span class="dv">0</span>, GPInvestment<span class="fl">+2.5</span>,</span>
<span id="cb126-44"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-44" tabindex="-1"></a>        GPInvestment<span class="fl">+0.5</span></span>
<span id="cb126-45"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-45" tabindex="-1"></a>      )</span>
<span id="cb126-46"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-46" tabindex="-1"></a>      )</span>
<span id="cb126-47"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-47" tabindex="-1"></a>    ),</span>
<span id="cb126-48"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-48" tabindex="-1"></a>    </span>
<span id="cb126-49"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-49" tabindex="-1"></a>    <span class="at">GP_lb =</span> <span class="fu">ifelse</span>(GP_lb<span class="sc">&lt;</span><span class="dv">0</span>,<span class="dv">0</span>,GP_lb),</span>
<span id="cb126-50"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-50" tabindex="-1"></a>    <span class="at">GP_ub =</span> <span class="fu">ifelse</span>(GP_ub<span class="sc">&gt;</span><span class="dv">100</span>,<span class="dv">100</span>,GP_ub)</span>
<span id="cb126-51"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-51" tabindex="-1"></a>    </span>
<span id="cb126-52"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-52" tabindex="-1"></a>  ) </span>
<span id="cb126-53"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-53" tabindex="-1"></a></span>
<span id="cb126-54"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-54" tabindex="-1"></a><span class="cf">if</span> (<span class="cn">FALSE</span>) {</span>
<span id="cb126-55"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-55" tabindex="-1"></a>  <span class="co"># this is how I wanted to do it :(</span></span>
<span id="cb126-56"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-56" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],<span class="at">ncol =</span> <span class="dv">1</span>)</span>
<span id="cb126-57"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-57" tabindex="-1"></a>  Xnames<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;(constant)&quot;</span>)</span>
<span id="cb126-58"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-58" tabindex="-1"></a>  </span>
<span id="cb126-59"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-59" tabindex="-1"></a>  <span class="cf">for</span> (xx <span class="cf">in</span> diploma.name[<span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(diploma.name)]) {</span>
<span id="cb126-60"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-60" tabindex="-1"></a>    </span>
<span id="cb126-61"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-61" tabindex="-1"></a>    X<span class="ot">&lt;-</span><span class="fu">cbind</span>(X,D<span class="sc">$</span>diploma<span class="sc">==</span>xx)</span>
<span id="cb126-62"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-62" tabindex="-1"></a>    Xnames<span class="ot">&lt;-</span><span class="fu">c</span>(Xnames,<span class="fu">paste</span>(<span class="st">&quot;Highest degree =&quot;</span>,xx))</span>
<span id="cb126-63"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-63" tabindex="-1"></a>    </span>
<span id="cb126-64"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-64" tabindex="-1"></a>  }</span>
<span id="cb126-65"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-65" tabindex="-1"></a>  </span>
<span id="cb126-66"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-66" tabindex="-1"></a>  X<span class="ot">&lt;-</span><span class="fu">cbind</span>(X,D<span class="sc">$</span>politique,D<span class="sc">$</span>genre,D<span class="sc">$</span>age)</span>
<span id="cb126-67"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-67" tabindex="-1"></a>  Xnames<span class="ot">&lt;-</span><span class="fu">c</span>(Xnames,<span class="st">&quot;Political orientation (0-10)&quot;</span>,<span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Age&quot;</span>)</span>
<span id="cb126-68"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-68" tabindex="-1"></a>}</span>
<span id="cb126-69"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-69" tabindex="-1"></a></span>
<span id="cb126-70"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-70" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],<span class="at">ncol =</span> <span class="dv">1</span>), D<span class="sc">$</span>diplome, D<span class="sc">$</span>politique,D<span class="sc">$</span>genre, D<span class="sc">$</span>age)</span>
<span id="cb126-71"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-71" tabindex="-1"></a>Xnames<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;(constant)&quot;</span>,<span class="st">&quot;Highest degree earned&quot;</span>, <span class="st">&quot;Political orientation (0-10)&quot;</span>, <span class="st">&quot;Male&quot;</span>,<span class="st">&quot;Age&quot;</span>)</span>
<span id="cb126-72"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-72" tabindex="-1"></a></span>
<span id="cb126-73"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-73" tabindex="-1"></a></span>
<span id="cb126-74"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-74" tabindex="-1"></a></span>
<span id="cb126-75"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-75" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb126-76"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-76" tabindex="-1"></a><span class="co"># Ordered logit model</span></span>
<span id="cb126-77"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-77" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb126-78"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-78" tabindex="-1"></a></span>
<span id="cb126-79"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-79" tabindex="-1"></a>model_ordered_logit<span class="ot">&lt;-</span><span class="st">&quot;Code/HW2025/GP_ordered_logit.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb126-80"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-80" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb126-81"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-81" tabindex="-1"></a></span>
<span id="cb126-82"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-82" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb126-83"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-83" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb126-84"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-84" tabindex="-1"></a>  </span>
<span id="cb126-85"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-85" tabindex="-1"></a>  <span class="at">GP_lb =</span> D<span class="sc">$</span>GP_lb,</span>
<span id="cb126-86"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-86" tabindex="-1"></a>  <span class="at">GP_ub =</span> D<span class="sc">$</span>GP_ub,</span>
<span id="cb126-87"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-87" tabindex="-1"></a>  </span>
<span id="cb126-88"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-88" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>],</span>
<span id="cb126-89"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-89" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb126-90"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-90" tabindex="-1"></a>  </span>
<span id="cb126-91"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-91" tabindex="-1"></a>  <span class="at">Y =</span> D<span class="sc">$</span>confiance_autres_general<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb126-92"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-92" tabindex="-1"></a>  <span class="at">ncat =</span> <span class="fu">max</span>(D<span class="sc">$</span>confiance_autres_general<span class="sc">+</span><span class="dv">1</span>),</span>
<span id="cb126-93"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-93" tabindex="-1"></a>  </span>
<span id="cb126-94"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-94" tabindex="-1"></a>  </span>
<span id="cb126-95"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-95" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb126-96"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-96" tabindex="-1"></a>  <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>),</span>
<span id="cb126-97"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-97" tabindex="-1"></a>  <span class="at">prior_r_mean =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>),</span>
<span id="cb126-98"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-98" tabindex="-1"></a>  <span class="at">prior_r_sd =</span> <span class="dv">1</span>,</span>
<span id="cb126-99"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-99" tabindex="-1"></a>  <span class="at">prior_r_nu =</span> <span class="dv">1</span>,</span>
<span id="cb126-100"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-100" tabindex="-1"></a>  <span class="at">estimateLogit =</span> <span class="dv">1</span></span>
<span id="cb126-101"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-101" tabindex="-1"></a>)</span>
<span id="cb126-102"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-102" tabindex="-1"></a></span>
<span id="cb126-103"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-103" tabindex="-1"></a>Fit<span class="ot">&lt;-</span>model_ordered_logit  <span class="sc">|&gt;</span></span>
<span id="cb126-104"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-104" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb126-105"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-105" tabindex="-1"></a>    <span class="at">data=</span>dStan,</span>
<span id="cb126-106"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-106" tabindex="-1"></a>    <span class="at">chains =</span><span class="dv">8</span> ,<span class="at">iter=</span><span class="dv">10000</span>,</span>
<span id="cb126-107"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-107" tabindex="-1"></a>    <span class="at">par =</span> <span class="fu">c</span>(<span class="st">&quot;r&quot;</span>,<span class="st">&quot;cut&quot;</span>), <span class="at">include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb126-108"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-108" tabindex="-1"></a>    <span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb126-109"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-109" tabindex="-1"></a>  )</span>
<span id="cb126-110"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-110" tabindex="-1"></a>  </span>
<span id="cb126-111"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-111" tabindex="-1"></a><span class="fu">summary</span>(Fit)<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb126-112"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-112" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb126-113"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-113" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;par&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-114"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-114" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">varname =</span> Xnames[<span class="fu">parse_number</span>(par)]) <span class="sc">|&gt;</span></span>
<span id="cb126-115"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-115" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="st">&quot;Code/HW2025/GP_ordered_logit.csv&quot;</span>)</span>
<span id="cb126-116"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-116" tabindex="-1"></a></span>
<span id="cb126-117"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-117" tabindex="-1"></a></span>
<span id="cb126-118"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-118" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb126-119"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-119" tabindex="-1"></a><span class="co"># Logit model</span></span>
<span id="cb126-120"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-120" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb126-121"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-121" tabindex="-1"></a></span>
<span id="cb126-122"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-122" tabindex="-1"></a>model_logit<span class="ot">&lt;-</span><span class="st">&quot;Code/HW2025/GPlogit.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb126-123"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-123" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb126-124"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-124" tabindex="-1"></a></span>
<span id="cb126-125"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-125" tabindex="-1"></a></span>
<span id="cb126-126"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-126" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb126-127"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-127" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb126-128"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-128" tabindex="-1"></a>  </span>
<span id="cb126-129"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-129" tabindex="-1"></a>  <span class="at">GP_lb =</span> D<span class="sc">$</span>GP_lb,</span>
<span id="cb126-130"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-130" tabindex="-1"></a>  <span class="at">GP_ub =</span> D<span class="sc">$</span>GP_ub,</span>
<span id="cb126-131"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-131" tabindex="-1"></a>  </span>
<span id="cb126-132"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-132" tabindex="-1"></a>  <span class="at">k =</span> <span class="fu">dim</span>(X)[<span class="dv">2</span>],</span>
<span id="cb126-133"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-133" tabindex="-1"></a>  <span class="at">X =</span> X,</span>
<span id="cb126-134"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-134" tabindex="-1"></a>  <span class="at">is_discrete =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),</span>
<span id="cb126-135"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-135" tabindex="-1"></a>  </span>
<span id="cb126-136"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-136" tabindex="-1"></a>  <span class="at">Y =</span> D<span class="sc">$</span>confiance_autres,</span>
<span id="cb126-137"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-137" tabindex="-1"></a>  </span>
<span id="cb126-138"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-138" tabindex="-1"></a></span>
<span id="cb126-139"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-139" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb126-140"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-140" tabindex="-1"></a>  <span class="at">prior_beta =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>),</span>
<span id="cb126-141"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-141" tabindex="-1"></a>  <span class="at">prior_r_mean =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>),</span>
<span id="cb126-142"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-142" tabindex="-1"></a>  <span class="at">prior_r_sd =</span> <span class="dv">1</span>,</span>
<span id="cb126-143"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-143" tabindex="-1"></a>  <span class="at">prior_r_nu =</span> <span class="dv">1</span>,</span>
<span id="cb126-144"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-144" tabindex="-1"></a>  <span class="at">estimateLogit =</span> <span class="dv">1</span></span>
<span id="cb126-145"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-145" tabindex="-1"></a>)</span>
<span id="cb126-146"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-146" tabindex="-1"></a></span>
<span id="cb126-147"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-147" tabindex="-1"></a>Fit<span class="ot">&lt;-</span>model_logit <span class="sc">|&gt;</span></span>
<span id="cb126-148"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-148" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb126-149"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-149" tabindex="-1"></a>    <span class="at">data=</span>dStan,</span>
<span id="cb126-150"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-150" tabindex="-1"></a>    <span class="co"># this ran just fine with chains = 4, iter = 2000. I&#39;m just being thorough</span></span>
<span id="cb126-151"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-151" tabindex="-1"></a>    <span class="at">chains =</span><span class="dv">8</span> ,<span class="at">iter=</span><span class="dv">10000</span>,</span>
<span id="cb126-152"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-152" tabindex="-1"></a>    <span class="at">par =</span> <span class="st">&quot;r&quot;</span>, <span class="at">include =</span> <span class="cn">FALSE</span>,</span>
<span id="cb126-153"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-153" tabindex="-1"></a>    <span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb126-154"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-154" tabindex="-1"></a>  )</span>
<span id="cb126-155"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-155" tabindex="-1"></a></span>
<span id="cb126-156"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-156" tabindex="-1"></a><span class="fu">summary</span>(Fit)<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb126-157"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-157" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb126-158"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-158" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;par&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb126-159"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-159" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">varname =</span> Xnames[<span class="fu">parse_number</span>(par)]) <span class="sc">|&gt;</span></span>
<span id="cb126-160"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#cb126-160" tabindex="-1"></a>  <span class="fu">write.csv</span>(<span class="st">&quot;Code/HW2025/GPlogit.csv&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-DIK2016" class="csl-entry">
Davis, Douglas, Asen Ivanov, and Oleg Korenok. 2016. <span>“Individual Characteristics and Behavior in Repeated Games: An Experimental Study.”</span> <em>Experimental Economics</em> 19 (1): 67–99.
</div>
<div id="ref-Gillen2019" class="csl-entry">
Gillen, Ben, Erik Snowberg, and Leeat Yariv. 2019. <span>“Experimenting with Measurement Error: Techniques with Applications to the Caltech Cohort Study.”</span> <em>Journal of Political Economy</em> 127 (4): 1826–63.
</div>
<div id="ref-Gneezy1997" class="csl-entry">
Gneezy, Uri, and Jan Potters. 1997. <span>“An Experiment on Risk Taking and Evaluation Periods.”</span> <em>The Quarterly Journal of Economics</em> 112 (2): 631–45.
</div>
<div id="ref-Holt2002" class="csl-entry">
Holt, Charles A, and Susan K Laury. 2002. <span>“Risk Aversion and Incentive Effects.”</span> <em>American Economic Review</em> 92 (5): 1644–55.
</div>
<div id="ref-MW2025" class="csl-entry">
Montoya Herrera, Daniel, and Marc Willinger. 2025. <span>“Are Risk-Tolerant Individuals More Trustful? A Representative Sample Study.”</span> <em>Journal of the Economic Science Association</em>, 1–22. <a href="https://doi.org/10.1017/esa.2025.2">https://doi.org/10.1017/esa.2025.2</a>.
</div>
<div id="ref-SPG2018" class="csl-entry">
Saccardo, Silvia, Aniela Pietrasz, and Uri Gneezy. 2018. <span>“On the Size of the Gender Difference in Competitiveness.”</span> <em>Management Science</em> 64 (4): 1541–54.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="39">
<li id="fn39"><p>And this is assuming that the participant doesn’t make any mistakes, and so their switching point correctly identifies this range 100% of the time.<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#fnref39" class="footnote-back">↩︎</a></p></li>
<li id="fn40"><p>Ideally here the intervals for the time task should be functions of <span class="math inline">\(r_i\)</span>, as we cannot dis-entangle time preferences from risk preferences. To keep things simple here (and because I haven’t worked out a way of doing it yet), I do not allow for te interaction of time and risk preferences.<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#fnref40" class="footnote-back">↩︎</a></p></li>
<li id="fn41"><p>There is no reason why we can’t also include time-varying <span class="math inline">\(x\)</span>s here, and so the <span class="math inline">\(x\)</span>s could also have a <span class="math inline">\(t\)</span> subscript. In this application, though, everything is time-invariant. <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#fnref41" class="footnote-back">↩︎</a></p></li>
<li id="fn42"><p>I also exclude all participants from the pilot part of the experiment for the same reason: missing data. <a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#fnref42" class="footnote-back">↩︎</a></p></li>
<li id="fn43"><p>If you look at my code, I had to bound it at <span class="math inline">\(r&lt;10^3\)</span>.<a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#fnref43" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="filling-in-the-blanks-imputation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-evaluation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
