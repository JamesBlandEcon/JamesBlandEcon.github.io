<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Application: A Quantal Response Equilibrium with discrete types | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="15 Application: A Quantal Response Equilibrium with discrete types | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Application: A Quantal Response Equilibrium with discrete types | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Application: A Quantal Response Equilibrium with discrete types | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-03-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"/>
<link rel="next" href="application-level-k-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>8</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-evaluation.html"><a href="model-evaluation.html#example-dataset-and-models"><i class="fa fa-check"></i><b>8.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="8.2" data-path="model-evaluation.html"><a href="model-evaluation.html#model-posterior-probabilities"><i class="fa fa-check"></i><b>8.2</b> Model posterior probabilities</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-evaluation.html"><a href="model-evaluation.html#implementation-using-bridge-sampling-and-the-bridgesampling-library"><i class="fa fa-check"></i><b>8.2.1</b> Implementation using bridge sampling and the <code>bridgesampling</code> library</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-evaluation.html"><a href="model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>8.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-evaluation.html"><a href="model-evaluation.html#expected-log-predicted-density-elpd-and-other-measures-of-goodness-of-fit"><i class="fa fa-check"></i><b>8.3.1</b> Expected Log Predicted Density (ELPD) and other measures of goodness of fit</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-evaluation.html"><a href="model-evaluation.html#round-cross-validation"><i class="fa fa-check"></i><b>8.3.2</b> 1-round cross-validation</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-evaluation.html"><a href="model-evaluation.html#leave-one-out-cross-validation-loo"><i class="fa fa-check"></i><b>8.3.3</b> Leave-one-out cross-validation (LOO)</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-evaluation.html"><a href="model-evaluation.html#approximate-loo"><i class="fa fa-check"></i><b>8.3.4</b> Approximate LOO</a></li>
<li class="chapter" data-level="8.3.5" data-path="model-evaluation.html"><a href="model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>8.3.5</b> <span class="math inline">\(k\)</span>-fold cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>9</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="9.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>9.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="9.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>9.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="9.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>9.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="9.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>9.4</b> Vectorization</a></li>
<li class="chapter" data-level="9.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>9.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="9.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>9.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>9.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="9.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>9.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>9.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>9.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="9.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>9.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="10" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>10</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="10.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>10.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="10.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>10.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="10.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>10.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>10.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="10.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>10.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="10.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results"><i class="fa fa-check"></i><b>10.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>10.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>10.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="10.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>10.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="10.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>10.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>10.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>10.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="10.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>10.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="10.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>10.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>11</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>11.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="11.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>11.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>11.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="11.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>11.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>11.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>12</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>12.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="12.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>12.2</b> The likelihood function</a></li>
<li class="chapter" data-level="12.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>12.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="12.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-2"><i class="fa fa-check"></i><b>12.4</b> Results</a></li>
<li class="chapter" data-level="12.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>12.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>13</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="13.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>13.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="13.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>13.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>13.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="13.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>13.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="13.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>13.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="13.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>13.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>13.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="13.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>13.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>13.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="13.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>13.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="13.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>13.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>14</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>14.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="14.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>14.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>14.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="14.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>14.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="14.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>14.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="14.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-3"><i class="fa fa-check"></i><b>14.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>14.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>15</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1"><i class="fa fa-check"></i><b>15.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="15.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>15.2</b> A note on replication</a></li>
<li class="chapter" data-level="15.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>15.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>15.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="15.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>15.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="15.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>15.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-4"><i class="fa fa-check"></i><b>15.4</b> Results</a></li>
<li class="chapter" data-level="15.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>15.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>16</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>16.1</b> Data and game</a></li>
<li class="chapter" data-level="16.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>16.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>16.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="16.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>16.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>16.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>16.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="16.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>16.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="16.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-5"><i class="fa fa-check"></i><b>16.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>16.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>16.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="16.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>16.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>16.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>16.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="16.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>16.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="16.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>16.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>16.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="16.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>16.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="16.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>16.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="16.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>16.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>16.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="16.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>16.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="16.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>16.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>16.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>16.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="16.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>16.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="16.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>16.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="16.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>16.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="16.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>16.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>17</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>17.1</b> Example dataset</a></li>
<li class="chapter" data-level="17.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>17.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="17.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>17.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>17.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="17.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>17.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="17.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>17.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>17.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>17.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="17.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>17.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>17.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>18</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>18.1</b> Data</a></li>
<li class="chapter" data-level="18.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>18.2</b> A basic model</a></li>
<li class="chapter" data-level="18.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>18.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="18.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>18.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="18.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>18.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="18.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>18.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>19</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="19.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>19.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="19.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>19.2</b> Computational issues</a></li>
<li class="chapter" data-level="19.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>19.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="19.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>19.4</b> A representative agent model</a></li>
<li class="chapter" data-level="19.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>19.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="19.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>19.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="application-a-quantal-response-equilibrium-with-discrete-types" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Application: A Quantal Response Equilibrium with discrete types<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#application-a-quantal-response-equilibrium-with-discrete-types" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, I would like to show you how to estimate a quantal response equilibrium model with discrete player types. This is in contrast to the Volunteer’s Dilemma chapter, where I implemented the <em>continuous</em>-type models studied in <span class="citation">Goeree, Holt, and Smith (<a href="#ref-Goeree2017">2017</a>)</span>. The distinction between discrete and continuous types can become a bit blurred when there are a lot of types in a model. For example in auctions, we often assume a continuous distribution of values (i.e. types), but when we implement this in the lab we must have a discrete distribution, albeit with a lot of types. Here I am going to show you a model with just two types, so that you can hopefully see the way we solve for the model, then construct the likelihood.</p>
<div id="example-dataset-and-models-1" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Example dataset and models<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This dataset is particularly special to me, because it is from my job market paper <span class="citation">(<a href="#ref-Bland2019JMP">Bland 2019</a>)</span>! In it, I was interested in whether choice bracketing was important in games. Choice bracketing is a phenomenon where people who face more than one decision to make partition their decisions into more than one choice set, and then make decisions for each element of these partitions sepatately. To fix ideas, Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREnarrowgames">15.1</a> shows the two games in the baseline treatment that participants played. These games were played simultaneously and against the same opponenet. Payoffs from both games determined the participants’ earnings. However game theory and <em>broad bracketing</em> (the standard, “rational” assumption in economics) assumes that players will understand that the payoffs will be added up, and so will consider these two “games” to actually be one big game, shown in Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREbroadgame">15.2</a>. Note that the actions in this game are the <em>combinations</em> of actions that a player could play in the two games in Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREnarrowgames">15.1</a>.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-1" tabindex="-1"></a>u1<span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb185-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>),<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">0</span>)</span>
<span id="cb185-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-3" tabindex="-1"></a>)</span>
<span id="cb185-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-4" tabindex="-1"></a>U1<span class="ot">&lt;-</span><span class="fu">paste0</span>(u1,<span class="st">&quot;, &quot;</span>,u1 <span class="sc">|&gt;</span> <span class="fu">t</span>()) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb185-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-5" tabindex="-1"></a><span class="fu">rownames</span>(U1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb185-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-6" tabindex="-1"></a><span class="fu">colnames</span>(U1)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb185-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-7" tabindex="-1"></a></span>
<span id="cb185-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-8" tabindex="-1"></a>u2<span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb185-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-9" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">56</span>,<span class="dv">56</span>),<span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">0</span>)</span>
<span id="cb185-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-10" tabindex="-1"></a>)</span>
<span id="cb185-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-11" tabindex="-1"></a>U2<span class="ot">&lt;-</span><span class="fu">paste0</span>(u2,<span class="st">&quot;, &quot;</span>,u2 <span class="sc">|&gt;</span> <span class="fu">t</span>()) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb185-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-12" tabindex="-1"></a><span class="fu">rownames</span>(U2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb185-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-13" tabindex="-1"></a><span class="fu">colnames</span>(U2)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>)</span>
<span id="cb185-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-14" tabindex="-1"></a></span>
<span id="cb185-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-15" tabindex="-1"></a></span>
<span id="cb185-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-16" tabindex="-1"></a><span class="fu">list</span>(U1,U2) <span class="sc">|&gt;</span> </span>
<span id="cb185-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-17" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;The two games in the baseline treatment, narrow presentation&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb185-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-18" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb185-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb185-19" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;Game 1&quot;</span>,<span class="st">&quot;Game 2&quot;</span>))</span></code></pre></div>
<table class="kable_wrapper lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Game 1
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Game 2
</div>
</th>
</tr>
</thead>
<caption>
<span id="tab:JMPQREnarrowgames">Table 15.1: </span>The two games in the baseline treatment, narrow presentation
</caption>
<tbody>
<tr>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
A
</th>
<th style="text-align:left;">
B
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
10, 10
</td>
<td style="text-align:left;">
10, 100
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
100, 10
</td>
<td style="text-align:left;">
0, 0
</td>
</tr>
</tbody>
</table>
</td>
<td>
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
C
</th>
<th style="text-align:left;">
D
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
56, 56
</td>
<td style="text-align:left;">
56, 160
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:left;">
160, 56
</td>
<td style="text-align:left;">
0, 0
</td>
</tr>
</tbody>
</table>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-1" tabindex="-1"></a>Ub<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb186-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">66</span>,<span class="dv">66</span>,<span class="dv">66</span>,<span class="dv">66</span>),</span>
<span id="cb186-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">170</span>,<span class="dv">10</span>,<span class="dv">170</span>,<span class="dv">10</span>),</span>
<span id="cb186-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">156</span>,<span class="dv">156</span>,<span class="dv">56</span>,<span class="dv">56</span>),</span>
<span id="cb186-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-5" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">260</span>,<span class="dv">100</span>,<span class="dv">160</span>,<span class="dv">0</span>)</span>
<span id="cb186-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-6" tabindex="-1"></a>)</span>
<span id="cb186-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-7" tabindex="-1"></a></span>
<span id="cb186-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-8" tabindex="-1"></a>U<span class="ot">&lt;-</span><span class="fu">paste0</span>(Ub,<span class="st">&quot;, &quot;</span>,<span class="fu">t</span>(Ub)) <span class="sc">|&gt;</span> <span class="fu">matrix</span>(<span class="at">nrow=</span><span class="dv">4</span>)</span>
<span id="cb186-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-9" tabindex="-1"></a></span>
<span id="cb186-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-10" tabindex="-1"></a><span class="fu">colnames</span>(U)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;AC&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;BD&quot;</span>)</span>
<span id="cb186-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-11" tabindex="-1"></a><span class="fu">rownames</span>(U)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;AC&quot;</span>,<span class="st">&quot;AD&quot;</span>,<span class="st">&quot;BC&quot;</span>,<span class="st">&quot;BD&quot;</span>)</span>
<span id="cb186-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-12" tabindex="-1"></a></span>
<span id="cb186-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-13" tabindex="-1"></a>U <span class="sc">|&gt;</span> </span>
<span id="cb186-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-14" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption=</span><span class="st">&quot;The $4</span><span class="sc">\\</span><span class="st">times 4$ game when players add up the payoffs of the two $2</span><span class="sc">\\</span><span class="st">times 2$ games&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb186-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb186-15" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:JMPQREbroadgame">Table 15.2: </span>The <span class="math inline">\(4\times 4\)</span> game when players add up the payoffs of the two <span class="math inline">\(2\times 2\)</span> games
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
AC
</th>
<th style="text-align:left;">
AD
</th>
<th style="text-align:left;">
BC
</th>
<th style="text-align:left;">
BD
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
AC
</td>
<td style="text-align:left;">
66, 66
</td>
<td style="text-align:left;">
66, 170
</td>
<td style="text-align:left;">
66, 156
</td>
<td style="text-align:left;">
66, 260
</td>
</tr>
<tr>
<td style="text-align:left;">
AD
</td>
<td style="text-align:left;">
170, 66
</td>
<td style="text-align:left;">
10, 10
</td>
<td style="text-align:left;">
170, 156
</td>
<td style="text-align:left;">
10, 100
</td>
</tr>
<tr>
<td style="text-align:left;">
BC
</td>
<td style="text-align:left;">
156, 66
</td>
<td style="text-align:left;">
156, 170
</td>
<td style="text-align:left;">
56, 56
</td>
<td style="text-align:left;">
56, 160
</td>
</tr>
<tr>
<td style="text-align:left;">
BD
</td>
<td style="text-align:left;">
260, 66
</td>
<td style="text-align:left;">
100, 10
</td>
<td style="text-align:left;">
160, 56
</td>
<td style="text-align:left;">
0, 0
</td>
</tr>
</tbody>
</table>
<p>My research question was: do people see these as two separate games (i.e. Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREnarrowgames">15.1</a>), or do they integrate the payoffs together (i.e. Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREbroadgame">15.2</a>)? I did this with a 3-treatment design that varied payoffs in a way that would not affect players’ actions under assumptions of broad or narrow bracketing. The way I achieved this was that in a second treatment I added 50 points to all the payoffs in Game 1 compared to the baseleine, and in a third treatment I added 50 points to all the payoffs in Game 2. If players bracketed narrowly then there should be no difference in choice frequencies in Game 1 between the baseline and Treatment 3, and in Game 2 between the baseline and Treatment 2. On the other hand, if people broadly bracketed there should be no difference in choice frequencies between Treatments 2 and 3. Unfortunately, I was able to reject <em>both</em> assumptions: the aggregate data didn’t look like narrow bracketing, but it didn’t look like broad bracketing either!</p>
<p>Fortunately, I wasn’t done analyzing me data. One of the structural analyses I did was estimate some Quantal Response Equilibrium models that assumed either broad bracketing, narrow bracketing, or a mixture of both.<a href="#fn67" class="footnote-ref" id="fnref67"><sup>67</sup></a> That way, I could ask which model <em>best</em> organized the data, rather than rejecting both assumptions against a generic alternative assumption of “something else”.</p>
<p>All of the quantal response equilibrium models I estimated assume a common choice precision <span class="math inline">\(\lambda&gt;0\)</span> and common risk-aversion parameter <span class="math inline">\(r&gt;0\)</span>, but differ in their assumptions about how payoffs are calculated. I will start by walking you through the models that assume only broad or narrow bracketing, and then use these to build up to a model where there is a mixture of broad-bracketing and narrow-bracketing participants in the sample.</p>
</div>
<div id="a-note-on-replication" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> A note on replication<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>What I am about to show you is most certainty <em>not</em> an attempt to replicate the quantal response equilibrium analysis of <span class="citation">Bland (<a href="#ref-Bland2019JMP">2019</a>)</span>. Aside from using very different priors for the model’s parameters (which I suspect wouldn’t have changed things too much), I am using a very differ technique to compute quantal response equilibrium. In particular, in my job market paper, I use the <em>empirical payoff</em> technique, which is a computational shortcut that avoids having the solve for the equilibrium at all. However as shown in <span class="citation">Bland and Turocy (<a href="#ref-BlandTurocy2023">2025</a>)</span>, this technique can produce unreliable results because it can be fitting data to a very different curve than the actual quantal response equilibrium. Instead, I am using the <em>equilibrium correspondence</em> approach, which is what I have been teaching you in the previous quantal response equilibrium chapters. Had I known about the issues of using the empirical payoff approach when I wrote my job market paper, I certainly would not have used it, especially since it is fairly easy to compute the equilibrium in this situation. All of this is to say, don’t expect what follows to be an exact replication of <span class="citation">Bland (<a href="#ref-Bland2019JMP">2019</a>)</span>.</p>
</div>
<div id="three-models-that-make-different-assumptions-about-bracketing" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Three models that make different assumptions about bracketing<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="broad-bracketing-only" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Broad bracketing only<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This is probably the most standard Quantal Response Equilibrium model. Here we are going to derive the system of equations that characterize the equilibrium as a function of <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(r\)</span>, and then propose a method for solving for the equilibrium mixed strategies iteratively.</p>
<p>First, if <span class="math inline">\(U^r\)</span> is the payoff matrix of the row player (in Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREbroadgame">15.2</a>) raised element-wise to the power of <span class="math inline">\(r\)</span>, and <span class="math inline">\(\rho\)</span> is vector of the logged mixed strategy, then we can write the equilibrium conditions in log differences as follows:</p>
<p><span class="math display">\[
\begin{aligned}
0=H_a(\rho;\lambda,r)&amp;\doteq \rho_a-\rho_1-\lambda [U_a^r-U_1^r]\quad \text{for }a\in\{2,3,4\}
\end{aligned}
\]</span></p>
<p>and then we need one more constraint to ensure that the probabilities add up to one:</p>
<p><span class="math display">\[
0=H_1(\rho;\lambda,r)=1-\sum_{a=1}^4\exp(\rho_a)
\]</span></p>
<p>We can then write these in matrix notation as:</p>
<p><span class="math display">\[
H(\rho;\lambda,r)=A\rho-\lambda AU^r\exp(\rho)-B\exp(\rho)+c
\]</span></p>
<p>where:</p>
<p><span class="math display">\[
\begin{aligned}
A&amp;=\begin{bmatrix}
-1 &amp; 1 &amp; 0 &amp; 0\\
-1 &amp; 0 &amp; 1 &amp; 0\\
-1 &amp; 0 &amp; 0 &amp; 1\\
0 &amp; 0 &amp; 0 &amp; 0
\end{bmatrix},\quad
B=\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 0\\
1 &amp; 1 &amp; 1 &amp; 1
\end{bmatrix},\quad
c=\begin{pmatrix}
0\\ 0 \\ 0 \\ 1
\end{pmatrix}
\end{aligned}
\]</span></p>
<p>we can then solve for iterativelythe equilibrium (log) mixed strategy iteratively using Newton’s method:</p>
<p><span class="math display">\[
\rho^{t+1}=\rho^t-J^{-1}(\rho^t;\lambda,r)H(\rho^t;\lambda,r)
\]</span></p>
<p>Where <span class="math inline">\(J\)</span> is the Jacobian of the system with respect to <span class="math inline">\(\rho\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
J(\rho;\lambda,r)&amp;=A-(\lambda AU^r+B)\mathrm{diag\_matrix}(\exp(\rho))
\end{aligned}
\]</span></p>
<p>For many games this won’t be enough to find an equilibrium, and you should then go and use the full predictor-corrector method described earlier in this book and in <span class="citation">Bland and Turocy (<a href="#ref-BlandTurocy2023">2025</a>)</span>, but in this instance I found that it worked well.</p>
<p>Once we have the log equilibrium mixed strategy <span class="math inline">\(\rho\)</span>, this is exactly the quantity we need to increment the likelihood: just add <span class="math inline">\(\rho_a\)</span> to it every time a participant chooses action <span class="math inline">\(a\)</span>.</p>
<p>Here is the <em>Stan</em> program I wrote to estimate this model. One thing to note is that there is a <span class="math inline">\(\rho\)</span> for every treatment (there were three treatments) becuase the payoffs change between treatments.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb187-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-1" tabindex="-1"></a></span>
<span id="cb187-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-2" tabindex="-1"></a></span>
<span id="cb187-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-3" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb187-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-4" tabindex="-1"></a>  </span>
<span id="cb187-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-5" tabindex="-1"></a>  vector QRElp<span class="op">(</span></span>
<span id="cb187-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-6" tabindex="-1"></a>    matrix U<span class="op">,</span> real lambda<span class="op">,</span></span>
<span id="cb187-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-7" tabindex="-1"></a>    data matrix A<span class="op">,</span> data matrix B<span class="op">,</span> data vector c<span class="op">,</span></span>
<span id="cb187-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-8" tabindex="-1"></a>    data real tol<span class="op">,</span> data <span class="dt">int</span> iter</span>
<span id="cb187-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-9" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-10" tabindex="-1"></a>    </span>
<span id="cb187-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-11" tabindex="-1"></a>    <span class="co">// returns the log QRE probabilities</span></span>
<span id="cb187-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-12" tabindex="-1"></a>    </span>
<span id="cb187-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-13" tabindex="-1"></a>    <span class="dt">int</span> nactions <span class="op">=</span> dims<span class="op">(</span>U<span class="op">)[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb187-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-14" tabindex="-1"></a>    </span>
<span id="cb187-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-15" tabindex="-1"></a>    <span class="co">// initialization</span></span>
<span id="cb187-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-16" tabindex="-1"></a>    vector<span class="op">[</span>nactions<span class="op">]</span> rho <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="fl">1.0</span><span class="op">/</span>nactions<span class="op">),</span>nactions<span class="op">);</span></span>
<span id="cb187-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-17" tabindex="-1"></a>    </span>
<span id="cb187-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-18" tabindex="-1"></a>    </span>
<span id="cb187-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-19" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span>iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-20"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-20" tabindex="-1"></a>      </span>
<span id="cb187-21"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-21" tabindex="-1"></a>      </span>
<span id="cb187-22"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-22" tabindex="-1"></a>      vector<span class="op">[</span>nactions<span class="op">]</span> H <span class="op">=</span> A<span class="op">*</span>rho<span class="op">-(</span>lambda<span class="op">*</span>A<span class="op">*</span>U<span class="op">+</span>B<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">)+</span>c<span class="op">;</span></span>
<span id="cb187-23"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-23" tabindex="-1"></a>      </span>
<span id="cb187-24"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-24" tabindex="-1"></a>      matrix<span class="op">[</span>nactions<span class="op">,</span>nactions<span class="op">]</span> J <span class="op">=</span> A<span class="op">-(</span>lambda<span class="op">*</span>A<span class="op">*</span>U<span class="op">+</span>B<span class="op">)*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">));</span></span>
<span id="cb187-25"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-25" tabindex="-1"></a>      <span class="co">// change in rho</span></span>
<span id="cb187-26"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-26" tabindex="-1"></a>      vector<span class="op">[</span>nactions<span class="op">]</span> drho  <span class="op">=</span> <span class="op">-</span>J\H<span class="op">;</span></span>
<span id="cb187-27"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-27" tabindex="-1"></a>      </span>
<span id="cb187-28"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-28" tabindex="-1"></a>      rho <span class="op">+=</span> drho<span class="op">;</span></span>
<span id="cb187-29"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-29" tabindex="-1"></a>      </span>
<span id="cb187-30"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-30" tabindex="-1"></a>      <span class="co">//print(max(abs(H)));</span></span>
<span id="cb187-31"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-31" tabindex="-1"></a>      <span class="co">//print(rho);</span></span>
<span id="cb187-32"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-32" tabindex="-1"></a>      <span class="co">//print(&quot;---------------&quot;);</span></span>
<span id="cb187-33"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-33" tabindex="-1"></a>      </span>
<span id="cb187-34"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-34" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-35"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-35" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb187-36"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-36" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb187-37"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-37" tabindex="-1"></a>      </span>
<span id="cb187-38"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-38" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>tt<span class="op">==</span>iter <span class="op">&amp;&amp;</span> max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&gt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-39"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-39" tabindex="-1"></a>        </span>
<span id="cb187-40"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-40" tabindex="-1"></a>        print<span class="op">(</span><span class="st">&quot;maximum number of iterations reached without reaching tolerance&quot;</span><span class="op">);</span></span>
<span id="cb187-41"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-41" tabindex="-1"></a>        </span>
<span id="cb187-42"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-42" tabindex="-1"></a>        print<span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">)));</span></span>
<span id="cb187-43"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-43" tabindex="-1"></a>        </span>
<span id="cb187-44"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-44" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb187-45"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-45" tabindex="-1"></a>      </span>
<span id="cb187-46"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-46" tabindex="-1"></a>      </span>
<span id="cb187-47"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-47" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-48"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-48" tabindex="-1"></a>    </span>
<span id="cb187-49"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-49" tabindex="-1"></a>    <span class="cf">return</span> rho<span class="op">;</span></span>
<span id="cb187-50"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-50" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-51"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-51" tabindex="-1"></a>  </span>
<span id="cb187-52"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-52" tabindex="-1"></a>  </span>
<span id="cb187-53"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-53" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-54"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-54" tabindex="-1"></a></span>
<span id="cb187-55"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-55" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb187-56"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-56" tabindex="-1"></a>  </span>
<span id="cb187-57"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-57" tabindex="-1"></a>  </span>
<span id="cb187-58"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-58" tabindex="-1"></a>  <span class="co">// payoff matrices for the 3 treatments</span></span>
<span id="cb187-59"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-59" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ubroad<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb187-60"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-60" tabindex="-1"></a>  </span>
<span id="cb187-61"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-61" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb187-62"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-62" tabindex="-1"></a>  </span>
<span id="cb187-63"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-63" tabindex="-1"></a>  <span class="dt">int</span> treatment<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb187-64"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-64" tabindex="-1"></a>  </span>
<span id="cb187-65"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-65" tabindex="-1"></a>  <span class="co">// coded as 1=AC, 2=AD, 3=BC, 4=BD</span></span>
<span id="cb187-66"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-66" tabindex="-1"></a>  <span class="dt">int</span> action<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb187-67"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-67" tabindex="-1"></a>  </span>
<span id="cb187-68"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-68" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r<span class="op">;</span></span>
<span id="cb187-69"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-69" tabindex="-1"></a>  </span>
<span id="cb187-70"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-70" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_lambda<span class="op">;</span></span>
<span id="cb187-71"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-71" tabindex="-1"></a>  </span>
<span id="cb187-72"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-72" tabindex="-1"></a>  </span>
<span id="cb187-73"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-73" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span></span>
<span id="cb187-74"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-74" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> iter<span class="op">;</span></span>
<span id="cb187-75"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-75" tabindex="-1"></a>  </span>
<span id="cb187-76"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-76" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> UseData<span class="op">;</span></span>
<span id="cb187-77"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-77" tabindex="-1"></a>  </span>
<span id="cb187-78"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-78" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> contextual<span class="op">;</span></span>
<span id="cb187-79"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-79" tabindex="-1"></a></span>
<span id="cb187-80"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-80" tabindex="-1"></a>  </span>
<span id="cb187-81"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-81" tabindex="-1"></a>  </span>
<span id="cb187-82"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-82" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-83"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-83" tabindex="-1"></a></span>
<span id="cb187-84"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-84" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb187-85"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-85" tabindex="-1"></a>  </span>
<span id="cb187-86"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-86" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> A_broad <span class="op">=</span> <span class="op">[</span></span>
<span id="cb187-87"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-87" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb187-88"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-88" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb187-89"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-89" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb187-90"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-90" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb187-91"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-91" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb187-92"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-92" tabindex="-1"></a>  </span>
<span id="cb187-93"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-93" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> B_broad <span class="op">=</span> <span class="op">[</span></span>
<span id="cb187-94"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-94" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb187-95"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-95" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb187-96"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-96" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb187-97"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-97" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb187-98"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-98" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb187-99"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-99" tabindex="-1"></a>  </span>
<span id="cb187-100"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-100" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> c_broad <span class="op">=</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb187-101"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-101" tabindex="-1"></a>  </span>
<span id="cb187-102"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-102" tabindex="-1"></a>  </span>
<span id="cb187-103"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-103" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-104"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-104" tabindex="-1"></a></span>
<span id="cb187-105"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-105" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb187-106"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-106" tabindex="-1"></a>  </span>
<span id="cb187-107"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-107" tabindex="-1"></a>  <span class="co">// risk aversion</span></span>
<span id="cb187-108"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-108" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r<span class="op">;</span></span>
<span id="cb187-109"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-109" tabindex="-1"></a>  <span class="co">// choice precision</span></span>
<span id="cb187-110"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-110" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb187-111"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-111" tabindex="-1"></a>  </span>
<span id="cb187-112"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-112" tabindex="-1"></a> </span>
<span id="cb187-113"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-113" tabindex="-1"></a>  </span>
<span id="cb187-114"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-114" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-115"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-115" tabindex="-1"></a></span>
<span id="cb187-116"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-116" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb187-117"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-117" tabindex="-1"></a>  </span>
<span id="cb187-118"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-118" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> rho<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb187-119"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-119" tabindex="-1"></a>  </span>
<span id="cb187-120"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-120" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-121"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-121" tabindex="-1"></a>    </span>
<span id="cb187-122"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-122" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> U <span class="op">=</span> pow<span class="op">(</span>Ubroad<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb187-123"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-123" tabindex="-1"></a>    </span>
<span id="cb187-124"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-124" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contextual<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-125"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-125" tabindex="-1"></a>      <span class="co">// contextual utility normalization</span></span>
<span id="cb187-126"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-126" tabindex="-1"></a>      U <span class="op">=</span> U<span class="op">/(</span>U<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb187-127"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-127" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-128"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-128" tabindex="-1"></a>    </span>
<span id="cb187-129"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-129" tabindex="-1"></a>    rho<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> QRElp<span class="op">(</span></span>
<span id="cb187-130"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-130" tabindex="-1"></a>      U<span class="op">,</span> lambda<span class="op">,</span></span>
<span id="cb187-131"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-131" tabindex="-1"></a>      A_broad<span class="op">,</span> B_broad<span class="op">,</span> c_broad<span class="op">,</span></span>
<span id="cb187-132"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-132" tabindex="-1"></a>      tol<span class="op">,</span> iter</span>
<span id="cb187-133"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-133" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb187-134"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-134" tabindex="-1"></a>    </span>
<span id="cb187-135"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-135" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-136"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-136" tabindex="-1"></a>  </span>
<span id="cb187-137"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-137" tabindex="-1"></a>  </span>
<span id="cb187-138"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-138" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-139"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-139" tabindex="-1"></a></span>
<span id="cb187-140"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-140" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb187-141"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-141" tabindex="-1"></a>  </span>
<span id="cb187-142"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-142" tabindex="-1"></a>  </span>
<span id="cb187-143"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-143" tabindex="-1"></a>  <span class="co">// likelihood contribution</span></span>
<span id="cb187-144"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-144" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-145"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-145" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-146"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-146" tabindex="-1"></a>    </span>
<span id="cb187-147"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-147" tabindex="-1"></a>    target <span class="op">+=</span> rho<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]][</span>action<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb187-148"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-148" tabindex="-1"></a>    </span>
<span id="cb187-149"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-149" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-150"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-150" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-151"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-151" tabindex="-1"></a></span>
<span id="cb187-152"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-152" tabindex="-1"></a>  </span>
<span id="cb187-153"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-153" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb187-154"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-154" tabindex="-1"></a>  </span>
<span id="cb187-155"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-155" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>r <span class="op">|</span> prior_r<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb187-156"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-156" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>lambda <span class="op">|</span> prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb187-157"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-157" tabindex="-1"></a>  </span>
<span id="cb187-158"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-158" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-159"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-159" tabindex="-1"></a></span>
<span id="cb187-160"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-160" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb187-161"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-161" tabindex="-1"></a>  </span>
<span id="cb187-162"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-162" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> sigma<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb187-163"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-163" tabindex="-1"></a>  </span>
<span id="cb187-164"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-164" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-165"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-165" tabindex="-1"></a>    </span>
<span id="cb187-166"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-166" tabindex="-1"></a>    sigma<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">]);</span></span>
<span id="cb187-167"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-167" tabindex="-1"></a>    </span>
<span id="cb187-168"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-168" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb187-169"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-169" tabindex="-1"></a>  </span>
<span id="cb187-170"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-170" tabindex="-1"></a>  </span>
<span id="cb187-171"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb187-171" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="narrow-bracketing-only" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Narrow bracketing only<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here we need to compute two equilibrium mixed strategies per treatment. One for Game 1 and one for Game 2. The steps for doing this are similar to that for the broad bracketing assumption, except that we have two log mixed strategies to keep track of, which I call <span class="math inline">\(\rho^1\)</span> and <span class="math inline">\(\rho^2\)</span>. For each game, we can write the system of eqations describing the equilibrium as:</p>
<p><span class="math display">\[
\begin{aligned}
H(\rho^g;\lambda,r)&amp;=A\rho^g-\lambda A (U^g)^r\exp(\rho^g)-B\exp(\rho^g)+c,\quad g\in\{1,2\}\\
\text{where: }A&amp;=\begin{bmatrix}-1 &amp; 1\\ 0 &amp; 0\end{bmatrix},\quad
B = \begin{bmatrix}
0 &amp; 0\\ 1 &amp; 1
\end{bmatrix},\quad
c = \begin{pmatrix}0 \\ 1\end{pmatrix}
\end{aligned}
\]</span></p>
<p>So it is basically the same process to solve for the quantal response equilibrium compared to the broad bracketing model.</p>
<p>One additional assumption I had to make here was about dependence between actions in the two games. While broad bracketing implies a probability distribution over all <em>four</em> combinations of actions, narrow bracketing only says something about the <em>marginal</em> strategy profiles. Here I assumed that they were independent, so the log mixed strategy would be (since multiplying probability levels is the same as adding logged probabilities):</p>
<p><span class="math display">\[
\rho = \begin{pmatrix}
\rho^1_A+\rho^2_C\\
\rho^1_A+\rho^2_D\\
\rho^1_B+\rho^2_C\\
\rho^1_B+\rho^2_D\\
\end{pmatrix}
\]</span>
Here is the <em>Stan</em> program I wrote to estimate this model:</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb188-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-1" tabindex="-1"></a></span>
<span id="cb188-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-2" tabindex="-1"></a></span>
<span id="cb188-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-3" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb188-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-4" tabindex="-1"></a>  </span>
<span id="cb188-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-5" tabindex="-1"></a>  vector QRElp<span class="op">(</span></span>
<span id="cb188-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-6" tabindex="-1"></a>    matrix U<span class="op">,</span> real lambda<span class="op">,</span></span>
<span id="cb188-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-7" tabindex="-1"></a>    data matrix A<span class="op">,</span> data matrix B<span class="op">,</span> data vector c<span class="op">,</span></span>
<span id="cb188-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-8" tabindex="-1"></a>    data real tol<span class="op">,</span> data <span class="dt">int</span> iter</span>
<span id="cb188-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-9" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-10" tabindex="-1"></a>    </span>
<span id="cb188-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-11" tabindex="-1"></a>    <span class="co">// returns the log QRE probabilities</span></span>
<span id="cb188-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-12" tabindex="-1"></a>    </span>
<span id="cb188-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-13" tabindex="-1"></a>    <span class="dt">int</span> nactions <span class="op">=</span> dims<span class="op">(</span>U<span class="op">)[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb188-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-14" tabindex="-1"></a>    </span>
<span id="cb188-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-15" tabindex="-1"></a>    <span class="co">// initialization</span></span>
<span id="cb188-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-16" tabindex="-1"></a>    vector<span class="op">[</span>nactions<span class="op">]</span> rho <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="fl">1.0</span><span class="op">/</span>nactions<span class="op">),</span>nactions<span class="op">);</span></span>
<span id="cb188-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-17" tabindex="-1"></a>    </span>
<span id="cb188-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-18" tabindex="-1"></a>    </span>
<span id="cb188-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-19" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span>iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-20"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-20" tabindex="-1"></a>      </span>
<span id="cb188-21"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-21" tabindex="-1"></a>      </span>
<span id="cb188-22"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-22" tabindex="-1"></a>      vector<span class="op">[</span>nactions<span class="op">]</span> H <span class="op">=</span> A<span class="op">*</span>rho<span class="op">-(</span>lambda<span class="op">*</span>A<span class="op">*</span>U<span class="op">+</span>B<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">)+</span>c<span class="op">;</span></span>
<span id="cb188-23"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-23" tabindex="-1"></a>      </span>
<span id="cb188-24"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-24" tabindex="-1"></a>      matrix<span class="op">[</span>nactions<span class="op">,</span>nactions<span class="op">]</span> J <span class="op">=</span> A<span class="op">-(</span>lambda<span class="op">*</span>A<span class="op">*</span>U<span class="op">+</span>B<span class="op">)*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">));</span></span>
<span id="cb188-25"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-25" tabindex="-1"></a>      <span class="co">// change in rho</span></span>
<span id="cb188-26"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-26" tabindex="-1"></a>      vector<span class="op">[</span>nactions<span class="op">]</span> drho  <span class="op">=</span> <span class="op">-</span>J\H<span class="op">;</span></span>
<span id="cb188-27"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-27" tabindex="-1"></a>      </span>
<span id="cb188-28"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-28" tabindex="-1"></a>      rho <span class="op">+=</span> drho<span class="op">;</span></span>
<span id="cb188-29"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-29" tabindex="-1"></a>      </span>
<span id="cb188-30"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-30" tabindex="-1"></a>      <span class="co">//print(max(abs(H)));</span></span>
<span id="cb188-31"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-31" tabindex="-1"></a>      <span class="co">//print(rho);</span></span>
<span id="cb188-32"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-32" tabindex="-1"></a>      <span class="co">//print(&quot;---------------&quot;);</span></span>
<span id="cb188-33"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-33" tabindex="-1"></a>      </span>
<span id="cb188-34"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-34" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-35"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-35" tabindex="-1"></a>        <span class="cf">break</span><span class="op">;</span></span>
<span id="cb188-36"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-36" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb188-37"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-37" tabindex="-1"></a>      </span>
<span id="cb188-38"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-38" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>tt<span class="op">==</span>iter <span class="op">&amp;&amp;</span> max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&gt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-39"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-39" tabindex="-1"></a>        </span>
<span id="cb188-40"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-40" tabindex="-1"></a>        print<span class="op">(</span><span class="st">&quot;maximum number of iterations reached without reaching tolerance&quot;</span><span class="op">);</span></span>
<span id="cb188-41"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-41" tabindex="-1"></a>        </span>
<span id="cb188-42"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-42" tabindex="-1"></a>        print<span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">)));</span></span>
<span id="cb188-43"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-43" tabindex="-1"></a>        </span>
<span id="cb188-44"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-44" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb188-45"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-45" tabindex="-1"></a>      </span>
<span id="cb188-46"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-46" tabindex="-1"></a>      </span>
<span id="cb188-47"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-47" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-48"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-48" tabindex="-1"></a>    </span>
<span id="cb188-49"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-49" tabindex="-1"></a>    <span class="cf">return</span> rho<span class="op">;</span></span>
<span id="cb188-50"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-50" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb188-51"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-51" tabindex="-1"></a>  </span>
<span id="cb188-52"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-52" tabindex="-1"></a>  </span>
<span id="cb188-53"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-53" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-54"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-54" tabindex="-1"></a></span>
<span id="cb188-55"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-55" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb188-56"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-56" tabindex="-1"></a>  </span>
<span id="cb188-57"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-57" tabindex="-1"></a>  </span>
<span id="cb188-58"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-58" tabindex="-1"></a>  <span class="co">// payoff matrices for the 3 treatments</span></span>
<span id="cb188-59"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-59" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Unarrow1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-60"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-60" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Unarrow2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-61"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-61" tabindex="-1"></a>  </span>
<span id="cb188-62"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-62" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb188-63"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-63" tabindex="-1"></a>  </span>
<span id="cb188-64"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-64" tabindex="-1"></a>  <span class="dt">int</span> treatment<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb188-65"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-65" tabindex="-1"></a>  </span>
<span id="cb188-66"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-66" tabindex="-1"></a>  <span class="co">// coded as 1=AC, 2=AD, 3=BC, 4=BD</span></span>
<span id="cb188-67"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-67" tabindex="-1"></a>  <span class="dt">int</span> action<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb188-68"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-68" tabindex="-1"></a>  </span>
<span id="cb188-69"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-69" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r<span class="op">;</span></span>
<span id="cb188-70"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-70" tabindex="-1"></a>  </span>
<span id="cb188-71"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-71" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_lambda<span class="op">;</span></span>
<span id="cb188-72"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-72" tabindex="-1"></a>  </span>
<span id="cb188-73"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-73" tabindex="-1"></a>  </span>
<span id="cb188-74"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-74" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span></span>
<span id="cb188-75"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-75" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> iter<span class="op">;</span></span>
<span id="cb188-76"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-76" tabindex="-1"></a>  </span>
<span id="cb188-77"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-77" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> UseData<span class="op">;</span></span>
<span id="cb188-78"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-78" tabindex="-1"></a>  </span>
<span id="cb188-79"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-79" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> contextual<span class="op">;</span></span>
<span id="cb188-80"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-80" tabindex="-1"></a></span>
<span id="cb188-81"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-81" tabindex="-1"></a>  </span>
<span id="cb188-82"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-82" tabindex="-1"></a>  </span>
<span id="cb188-83"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-83" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-84"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-84" tabindex="-1"></a></span>
<span id="cb188-85"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-85" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb188-86"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-86" tabindex="-1"></a>  </span>
<span id="cb188-87"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-87" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> A_narrow <span class="op">=</span> <span class="op">[</span></span>
<span id="cb188-88"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-88" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb188-89"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-89" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb188-90"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-90" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb188-91"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-91" tabindex="-1"></a>  </span>
<span id="cb188-92"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-92" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> B_narrow <span class="op">=</span> <span class="op">[</span></span>
<span id="cb188-93"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-93" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb188-94"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-94" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb188-95"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-95" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb188-96"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-96" tabindex="-1"></a>  </span>
<span id="cb188-97"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-97" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> c_narrow <span class="op">=</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb188-98"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-98" tabindex="-1"></a>  </span>
<span id="cb188-99"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-99" tabindex="-1"></a>  </span>
<span id="cb188-100"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-100" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-101"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-101" tabindex="-1"></a></span>
<span id="cb188-102"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-102" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb188-103"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-103" tabindex="-1"></a>  </span>
<span id="cb188-104"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-104" tabindex="-1"></a>  <span class="co">// risk aversion</span></span>
<span id="cb188-105"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-105" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r<span class="op">;</span></span>
<span id="cb188-106"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-106" tabindex="-1"></a>  <span class="co">// choice precision</span></span>
<span id="cb188-107"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-107" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb188-108"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-108" tabindex="-1"></a>  </span>
<span id="cb188-109"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-109" tabindex="-1"></a> </span>
<span id="cb188-110"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-110" tabindex="-1"></a>  </span>
<span id="cb188-111"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-111" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-112"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-112" tabindex="-1"></a></span>
<span id="cb188-113"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-113" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb188-114"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-114" tabindex="-1"></a>  </span>
<span id="cb188-115"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-115" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> rho1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-116"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-116" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> rho2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-117"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-117" tabindex="-1"></a>  </span>
<span id="cb188-118"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-118" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> rho<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-119"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-119" tabindex="-1"></a>  </span>
<span id="cb188-120"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-120" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-121"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-121" tabindex="-1"></a>    </span>
<span id="cb188-122"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-122" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> U1 <span class="op">=</span> pow<span class="op">(</span>Unarrow1<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb188-123"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-123" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> U2 <span class="op">=</span> pow<span class="op">(</span>Unarrow2<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb188-124"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-124" tabindex="-1"></a>    </span>
<span id="cb188-125"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-125" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contextual<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-126"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-126" tabindex="-1"></a>      <span class="co">// contextual utility normalization</span></span>
<span id="cb188-127"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-127" tabindex="-1"></a>     U1 <span class="op">=</span> U1<span class="op">/(</span>U1<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U1<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb188-128"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-128" tabindex="-1"></a>     U2 <span class="op">=</span> U2<span class="op">/(</span>U2<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U2<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb188-129"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-129" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-130"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-130" tabindex="-1"></a>    </span>
<span id="cb188-131"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-131" tabindex="-1"></a>    rho1<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> QRElp<span class="op">(</span></span>
<span id="cb188-132"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-132" tabindex="-1"></a>      U1<span class="op">,</span> lambda<span class="op">,</span></span>
<span id="cb188-133"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-133" tabindex="-1"></a>      A_narrow<span class="op">,</span> B_narrow<span class="op">,</span> c_narrow<span class="op">,</span></span>
<span id="cb188-134"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-134" tabindex="-1"></a>      tol<span class="op">,</span> iter</span>
<span id="cb188-135"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-135" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb188-136"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-136" tabindex="-1"></a>    </span>
<span id="cb188-137"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-137" tabindex="-1"></a>    rho2<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> QRElp<span class="op">(</span></span>
<span id="cb188-138"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-138" tabindex="-1"></a>      U2<span class="op">,</span> lambda<span class="op">,</span></span>
<span id="cb188-139"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-139" tabindex="-1"></a>      A_narrow<span class="op">,</span> B_narrow<span class="op">,</span> c_narrow<span class="op">,</span></span>
<span id="cb188-140"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-140" tabindex="-1"></a>      tol<span class="op">,</span> iter</span>
<span id="cb188-141"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-141" tabindex="-1"></a>    <span class="op">);</span></span>
<span id="cb188-142"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-142" tabindex="-1"></a>    </span>
<span id="cb188-143"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-143" tabindex="-1"></a>    rho<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> to_vector<span class="op">(</span>log<span class="op">(</span>exp<span class="op">(</span>rho1<span class="op">[</span>tt<span class="op">])*</span>exp<span class="op">(</span>rho2<span class="op">[</span>tt<span class="op">]</span><span class="ch">&#39;)</span><span class="er">));</span></span>
<span id="cb188-144"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-144" tabindex="-1"></a>    </span>
<span id="cb188-145"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-145" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb188-146"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-146" tabindex="-1"></a>  </span>
<span id="cb188-147"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-147" tabindex="-1"></a>  </span>
<span id="cb188-148"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-148" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-149"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-149" tabindex="-1"></a></span>
<span id="cb188-150"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-150" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb188-151"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-151" tabindex="-1"></a>  </span>
<span id="cb188-152"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-152" tabindex="-1"></a>  </span>
<span id="cb188-153"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-153" tabindex="-1"></a>  <span class="co">// likelihood contribution</span></span>
<span id="cb188-154"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-154" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-155"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-155" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-156"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-156" tabindex="-1"></a>    </span>
<span id="cb188-157"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-157" tabindex="-1"></a>    target <span class="op">+=</span> rho<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]][</span>action<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb188-158"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-158" tabindex="-1"></a>    </span>
<span id="cb188-159"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-159" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb188-160"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-160" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb188-161"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-161" tabindex="-1"></a></span>
<span id="cb188-162"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-162" tabindex="-1"></a>  </span>
<span id="cb188-163"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-163" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb188-164"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-164" tabindex="-1"></a>  </span>
<span id="cb188-165"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-165" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>r <span class="op">|</span> prior_r<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb188-166"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-166" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>lambda <span class="op">|</span> prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb188-167"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-167" tabindex="-1"></a>  </span>
<span id="cb188-168"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-168" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-169"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-169" tabindex="-1"></a></span>
<span id="cb188-170"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-170" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb188-171"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-171" tabindex="-1"></a>  </span>
<span id="cb188-172"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-172" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> sigma1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-173"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-173" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> sigma2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-174"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-174" tabindex="-1"></a>  </span>
<span id="cb188-175"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-175" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> sigma<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb188-176"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-176" tabindex="-1"></a>  </span>
<span id="cb188-177"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-177" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-178"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-178" tabindex="-1"></a>    sigma1<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho1<span class="op">[</span>tt<span class="op">]);</span></span>
<span id="cb188-179"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-179" tabindex="-1"></a>    sigma2<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho2<span class="op">[</span>tt<span class="op">]);</span></span>
<span id="cb188-180"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-180" tabindex="-1"></a>    sigma<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">]);</span></span>
<span id="cb188-181"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-181" tabindex="-1"></a>    </span>
<span id="cb188-182"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-182" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb188-183"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-183" tabindex="-1"></a>  </span>
<span id="cb188-184"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-184" tabindex="-1"></a>  </span>
<span id="cb188-185"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb188-185" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="a-mixture-of-broad-and-narrow-bracketing" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> A mixture of broad and narrow bracketing<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we have more than one thing that people could be doing, it is possible (and often likely) that all of the things are important. I therefore also estimate a quantal response equilibrium model that assumes fraction <span class="math inline">\(\phi\in(0,1)\)</span> of participants narrowly bracket, and fraction <span class="math inline">\(1-\phi\)</span> broadly bracket. That is, we have two <em>types</em> of player in our game. If we weren’t doing quantal response equilibrium, we would be looking to solve a <em>Bayesian</em> Nash equilibrium. For quantal response equilibrium, while conceptually this is not too hard to implement, some care needs to be taken when writing down the equilibrium conditions. For this, we will need a set of equations for the narrow-bracketing type, a set for the broad-bracketing type, and a description of how the types’ mixed strategies relate to the aggregate mixed strategy (when we integrate out the types). By the “aggregate mixed strategy” here I mean the average choice probabilities implied by the mixing probability <span class="math inline">\(\phi\)</span> and the mixed strategies played by each type. In this kind of game this is the quantity players need to know in order to evaluate their expected utilities (irrespective of whether they are broad or narrow bracketers).</p>
<p>Let <span class="math inline">\(\rho\)</span> be the log probabilities of the broad and narrow actions:</p>
<p><span class="math display">\[
\rho=\begin{pmatrix}
\rho_{AC}^B &amp; \rho_{AD}^B &amp; \rho_{BC}^B &amp; \rho_{BD}^B &amp; \rho_{A}^N &amp; \rho_{B}^N &amp; \rho_{C}^N &amp; \rho_{D}^N
\end{pmatrix}^\top
\]</span></p>
<p>We can write the aggregate mixed strategy (in levels, rather than logs) from a broad bracketer’s perspective as:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma^{B*}&amp;=\begin{pmatrix}
(1-\phi)\exp(\rho_{AC}^B)+\phi\exp(\rho_A^N+\rho_C^N)\\
(1-\phi)\exp(\rho_{AD}^B)+\phi\exp(\rho_A^N+\rho_D^N)\\
(1-\phi)\exp(\rho_{BC}^B)+\phi\exp(\rho_B^N+\rho_C^N)\\
(1-\phi)\exp(\rho_{BD}^B)+\phi\exp(\rho_B^N+\rho_D^N)
\end{pmatrix}
\end{aligned}
\]</span></p>
<p>In order to evaluate the Jacobian, we need the derivative of this, which is:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \sigma^{B*}}{\partial \rho^\top}&amp;=\begin{bmatrix}
(1-\phi)\exp(\rho^B_{AC}) &amp; 0 &amp; 0 &amp; 0 &amp; \phi\exp(\rho^N_A+\rho^N_C) &amp; 0 &amp;\phi\exp(\rho^N_A+\rho^N_C) &amp; 0\\
0 &amp; (1-\phi)\exp(\rho^B_{AD}) &amp; 0 &amp; 0 &amp; \phi\exp(\rho^N_A+\rho^N_D) &amp; 0 &amp; 0 &amp; \phi\exp(\rho^N_A+\rho^N_D)\\
0 &amp; 0 &amp; (1-\phi)\exp(\rho^B_{BC}) &amp; 0 &amp; 0 &amp; \phi\exp(\rho^N_B+\rho^N_C)&amp; \phi\exp(\rho^N_B+\rho^N_C)&amp; 0 \\
0 &amp; 0 &amp; 0 &amp; (1-\phi)\exp(\rho^B_{BD}) &amp; 0 &amp; \phi\exp(\rho^N_B+\rho^N_D)&amp; 0 &amp; \phi\exp(\rho^N_B+\rho^N_D)
\end{bmatrix}
\end{aligned}
\]</span></p>
<p>Then we can write the aggregate mixed strategy from a narrow bracketer’s perspective as:</p>
<p><span class="math display">\[
\begin{aligned}
\sigma^{N*}&amp;=\begin{pmatrix}
\sigma^{B*}_{AC}+\sigma^{B*}_{AD}\\
\sigma^{B*}_{BC}+\sigma^{B*}_{BD}\\
\sigma^{B*}_{AC}+\sigma^{B*}_{BC}\\
\sigma^{B*}_{AD}+\sigma^{B*}_{BD}
\end{pmatrix}
\end{aligned}
\]</span></p>
<p>Then to get the Jacobian we can write:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial \sigma^{N*}}{\partial \rho^\top}&amp;=\frac{\partial \sigma^{N*}}{\partial {\sigma^{B*}}^\top}\frac{\partial \sigma^{B*}}{\partial \rho^\top},\quad
\text{where }\frac{\partial \sigma^{N*}}{\partial {\sigma^{B*}}^\top}
=\begin{bmatrix}
1 &amp; 1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1&amp; 1\\
1&amp; 0 &amp; 1 &amp; 0\\
0 &amp; 1 &amp; 0 &amp; 1
\end{bmatrix}
\end{aligned}
\]</span></p>
<p>We can then write the system of equations describing the equilibrium as:</p>
<p><span class="math display">\[
\begin{aligned}
H_{1:4}(\rho;r,\phi,\lambda)&amp;=A^B\rho^B-\lambda A^B(U^B)^r\sigma^{B*}-B^B\exp(\rho^B)+c^B\\
H_{5:6}(\rho;r,\phi,\lambda)&amp;=A^N\rho^N_1-\lambda A^N(U_1^N)^r\sigma_1^{N*}-B^N\exp(\rho_1^N)+c^N\\ H_{7:8}(\rho;r,\phi,\lambda)&amp;=A^N\rho^N_2-\lambda A^N(U_2^N)^r\sigma_2^{N*}-B^N\exp(\rho_2^N)+c^N
\end{aligned}
\]</span></p>
<p>Where <span class="math inline">\(A^B\)</span> is the <span class="math inline">\(A\)</span> matrix defined for the broad-only model, <span class="math inline">\(A^N\)</span> is the <span class="math inline">\(A\)</span> matrix defined for the narrow-only model, and so on.</p>
<p>Now that we can set up and solve the system of equations characterizing the quantal response equilibrium mixed strategies, we need to take these mixed strategies and compute the likelihod. Here, becuase participants made more than one decision in the experiment, we could make (at least) two different assumptions about how the likelihood is calculated. These are (1) the <em>dichotomous</em> mixture model assumption, and (2) the <em>toolbox</em> mixture assumption. The dichotomous assumption in this model is that participants are either broad <em>or</em> narrow bracketers, and <em>always</em> make their decisions according to that type. In this case, we compute the log-likelihood contribution for participant <span class="math inline">\(i\)</span> as follows:</p>
<p><span class="math display">\[
\log p(y_i\mid \rho^B,\rho^N,\phi)=\log\left(\phi\exp\left(y_i^\top\rho^N\right)+(1-\phi)\exp\left(y_i^\top\rho^B\right)\right)
\]</span></p>
<p>where <span class="math inline">\(y_i\)</span> is a vector of counts of the four combinations of actions.</p>
<p>On the other hand, the toolbox assumption states that participants bracket narrowly for each <em>decision</em> with probability <span class="math inline">\(\phi\)</span>, and so we write the likelihood as follows:</p>
<p><span class="math display">\[
\log p(y_i\mid \rho^B,\rho^N,\phi)
=y_i^\top\log\left(\phi\exp(\rho^N)+(1-\phi)\exp(\rho^B)\right)
\]</span></p>
<p>Here is the <em>Stan</em> program I wrote to estimate the dichotomous model:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb189-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-1" tabindex="-1"></a></span>
<span id="cb189-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-2" tabindex="-1"></a></span>
<span id="cb189-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-3" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb189-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-4" tabindex="-1"></a>  </span>
<span id="cb189-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-5" tabindex="-1"></a>  </span>
<span id="cb189-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-6" tabindex="-1"></a>  vector QRElp<span class="op">(</span></span>
<span id="cb189-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-7" tabindex="-1"></a>    matrix Ub<span class="op">,</span> matrix U1n<span class="op">,</span> matrix U2n<span class="op">,</span></span>
<span id="cb189-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-8" tabindex="-1"></a>    real lambda<span class="op">,</span> real mix_n<span class="op">,</span></span>
<span id="cb189-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-9" tabindex="-1"></a>    data <span class="dt">int</span> iter<span class="op">,</span> data real tol</span>
<span id="cb189-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-10" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-11" tabindex="-1"></a>    </span>
<span id="cb189-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-12" tabindex="-1"></a>    </span>
<span id="cb189-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-13" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ab <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-14" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-15" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-16" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb189-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-17" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb189-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-18" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb189-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-19" tabindex="-1"></a>  </span>
<span id="cb189-20"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-20" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Bb <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-21"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-21" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-22"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-22" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-23"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-23" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-24"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-24" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb189-25"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-25" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb189-26"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-26" tabindex="-1"></a>  </span>
<span id="cb189-27"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-27" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> cb <span class="op">=</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb189-28"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-28" tabindex="-1"></a>  </span>
<span id="cb189-29"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-29" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> An <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-30"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-30" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb189-31"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-31" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb189-32"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-32" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb189-33"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-33" tabindex="-1"></a>  </span>
<span id="cb189-34"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-34" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Bn <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-35"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-35" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-36"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-36" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb189-37"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-37" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb189-38"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-38" tabindex="-1"></a>  </span>
<span id="cb189-39"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-39" tabindex="-1"></a>  </span>
<span id="cb189-40"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-40" tabindex="-1"></a>  </span>
<span id="cb189-41"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-41" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> cn <span class="op">=</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb189-42"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-42" tabindex="-1"></a>  </span>
<span id="cb189-43"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-43" tabindex="-1"></a>  </span>
<span id="cb189-44"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-44" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Dsigma1n <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-45"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-45" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-46"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-46" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb189-47"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-47" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb189-48"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-48" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Dsigma2n <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-49"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-49" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb189-50"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-50" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb189-51"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-51" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb189-52"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-52" tabindex="-1"></a>  </span>
<span id="cb189-53"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-53" tabindex="-1"></a>  <span class="co">// initialization</span></span>
<span id="cb189-54"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-54" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> rho<span class="op">;</span></span>
<span id="cb189-55"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-55" tabindex="-1"></a>      rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="dv">0</span><span class="er">.25</span><span class="op">),</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb189-56"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-56" tabindex="-1"></a>      rho<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="dv">0</span><span class="er">.50</span><span class="op">),</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb189-57"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-57" tabindex="-1"></a>   </span>
<span id="cb189-58"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-58" tabindex="-1"></a>   </span>
<span id="cb189-59"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-59" tabindex="-1"></a>   <span class="co">// START LOOP HERE-----------------------------------------------------------</span></span>
<span id="cb189-60"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-60" tabindex="-1"></a>   </span>
<span id="cb189-61"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-61" tabindex="-1"></a>   <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span>iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-62"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-62" tabindex="-1"></a>   </span>
<span id="cb189-63"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-63" tabindex="-1"></a>   <span class="co">// aggregate mixed strategy, from the broad bracketers&#39; perspective</span></span>
<span id="cb189-64"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-64" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> SIGMAb <span class="op">=</span> <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb189-65"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-65" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">5</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">7</span><span class="op">]);</span></span>
<span id="cb189-66"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-66" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">5</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb189-67"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-67" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">6</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">7</span><span class="op">]);</span></span>
<span id="cb189-68"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-68" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">6</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb189-69"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-69" tabindex="-1"></a>      </span>
<span id="cb189-70"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-70" tabindex="-1"></a>   <span class="co">// aggregate mixed strategy, from the narrow bracketers&#39; perspective</span></span>
<span id="cb189-71"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-71" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> SIGMA1n<span class="op">;</span></span>
<span id="cb189-72"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-72" tabindex="-1"></a>      SIGMA1n<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb189-73"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-73" tabindex="-1"></a>      SIGMA1n<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-74"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-74" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> SIGMA2n<span class="op">;</span></span>
<span id="cb189-75"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-75" tabindex="-1"></a>      SIGMA2n<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-76"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-76" tabindex="-1"></a>      SIGMA2n<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb189-77"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-77" tabindex="-1"></a>   </span>
<span id="cb189-78"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-78" tabindex="-1"></a>   </span>
<span id="cb189-79"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-79" tabindex="-1"></a>   </span>
<span id="cb189-80"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-80" tabindex="-1"></a>   </span>
<span id="cb189-81"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-81" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> rhob <span class="op">=</span> rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb189-82"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-82" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> rho1n <span class="op">=</span> rho<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb189-83"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-83" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> rho2n <span class="op">=</span> rho<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">];</span></span>
<span id="cb189-84"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-84" tabindex="-1"></a>   </span>
<span id="cb189-85"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-85" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> H<span class="op">;</span></span>
<span id="cb189-86"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-86" tabindex="-1"></a>      H<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> Ab<span class="op">*</span>rhob<span class="op">-</span>lambda<span class="op">*</span>Ab<span class="op">*</span>Ub<span class="op">*</span>SIGMAb<span class="op">-</span>Bb<span class="op">*</span>exp<span class="op">(</span>rhob<span class="op">)+</span>cb<span class="op">;</span></span>
<span id="cb189-87"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-87" tabindex="-1"></a>      H<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]</span> <span class="op">=</span> An<span class="op">*</span>rho1n<span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U1n<span class="op">*</span>SIGMA1n<span class="op">-</span>Bn<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">)+</span>cn<span class="op">;</span></span>
<span id="cb189-88"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-88" tabindex="-1"></a>      H<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> An<span class="op">*</span>rho2n<span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U2n<span class="op">*</span>SIGMA2n<span class="op">-</span>Bn<span class="op">*</span>exp<span class="op">(</span>rho2n<span class="op">)+</span>cn<span class="op">;</span></span>
<span id="cb189-89"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-89" tabindex="-1"></a>   </span>
<span id="cb189-90"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-90" tabindex="-1"></a>   </span>
<span id="cb189-91"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-91" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">8</span><span class="op">]</span> DSIGMAb <span class="op">=</span> <span class="op">[</span></span>
<span id="cb189-92"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-92" tabindex="-1"></a>     <span class="op">[(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rhob<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span>                           <span class="op">],</span></span>
<span id="cb189-93"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-93" tabindex="-1"></a>     <span class="op">[</span><span class="dv">0</span><span class="op">,</span>                     <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">2</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           <span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">])],</span></span>
<span id="cb189-94"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-94" tabindex="-1"></a>     <span class="op">[</span><span class="dv">0</span><span class="op">,</span>                     <span class="dv">0</span><span class="op">,</span>                    <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">3</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span> <span class="op">,</span>                          mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span>mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span>                           <span class="op">],</span></span>
<span id="cb189-95"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-95" tabindex="-1"></a>     <span class="op">[</span><span class="dv">0</span><span class="op">,</span>                     <span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">4</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">])]</span></span>
<span id="cb189-96"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-96" tabindex="-1"></a>   <span class="op">];</span></span>
<span id="cb189-97"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-97" tabindex="-1"></a>   </span>
<span id="cb189-98"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-98" tabindex="-1"></a>   </span>
<span id="cb189-99"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-99" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">8</span><span class="op">,</span><span class="dv">8</span><span class="op">]</span> J <span class="op">=</span> rep_matrix<span class="op">(</span><span class="dv">0</span><span class="er">.0</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb189-100"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-100" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">,</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]</span> <span class="op">+=</span> Ab<span class="op">-</span>Bb<span class="op">*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]));</span></span>
<span id="cb189-101"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-101" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">,</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]</span> <span class="op">+=</span> An<span class="op">-</span>Bn<span class="op">*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]));</span></span>
<span id="cb189-102"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-102" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">,</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> <span class="op">+=</span> An<span class="op">-</span>Bn<span class="op">*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]));</span></span>
<span id="cb189-103"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-103" tabindex="-1"></a>      </span>
<span id="cb189-104"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-104" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">,]</span> <span class="op">+=</span> <span class="op">-</span>lambda<span class="op">*</span>Ab<span class="op">*</span>Ub<span class="op">*</span>DSIGMAb<span class="op">;</span></span>
<span id="cb189-105"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-105" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">,]</span> <span class="op">+=</span> <span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U1n<span class="op">*</span>Dsigma1n<span class="op">*</span>DSIGMAb<span class="op">;</span></span>
<span id="cb189-106"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-106" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">,]</span> <span class="op">+=</span> <span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U2n<span class="op">*</span>Dsigma2n<span class="op">*</span>DSIGMAb<span class="op">;</span></span>
<span id="cb189-107"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-107" tabindex="-1"></a>      </span>
<span id="cb189-108"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-108" tabindex="-1"></a>      </span>
<span id="cb189-109"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-109" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> drho <span class="op">=</span> <span class="op">-</span>J\H<span class="op">;</span></span>
<span id="cb189-110"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-110" tabindex="-1"></a>  </span>
<span id="cb189-111"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-111" tabindex="-1"></a>   rho <span class="op">+=</span> drho<span class="op">;</span></span>
<span id="cb189-112"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-112" tabindex="-1"></a>   </span>
<span id="cb189-113"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-113" tabindex="-1"></a>   <span class="cf">if</span> <span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-114"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-114" tabindex="-1"></a>     </span>
<span id="cb189-115"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-115" tabindex="-1"></a>     <span class="cf">break</span><span class="op">;</span></span>
<span id="cb189-116"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-116" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb189-117"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-117" tabindex="-1"></a>   </span>
<span id="cb189-118"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-118" tabindex="-1"></a>   <span class="cf">if</span> <span class="op">(</span>tt<span class="op">==</span>iter <span class="op">&amp;&amp;</span> max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&gt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-119"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-119" tabindex="-1"></a>     </span>
<span id="cb189-120"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-120" tabindex="-1"></a>     print<span class="op">(</span><span class="st">&quot;Maximum iterations reached without achieveing tolerance&quot;</span><span class="op">);</span></span>
<span id="cb189-121"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-121" tabindex="-1"></a>     </span>
<span id="cb189-122"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-122" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb189-123"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-123" tabindex="-1"></a>   </span>
<span id="cb189-124"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-124" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb189-125"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-125" tabindex="-1"></a>   </span>
<span id="cb189-126"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-126" tabindex="-1"></a>   <span class="cf">return</span> rho<span class="op">;</span></span>
<span id="cb189-127"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-127" tabindex="-1"></a>    </span>
<span id="cb189-128"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-128" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-129"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-129" tabindex="-1"></a>  </span>
<span id="cb189-130"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-130" tabindex="-1"></a>  </span>
<span id="cb189-131"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-131" tabindex="-1"></a>  </span>
<span id="cb189-132"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-132" tabindex="-1"></a>  </span>
<span id="cb189-133"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-133" tabindex="-1"></a>  </span>
<span id="cb189-134"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-134" tabindex="-1"></a></span>
<span id="cb189-135"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-135" tabindex="-1"></a>  </span>
<span id="cb189-136"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-136" tabindex="-1"></a>  </span>
<span id="cb189-137"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-137" tabindex="-1"></a>  </span>
<span id="cb189-138"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-138" tabindex="-1"></a>  </span>
<span id="cb189-139"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-139" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-140"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-140" tabindex="-1"></a></span>
<span id="cb189-141"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-141" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb189-142"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-142" tabindex="-1"></a>  </span>
<span id="cb189-143"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-143" tabindex="-1"></a>  </span>
<span id="cb189-144"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-144" tabindex="-1"></a>  <span class="co">// payoff matrices for the 3 treatments</span></span>
<span id="cb189-145"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-145" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ubroad<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-146"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-146" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Unarrow1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-147"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-147" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Unarrow2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-148"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-148" tabindex="-1"></a>  </span>
<span id="cb189-149"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-149" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb189-150"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-150" tabindex="-1"></a>  </span>
<span id="cb189-151"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-151" tabindex="-1"></a>  <span class="dt">int</span> id<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-152"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-152" tabindex="-1"></a>  </span>
<span id="cb189-153"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-153" tabindex="-1"></a>  <span class="dt">int</span> nparticipants<span class="op">;</span></span>
<span id="cb189-154"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-154" tabindex="-1"></a>  </span>
<span id="cb189-155"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-155" tabindex="-1"></a>  <span class="dt">int</span> treatment<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-156"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-156" tabindex="-1"></a>  </span>
<span id="cb189-157"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-157" tabindex="-1"></a>  <span class="co">// coded as 1=AC, 2=AD, 3=BC, 4=BD</span></span>
<span id="cb189-158"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-158" tabindex="-1"></a>  <span class="dt">int</span> action_broad<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-159"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-159" tabindex="-1"></a>  </span>
<span id="cb189-160"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-160" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r<span class="op">;</span></span>
<span id="cb189-161"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-161" tabindex="-1"></a>  </span>
<span id="cb189-162"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-162" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_lambda<span class="op">;</span></span>
<span id="cb189-163"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-163" tabindex="-1"></a>  </span>
<span id="cb189-164"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-164" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_mix<span class="op">;</span></span>
<span id="cb189-165"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-165" tabindex="-1"></a>  </span>
<span id="cb189-166"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-166" tabindex="-1"></a>  </span>
<span id="cb189-167"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-167" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span></span>
<span id="cb189-168"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-168" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> iter<span class="op">;</span></span>
<span id="cb189-169"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-169" tabindex="-1"></a>  </span>
<span id="cb189-170"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-170" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> UseData<span class="op">;</span></span>
<span id="cb189-171"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-171" tabindex="-1"></a>  </span>
<span id="cb189-172"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-172" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> contextual<span class="op">;</span></span>
<span id="cb189-173"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-173" tabindex="-1"></a></span>
<span id="cb189-174"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-174" tabindex="-1"></a>  </span>
<span id="cb189-175"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-175" tabindex="-1"></a>  </span>
<span id="cb189-176"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-176" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-177"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-177" tabindex="-1"></a></span>
<span id="cb189-178"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-178" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb189-179"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-179" tabindex="-1"></a>  </span>
<span id="cb189-180"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-180" tabindex="-1"></a> </span>
<span id="cb189-181"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-181" tabindex="-1"></a>  </span>
<span id="cb189-182"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-182" tabindex="-1"></a>  </span>
<span id="cb189-183"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-183" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> rho0 <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="fl">1.0</span><span class="op">/</span><span class="fl">4.0</span><span class="op">),</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb189-184"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-184" tabindex="-1"></a>      </span>
<span id="cb189-185"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-185" tabindex="-1"></a>      </span>
<span id="cb189-186"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-186" tabindex="-1"></a>  <span class="dt">int</span> action_narrow1<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-187"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-187" tabindex="-1"></a>  <span class="dt">int</span> action_narrow2<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb189-188"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-188" tabindex="-1"></a>  </span>
<span id="cb189-189"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-189" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-190"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-190" tabindex="-1"></a>    </span>
<span id="cb189-191"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-191" tabindex="-1"></a>    action_narrow1<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">1</span> <span class="op">||</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">2</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb189-192"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-192" tabindex="-1"></a>    action_narrow2<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">1</span> <span class="op">||</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">3</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb189-193"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-193" tabindex="-1"></a>    </span>
<span id="cb189-194"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-194" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-195"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-195" tabindex="-1"></a>  </span>
<span id="cb189-196"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-196" tabindex="-1"></a>  </span>
<span id="cb189-197"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-197" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-198"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-198" tabindex="-1"></a></span>
<span id="cb189-199"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-199" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb189-200"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-200" tabindex="-1"></a>  </span>
<span id="cb189-201"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-201" tabindex="-1"></a>  <span class="co">// risk aversion</span></span>
<span id="cb189-202"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-202" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r<span class="op">;</span></span>
<span id="cb189-203"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-203" tabindex="-1"></a>  <span class="co">// choice precision</span></span>
<span id="cb189-204"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-204" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb189-205"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-205" tabindex="-1"></a>  </span>
<span id="cb189-206"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-206" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> mix_narrow<span class="op">;</span></span>
<span id="cb189-207"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-207" tabindex="-1"></a>  </span>
<span id="cb189-208"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-208" tabindex="-1"></a> </span>
<span id="cb189-209"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-209" tabindex="-1"></a>  </span>
<span id="cb189-210"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-210" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-211"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-211" tabindex="-1"></a></span>
<span id="cb189-212"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-212" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb189-213"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-213" tabindex="-1"></a>  </span>
<span id="cb189-214"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-214" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> rho<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-215"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-215" tabindex="-1"></a>  </span>
<span id="cb189-216"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-216" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> sigma_broad<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-217"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-217" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> sigma_narrow1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-218"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-218" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> sigma_narrow2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-219"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-219" tabindex="-1"></a>  </span>
<span id="cb189-220"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-220" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-221"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-221" tabindex="-1"></a>    </span>
<span id="cb189-222"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-222" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ub <span class="op">=</span> pow<span class="op">(</span>Ubroad<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb189-223"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-223" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> U1n <span class="op">=</span> pow<span class="op">(</span>Unarrow1<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb189-224"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-224" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> U2n <span class="op">=</span> pow<span class="op">(</span>Unarrow1<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb189-225"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-225" tabindex="-1"></a>    </span>
<span id="cb189-226"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-226" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contextual<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-227"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-227" tabindex="-1"></a>      <span class="co">// contextual utility normalization</span></span>
<span id="cb189-228"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-228" tabindex="-1"></a>      Ub <span class="op">=</span> Ub<span class="op">/(</span>Ub<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>Ub<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb189-229"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-229" tabindex="-1"></a>      U1n <span class="op">=</span> U1n<span class="op">/(</span>U1n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U1n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-230"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-230" tabindex="-1"></a>      U2n <span class="op">=</span> U2n<span class="op">/(</span>U2n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U2n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-231"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-231" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-232"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-232" tabindex="-1"></a>    </span>
<span id="cb189-233"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-233" tabindex="-1"></a>    rho<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> QRElp<span class="op">(</span></span>
<span id="cb189-234"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-234" tabindex="-1"></a>      Ub<span class="op">,</span>U1n<span class="op">,</span> U2n<span class="op">,</span></span>
<span id="cb189-235"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-235" tabindex="-1"></a>      lambda<span class="op">,</span>mix_narrow<span class="op">,</span></span>
<span id="cb189-236"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-236" tabindex="-1"></a>      iter<span class="op">,</span>tol</span>
<span id="cb189-237"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-237" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb189-238"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-238" tabindex="-1"></a>    </span>
<span id="cb189-239"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-239" tabindex="-1"></a>   </span>
<span id="cb189-240"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-240" tabindex="-1"></a>    </span>
<span id="cb189-241"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-241" tabindex="-1"></a>    sigma_broad<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">][</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb189-242"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-242" tabindex="-1"></a>    </span>
<span id="cb189-243"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-243" tabindex="-1"></a>    sigma_narrow1<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">][</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]);</span></span>
<span id="cb189-244"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-244" tabindex="-1"></a>    sigma_narrow2<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">][</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb189-245"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-245" tabindex="-1"></a>    </span>
<span id="cb189-246"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-246" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-247"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-247" tabindex="-1"></a>  </span>
<span id="cb189-248"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-248" tabindex="-1"></a>  </span>
<span id="cb189-249"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-249" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-250"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-250" tabindex="-1"></a></span>
<span id="cb189-251"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-251" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb189-252"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-252" tabindex="-1"></a>  </span>
<span id="cb189-253"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-253" tabindex="-1"></a>  </span>
<span id="cb189-254"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-254" tabindex="-1"></a>  </span>
<span id="cb189-255"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-255" tabindex="-1"></a>  </span>
<span id="cb189-256"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-256" tabindex="-1"></a>  </span>
<span id="cb189-257"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-257" tabindex="-1"></a>  <span class="co">// likelihood contribution</span></span>
<span id="cb189-258"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-258" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-259"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-259" tabindex="-1"></a>    vector<span class="op">[</span>nparticipants<span class="op">]</span> ll_narrow <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span>mix_narrow<span class="op">),</span>nparticipants<span class="op">);</span></span>
<span id="cb189-260"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-260" tabindex="-1"></a>    vector<span class="op">[</span>nparticipants<span class="op">]</span> ll_broad <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_narrow<span class="op">),</span>nparticipants<span class="op">);</span></span>
<span id="cb189-261"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-261" tabindex="-1"></a>    </span>
<span id="cb189-262"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-262" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-263"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-263" tabindex="-1"></a>      </span>
<span id="cb189-264"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-264" tabindex="-1"></a>      ll_broad<span class="op">[</span>id<span class="op">[</span>ii<span class="op">]]</span> <span class="op">+=</span> log<span class="op">(</span>sigma_broad<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]])[</span>action_broad<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb189-265"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-265" tabindex="-1"></a>    </span>
<span id="cb189-266"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-266" tabindex="-1"></a>      ll_narrow<span class="op">[</span>id<span class="op">[</span>ii<span class="op">]]</span> <span class="op">+=</span> log<span class="op">(</span>sigma_narrow1<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]])[</span>action_narrow1<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb189-267"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-267" tabindex="-1"></a>      ll_narrow<span class="op">[</span>id<span class="op">[</span>ii<span class="op">]]</span> <span class="op">+=</span> log<span class="op">(</span>sigma_narrow2<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]])[</span>action_narrow2<span class="op">[</span>ii<span class="op">]];</span></span>
<span id="cb189-268"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-268" tabindex="-1"></a>    </span>
<span id="cb189-269"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-269" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-270"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-270" tabindex="-1"></a>    </span>
<span id="cb189-271"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-271" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nparticipants<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-272"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-272" tabindex="-1"></a>      target <span class="op">+=</span> log_sum_exp<span class="op">(</span>ll_broad<span class="op">[</span>ii<span class="op">],</span>ll_narrow<span class="op">[</span>ii<span class="op">]);</span></span>
<span id="cb189-273"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-273" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-274"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-274" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-275"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-275" tabindex="-1"></a></span>
<span id="cb189-276"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-276" tabindex="-1"></a>  </span>
<span id="cb189-277"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-277" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb189-278"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-278" tabindex="-1"></a>  </span>
<span id="cb189-279"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-279" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>r <span class="op">|</span> prior_r<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-280"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-280" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>lambda <span class="op">|</span> prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-281"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-281" tabindex="-1"></a>  target <span class="op">+=</span> beta_lpdf<span class="op">(</span>mix_narrow <span class="op">|</span> prior_mix<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mix<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb189-282"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-282" tabindex="-1"></a>  </span>
<span id="cb189-283"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-283" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-284"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-284" tabindex="-1"></a></span>
<span id="cb189-285"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-285" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb189-286"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-286" tabindex="-1"></a>  </span>
<span id="cb189-287"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-287" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> sigma<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb189-288"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-288" tabindex="-1"></a>  </span>
<span id="cb189-289"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-289" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-290"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-290" tabindex="-1"></a>    </span>
<span id="cb189-291"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-291" tabindex="-1"></a>    sigma<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">]);</span></span>
<span id="cb189-292"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-292" tabindex="-1"></a>    </span>
<span id="cb189-293"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-293" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb189-294"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-294" tabindex="-1"></a>  </span>
<span id="cb189-295"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-295" tabindex="-1"></a>  </span>
<span id="cb189-296"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb189-296" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>And is the <em>Stan</em> program I wrote to estimate the toolbox model:</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb190-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-1" tabindex="-1"></a></span>
<span id="cb190-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-2" tabindex="-1"></a></span>
<span id="cb190-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-3" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb190-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-4" tabindex="-1"></a>  </span>
<span id="cb190-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-5" tabindex="-1"></a>  </span>
<span id="cb190-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-6" tabindex="-1"></a>  vector QRElp<span class="op">(</span></span>
<span id="cb190-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-7" tabindex="-1"></a>    matrix Ub<span class="op">,</span> matrix U1n<span class="op">,</span> matrix U2n<span class="op">,</span></span>
<span id="cb190-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-8" tabindex="-1"></a>    real lambda<span class="op">,</span> real mix_n<span class="op">,</span></span>
<span id="cb190-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-9" tabindex="-1"></a>    data <span class="dt">int</span> iter<span class="op">,</span> data real tol</span>
<span id="cb190-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-10" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-11" tabindex="-1"></a>    </span>
<span id="cb190-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-12" tabindex="-1"></a>    </span>
<span id="cb190-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-13" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ab <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-14" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-15" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-16" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb190-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-17" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb190-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-18" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb190-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-19" tabindex="-1"></a>  </span>
<span id="cb190-20"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-20" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Bb <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-21"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-21" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-22"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-22" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-23"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-23" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-24"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-24" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb190-25"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-25" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb190-26"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-26" tabindex="-1"></a>  </span>
<span id="cb190-27"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-27" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> cb <span class="op">=</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb190-28"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-28" tabindex="-1"></a>  </span>
<span id="cb190-29"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-29" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> An <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-30"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-30" tabindex="-1"></a>    <span class="op">[-</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb190-31"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-31" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">]</span></span>
<span id="cb190-32"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-32" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb190-33"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-33" tabindex="-1"></a>  </span>
<span id="cb190-34"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-34" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Bn <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-35"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-35" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-36"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-36" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb190-37"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-37" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb190-38"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-38" tabindex="-1"></a>  </span>
<span id="cb190-39"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-39" tabindex="-1"></a>  </span>
<span id="cb190-40"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-40" tabindex="-1"></a>  </span>
<span id="cb190-41"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-41" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> cn <span class="op">=</span> <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb190-42"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-42" tabindex="-1"></a>  </span>
<span id="cb190-43"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-43" tabindex="-1"></a>  </span>
<span id="cb190-44"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-44" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Dsigma1n <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-45"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-45" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-46"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-46" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb190-47"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-47" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb190-48"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-48" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Dsigma2n <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-49"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-49" tabindex="-1"></a>    <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">],</span></span>
<span id="cb190-50"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-50" tabindex="-1"></a>    <span class="op">[</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">]</span></span>
<span id="cb190-51"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-51" tabindex="-1"></a>  <span class="op">];</span></span>
<span id="cb190-52"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-52" tabindex="-1"></a>  </span>
<span id="cb190-53"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-53" tabindex="-1"></a>  <span class="co">// initialization</span></span>
<span id="cb190-54"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-54" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> rho<span class="op">;</span></span>
<span id="cb190-55"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-55" tabindex="-1"></a>      rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="dv">0</span><span class="er">.25</span><span class="op">),</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb190-56"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-56" tabindex="-1"></a>      rho<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="dv">0</span><span class="er">.50</span><span class="op">),</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb190-57"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-57" tabindex="-1"></a>   </span>
<span id="cb190-58"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-58" tabindex="-1"></a>   </span>
<span id="cb190-59"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-59" tabindex="-1"></a>   <span class="co">// START LOOP HERE-----------------------------------------------------------</span></span>
<span id="cb190-60"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-60" tabindex="-1"></a>   </span>
<span id="cb190-61"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-61" tabindex="-1"></a>   <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span>iter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-62"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-62" tabindex="-1"></a>   </span>
<span id="cb190-63"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-63" tabindex="-1"></a>   <span class="co">// aggregate mixed strategy, from the broad bracketers&#39; perspective</span></span>
<span id="cb190-64"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-64" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> SIGMAb <span class="op">=</span> <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb190-65"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-65" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">5</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">7</span><span class="op">]);</span></span>
<span id="cb190-66"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-66" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">5</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb190-67"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-67" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">6</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">7</span><span class="op">]);</span></span>
<span id="cb190-68"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-68" tabindex="-1"></a>      SIGMAb<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">+=</span> mix_n<span class="op">*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">6</span><span class="op">]+</span>rho<span class="op">[</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb190-69"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-69" tabindex="-1"></a>      </span>
<span id="cb190-70"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-70" tabindex="-1"></a>   <span class="co">// aggregate mixed strategy, from the narrow bracketers&#39; perspective</span></span>
<span id="cb190-71"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-71" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> SIGMA1n<span class="op">;</span></span>
<span id="cb190-72"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-72" tabindex="-1"></a>      SIGMA1n<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb190-73"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-73" tabindex="-1"></a>      SIGMA1n<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-74"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-74" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> SIGMA2n<span class="op">;</span></span>
<span id="cb190-75"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-75" tabindex="-1"></a>      SIGMA2n<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-76"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-76" tabindex="-1"></a>      SIGMA2n<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> SIGMAb<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>SIGMAb<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb190-77"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-77" tabindex="-1"></a>   </span>
<span id="cb190-78"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-78" tabindex="-1"></a>   </span>
<span id="cb190-79"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-79" tabindex="-1"></a>   </span>
<span id="cb190-80"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-80" tabindex="-1"></a>   </span>
<span id="cb190-81"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-81" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> rhob <span class="op">=</span> rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb190-82"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-82" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> rho1n <span class="op">=</span> rho<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb190-83"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-83" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> rho2n <span class="op">=</span> rho<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">];</span></span>
<span id="cb190-84"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-84" tabindex="-1"></a>   </span>
<span id="cb190-85"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-85" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> H<span class="op">;</span></span>
<span id="cb190-86"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-86" tabindex="-1"></a>      H<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> Ab<span class="op">*</span>rhob<span class="op">-</span>lambda<span class="op">*</span>Ab<span class="op">*</span>Ub<span class="op">*</span>SIGMAb<span class="op">-</span>Bb<span class="op">*</span>exp<span class="op">(</span>rhob<span class="op">)+</span>cb<span class="op">;</span></span>
<span id="cb190-87"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-87" tabindex="-1"></a>      H<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]</span> <span class="op">=</span> An<span class="op">*</span>rho1n<span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U1n<span class="op">*</span>SIGMA1n<span class="op">-</span>Bn<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">)+</span>cn<span class="op">;</span></span>
<span id="cb190-88"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-88" tabindex="-1"></a>      H<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> An<span class="op">*</span>rho2n<span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U2n<span class="op">*</span>SIGMA2n<span class="op">-</span>Bn<span class="op">*</span>exp<span class="op">(</span>rho2n<span class="op">)+</span>cn<span class="op">;</span></span>
<span id="cb190-89"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-89" tabindex="-1"></a>   </span>
<span id="cb190-90"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-90" tabindex="-1"></a>   </span>
<span id="cb190-91"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-91" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">8</span><span class="op">]</span> DSIGMAb <span class="op">=</span> <span class="op">[</span></span>
<span id="cb190-92"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-92" tabindex="-1"></a>     <span class="op">[(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rhob<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span>                           <span class="op">],</span></span>
<span id="cb190-93"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-93" tabindex="-1"></a>     <span class="op">[</span><span class="dv">0</span><span class="op">,</span>                     <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">2</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           <span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">1</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">])],</span></span>
<span id="cb190-94"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-94" tabindex="-1"></a>     <span class="op">[</span><span class="dv">0</span><span class="op">,</span>                     <span class="dv">0</span><span class="op">,</span>                    <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">3</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span> <span class="op">,</span>                          mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span>mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">1</span><span class="op">]),</span><span class="dv">0</span>                           <span class="op">],</span></span>
<span id="cb190-95"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-95" tabindex="-1"></a>     <span class="op">[</span><span class="dv">0</span><span class="op">,</span>                     <span class="dv">0</span><span class="op">,</span>                    <span class="dv">0</span><span class="op">,</span>                    <span class="op">(</span><span class="dv">1</span><span class="op">-</span>mix_n<span class="op">)*</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">4</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">]),</span><span class="dv">0</span><span class="op">,</span>                           mix_n<span class="op">*</span>exp<span class="op">(</span>rho1n<span class="op">[</span><span class="dv">2</span><span class="op">]+</span>rho2n<span class="op">[</span><span class="dv">2</span><span class="op">])]</span></span>
<span id="cb190-96"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-96" tabindex="-1"></a>   <span class="op">];</span></span>
<span id="cb190-97"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-97" tabindex="-1"></a>   </span>
<span id="cb190-98"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-98" tabindex="-1"></a>   </span>
<span id="cb190-99"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-99" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">8</span><span class="op">,</span><span class="dv">8</span><span class="op">]</span> J <span class="op">=</span> rep_matrix<span class="op">(</span><span class="dv">0</span><span class="er">.0</span><span class="op">,</span><span class="dv">8</span><span class="op">,</span><span class="dv">8</span><span class="op">);</span></span>
<span id="cb190-100"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-100" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">,</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]</span> <span class="op">+=</span> Ab<span class="op">-</span>Bb<span class="op">*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]));</span></span>
<span id="cb190-101"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-101" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">,</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]</span> <span class="op">+=</span> An<span class="op">-</span>Bn<span class="op">*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]));</span></span>
<span id="cb190-102"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-102" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">,</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]</span> <span class="op">+=</span> An<span class="op">-</span>Bn<span class="op">*</span>diag_matrix<span class="op">(</span>exp<span class="op">(</span>rho<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]));</span></span>
<span id="cb190-103"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-103" tabindex="-1"></a>      </span>
<span id="cb190-104"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-104" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">,]</span> <span class="op">+=</span> <span class="op">-</span>lambda<span class="op">*</span>Ab<span class="op">*</span>Ub<span class="op">*</span>DSIGMAb<span class="op">;</span></span>
<span id="cb190-105"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-105" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">,]</span> <span class="op">+=</span> <span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U1n<span class="op">*</span>Dsigma1n<span class="op">*</span>DSIGMAb<span class="op">;</span></span>
<span id="cb190-106"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-106" tabindex="-1"></a>      J<span class="op">[</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">,]</span> <span class="op">+=</span> <span class="op">-</span>lambda<span class="op">*</span>An<span class="op">*</span>U2n<span class="op">*</span>Dsigma2n<span class="op">*</span>DSIGMAb<span class="op">;</span></span>
<span id="cb190-107"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-107" tabindex="-1"></a>      </span>
<span id="cb190-108"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-108" tabindex="-1"></a>      </span>
<span id="cb190-109"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-109" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> drho <span class="op">=</span> <span class="op">-</span>J\H<span class="op">;</span></span>
<span id="cb190-110"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-110" tabindex="-1"></a>  </span>
<span id="cb190-111"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-111" tabindex="-1"></a>   rho <span class="op">+=</span> drho<span class="op">;</span></span>
<span id="cb190-112"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-112" tabindex="-1"></a>   </span>
<span id="cb190-113"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-113" tabindex="-1"></a>   <span class="cf">if</span> <span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-114"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-114" tabindex="-1"></a>     </span>
<span id="cb190-115"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-115" tabindex="-1"></a>     <span class="cf">break</span><span class="op">;</span></span>
<span id="cb190-116"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-116" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb190-117"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-117" tabindex="-1"></a>   </span>
<span id="cb190-118"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-118" tabindex="-1"></a>   <span class="cf">if</span> <span class="op">(</span>tt<span class="op">==</span>iter <span class="op">&amp;&amp;</span> max<span class="op">(</span>abs<span class="op">(</span>H<span class="op">))&gt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-119"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-119" tabindex="-1"></a>     </span>
<span id="cb190-120"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-120" tabindex="-1"></a>     print<span class="op">(</span><span class="st">&quot;Maximum iterations reached without achieveing tolerance&quot;</span><span class="op">);</span></span>
<span id="cb190-121"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-121" tabindex="-1"></a>     </span>
<span id="cb190-122"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-122" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb190-123"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-123" tabindex="-1"></a>   </span>
<span id="cb190-124"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-124" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb190-125"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-125" tabindex="-1"></a>   </span>
<span id="cb190-126"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-126" tabindex="-1"></a>   <span class="cf">return</span> rho<span class="op">;</span></span>
<span id="cb190-127"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-127" tabindex="-1"></a>    </span>
<span id="cb190-128"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-128" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-129"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-129" tabindex="-1"></a>  </span>
<span id="cb190-130"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-130" tabindex="-1"></a>  </span>
<span id="cb190-131"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-131" tabindex="-1"></a>  </span>
<span id="cb190-132"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-132" tabindex="-1"></a>  </span>
<span id="cb190-133"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-133" tabindex="-1"></a>  </span>
<span id="cb190-134"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-134" tabindex="-1"></a></span>
<span id="cb190-135"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-135" tabindex="-1"></a>  </span>
<span id="cb190-136"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-136" tabindex="-1"></a>  </span>
<span id="cb190-137"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-137" tabindex="-1"></a>  </span>
<span id="cb190-138"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-138" tabindex="-1"></a>  </span>
<span id="cb190-139"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-139" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-140"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-140" tabindex="-1"></a></span>
<span id="cb190-141"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-141" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb190-142"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-142" tabindex="-1"></a>  </span>
<span id="cb190-143"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-143" tabindex="-1"></a>  </span>
<span id="cb190-144"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-144" tabindex="-1"></a>  <span class="co">// payoff matrices for the 3 treatments</span></span>
<span id="cb190-145"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-145" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ubroad<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-146"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-146" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Unarrow1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-147"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-147" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> Unarrow2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-148"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-148" tabindex="-1"></a>  </span>
<span id="cb190-149"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-149" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// number of observations</span></span>
<span id="cb190-150"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-150" tabindex="-1"></a>  </span>
<span id="cb190-151"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-151" tabindex="-1"></a>  <span class="dt">int</span> id<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-152"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-152" tabindex="-1"></a>  </span>
<span id="cb190-153"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-153" tabindex="-1"></a>  <span class="dt">int</span> nparticipants<span class="op">;</span></span>
<span id="cb190-154"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-154" tabindex="-1"></a>  </span>
<span id="cb190-155"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-155" tabindex="-1"></a>  <span class="dt">int</span> treatment<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-156"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-156" tabindex="-1"></a>  </span>
<span id="cb190-157"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-157" tabindex="-1"></a>  <span class="co">// coded as 1=AC, 2=AD, 3=BC, 4=BD</span></span>
<span id="cb190-158"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-158" tabindex="-1"></a>  <span class="dt">int</span> action_broad<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-159"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-159" tabindex="-1"></a>  </span>
<span id="cb190-160"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-160" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_r<span class="op">;</span></span>
<span id="cb190-161"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-161" tabindex="-1"></a>  </span>
<span id="cb190-162"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-162" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_lambda<span class="op">;</span></span>
<span id="cb190-163"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-163" tabindex="-1"></a>  </span>
<span id="cb190-164"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-164" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_mix<span class="op">;</span></span>
<span id="cb190-165"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-165" tabindex="-1"></a>  </span>
<span id="cb190-166"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-166" tabindex="-1"></a>  </span>
<span id="cb190-167"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-167" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> tol<span class="op">;</span></span>
<span id="cb190-168"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-168" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> iter<span class="op">;</span></span>
<span id="cb190-169"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-169" tabindex="-1"></a>  </span>
<span id="cb190-170"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-170" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> UseData<span class="op">;</span></span>
<span id="cb190-171"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-171" tabindex="-1"></a>  </span>
<span id="cb190-172"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-172" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> contextual<span class="op">;</span></span>
<span id="cb190-173"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-173" tabindex="-1"></a></span>
<span id="cb190-174"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-174" tabindex="-1"></a>  </span>
<span id="cb190-175"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-175" tabindex="-1"></a>  </span>
<span id="cb190-176"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-176" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-177"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-177" tabindex="-1"></a></span>
<span id="cb190-178"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-178" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb190-179"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-179" tabindex="-1"></a>  </span>
<span id="cb190-180"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-180" tabindex="-1"></a> </span>
<span id="cb190-181"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-181" tabindex="-1"></a>  </span>
<span id="cb190-182"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-182" tabindex="-1"></a>  </span>
<span id="cb190-183"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-183" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> rho0 <span class="op">=</span> rep_vector<span class="op">(</span>log<span class="op">(</span><span class="fl">1.0</span><span class="op">/</span><span class="fl">4.0</span><span class="op">),</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb190-184"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-184" tabindex="-1"></a>      </span>
<span id="cb190-185"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-185" tabindex="-1"></a>      </span>
<span id="cb190-186"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-186" tabindex="-1"></a>  <span class="dt">int</span> action_narrow1<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-187"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-187" tabindex="-1"></a>  <span class="dt">int</span> action_narrow2<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb190-188"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-188" tabindex="-1"></a>  </span>
<span id="cb190-189"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-189" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-190"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-190" tabindex="-1"></a>    </span>
<span id="cb190-191"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-191" tabindex="-1"></a>    action_narrow1<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">1</span> <span class="op">||</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">2</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb190-192"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-192" tabindex="-1"></a>    action_narrow2<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">1</span> <span class="op">||</span> action_broad<span class="op">[</span>ii<span class="op">]==</span><span class="dv">3</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb190-193"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-193" tabindex="-1"></a>    </span>
<span id="cb190-194"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-194" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-195"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-195" tabindex="-1"></a>  </span>
<span id="cb190-196"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-196" tabindex="-1"></a>  </span>
<span id="cb190-197"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-197" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-198"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-198" tabindex="-1"></a></span>
<span id="cb190-199"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-199" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb190-200"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-200" tabindex="-1"></a>  </span>
<span id="cb190-201"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-201" tabindex="-1"></a>  <span class="co">// risk aversion</span></span>
<span id="cb190-202"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-202" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> r<span class="op">;</span></span>
<span id="cb190-203"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-203" tabindex="-1"></a>  <span class="co">// choice precision</span></span>
<span id="cb190-204"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-204" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb190-205"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-205" tabindex="-1"></a>  </span>
<span id="cb190-206"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-206" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> mix_narrow<span class="op">;</span></span>
<span id="cb190-207"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-207" tabindex="-1"></a>  </span>
<span id="cb190-208"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-208" tabindex="-1"></a> </span>
<span id="cb190-209"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-209" tabindex="-1"></a>  </span>
<span id="cb190-210"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-210" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-211"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-211" tabindex="-1"></a></span>
<span id="cb190-212"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-212" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb190-213"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-213" tabindex="-1"></a>  </span>
<span id="cb190-214"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-214" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">8</span><span class="op">]</span> rho<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-215"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-215" tabindex="-1"></a>  </span>
<span id="cb190-216"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-216" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> sigma_broad<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-217"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-217" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> sigma_narrow1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-218"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-218" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> sigma_narrow2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-219"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-219" tabindex="-1"></a>  </span>
<span id="cb190-220"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-220" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-221"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-221" tabindex="-1"></a>    </span>
<span id="cb190-222"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-222" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]</span> Ub <span class="op">=</span> pow<span class="op">(</span>Ubroad<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb190-223"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-223" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> U1n <span class="op">=</span> pow<span class="op">(</span>Unarrow1<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb190-224"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-224" tabindex="-1"></a>    matrix<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]</span> U2n <span class="op">=</span> pow<span class="op">(</span>Unarrow1<span class="op">[</span>tt<span class="op">],</span>r<span class="op">);</span></span>
<span id="cb190-225"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-225" tabindex="-1"></a>    </span>
<span id="cb190-226"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-226" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contextual<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-227"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-227" tabindex="-1"></a>      <span class="co">// contextual utility normalization</span></span>
<span id="cb190-228"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-228" tabindex="-1"></a>      Ub <span class="op">=</span> Ub<span class="op">/(</span>Ub<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>Ub<span class="op">[</span><span class="dv">4</span><span class="op">,</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb190-229"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-229" tabindex="-1"></a>      U1n <span class="op">=</span> U1n<span class="op">/(</span>U1n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U1n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-230"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-230" tabindex="-1"></a>      U2n <span class="op">=</span> U2n<span class="op">/(</span>U2n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">1</span><span class="op">]-</span>U2n<span class="op">[</span><span class="dv">2</span><span class="op">,</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-231"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-231" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-232"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-232" tabindex="-1"></a>    </span>
<span id="cb190-233"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-233" tabindex="-1"></a>    rho<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> QRElp<span class="op">(</span></span>
<span id="cb190-234"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-234" tabindex="-1"></a>      Ub<span class="op">,</span>U1n<span class="op">,</span> U2n<span class="op">,</span></span>
<span id="cb190-235"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-235" tabindex="-1"></a>      lambda<span class="op">,</span>mix_narrow<span class="op">,</span></span>
<span id="cb190-236"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-236" tabindex="-1"></a>      iter<span class="op">,</span>tol</span>
<span id="cb190-237"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-237" tabindex="-1"></a>  <span class="op">);</span></span>
<span id="cb190-238"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-238" tabindex="-1"></a>    </span>
<span id="cb190-239"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-239" tabindex="-1"></a>   </span>
<span id="cb190-240"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-240" tabindex="-1"></a>    </span>
<span id="cb190-241"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-241" tabindex="-1"></a>    sigma_broad<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">][</span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">]);</span></span>
<span id="cb190-242"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-242" tabindex="-1"></a>    </span>
<span id="cb190-243"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-243" tabindex="-1"></a>    sigma_narrow1<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">][</span><span class="dv">5</span><span class="op">:</span><span class="dv">6</span><span class="op">]);</span></span>
<span id="cb190-244"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-244" tabindex="-1"></a>    sigma_narrow2<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">][</span><span class="dv">7</span><span class="op">:</span><span class="dv">8</span><span class="op">]);</span></span>
<span id="cb190-245"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-245" tabindex="-1"></a>    </span>
<span id="cb190-246"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-246" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-247"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-247" tabindex="-1"></a>  </span>
<span id="cb190-248"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-248" tabindex="-1"></a>  </span>
<span id="cb190-249"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-249" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-250"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-250" tabindex="-1"></a></span>
<span id="cb190-251"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-251" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb190-252"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-252" tabindex="-1"></a>  </span>
<span id="cb190-253"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-253" tabindex="-1"></a>  </span>
<span id="cb190-254"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-254" tabindex="-1"></a>  </span>
<span id="cb190-255"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-255" tabindex="-1"></a>  </span>
<span id="cb190-256"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-256" tabindex="-1"></a>  </span>
<span id="cb190-257"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-257" tabindex="-1"></a>  <span class="co">// likelihood contribution</span></span>
<span id="cb190-258"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-258" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-259"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-259" tabindex="-1"></a>    </span>
<span id="cb190-260"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-260" tabindex="-1"></a>    </span>
<span id="cb190-261"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-261" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-262"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-262" tabindex="-1"></a>      </span>
<span id="cb190-263"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-263" tabindex="-1"></a>      target <span class="op">+=</span> log<span class="op">(</span></span>
<span id="cb190-264"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-264" tabindex="-1"></a>        mix_narrow<span class="op">*</span>sigma_narrow1<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]][</span>action_narrow1<span class="op">[</span>ii<span class="op">]]*</span>sigma_narrow2<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]][</span>action_narrow2<span class="op">[</span>ii<span class="op">]]</span></span>
<span id="cb190-265"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-265" tabindex="-1"></a>        <span class="op">+(</span><span class="fl">1.0</span><span class="op">-</span>mix_narrow<span class="op">)*</span>sigma_broad<span class="op">[</span>treatment<span class="op">[</span>ii<span class="op">]][</span>action_broad<span class="op">[</span>ii<span class="op">]]</span></span>
<span id="cb190-266"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-266" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb190-267"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-267" tabindex="-1"></a>      </span>
<span id="cb190-268"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-268" tabindex="-1"></a>      </span>
<span id="cb190-269"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-269" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-270"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-270" tabindex="-1"></a>    </span>
<span id="cb190-271"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-271" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-272"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-272" tabindex="-1"></a></span>
<span id="cb190-273"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-273" tabindex="-1"></a>  </span>
<span id="cb190-274"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-274" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb190-275"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-275" tabindex="-1"></a>  </span>
<span id="cb190-276"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-276" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>r <span class="op">|</span> prior_r<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_r<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-277"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-277" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>lambda <span class="op">|</span> prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-278"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-278" tabindex="-1"></a>  target <span class="op">+=</span> beta_lpdf<span class="op">(</span>mix_narrow <span class="op">|</span> prior_mix<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_mix<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb190-279"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-279" tabindex="-1"></a>  </span>
<span id="cb190-280"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-280" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-281"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-281" tabindex="-1"></a></span>
<span id="cb190-282"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-282" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb190-283"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-283" tabindex="-1"></a>  </span>
<span id="cb190-284"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-284" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> sigma<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb190-285"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-285" tabindex="-1"></a>  </span>
<span id="cb190-286"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-286" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-287"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-287" tabindex="-1"></a>    </span>
<span id="cb190-288"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-288" tabindex="-1"></a>    sigma<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> exp<span class="op">(</span>rho<span class="op">[</span>tt<span class="op">]);</span></span>
<span id="cb190-289"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-289" tabindex="-1"></a>    </span>
<span id="cb190-290"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-290" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb190-291"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-291" tabindex="-1"></a>  </span>
<span id="cb190-292"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-292" tabindex="-1"></a>  </span>
<span id="cb190-293"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb190-293" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Note that they are exactly the same except for how the likelihood is clacluated.</p>
</div>
</div>
<div id="results-4" class="section level2 hasAnchor" number="15.4">
<h2><span class="header-section-number">15.4</span> Results<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>I estimate these three models with the following priors:</p>
<p><span class="math display">\[
\begin{aligned}
\log r &amp;\sim N(\log(0.5),1)\\
\log\lambda &amp;\sim N(\log(5),1)\\
\phi&amp;\sim \mathrm{Beta}(1,1)
\end{aligned}
\]</span></p>
<p>I used data from the final 10 rounds of play in order to hopefully mitigate any learning effects.</p>
<p>Table <a href="application-a-quantal-response-equilibrium-with-discrete-types.html#tab:JMPQREresults">15.3</a> shows the parameter estimates (first three rows) and implied action frequencies (remaining rows) for the four models estimated. The rightmost column of this Table also shows the empirical choice frequencies from the data used to estimate these models. Comparing the “Data” column to the estimated choice frequencies reveals that none the models perform particularly well at organizing these choice frequencies. However model posterior probabilities (assigning equal prior probabilities to all four models) overwhelmingly (one to at least five decimal places) select the dichotomous mixture model. Here we estimate that approximately 46% of participants narrowly bracket the games. If I were forced to select one of the one-type models, the narrow assumption does overwhelmingly better than the broad assumption based on model posterior probability.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-1" tabindex="-1"></a>fmt<span class="ot">&lt;-</span><span class="st">&quot;%.3f&quot;</span></span>
<span id="cb191-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-2" tabindex="-1"></a></span>
<span id="cb191-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-3" tabindex="-1"></a>ESTIMATES <span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb191-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-4" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_broad.rds&quot;</span> <span class="sc">|&gt;</span> <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb191-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-5" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-6" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-7" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb191-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-8" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">&quot;Broad&quot;</span></span>
<span id="cb191-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-9" tabindex="-1"></a>    ),</span>
<span id="cb191-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-10" tabindex="-1"></a>   <span class="fu">summary</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_narrow.rds&quot;</span> <span class="sc">|&gt;</span> <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb191-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-11" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-12" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-13" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb191-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-14" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">&quot;Narrow&quot;</span></span>
<span id="cb191-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-15" tabindex="-1"></a>    ),</span>
<span id="cb191-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-16" tabindex="-1"></a>   <span class="fu">summary</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_mix.rds&quot;</span> <span class="sc">|&gt;</span> <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb191-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-17" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-18" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-19" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb191-20"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-20" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">&quot;Dichotomous&quot;</span></span>
<span id="cb191-21"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-21" tabindex="-1"></a>    ),</span>
<span id="cb191-22"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-22" tabindex="-1"></a>   <span class="fu">summary</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_toolbox.rds&quot;</span> <span class="sc">|&gt;</span> <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span> </span>
<span id="cb191-23"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-23" tabindex="-1"></a>    <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-24"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-24" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-25"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-25" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb191-26"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-26" tabindex="-1"></a>      <span class="at">model =</span> <span class="st">&quot;Toolbox&quot;</span></span>
<span id="cb191-27"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-27" tabindex="-1"></a>    )</span>
<span id="cb191-28"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-28" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb191-29"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-29" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-30"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-30" tabindex="-1"></a>    <span class="at">treatment =</span> parameter <span class="sc">|&gt;</span> <span class="fu">str_split_i</span>(<span class="st">&quot;,&quot;</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">parse_number</span>(),</span>
<span id="cb191-31"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-31" tabindex="-1"></a>    <span class="at">action =</span>  <span class="fu">c</span>(<span class="st">&quot;{AC}&quot;</span>,<span class="st">&quot;{AD}&quot;</span>,<span class="st">&quot;{BC}&quot;</span>,<span class="st">&quot;{BD}&quot;</span>)[(parameter <span class="sc">|&gt;</span> <span class="fu">str_split_i</span>(<span class="st">&quot;,&quot;</span>,<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">parse_number</span>())]</span>
<span id="cb191-32"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-32" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-33"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-33" tabindex="-1"></a>  <span class="fu">filter</span>(parameter<span class="sc">!=</span><span class="st">&quot;lp__&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;rho&quot;</span>,parameter) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;sigma_broad&quot;</span>,parameter) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;sigma_narrow&quot;</span>,parameter) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;sigma1&quot;</span>,parameter) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">grepl</span>(<span class="st">&quot;sigma2&quot;</span>,parameter)) <span class="sc">|&gt;</span></span>
<span id="cb191-34"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-34" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-35"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-35" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(action),parameter,</span>
<span id="cb191-36"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-36" tabindex="-1"></a>                       <span class="fu">paste0</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">sigma^&quot;</span>,treatment,<span class="st">&quot;_&quot;</span>,action,<span class="st">&quot;$&quot;</span>)</span>
<span id="cb191-37"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-37" tabindex="-1"></a>                       )</span>
<span id="cb191-38"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-38" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-39"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-39" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-40"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-40" tabindex="-1"></a>    <span class="at">msd =</span> <span class="fu">paste0</span>(<span class="fu">sprintf</span>(fmt,mean),<span class="st">&quot; (&quot;</span>,<span class="fu">sprintf</span>(fmt,sd),<span class="st">&quot;)&quot;</span>)</span>
<span id="cb191-41"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-41" tabindex="-1"></a>  )</span>
<span id="cb191-42"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-42" tabindex="-1"></a></span>
<span id="cb191-43"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-43" tabindex="-1"></a>TAB<span class="ot">&lt;-</span>ESTIMATES <span class="sc">|&gt;</span></span>
<span id="cb191-44"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-44" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb191-45"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-45" tabindex="-1"></a>    <span class="at">id_cols =</span> parameter,</span>
<span id="cb191-46"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-46" tabindex="-1"></a>    <span class="at">names_from =</span> model,</span>
<span id="cb191-47"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-47" tabindex="-1"></a>    <span class="at">values_from =</span> msd</span>
<span id="cb191-48"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-48" tabindex="-1"></a>  ) </span>
<span id="cb191-49"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-49" tabindex="-1"></a></span>
<span id="cb191-50"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-50" tabindex="-1"></a></span>
<span id="cb191-51"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-51" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="st">&quot;Data/Bland2019HowManyGames.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb191-52"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-52" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-53"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-53" tabindex="-1"></a>  <span class="fu">arrange</span>(uid,Period) <span class="sc">|&gt;</span></span>
<span id="cb191-54"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-54" tabindex="-1"></a>  <span class="fu">filter</span>(Period<span class="sc">&gt;</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-55"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-55" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-56"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-56" tabindex="-1"></a>    <span class="at">uid =</span> <span class="fu">paste</span>(<span class="st">&quot;uid =&quot;</span>,uid) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.integer</span>() </span>
<span id="cb191-57"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-57" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-58"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-58" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-59"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-59" tabindex="-1"></a>    <span class="at">BroadActComb =</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>ActionAB)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>ActionCD)<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb191-60"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-60" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">ifelse</span>(</span>
<span id="cb191-61"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-61" tabindex="-1"></a>      d1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> d2<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="fu">ifelse</span>(</span>
<span id="cb191-62"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-62" tabindex="-1"></a>        d1<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb191-63"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-63" tabindex="-1"></a>      )</span>
<span id="cb191-64"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-64" tabindex="-1"></a>    )</span>
<span id="cb191-65"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-65" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-66"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-66" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment) <span class="sc">|&gt;</span></span>
<span id="cb191-67"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-67" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-68"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-68" tabindex="-1"></a>    <span class="at">count =</span> <span class="fu">n</span>()</span>
<span id="cb191-69"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-69" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-70"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-70" tabindex="-1"></a>  <span class="fu">group_by</span>(treatment,BroadActComb) <span class="sc">|&gt;</span></span>
<span id="cb191-71"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-71" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb191-72"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-72" tabindex="-1"></a>    <span class="at">Data =</span> <span class="fu">sprintf</span>(fmt,<span class="fu">n</span>()<span class="sc">/</span><span class="fu">mean</span>(count))</span>
<span id="cb191-73"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-73" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-74"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-74" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-75"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-75" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">paste0</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">sigma^&quot;</span>,treatment,<span class="st">&quot;_&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;{AC}&quot;</span>,<span class="st">&quot;{AD}&quot;</span>,<span class="st">&quot;{BC}&quot;</span>,<span class="st">&quot;{BD}&quot;</span>)[BroadActComb],<span class="st">&quot;$&quot;</span>)</span>
<span id="cb191-76"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-76" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-77"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-77" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb191-78"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-78" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Data,parameter,<span class="sc">-</span>treatment)</span>
<span id="cb191-79"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-79" tabindex="-1"></a></span>
<span id="cb191-80"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-80" tabindex="-1"></a></span>
<span id="cb191-81"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-81" tabindex="-1"></a>TAB<span class="ot">&lt;-</span>TAB <span class="sc">|&gt;</span></span>
<span id="cb191-82"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-82" tabindex="-1"></a>  <span class="fu">full_join</span>(D,<span class="at">by=</span><span class="st">&quot;parameter&quot;</span>)</span>
<span id="cb191-83"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-83" tabindex="-1"></a></span>
<span id="cb191-84"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-84" tabindex="-1"></a>TAB[<span class="fu">is.na</span>(TAB)]<span class="ot">&lt;-</span><span class="st">&quot;&quot;</span></span>
<span id="cb191-85"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-85" tabindex="-1"></a></span>
<span id="cb191-86"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-86" tabindex="-1"></a>TAB<span class="ot">&lt;-</span>TAB <span class="sc">|&gt;</span></span>
<span id="cb191-87"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-87" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb191-88"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-88" tabindex="-1"></a>    <span class="at">order =</span> <span class="fu">ifelse</span>(</span>
<span id="cb191-89"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-89" tabindex="-1"></a>      parameter <span class="sc">==</span> <span class="st">&quot;r&quot;</span>,<span class="dv">1</span>,</span>
<span id="cb191-90"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-90" tabindex="-1"></a>      <span class="fu">ifelse</span>(parameter<span class="sc">==</span><span class="st">&quot;lambda&quot;</span>,<span class="dv">2</span>,</span>
<span id="cb191-91"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-91" tabindex="-1"></a>             <span class="fu">ifelse</span>(parameter<span class="sc">==</span><span class="st">&quot;mix_narrow&quot;</span>,<span class="dv">3</span>,<span class="dv">4</span>))</span>
<span id="cb191-92"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-92" tabindex="-1"></a>    )</span>
<span id="cb191-93"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-93" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb191-94"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-94" tabindex="-1"></a>  <span class="fu">arrange</span>(order,parameter) <span class="sc">|&gt;</span></span>
<span id="cb191-95"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-95" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>order)</span>
<span id="cb191-96"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-96" tabindex="-1"></a></span>
<span id="cb191-97"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-97" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb191-98"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-98" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits=</span><span class="dv">3</span>,<span class="at">caption =</span> <span class="st">&quot;Estimates from the three models. Posterior means with standard deviations in parentheses. The &#39;Data&#39; column shows the empirical choice frequencies from the data used to estimate the models.&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-99"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-99" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb191-100"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb191-100" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;One type&quot;</span><span class="ot">=</span><span class="dv">2</span>,<span class="st">&quot;Two types&quot;</span><span class="ot">=</span><span class="dv">2</span>,<span class="st">&quot;&quot;</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:JMPQREresults">Table 15.3: </span>Estimates from the three models. Posterior means with standard deviations in parentheses. The ‘Data’ column shows the empirical choice frequencies from the data used to estimate the models.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
One type
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Two types
</div>
</th>
<th style="empty-cells: hide;" colspan="1">
</th>
</tr>
<tr>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:left;">
Broad
</th>
<th style="text-align:left;">
Narrow
</th>
<th style="text-align:left;">
Dichotomous
</th>
<th style="text-align:left;">
Toolbox
</th>
<th style="text-align:left;">
Data
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
r
</td>
<td style="text-align:left;">
0.474 (1.476)
</td>
<td style="text-align:left;">
0.085 (0.026)
</td>
<td style="text-align:left;">
0.022 (0.010)
</td>
<td style="text-align:left;">
0.021 (0.010)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
lambda
</td>
<td style="text-align:left;">
0.149 (0.075)
</td>
<td style="text-align:left;">
2.281 (0.410)
</td>
<td style="text-align:left;">
3.562 (0.330)
</td>
<td style="text-align:left;">
0.935 (0.151)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
mix_narrow
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
0.457 (0.059)
</td>
<td style="text-align:left;">
0.927 (0.063)
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^1_{AC}\)</span>
</td>
<td style="text-align:left;">
0.250 (0.002)
</td>
<td style="text-align:left;">
0.397 (0.014)
</td>
<td style="text-align:left;">
0.268 (0.003)
</td>
<td style="text-align:left;">
0.258 (0.001)
</td>
<td style="text-align:left;">
0.462
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^1_{AD}\)</span>
</td>
<td style="text-align:left;">
0.250 (0.001)
</td>
<td style="text-align:left;">
0.249 (0.007)
</td>
<td style="text-align:left;">
0.267 (0.003)
</td>
<td style="text-align:left;">
0.257 (0.001)
</td>
<td style="text-align:left;">
0.208
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^1_{BC}\)</span>
</td>
<td style="text-align:left;">
0.252 (0.002)
</td>
<td style="text-align:left;">
0.217 (0.006)
</td>
<td style="text-align:left;">
0.279 (0.004)
</td>
<td style="text-align:left;">
0.260 (0.001)
</td>
<td style="text-align:left;">
0.142
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^1_{BD}\)</span>
</td>
<td style="text-align:left;">
0.248 (0.004)
</td>
<td style="text-align:left;">
0.137 (0.008)
</td>
<td style="text-align:left;">
0.187 (0.004)
</td>
<td style="text-align:left;">
0.225 (0.003)
</td>
<td style="text-align:left;">
0.188
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^2_{AC}\)</span>
</td>
<td style="text-align:left;">
0.247 (0.001)
</td>
<td style="text-align:left;">
0.245 (0.006)
</td>
<td style="text-align:left;">
0.232 (0.003)
</td>
<td style="text-align:left;">
0.242 (0.001)
</td>
<td style="text-align:left;">
0.422
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^2_{AD}\)</span>
</td>
<td style="text-align:left;">
0.248 (0.001)
</td>
<td style="text-align:left;">
0.402 (0.016)
</td>
<td style="text-align:left;">
0.190 (0.005)
</td>
<td style="text-align:left;">
0.232 (0.003)
</td>
<td style="text-align:left;">
0.320
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^2_{BC}\)</span>
</td>
<td style="text-align:left;">
0.252 (0.001)
</td>
<td style="text-align:left;">
0.134 (0.009)
</td>
<td style="text-align:left;">
0.315 (0.007)
</td>
<td style="text-align:left;">
0.268 (0.003)
</td>
<td style="text-align:left;">
0.050
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^2_{BD}\)</span>
</td>
<td style="text-align:left;">
0.253 (0.002)
</td>
<td style="text-align:left;">
0.220 (0.004)
</td>
<td style="text-align:left;">
0.263 (0.005)
</td>
<td style="text-align:left;">
0.259 (0.001)
</td>
<td style="text-align:left;">
0.207
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^3_{AC}\)</span>
</td>
<td style="text-align:left;">
0.247 (0.001)
</td>
<td style="text-align:left;">
0.309 (0.007)
</td>
<td style="text-align:left;">
0.163 (0.009)
</td>
<td style="text-align:left;">
0.225 (0.005)
</td>
<td style="text-align:left;">
0.406
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^3_{AD}\)</span>
</td>
<td style="text-align:left;">
0.248 (0.001)
</td>
<td style="text-align:left;">
0.194 (0.006)
</td>
<td style="text-align:left;">
0.207 (0.003)
</td>
<td style="text-align:left;">
0.236 (0.002)
</td>
<td style="text-align:left;">
0.294
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^3_{BC}\)</span>
</td>
<td style="text-align:left;">
0.252 (0.001)
</td>
<td style="text-align:left;">
0.305 (0.006)
</td>
<td style="text-align:left;">
0.286 (0.002)
</td>
<td style="text-align:left;">
0.263 (0.002)
</td>
<td style="text-align:left;">
0.147
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\sigma^3_{BD}\)</span>
</td>
<td style="text-align:left;">
0.253 (0.002)
</td>
<td style="text-align:left;">
0.192 (0.007)
</td>
<td style="text-align:left;">
0.344 (0.012)
</td>
<td style="text-align:left;">
0.276 (0.005)
</td>
<td style="text-align:left;">
0.153
</td>
</tr>
</tbody>
</table>
<p>Of some concern here is that the estimated posterior means for <span class="math inline">\(r\)</span> for all but the broad-only model are not particularly plausible: they are very close to zerom, which implies extreme risk-aversion. One explanation for this could be that risk-aversion isn’t really what is driving behavior in this game, and we might need another model of behavior to better organize the data. Alternatively, it could be that quantal response equilibrium is not a good model for play. In another chapter I will further explore this by taking a <em>learning</em> model to the data (instead of an <em>equilibrium</em> model). This may better respect the heterogeneity in participants’ decision-making processes.</p>
<p>One final thing to note here is that we are evaluating some non-nested models. In particular, broad bracketing cannot generate the same predictions as narrow bracketing and vice versa. On the other hand, both mixture models can generate the same predictions as the broad bracketing model by setting <span class="math inline">\(\phi=0\)</span>, or the narrow bracketing model by setting <span class="math inline">\(\phi=1\)</span>. On a a third hand, if <span class="math inline">\(\phi\)</span> is strictly in the interior of the unit interval, then the two mixture models will have different implications about the data.
The process of evaluating model posterior probabilities, however, is exactly the same whether they are nested or not. This is not the case if we were estimating these models using maximum likelihood, where we might have ended up having to use either AIC or BIC to select a model.</p>
</div>
<div id="r-code-used-to-estimate-these-models" class="section level2 hasAnchor" number="15.5">
<h2><span class="header-section-number">15.5</span> <em>R</em> code used to estimate these models<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb192-2"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb192-3"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-3" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-4"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb192-5"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-5" tabindex="-1"></a><span class="fu">library</span>(bridgesampling)</span>
<span id="cb192-6"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-6" tabindex="-1"></a></span>
<span id="cb192-7"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-7" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="st">&quot;Data/Bland2019HowManyGames.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb192-8"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-8" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb192-9"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-9" tabindex="-1"></a>  <span class="fu">arrange</span>(uid,Period) <span class="sc">|&gt;</span></span>
<span id="cb192-10"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-10" tabindex="-1"></a>  <span class="fu">filter</span>(Period<span class="sc">&gt;</span><span class="dv">10</span>) <span class="sc">|&gt;</span></span>
<span id="cb192-11"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-11" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb192-12"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-12" tabindex="-1"></a>    <span class="at">uid =</span> <span class="fu">paste</span>(<span class="st">&quot;uid =&quot;</span>,uid) <span class="sc">|&gt;</span> <span class="fu">as.factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.integer</span>() </span>
<span id="cb192-13"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-13" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb192-14"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-14" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb192-15"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-15" tabindex="-1"></a>    <span class="at">BroadActComb =</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>ActionAB)<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>ActionCD)<span class="sc">+</span><span class="dv">1</span>,</span>
<span id="cb192-16"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-16" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">ifelse</span>(</span>
<span id="cb192-17"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-17" tabindex="-1"></a>      d1<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> d2<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span>,<span class="fu">ifelse</span>(</span>
<span id="cb192-18"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-18" tabindex="-1"></a>        d1<span class="sc">!=</span><span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb192-19"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-19" tabindex="-1"></a>      )</span>
<span id="cb192-20"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-20" tabindex="-1"></a>    )</span>
<span id="cb192-21"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-21" tabindex="-1"></a>  )</span>
<span id="cb192-22"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-22" tabindex="-1"></a></span>
<span id="cb192-23"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-23" tabindex="-1"></a>U0broad<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb192-24"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-24" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">66</span>, <span class="dv">66</span>, <span class="dv">66</span>),</span>
<span id="cb192-25"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-25" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">170</span>,<span class="dv">10</span>,<span class="dv">170</span>, <span class="dv">10</span>),</span>
<span id="cb192-26"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-26" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">156</span>,<span class="dv">156</span>,<span class="dv">56</span>,<span class="dv">56</span>),</span>
<span id="cb192-27"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-27" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">260</span>,<span class="dv">100</span>,<span class="dv">160</span>,<span class="dv">0</span>)</span>
<span id="cb192-28"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-28" tabindex="-1"></a>)</span>
<span id="cb192-29"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-29" tabindex="-1"></a></span>
<span id="cb192-30"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-30" tabindex="-1"></a>U0ABnarrow<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb192-31"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-31" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">10</span>),</span>
<span id="cb192-32"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-32" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">0</span>)</span>
<span id="cb192-33"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-33" tabindex="-1"></a>)</span>
<span id="cb192-34"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-34" tabindex="-1"></a></span>
<span id="cb192-35"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-35" tabindex="-1"></a>U0CDnarrow<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb192-36"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-36" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">56</span>,<span class="dv">56</span>),</span>
<span id="cb192-37"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-37" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">0</span>)</span>
<span id="cb192-38"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-38" tabindex="-1"></a>)</span>
<span id="cb192-39"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-39" tabindex="-1"></a></span>
<span id="cb192-40"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-40" tabindex="-1"></a></span>
<span id="cb192-41"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-41" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb192-42"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-42" tabindex="-1"></a>  </span>
<span id="cb192-43"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-43" tabindex="-1"></a>  <span class="at">Ubroad =</span> <span class="fu">list</span>(</span>
<span id="cb192-44"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-44" tabindex="-1"></a>    U0broad,</span>
<span id="cb192-45"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-45" tabindex="-1"></a>    U0broad <span class="sc">+</span> <span class="dv">50</span>,</span>
<span id="cb192-46"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-46" tabindex="-1"></a>    U0broad <span class="sc">+</span> <span class="dv">50</span></span>
<span id="cb192-47"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-47" tabindex="-1"></a>  ),</span>
<span id="cb192-48"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-48" tabindex="-1"></a>  </span>
<span id="cb192-49"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-49" tabindex="-1"></a>  </span>
<span id="cb192-50"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-50" tabindex="-1"></a>  <span class="at">Unarrow1 =</span> <span class="fu">list</span>(</span>
<span id="cb192-51"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-51" tabindex="-1"></a>    U0ABnarrow,</span>
<span id="cb192-52"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-52" tabindex="-1"></a>    U0ABnarrow<span class="sc">+</span><span class="dv">50</span>,</span>
<span id="cb192-53"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-53" tabindex="-1"></a>    U0ABnarrow</span>
<span id="cb192-54"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-54" tabindex="-1"></a>  ),</span>
<span id="cb192-55"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-55" tabindex="-1"></a>  </span>
<span id="cb192-56"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-56" tabindex="-1"></a>  <span class="at">Unarrow2 =</span> <span class="fu">list</span>(</span>
<span id="cb192-57"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-57" tabindex="-1"></a>    U0CDnarrow,</span>
<span id="cb192-58"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-58" tabindex="-1"></a>    U0CDnarrow,</span>
<span id="cb192-59"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-59" tabindex="-1"></a>    U0CDnarrow<span class="sc">+</span><span class="dv">50</span></span>
<span id="cb192-60"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-60" tabindex="-1"></a>  ),</span>
<span id="cb192-61"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-61" tabindex="-1"></a>  </span>
<span id="cb192-62"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-62" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb192-63"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-63" tabindex="-1"></a>  </span>
<span id="cb192-64"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-64" tabindex="-1"></a>  <span class="at">id =</span> D<span class="sc">$</span>uid,</span>
<span id="cb192-65"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-65" tabindex="-1"></a>  </span>
<span id="cb192-66"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-66" tabindex="-1"></a>  <span class="at">nparticipants =</span> D<span class="sc">$</span>uid <span class="sc">|&gt;</span> <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">length</span>(),</span>
<span id="cb192-67"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-67" tabindex="-1"></a>  </span>
<span id="cb192-68"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-68" tabindex="-1"></a>  <span class="at">treatment =</span> D<span class="sc">$</span>treatment,</span>
<span id="cb192-69"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-69" tabindex="-1"></a>  <span class="at">action =</span> D<span class="sc">$</span>BroadActComb,</span>
<span id="cb192-70"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-70" tabindex="-1"></a>  <span class="at">action_broad =</span> D<span class="sc">$</span>BroadActComb,</span>
<span id="cb192-71"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-71" tabindex="-1"></a>  </span>
<span id="cb192-72"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-72" tabindex="-1"></a>  <span class="at">prior_r =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.5</span>),<span class="dv">1</span>),</span>
<span id="cb192-73"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-73" tabindex="-1"></a>  <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="dv">5</span>),<span class="dv">1</span>),</span>
<span id="cb192-74"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-74" tabindex="-1"></a>  <span class="at">prior_mix =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb192-75"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-75" tabindex="-1"></a>  </span>
<span id="cb192-76"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-76" tabindex="-1"></a>  <span class="at">tol =</span> <span class="dv">10</span><span class="sc">^-</span><span class="dv">5</span>,</span>
<span id="cb192-77"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-77" tabindex="-1"></a>  <span class="at">iter =</span> <span class="dv">1000</span>,</span>
<span id="cb192-78"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-78" tabindex="-1"></a>  </span>
<span id="cb192-79"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-79" tabindex="-1"></a>  <span class="at">UseData =</span> <span class="dv">1</span>,</span>
<span id="cb192-80"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-80" tabindex="-1"></a>  </span>
<span id="cb192-81"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-81" tabindex="-1"></a>  <span class="at">contextual =</span> <span class="dv">1</span></span>
<span id="cb192-82"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-82" tabindex="-1"></a>  </span>
<span id="cb192-83"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-83" tabindex="-1"></a>  </span>
<span id="cb192-84"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-84" tabindex="-1"></a>)</span>
<span id="cb192-85"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-85" tabindex="-1"></a></span>
<span id="cb192-86"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-86" tabindex="-1"></a>model_toolbox<span class="ot">&lt;-</span><span class="st">&quot;Code/HowManyGames/QRE_toolbox.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb192-87"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-87" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb192-88"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-88" tabindex="-1"></a></span>
<span id="cb192-89"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-89" tabindex="-1"></a></span>
<span id="cb192-90"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-90" tabindex="-1"></a></span>
<span id="cb192-91"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-91" tabindex="-1"></a>Fit_toolbox <span class="ot">&lt;-</span> model_toolbox <span class="sc">|&gt;</span></span>
<span id="cb192-92"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-92" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb192-93"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-93" tabindex="-1"></a>    <span class="co">#chains=1,iter=100, # debugging settings</span></span>
<span id="cb192-94"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-94" tabindex="-1"></a>    <span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb192-95"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-95" tabindex="-1"></a>  )</span>
<span id="cb192-96"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-96" tabindex="-1"></a></span>
<span id="cb192-97"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-97" tabindex="-1"></a>bs_toolbox<span class="ot">&lt;-</span>Fit_toolbox <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb192-98"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-98" tabindex="-1"></a></span>
<span id="cb192-99"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-99" tabindex="-1"></a>Fit_toolbox <span class="sc">|&gt;</span></span>
<span id="cb192-100"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-100" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_toolbox.rds&quot;</span>)</span>
<span id="cb192-101"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-101" tabindex="-1"></a></span>
<span id="cb192-102"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-102" tabindex="-1"></a></span>
<span id="cb192-103"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-103" tabindex="-1"></a></span>
<span id="cb192-104"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-104" tabindex="-1"></a></span>
<span id="cb192-105"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-105" tabindex="-1"></a>model_mix<span class="ot">&lt;-</span><span class="st">&quot;Code/HowManyGames/QRE_mix.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb192-106"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-106" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb192-107"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-107" tabindex="-1"></a></span>
<span id="cb192-108"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-108" tabindex="-1"></a></span>
<span id="cb192-109"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-109" tabindex="-1"></a></span>
<span id="cb192-110"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-110" tabindex="-1"></a>Fit_mix <span class="ot">&lt;-</span> model_mix <span class="sc">|&gt;</span></span>
<span id="cb192-111"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-111" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb192-112"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-112" tabindex="-1"></a>    <span class="co">#chains=1,iter=100, # debugging settings</span></span>
<span id="cb192-113"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-113" tabindex="-1"></a>    <span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb192-114"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-114" tabindex="-1"></a>     )</span>
<span id="cb192-115"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-115" tabindex="-1"></a></span>
<span id="cb192-116"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-116" tabindex="-1"></a>bs_mix<span class="ot">&lt;-</span>Fit_mix <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb192-117"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-117" tabindex="-1"></a></span>
<span id="cb192-118"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-118" tabindex="-1"></a>Fit_mix <span class="sc">|&gt;</span></span>
<span id="cb192-119"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-119" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_mix.rds&quot;</span>)</span>
<span id="cb192-120"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-120" tabindex="-1"></a></span>
<span id="cb192-121"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-121" tabindex="-1"></a>model_narrow<span class="ot">&lt;-</span><span class="st">&quot;Code/HowManyGames/QRE_narrow.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb192-122"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-122" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb192-123"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-123" tabindex="-1"></a></span>
<span id="cb192-124"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-124" tabindex="-1"></a>Fit_narrow<span class="ot">&lt;-</span>model_narrow <span class="sc">|&gt;</span></span>
<span id="cb192-125"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-125" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb192-126"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-126" tabindex="-1"></a></span>
<span id="cb192-127"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-127" tabindex="-1"></a>bs_narrow<span class="ot">&lt;-</span>Fit_narrow <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb192-128"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-128" tabindex="-1"></a></span>
<span id="cb192-129"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-129" tabindex="-1"></a>Fit_narrow <span class="sc">|&gt;</span></span>
<span id="cb192-130"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-130" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_narrow.rds&quot;</span>)</span>
<span id="cb192-131"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-131" tabindex="-1"></a></span>
<span id="cb192-132"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-132" tabindex="-1"></a>model_broad<span class="ot">&lt;-</span><span class="st">&quot;Code/HowManyGames/QRE_broad.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb192-133"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-133" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb192-134"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-134" tabindex="-1"></a></span>
<span id="cb192-135"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-135" tabindex="-1"></a>Fit_broad <span class="ot">&lt;-</span> model_broad <span class="sc">|&gt;</span></span>
<span id="cb192-136"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-136" tabindex="-1"></a>  <span class="fu">sampling</span>(</span>
<span id="cb192-137"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-137" tabindex="-1"></a>    <span class="co">#iter = 100,chains=1, # debugging settings</span></span>
<span id="cb192-138"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-138" tabindex="-1"></a>    <span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb192-139"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-139" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.99</span>)</span>
<span id="cb192-140"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-140" tabindex="-1"></a>  )</span>
<span id="cb192-141"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-141" tabindex="-1"></a></span>
<span id="cb192-142"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-142" tabindex="-1"></a>bs_broad<span class="ot">&lt;-</span>Fit_broad <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb192-143"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-143" tabindex="-1"></a></span>
<span id="cb192-144"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-144" tabindex="-1"></a>Fit_broad <span class="sc">|&gt;</span></span>
<span id="cb192-145"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-145" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/HowManyGames/Fit_QRE_broad.rds&quot;</span>)</span>
<span id="cb192-146"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-146" tabindex="-1"></a></span>
<span id="cb192-147"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-147" tabindex="-1"></a>postprob<span class="ot">&lt;-</span><span class="fu">post_prob</span>(bs_mix,bs_toolbox,bs_narrow,bs_broad)</span>
<span id="cb192-148"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-148" tabindex="-1"></a></span>
<span id="cb192-149"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-149" tabindex="-1"></a>postprob <span class="sc">|&gt;</span></span>
<span id="cb192-150"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#cb192-150" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/HowManyGames/postprob_QRE.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Bland2019JMP" class="csl-entry">
Bland, James R. 2019. <span>“How Many Games Are We Playing? An Experimental Analysis of Choice Bracketing in Games.”</span> <em>Journal of Behavioral and Experimental Economics</em> 80: 80–91. <a href="https://doi.org/10.1016/j.socec.2019.03.011">https://doi.org/10.1016/j.socec.2019.03.011</a>.
</div>
<div id="ref-BlandTurocy2023" class="csl-entry">
Bland, James R, and Theodore L Turocy. 2025. <span>“Quantal Response Equilibrium as a Structural Model for Estimation: The Missing Manual.”</span> <em>Games and Economic Behavior</em>.
</div>
<div id="ref-Goeree2017" class="csl-entry">
Goeree, Jacob K, Charles A Holt, and Angela M Smith. 2017. <span>“An Experimental Examination of the Volunteer’s Dilemma.”</span> <em>Games and Economic Behavior</em> 102: 303–15.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="67">
<li id="fn67"><p>I thank an anonymous referee for requesting some QRE analysis in this paper. At the time, QRE was a passing interest of mine, but I hadn’t done any research using it. This was a very helpful nudge!<a href="application-a-quantal-response-equilibrium-with-discrete-types.html#fnref67" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-level-k-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
