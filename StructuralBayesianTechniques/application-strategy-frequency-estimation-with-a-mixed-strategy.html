<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Application: Strategy frequency estimation with a mixed strategy | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="12 Application: Strategy frequency estimation with a mixed strategy | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Application: Strategy frequency estimation with a mixed strategy | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Application: Strategy frequency estimation with a mixed strategy | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-05-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-strategy-frequency-estimation.html"/>
<link rel="next" href="computing-quantal-response-equilibrium.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>8</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="model-evaluation.html"><a href="model-evaluation.html#example-dataset-and-models"><i class="fa fa-check"></i><b>8.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="8.2" data-path="model-evaluation.html"><a href="model-evaluation.html#model-posterior-probabilities"><i class="fa fa-check"></i><b>8.2</b> Model posterior probabilities</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="model-evaluation.html"><a href="model-evaluation.html#implementation-using-bridge-sampling-and-the-bridgesampling-library"><i class="fa fa-check"></i><b>8.2.1</b> Implementation using bridge sampling and the <code>bridgesampling</code> library</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="model-evaluation.html"><a href="model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>8.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="model-evaluation.html"><a href="model-evaluation.html#expected-log-predicted-density-elpd-and-other-measures-of-goodness-of-fit"><i class="fa fa-check"></i><b>8.3.1</b> Expected Log Predicted Density (ELPD) and other measures of goodness of fit</a></li>
<li class="chapter" data-level="8.3.2" data-path="model-evaluation.html"><a href="model-evaluation.html#round-cross-validation"><i class="fa fa-check"></i><b>8.3.2</b> 1-round cross-validation</a></li>
<li class="chapter" data-level="8.3.3" data-path="model-evaluation.html"><a href="model-evaluation.html#leave-one-out-cross-validation-loo"><i class="fa fa-check"></i><b>8.3.3</b> Leave-one-out cross-validation (LOO)</a></li>
<li class="chapter" data-level="8.3.4" data-path="model-evaluation.html"><a href="model-evaluation.html#approximate-loo"><i class="fa fa-check"></i><b>8.3.4</b> Approximate LOO</a></li>
<li class="chapter" data-level="8.3.5" data-path="model-evaluation.html"><a href="model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>8.3.5</b> <span class="math inline">\(k\)</span>-fold cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>9</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="9.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>9.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="9.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>9.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="9.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>9.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="9.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>9.4</b> Vectorization</a></li>
<li class="chapter" data-level="9.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>9.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="9.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>9.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>9.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="9.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>9.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>9.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>9.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="9.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>9.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="10" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>10</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="10.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>10.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="10.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>10.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="10.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>10.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>10.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="10.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>10.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="10.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results"><i class="fa fa-check"></i><b>10.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>10.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>10.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="10.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>10.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="10.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>10.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>10.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>10.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="10.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>10.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="10.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>10.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>11</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="11.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>11.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="11.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>11.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>11.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="11.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>11.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>11.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>12</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>12.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="12.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>12.2</b> The likelihood function</a></li>
<li class="chapter" data-level="12.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>12.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="12.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-2"><i class="fa fa-check"></i><b>12.4</b> Results</a></li>
<li class="chapter" data-level="12.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>12.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>13</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="13.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>13.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="13.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>13.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>13.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="13.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>13.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="13.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>13.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="13.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>13.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>13.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="13.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>13.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>13.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="13.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>13.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="13.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>13.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>14</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>14.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="14.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>14.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>14.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="14.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>14.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="14.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>14.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="14.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-3"><i class="fa fa-check"></i><b>14.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>14.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>15</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1"><i class="fa fa-check"></i><b>15.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="15.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>15.2</b> A note on replication</a></li>
<li class="chapter" data-level="15.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>15.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>15.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="15.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>15.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="15.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>15.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-4"><i class="fa fa-check"></i><b>15.4</b> Results</a></li>
<li class="chapter" data-level="15.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>15.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><i class="fa fa-check"></i><b>16</b> Application: QRE in a Bayesian game and cursed equilibrium</a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#example-game-and-dataset"><i class="fa fa-check"></i><b>16.1</b> Example game and dataset</a></li>
<li class="chapter" data-level="16.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#solving-for-qre"><i class="fa fa-check"></i><b>16.2</b> Solving for QRE</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#baseline-model"><i class="fa fa-check"></i><b>16.2.1</b> Baseline model</a></li>
<li class="chapter" data-level="16.2.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cursed-equilibrium"><i class="fa fa-check"></i><b>16.2.2</b> Cursed equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#a-quick-prior-calibration-1"><i class="fa fa-check"></i><b>16.3</b> A quick prior calibration</a></li>
<li class="chapter" data-level="16.4" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-results"><i class="fa fa-check"></i><b>16.4</b> Model results</a></li>
<li class="chapter" data-level="16.5" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-evaluation-1"><i class="fa fa-check"></i><b>16.5</b> Model evaluation</a></li>
<li class="chapter" data-level="16.6" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#r-code-used-in-this-chapter"><i class="fa fa-check"></i><b>16.6</b> <em>R</em> code used in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>17</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>17.1</b> Data and game</a></li>
<li class="chapter" data-level="17.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>17.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>17.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="17.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>17.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>17.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>17.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="17.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>17.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="17.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-5"><i class="fa fa-check"></i><b>17.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>17.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>17.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="17.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>17.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>17.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>17.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="17.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>17.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="17.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>17.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>17.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>17.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="17.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>17.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="17.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>17.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>17.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>17.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="17.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>17.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>17.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>17.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="17.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>17.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="17.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>17.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="17.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>17.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="17.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>17.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>18</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>18.1</b> Example dataset</a></li>
<li class="chapter" data-level="18.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>18.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="18.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>18.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="18.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>18.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="18.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>18.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="18.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>18.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="18.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>18.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="18.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>18.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="18.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>18.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="18.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>18.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>19</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="19.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>19.1</b> Data</a></li>
<li class="chapter" data-level="19.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>19.2</b> A basic model</a></li>
<li class="chapter" data-level="19.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>19.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="19.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>19.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="19.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>19.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="19.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>19.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>20</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="20.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>20.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="20.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>20.2</b> Computational issues</a></li>
<li class="chapter" data-level="20.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>20.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="20.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>20.4</b> A representative agent model</a></li>
<li class="chapter" data-level="20.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>20.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="20.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>20.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="application-strategy-frequency-estimation-with-a-mixed-strategy" class="section level1 hasAnchor" number="12">
<h1><span class="header-section-number">12</span> Application: Strategy frequency estimation with a mixed strategy<a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#application-strategy-frequency-estimation-with-a-mixed-strategy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In the previous chapter, we learned about the strategy frequency estimation method (SFEM). One omission in this chapter was the possibility for including mixed or behavior strategies in the estimation. That is, the previous chapter only coverered strategies that were <em>pure</em> strategies. While the extension to mixing is not difficult, it is worth some attention. In the example below, we are interested in the importance of an equilibrium mixed strategy, compared to some other plausible candidate strategies that players could be using.</p>
<div id="example-dataset-and-strategies" class="section level2 hasAnchor" number="12.1">
<h2><span class="header-section-number">12.1</span> Example dataset and strategies<a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><span class="citation">Anwar and Georgalos (<a href="#ref-Anwar2024">2024</a>)</span> study a sequential 4-player public goods game with poisition uncertainty. That is, participants in this game played sequentially, but did not know exactly the position out of four that they would take their turn. Each player could invest or not invest a fixed amount in a public good (i.e. investment was a binary decision, not continuous). Players receive partial information about the investments of players before them. Specifically,</p>
<ol style="list-style-type: decimal">
<li>In Treatment 1 players received information about the investment choices of the two players who moved before them. Players did not know their position in the game in this treatment, but could infer whether they were in Position 1 or 2 if they receivec feedback about fewer than 2 opponents.</li>
<li>In Treatment 2 players received information about the investment choice of the one player before them. Players did not know their position in the game, but could infer that they were in Position 1 because they would not have received any feedback about opponents’ cholices, and</li>
<li>Treatment 3 was the same as Treatment 1, except that players knew their position in the game.</li>
</ol>
<p>In their SFEM, <span class="citation">Anwar and Georgalos (<a href="#ref-Anwar2024">2024</a>)</span> consider four strategies shown in Table <a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#tab:Anwar2024strategies">12.1</a>. The “Free rider” and “Altruist” strategeis do not depend on the treatment, and just involve either always not cooperating or cooperating, respectively. The two other strategies, “G&amp;M” and “Conditional cooperator” depend on the treatment. Here the “G&amp;M” strategy is the equilibrium strategy characterized by <span class="citation">Gallice and Monzón (<a href="#ref-Gallice2019">2019</a>)</span> for this game. Importantly for this application, in Treatment 2 the strategy invests with probability <span class="math inline">\(\gamma=0.528\)</span> after some information sets. It is this strategy that will add the novel part to this SFEM compared to the previous chapter.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-1" tabindex="-1"></a>TAB<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb159-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;G&amp;M, T1&quot;</span>, <span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb159-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;G&amp;M, T2&quot;</span>, <span class="dv">1</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">gamma$&quot;</span>,<span class="dv">1</span> ,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">gamma$&quot;</span>,<span class="dv">1</span>,<span class="st">&quot; &quot;</span>),</span>
<span id="cb159-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-4" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;G&amp;M, T3&quot;</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb159-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-5" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Free rider&quot;</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb159-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-6" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Altruist&quot;</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb159-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-7" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Conditional co-operator, T1 &amp; T3&quot;</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb159-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-8" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;Conditional co-operator, T2&quot;</span>,<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="st">&quot; &quot;</span>)</span>
<span id="cb159-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-9" tabindex="-1"></a>)</span>
<span id="cb159-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-10" tabindex="-1"></a></span>
<span id="cb159-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-11" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb159-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-12" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;The four strategies considered in @Anwar2024. $</span><span class="sc">\\</span><span class="st">gamma=0.528$. $c_0$ ($c_1$, $c_2$) indicates the information set where 0 (1, 2) previous players have chosen to invest.&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb159-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-13" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb159-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-14" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;Strategy&quot;</span>,<span class="st">&quot;$c_0$&quot;</span>,<span class="st">&quot;$c_0$&quot;</span>,<span class="st">&quot;$c_1$&quot;</span>,<span class="st">&quot;$c_0$&quot;</span>,<span class="st">&quot;$c_1$&quot;</span>,<span class="st">&quot;$c_2$&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb159-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-15" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span>,<span class="st">&quot;Position 1&quot;</span>,<span class="st">&quot;Position 2&quot;</span><span class="ot">=</span><span class="dv">2</span>,<span class="st">&quot;Position 3 &amp; 4&quot;</span><span class="ot">=</span><span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb159-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb159-16" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span>,<span class="st">&quot;Information set&quot;</span> <span class="ot">=</span> <span class="dv">6</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="6">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Information set
</div>
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Position 1
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Position 2
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Position 3 &amp; 4
</div>
</th>
</tr>
<tr>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Strategy
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(c_0\)</span>
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(c_0\)</span>
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(c_1\)</span>
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(c_0\)</span>
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(c_1\)</span>
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(c_2\)</span>
</div>
</th>
</tr>
</thead>
<caption>
<span id="tab:Anwar2024strategies">Table 12.1: </span>The four strategies considered in <span class="citation">Anwar and Georgalos (<a href="#ref-Anwar2024">2024</a>)</span>. <span class="math inline">\(\gamma=0.528\)</span>. <span class="math inline">\(c_0\)</span> (<span class="math inline">\(c_1\)</span>, <span class="math inline">\(c_2\)</span>) indicates the information set where 0 (1, 2) previous players have chosen to invest.
</caption>
<tbody>
<tr>
<td style="text-align:left;">
G&amp;M, T1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
G&amp;M, T2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span class="math inline">\(\gamma\)</span>
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
<span class="math inline">\(\gamma\)</span>
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
G&amp;M, T3
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Free rider
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
0
</td>
</tr>
<tr>
<td style="text-align:left;">
Altruist
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Conditional co-operator, T1 &amp; T3
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Conditional co-operator, T2
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
0
</td>
<td style="text-align:left;">
1
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
</div>
<div id="the-likelihood-function" class="section level2 hasAnchor" number="12.2">
<h2><span class="header-section-number">12.2</span> The likelihood function<a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Note that we can write each strategy as a 6-vector, where each element represents the probability of playing “invest” in each information set. That is, the G&amp;M strategy for Treatment 1 can be represented by:</p>
<p><span class="math display">\[
\sigma_s = \begin{pmatrix}
1&amp;0&amp;1&amp;0&amp;0&amp;1
\end{pmatrix}^\top
\]</span></p>
<p>and the G&amp;M strategy for Treatment 2 can be represented by:</p>
<p><span class="math display">\[
\sigma_s=\begin{pmatrix}
1&amp;0.528 &amp; 1 &amp; 0.528 &amp; 1&amp; 0.5
\end{pmatrix}
\]</span>
Here since the “Position 3 &amp; 4, <span class="math inline">\(c_2\)</span>” information set is never reached, we can in principle put anything into this element of the vector. However since we will be taking the log of these vectors to calculate the log-likelihood, 0.5 will mean we don’t end up taking the log of a negative number.</p>
<p>Since there are still some (nearly all) pure strategies on the list, we still need the tremble probability <span class="math inline">\(\epsilon\in(0,0.5)\)</span> for these pure strategies to make sure that the likelihood function is not zero everywhere. Therefore we can define the strategy inclusive of trembles as the probability a player chooses “invest” after each of the six information sets:</p>
<p><span class="math display">\[
\tilde\sigma_s=(1-\epsilon)\sigma_s+\epsilon(1-\sigma_s)
\]</span></p>
<p>The only bits we need to worry about is for the second treatment, where the G&amp;M strategy is mixed. Here we just replace the relevant elements of <span class="math inline">\(\tilde\sigma_s\)</span> with <span class="math inline">\(\gamma\)</span>.<a href="#fn55" class="footnote-ref" id="fnref55"><sup>55</sup></a> That is, the G&amp;M strategy in Treatment 2 becomes:</p>
<p><span class="math display">\[
\tilde\sigma_{\text{G&amp;M, T2}}=\begin{pmatrix}
1-\epsilon &amp; 0.528 &amp; 1-\epsilon &amp; 0.528 &amp; 1-\epsilon &amp; 0.5
\end{pmatrix}^\top
\]</span></p>
<p>Now we can construct the log-likelihood of following a particular strategy <span class="math inline">\(\sigma_s\)</span> for a participant <span class="math inline">\(i\)</span>:</p>
<p><span class="math display">\[
\log p(y_i,n_i\mid \sigma_s,\epsilon)=y_i^\top \log(\tilde\sigma_s)+(n_i-y_i)^\top \log(1-\tilde\sigma_s)
\]</span></p>
<p>Where <span class="math inline">\(y_i\)</span> is a count of the number of times participant <span class="math inline">\(i\)</span> chose “invest” after each information set, and <span class="math inline">\(n_i\)</span> is a count of the number of times participant <span class="math inline">\(i\)</span> reached each information set.</p>
<p>The rest proceeds exactly as the SFEM would in the previous chapter. We next take the mixing probabilities <span class="math inline">\(\psi\in\Delta^4\)</span> and integrate out the types:</p>
<p><span class="math display">\[
\log p(y_i,n_i\mid \psi,\epsilon)=\log\left(\sum_{s=1}^4\exp\left(\log\psi_s+\log p(y_i,n_i\mid \sigma_s,\epsilon)\right)\right)
\]</span></p>
<p>Note, as we did in the previous chapter, that we are writing this in a form that means we can use <em>Stan</em>’s <code>log_sum_exp()</code> function.</p>
</div>
<div id="implementation-in-stan" class="section level2 hasAnchor" number="12.3">
<h2><span class="header-section-number">12.3</span> Implementation in <em>Stan</em><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The parameters in the model are the strategy frequencies <span class="math inline">\(\psi\in \Delta^4\)</span>, and the tremble prbability <span class="math inline">\(\epsilon\in(0,0.5)\)</span>. I assign the following priors to these parameters:</p>
<p><span class="math display">\[
\begin{aligned}
\psi&amp;\sim\mathrm{Dirichlet}(1,1,1,1)\\
\epsilon&amp;\sim\mathrm{TruncatedBeta}(1,1,(0,0.5))
\end{aligned}
\]</span></p>
<p>I estimate five models that make different assumptions about how the strategies and trembles relate between treatments. Because all of these programs can use the same <code>data</code> and <code>transformed data</code> blocks, I wrote a single script called <code>SFEM_INCLUDE_data.stan</code> to include at the top of alll the <em>Stan</em> programs. Here is <code>SFEM_INCLUDE_data.stan</code>:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb160-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-1" tabindex="-1"></a></span>
<span id="cb160-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-2" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb160-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-3" tabindex="-1"></a>  </span>
<span id="cb160-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-4" tabindex="-1"></a>  <span class="co">//</span></span>
<span id="cb160-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-5" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> gamma<span class="op">;</span></span>
<span id="cb160-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-6" tabindex="-1"></a>  </span>
<span id="cb160-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-7" tabindex="-1"></a>  <span class="dt">int</span> n_t1<span class="op">;</span></span>
<span id="cb160-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-8" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">6</span><span class="op">]</span> coop_t1<span class="op">;</span></span>
<span id="cb160-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-9" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">6</span><span class="op">]</span> count_t1<span class="op">;</span></span>
<span id="cb160-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-10" tabindex="-1"></a>  <span class="dt">int</span> n_t2<span class="op">;</span></span>
<span id="cb160-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-11" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">6</span><span class="op">]</span> coop_t2<span class="op">;</span></span>
<span id="cb160-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-12" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">6</span><span class="op">]</span> count_t2<span class="op">;</span></span>
<span id="cb160-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-13" tabindex="-1"></a>  <span class="dt">int</span> n_t3<span class="op">;</span></span>
<span id="cb160-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-14" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">6</span><span class="op">]</span> coop_t3<span class="op">;</span></span>
<span id="cb160-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-15" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">6</span><span class="op">]</span> count_t3<span class="op">;</span></span>
<span id="cb160-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-16" tabindex="-1"></a>  </span>
<span id="cb160-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-17" tabindex="-1"></a>  </span>
<span id="cb160-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-18" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">4</span><span class="op">]</span> prior_mix<span class="op">;</span></span>
<span id="cb160-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-19" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_eps<span class="op">;</span></span>
<span id="cb160-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-20" tabindex="-1"></a></span>
<span id="cb160-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-21" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb160-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-22" tabindex="-1"></a></span>
<span id="cb160-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-23" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb160-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-24" tabindex="-1"></a>  </span>
<span id="cb160-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-25" tabindex="-1"></a>  <span class="co">// description of strategies. See Table 3 in the paper</span></span>
<span id="cb160-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-26" tabindex="-1"></a>  </span>
<span id="cb160-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-27" tabindex="-1"></a>  row_vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> strg_t1<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb160-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-28" tabindex="-1"></a>  row_vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> strg_t2<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb160-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-29" tabindex="-1"></a>  row_vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> strg_t3<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb160-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-30" tabindex="-1"></a>  </span>
<span id="cb160-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-31" tabindex="-1"></a>  <span class="co">// G&amp;M</span></span>
<span id="cb160-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-32" tabindex="-1"></a>  strg_t1<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb160-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-33" tabindex="-1"></a>  strg_t2<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span>gamma<span class="op">,</span><span class="dv">1</span><span class="op">,</span>gamma<span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="er">.5</span><span class="op">];</span></span>
<span id="cb160-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-34" tabindex="-1"></a>  strg_t3<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-35" tabindex="-1"></a>  </span>
<span id="cb160-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-36" tabindex="-1"></a>  <span class="co">// free rider</span></span>
<span id="cb160-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-37" tabindex="-1"></a>  strg_t1<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-38" tabindex="-1"></a>  strg_t2<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-39" tabindex="-1"></a>  strg_t3<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">0</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-40" tabindex="-1"></a>  </span>
<span id="cb160-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-41" tabindex="-1"></a>  <span class="co">// altruist</span></span>
<span id="cb160-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-42" tabindex="-1"></a>  strg_t1<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-43" tabindex="-1"></a>  strg_t2<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-44" tabindex="-1"></a>  strg_t3<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> rep_row_vector<span class="op">(</span><span class="dv">1</span><span class="op">,</span><span class="dv">6</span><span class="op">);</span></span>
<span id="cb160-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-45" tabindex="-1"></a>  </span>
<span id="cb160-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-46" tabindex="-1"></a>  <span class="co">// conditional cooperator</span></span>
<span id="cb160-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-47" tabindex="-1"></a>  strg_t1<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb160-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-48" tabindex="-1"></a>  strg_t2<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="er">.5</span><span class="op">];</span></span>
<span id="cb160-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-49" tabindex="-1"></a>  strg_t3<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">0</span><span class="op">,</span><span class="dv">1</span><span class="op">,</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb160-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-50" tabindex="-1"></a>  </span>
<span id="cb160-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb160-51" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>First, I estimate a model that allows the strategy frequencies <span class="math inline">\(\psi\)</span> and the tremble probability <span class="math inline">\(\epsilon\)</span> to vary by treatment. This is probably the best comparison to the SFEM estimated in <span class="citation">Anwar and Georgalos (<a href="#ref-Anwar2024">2024</a>)</span> (see their Table 4):</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb161-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-1" tabindex="-1"></a></span>
<span id="cb161-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-2" tabindex="-1"></a><span class="pp">#include SFEM_INCLUDE_data.stan</span></span>
<span id="cb161-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-3" tabindex="-1"></a></span>
<span id="cb161-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-4" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb161-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-5" tabindex="-1"></a>  </span>
<span id="cb161-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-6" tabindex="-1"></a>  simplex<span class="op">[</span><span class="dv">4</span><span class="op">]</span> mix<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb161-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-7" tabindex="-1"></a>  </span>
<span id="cb161-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-8" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">0</span><span class="er">.5</span><span class="op">&gt;[</span><span class="dv">3</span><span class="op">]</span> eps<span class="op">;</span></span>
<span id="cb161-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-9" tabindex="-1"></a></span>
<span id="cb161-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb161-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-11" tabindex="-1"></a></span>
<span id="cb161-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-12" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb161-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-13" tabindex="-1"></a>  </span>
<span id="cb161-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-14" tabindex="-1"></a>  <span class="co">// get a matrix of cooperation probabilities for each strategy in each treatment</span></span>
<span id="cb161-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-15" tabindex="-1"></a>  </span>
<span id="cb161-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-16" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t1<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb161-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-17" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t2<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb161-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-18" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t3<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb161-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-19" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-20" tabindex="-1"></a>    </span>
<span id="cb161-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-21" tabindex="-1"></a></span>
<span id="cb161-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-22" tabindex="-1"></a>    </span>
<span id="cb161-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-23" tabindex="-1"></a>    pr_coop_t1<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t1<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[1])+(1-strg_t1[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb161-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-24" tabindex="-1"></a>    pr_coop_t2<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t2<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[2])+(1-strg_t2[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb161-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-25" tabindex="-1"></a>    pr_coop_t3<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t3<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[3])+(1-strg_t3[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb161-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-26" tabindex="-1"></a>    </span>
<span id="cb161-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-27" tabindex="-1"></a>    <span class="co">// fix the strategies that are actually mixed.</span></span>
<span id="cb161-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-28" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">6</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-29" tabindex="-1"></a>      </span>
<span id="cb161-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-30" tabindex="-1"></a>      pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb161-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-31" tabindex="-1"></a>      pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb161-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-32" tabindex="-1"></a>      pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb161-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-33" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb161-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-34" tabindex="-1"></a>    </span>
<span id="cb161-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-35" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb161-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-36" tabindex="-1"></a>  </span>
<span id="cb161-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-37" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t1 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="op">[</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;)</span><span class="er">,n_t1);</span></span>
<span id="cb161-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-38" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t2 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="op">[</span><span class="dv">2</span><span class="op">]</span><span class="ch">&#39;)</span><span class="er">,n_t2);</span></span>
<span id="cb161-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-39" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t3 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="op">[</span><span class="dv">3</span><span class="op">]</span><span class="ch">&#39;)</span><span class="er">,n_t3);</span></span>
<span id="cb161-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-40" tabindex="-1"></a>  </span>
<span id="cb161-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-41" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-42" tabindex="-1"></a>    </span>
<span id="cb161-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-43" tabindex="-1"></a>    like_t1<span class="op">[,</span>ss<span class="op">]+=</span>coop_t1<span class="op">*</span>log<span class="op">(</span>pr_coop_t1<span class="op">[</span>ss<span class="op">])+(</span>count_t1<span class="op">-</span>coop_t1<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t1<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb161-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-44" tabindex="-1"></a>    like_t2<span class="op">[,</span>ss<span class="op">]+=</span>coop_t2<span class="op">*</span>log<span class="op">(</span>pr_coop_t2<span class="op">[</span>ss<span class="op">])+(</span>count_t2<span class="op">-</span>coop_t2<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t2<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb161-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-45" tabindex="-1"></a>    like_t3<span class="op">[,</span>ss<span class="op">]+=</span>coop_t3<span class="op">*</span>log<span class="op">(</span>pr_coop_t3<span class="op">[</span>ss<span class="op">])+(</span>count_t3<span class="op">-</span>coop_t3<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t3<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb161-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-46" tabindex="-1"></a></span>
<span id="cb161-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-47" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb161-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-48" tabindex="-1"></a>  </span>
<span id="cb161-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-49" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-50" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t1<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb161-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-51" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb161-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-52" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-53" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t2<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb161-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-54" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb161-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-55" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-56" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t3<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb161-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-57" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb161-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-58" tabindex="-1"></a>  </span>
<span id="cb161-59"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-59" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-60"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-60" tabindex="-1"></a>    </span>
<span id="cb161-61"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-61" tabindex="-1"></a>    target <span class="op">+=</span> dirichlet_lpdf<span class="op">(</span>mix<span class="op">[</span>tt<span class="op">]|</span>prior_mix<span class="op">);</span></span>
<span id="cb161-62"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-62" tabindex="-1"></a>    target <span class="op">+=</span> beta_lpdf<span class="op">(</span>eps<span class="op">[</span>tt<span class="op">]|</span> prior_eps<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_eps<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb161-63"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-63" tabindex="-1"></a>    </span>
<span id="cb161-64"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-64" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb161-65"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-65" tabindex="-1"></a></span>
<span id="cb161-66"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb161-66" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>However what I was interested in (and this is not necessarily what <span class="citation">Anwar and Georgalos (<a href="#ref-Anwar2024">2024</a>)</span> were interested in) was how stable the strategy frequencies were across treatments, so I estimated a model that assumed that the strategy frequencies were <em>the same</em> across the three treatments, but allowed the tremble probability to vary across treatments:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb162-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-1" tabindex="-1"></a></span>
<span id="cb162-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-2" tabindex="-1"></a><span class="pp">#include SFEM_INCLUDE_data.stan</span></span>
<span id="cb162-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-3" tabindex="-1"></a></span>
<span id="cb162-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-4" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb162-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-5" tabindex="-1"></a>  </span>
<span id="cb162-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-6" tabindex="-1"></a>  simplex<span class="op">[</span><span class="dv">4</span><span class="op">]</span> mix<span class="op">;</span></span>
<span id="cb162-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-7" tabindex="-1"></a>  </span>
<span id="cb162-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-8" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">0</span><span class="er">.5</span><span class="op">&gt;[</span><span class="dv">3</span><span class="op">]</span> eps<span class="op">;</span></span>
<span id="cb162-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-9" tabindex="-1"></a></span>
<span id="cb162-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb162-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-11" tabindex="-1"></a></span>
<span id="cb162-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-12" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb162-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-13" tabindex="-1"></a>  </span>
<span id="cb162-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-14" tabindex="-1"></a>  <span class="co">// get a matrix of cooperation probabilities for each strategy in each treatment</span></span>
<span id="cb162-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-15" tabindex="-1"></a>  </span>
<span id="cb162-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-16" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t1<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb162-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-17" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t2<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb162-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-18" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t3<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb162-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-19" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-20" tabindex="-1"></a>    </span>
<span id="cb162-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-21" tabindex="-1"></a>    pr_coop_t1<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t1<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[1])+(1-strg_t1[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb162-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-22" tabindex="-1"></a>    pr_coop_t2<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t2<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[2])+(1-strg_t2[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb162-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-23" tabindex="-1"></a>    pr_coop_t3<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t3<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[3])+(1-strg_t3[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb162-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-24" tabindex="-1"></a>    </span>
<span id="cb162-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-25" tabindex="-1"></a>    <span class="co">// fix the strategies that are actually mixed.</span></span>
<span id="cb162-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-26" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">6</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-27" tabindex="-1"></a>      </span>
<span id="cb162-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-28" tabindex="-1"></a>      pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb162-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-29" tabindex="-1"></a>      pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb162-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-30" tabindex="-1"></a>      pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb162-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-31" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb162-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-32" tabindex="-1"></a>    </span>
<span id="cb162-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-33" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb162-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-34" tabindex="-1"></a>  </span>
<span id="cb162-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-35" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t1 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="ch">&#39;)</span><span class="er">,n_t1);</span></span>
<span id="cb162-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-36" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t2 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="ch">&#39;)</span><span class="er">,n_t2);</span></span>
<span id="cb162-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-37" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t3 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="ch">&#39;)</span><span class="er">,n_t3);</span></span>
<span id="cb162-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-38" tabindex="-1"></a>  </span>
<span id="cb162-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-39" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-40" tabindex="-1"></a>    </span>
<span id="cb162-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-41" tabindex="-1"></a>    like_t1<span class="op">[,</span>ss<span class="op">]+=</span>coop_t1<span class="op">*</span>log<span class="op">(</span>pr_coop_t1<span class="op">[</span>ss<span class="op">])+(</span>count_t1<span class="op">-</span>coop_t1<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t1<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb162-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-42" tabindex="-1"></a>    like_t2<span class="op">[,</span>ss<span class="op">]+=</span>coop_t2<span class="op">*</span>log<span class="op">(</span>pr_coop_t2<span class="op">[</span>ss<span class="op">])+(</span>count_t2<span class="op">-</span>coop_t2<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t2<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb162-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-43" tabindex="-1"></a>    like_t3<span class="op">[,</span>ss<span class="op">]+=</span>coop_t3<span class="op">*</span>log<span class="op">(</span>pr_coop_t3<span class="op">[</span>ss<span class="op">])+(</span>count_t3<span class="op">-</span>coop_t3<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t3<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb162-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-44" tabindex="-1"></a></span>
<span id="cb162-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-45" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb162-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-46" tabindex="-1"></a>  </span>
<span id="cb162-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-47" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-48" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t1<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb162-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-49" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb162-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-50" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-51" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t2<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb162-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-52" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb162-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-53" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-54" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t3<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb162-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-55" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb162-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-56" tabindex="-1"></a>  </span>
<span id="cb162-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-57" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-58" tabindex="-1"></a>    </span>
<span id="cb162-59"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-59" tabindex="-1"></a>    </span>
<span id="cb162-60"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-60" tabindex="-1"></a>    target <span class="op">+=</span> beta_lpdf<span class="op">(</span>eps<span class="op">[</span>tt<span class="op">]|</span> prior_eps<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_eps<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb162-61"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-61" tabindex="-1"></a>    </span>
<span id="cb162-62"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-62" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb162-63"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-63" tabindex="-1"></a>  </span>
<span id="cb162-64"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-64" tabindex="-1"></a>  target <span class="op">+=</span> dirichlet_lpdf<span class="op">(</span>mix<span class="op">|</span>prior_mix<span class="op">);</span></span>
<span id="cb162-65"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-65" tabindex="-1"></a></span>
<span id="cb162-66"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb162-66" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>For good measure, I also estimated a model that imposed that the tremble probabilities were constant across the treatments:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb163-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-1" tabindex="-1"></a></span>
<span id="cb163-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-2" tabindex="-1"></a><span class="pp">#include SFEM_INCLUDE_data.stan</span></span>
<span id="cb163-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-3" tabindex="-1"></a></span>
<span id="cb163-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-4" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb163-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-5" tabindex="-1"></a>  </span>
<span id="cb163-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-6" tabindex="-1"></a>  simplex<span class="op">[</span><span class="dv">4</span><span class="op">]</span> mix<span class="op">;</span></span>
<span id="cb163-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-7" tabindex="-1"></a>  </span>
<span id="cb163-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-8" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">0</span><span class="er">.5</span><span class="op">&gt;[</span><span class="dv">3</span><span class="op">]</span> eps<span class="op">;</span></span>
<span id="cb163-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-9" tabindex="-1"></a></span>
<span id="cb163-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb163-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-11" tabindex="-1"></a></span>
<span id="cb163-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-12" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb163-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-13" tabindex="-1"></a>  </span>
<span id="cb163-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-14" tabindex="-1"></a>  <span class="co">// get a matrix of cooperation probabilities for each strategy in each treatment</span></span>
<span id="cb163-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-15" tabindex="-1"></a>  </span>
<span id="cb163-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-16" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t1<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb163-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-17" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t2<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb163-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-18" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t3<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb163-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-19" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-20" tabindex="-1"></a>    </span>
<span id="cb163-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-21" tabindex="-1"></a>    pr_coop_t1<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t1<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[1])+(1-strg_t1[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb163-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-22" tabindex="-1"></a>    pr_coop_t2<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t2<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[2])+(1-strg_t2[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb163-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-23" tabindex="-1"></a>    pr_coop_t3<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t3<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[3])+(1-strg_t3[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb163-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-24" tabindex="-1"></a>    </span>
<span id="cb163-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-25" tabindex="-1"></a>    <span class="co">// fix the strategies that are actually mixed.</span></span>
<span id="cb163-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-26" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">6</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-27" tabindex="-1"></a>      </span>
<span id="cb163-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-28" tabindex="-1"></a>      pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb163-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-29" tabindex="-1"></a>      pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb163-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-30" tabindex="-1"></a>      pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb163-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-31" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb163-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-32" tabindex="-1"></a>    </span>
<span id="cb163-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-33" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb163-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-34" tabindex="-1"></a>  </span>
<span id="cb163-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-35" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t1 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="ch">&#39;)</span><span class="er">,n_t1);</span></span>
<span id="cb163-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-36" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t2 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="ch">&#39;)</span><span class="er">,n_t2);</span></span>
<span id="cb163-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-37" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">4</span><span class="op">]</span> like_t3 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="ch">&#39;)</span><span class="er">,n_t3);</span></span>
<span id="cb163-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-38" tabindex="-1"></a>  </span>
<span id="cb163-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-39" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-40" tabindex="-1"></a>    </span>
<span id="cb163-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-41" tabindex="-1"></a>    like_t1<span class="op">[,</span>ss<span class="op">]+=</span>coop_t1<span class="op">*</span>log<span class="op">(</span>pr_coop_t1<span class="op">[</span>ss<span class="op">])+(</span>count_t1<span class="op">-</span>coop_t1<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t1<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb163-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-42" tabindex="-1"></a>    like_t2<span class="op">[,</span>ss<span class="op">]+=</span>coop_t2<span class="op">*</span>log<span class="op">(</span>pr_coop_t2<span class="op">[</span>ss<span class="op">])+(</span>count_t2<span class="op">-</span>coop_t2<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t2<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb163-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-43" tabindex="-1"></a>    like_t3<span class="op">[,</span>ss<span class="op">]+=</span>coop_t3<span class="op">*</span>log<span class="op">(</span>pr_coop_t3<span class="op">[</span>ss<span class="op">])+(</span>count_t3<span class="op">-</span>coop_t3<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t3<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb163-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-44" tabindex="-1"></a></span>
<span id="cb163-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-45" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb163-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-46" tabindex="-1"></a>  </span>
<span id="cb163-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-47" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-48" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t1<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb163-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-49" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb163-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-50" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-51" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t2<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb163-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-52" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb163-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-53" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-54" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t3<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb163-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-55" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb163-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-56" tabindex="-1"></a>  </span>
<span id="cb163-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-57" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-58" tabindex="-1"></a>    </span>
<span id="cb163-59"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-59" tabindex="-1"></a>    </span>
<span id="cb163-60"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-60" tabindex="-1"></a>    target <span class="op">+=</span> beta_lpdf<span class="op">(</span>eps<span class="op">[</span>tt<span class="op">]|</span> prior_eps<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_eps<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb163-61"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-61" tabindex="-1"></a>    </span>
<span id="cb163-62"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-62" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb163-63"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-63" tabindex="-1"></a>  </span>
<span id="cb163-64"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-64" tabindex="-1"></a>  target <span class="op">+=</span> dirichlet_lpdf<span class="op">(</span>mix<span class="op">|</span>prior_mix<span class="op">);</span></span>
<span id="cb163-65"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-65" tabindex="-1"></a></span>
<span id="cb163-66"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb163-66" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>To test whether <em>all</em> players were using the G&amp;M strategy, I estimated a SFEM with just the G&amp;M strategy. Comparing this to the others would give us an idea of how important the free rider, altruist, and conditional co-operator stratgies were:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb164-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-1" tabindex="-1"></a></span>
<span id="cb164-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-2" tabindex="-1"></a><span class="pp">#include SFEM_INCLUDE_data.stan</span></span>
<span id="cb164-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-3" tabindex="-1"></a></span>
<span id="cb164-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-4" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb164-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-5" tabindex="-1"></a>  </span>
<span id="cb164-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-6" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">0</span><span class="er">.5</span><span class="op">&gt;[</span><span class="dv">3</span><span class="op">]</span> eps<span class="op">;</span></span>
<span id="cb164-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-7" tabindex="-1"></a></span>
<span id="cb164-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-8" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb164-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-9" tabindex="-1"></a></span>
<span id="cb164-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-10" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb164-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-11" tabindex="-1"></a>  </span>
<span id="cb164-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-12" tabindex="-1"></a>  <span class="co">// get a matrix of cooperation probabilities for each strategy in each treatment</span></span>
<span id="cb164-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-13" tabindex="-1"></a>  </span>
<span id="cb164-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-14" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t1<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb164-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-15" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t2<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb164-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-16" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t3<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb164-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-17" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-18" tabindex="-1"></a>    </span>
<span id="cb164-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-19" tabindex="-1"></a>    pr_coop_t1<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t1<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[1])+(1-strg_t1[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb164-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-20" tabindex="-1"></a>    pr_coop_t2<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t2<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[2])+(1-strg_t2[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb164-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-21" tabindex="-1"></a>    pr_coop_t3<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t3<span class="op">[</span>ss<span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[3])+(1-strg_t3[ss])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb164-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-22" tabindex="-1"></a>    </span>
<span id="cb164-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-23" tabindex="-1"></a>    <span class="co">// fix the strategies that are actually mixed.</span></span>
<span id="cb164-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-24" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">6</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-25" tabindex="-1"></a>      </span>
<span id="cb164-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-26" tabindex="-1"></a>      pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb164-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-27" tabindex="-1"></a>      pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb164-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-28" tabindex="-1"></a>      pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb164-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-29" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb164-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-30" tabindex="-1"></a>    </span>
<span id="cb164-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-31" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb164-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-32" tabindex="-1"></a>  </span>
<span id="cb164-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-33" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">1</span><span class="op">]</span> like_t1 <span class="op">=</span> rep_matrix<span class="op">(</span><span class="dv">0</span><span class="op">,</span>n_t1<span class="op">,</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb164-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-34" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">1</span><span class="op">]</span> like_t2 <span class="op">=</span> rep_matrix<span class="op">(</span><span class="dv">0</span><span class="op">,</span>n_t2<span class="op">,</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb164-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-35" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">1</span><span class="op">]</span> like_t3 <span class="op">=</span> rep_matrix<span class="op">(</span><span class="dv">0</span><span class="op">,</span>n_t3<span class="op">,</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb164-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-36" tabindex="-1"></a>  </span>
<span id="cb164-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-37" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-38" tabindex="-1"></a>    </span>
<span id="cb164-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-39" tabindex="-1"></a>    like_t1<span class="op">[,</span>ss<span class="op">]+=</span>coop_t1<span class="op">*</span>log<span class="op">(</span>pr_coop_t1<span class="op">[</span>ss<span class="op">])+(</span>count_t1<span class="op">-</span>coop_t1<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t1<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb164-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-40" tabindex="-1"></a>    like_t2<span class="op">[,</span>ss<span class="op">]+=</span>coop_t2<span class="op">*</span>log<span class="op">(</span>pr_coop_t2<span class="op">[</span>ss<span class="op">])+(</span>count_t2<span class="op">-</span>coop_t2<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t2<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb164-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-41" tabindex="-1"></a>    like_t3<span class="op">[,</span>ss<span class="op">]+=</span>coop_t3<span class="op">*</span>log<span class="op">(</span>pr_coop_t3<span class="op">[</span>ss<span class="op">])+(</span>count_t3<span class="op">-</span>coop_t3<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t3<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb164-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-42" tabindex="-1"></a></span>
<span id="cb164-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-43" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb164-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-44" tabindex="-1"></a>  </span>
<span id="cb164-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-45" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-46" tabindex="-1"></a>    target <span class="op">+=</span> like_t1<span class="op">[</span>ii<span class="op">,</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb164-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-47" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb164-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-48" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-49" tabindex="-1"></a>    target <span class="op">+=</span> like_t2<span class="op">[</span>ii<span class="op">,</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb164-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-50" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb164-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-51" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-52" tabindex="-1"></a>    target <span class="op">+=</span> like_t3<span class="op">[</span>ii<span class="op">,</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb164-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-53" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb164-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-54" tabindex="-1"></a>  </span>
<span id="cb164-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-55" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-56" tabindex="-1"></a>    </span>
<span id="cb164-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-57" tabindex="-1"></a>    </span>
<span id="cb164-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-58" tabindex="-1"></a>    target <span class="op">+=</span> beta_lpdf<span class="op">(</span>eps<span class="op">[</span>tt<span class="op">]|</span> prior_eps<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_eps<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb164-59"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-59" tabindex="-1"></a>    </span>
<span id="cb164-60"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-60" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb164-61"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-61" tabindex="-1"></a>  </span>
<span id="cb164-62"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-62" tabindex="-1"></a></span>
<span id="cb164-63"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb164-63" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Finally, to test the importance of the G&amp;M strategy, I estimated a model without this strategy. That is, if this strategy is <em>not</em> important, then eliminating it from the list should not matter too much:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb165-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-1" tabindex="-1"></a></span>
<span id="cb165-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-2" tabindex="-1"></a><span class="pp">#include SFEM_INCLUDE_data.stan</span></span>
<span id="cb165-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-3" tabindex="-1"></a></span>
<span id="cb165-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-4" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb165-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-5" tabindex="-1"></a>  </span>
<span id="cb165-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-6" tabindex="-1"></a>  simplex<span class="op">[</span><span class="dv">3</span><span class="op">]</span> mix<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb165-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-7" tabindex="-1"></a>  </span>
<span id="cb165-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-8" tabindex="-1"></a>  vector<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">0</span><span class="er">.5</span><span class="op">&gt;[</span><span class="dv">3</span><span class="op">]</span> eps<span class="op">;</span></span>
<span id="cb165-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-9" tabindex="-1"></a></span>
<span id="cb165-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-10" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb165-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-11" tabindex="-1"></a></span>
<span id="cb165-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-12" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb165-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-13" tabindex="-1"></a>  </span>
<span id="cb165-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-14" tabindex="-1"></a>  <span class="co">// get a matrix of cooperation probabilities for each strategy in each treatment</span></span>
<span id="cb165-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-15" tabindex="-1"></a>  </span>
<span id="cb165-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-16" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t1<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb165-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-17" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t2<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb165-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-18" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">6</span><span class="op">]</span> pr_coop_t3<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb165-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-19" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-20" tabindex="-1"></a>    </span>
<span id="cb165-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-21" tabindex="-1"></a>    pr_coop_t1<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t1<span class="op">[</span>ss<span class="op">+</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[1])+(1-strg_t1[ss+1])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb165-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-22" tabindex="-1"></a>    pr_coop_t2<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t2<span class="op">[</span>ss<span class="op">+</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[2])+(1-strg_t2[ss+1])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb165-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-23" tabindex="-1"></a>    pr_coop_t3<span class="op">[</span>ss<span class="op">]</span> <span class="op">=</span> strg_t3<span class="op">[</span>ss<span class="op">+</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;*</span><span class="er">(1-eps[3])+(1-strg_t3[ss+1])</span><span class="ch">&#39;</span><span class="op">*</span>eps<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb165-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-24" tabindex="-1"></a>    </span>
<span id="cb165-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-25" tabindex="-1"></a>    <span class="co">// fix the strategies that are actually mixed.</span></span>
<span id="cb165-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-26" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">6</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-27" tabindex="-1"></a>      </span>
<span id="cb165-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-28" tabindex="-1"></a>      pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t1<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb165-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-29" tabindex="-1"></a>      pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t2<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb165-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-30" tabindex="-1"></a>      pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]</span> <span class="op">=</span> abs<span class="op">(</span>strg_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">]-</span><span class="dv">0</span><span class="er">.5</span><span class="op">)&lt;</span><span class="dv">0</span><span class="er">.4</span> <span class="op">?</span> gamma <span class="op">:</span> pr_coop_t3<span class="op">[</span>ss<span class="op">][</span>tt<span class="op">];</span></span>
<span id="cb165-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-31" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb165-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-32" tabindex="-1"></a>    </span>
<span id="cb165-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-33" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb165-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-34" tabindex="-1"></a>  </span>
<span id="cb165-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-35" tabindex="-1"></a>  matrix<span class="op">[</span>n_t1<span class="op">,</span><span class="dv">3</span><span class="op">]</span> like_t1 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="op">[</span><span class="dv">1</span><span class="op">]</span><span class="ch">&#39;)</span><span class="er">,n_t1);</span></span>
<span id="cb165-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-36" tabindex="-1"></a>  matrix<span class="op">[</span>n_t2<span class="op">,</span><span class="dv">3</span><span class="op">]</span> like_t2 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="op">[</span><span class="dv">2</span><span class="op">]</span><span class="ch">&#39;)</span><span class="er">,n_t2);</span></span>
<span id="cb165-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-37" tabindex="-1"></a>  matrix<span class="op">[</span>n_t3<span class="op">,</span><span class="dv">3</span><span class="op">]</span> like_t3 <span class="op">=</span> rep_matrix<span class="op">(</span>log<span class="op">(</span>mix<span class="op">[</span><span class="dv">3</span><span class="op">]</span><span class="ch">&#39;)</span><span class="er">,n_t3);</span></span>
<span id="cb165-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-38" tabindex="-1"></a>  </span>
<span id="cb165-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-39" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-40" tabindex="-1"></a>    </span>
<span id="cb165-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-41" tabindex="-1"></a>    like_t1<span class="op">[,</span>ss<span class="op">]+=</span>coop_t1<span class="op">*</span>log<span class="op">(</span>pr_coop_t1<span class="op">[</span>ss<span class="op">])+(</span>count_t1<span class="op">-</span>coop_t1<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t1<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb165-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-42" tabindex="-1"></a>    like_t2<span class="op">[,</span>ss<span class="op">]+=</span>coop_t2<span class="op">*</span>log<span class="op">(</span>pr_coop_t2<span class="op">[</span>ss<span class="op">])+(</span>count_t2<span class="op">-</span>coop_t2<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t2<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb165-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-43" tabindex="-1"></a>    like_t3<span class="op">[,</span>ss<span class="op">]+=</span>coop_t3<span class="op">*</span>log<span class="op">(</span>pr_coop_t3<span class="op">[</span>ss<span class="op">])+(</span>count_t3<span class="op">-</span>coop_t3<span class="op">)*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>pr_coop_t3<span class="op">[</span>ss<span class="op">]);</span></span>
<span id="cb165-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-44" tabindex="-1"></a>    </span>
<span id="cb165-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-45" tabindex="-1"></a>    </span>
<span id="cb165-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-46" tabindex="-1"></a></span>
<span id="cb165-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-47" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb165-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-48" tabindex="-1"></a>  </span>
<span id="cb165-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-49" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-50" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t1<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb165-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-51" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb165-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-52" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-53" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t2<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb165-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-54" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb165-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-55" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>n_t3<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-56" tabindex="-1"></a>    target <span class="op">+=</span> log_sum_exp<span class="op">(</span>like_t3<span class="op">[</span>ii<span class="op">,]);</span></span>
<span id="cb165-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-57" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb165-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-58" tabindex="-1"></a>  </span>
<span id="cb165-59"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-59" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>tt in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-60"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-60" tabindex="-1"></a>    </span>
<span id="cb165-61"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-61" tabindex="-1"></a>    target <span class="op">+=</span> dirichlet_lpdf<span class="op">(</span>mix<span class="op">[</span>tt<span class="op">]|</span>prior_mix<span class="op">[</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">]);</span></span>
<span id="cb165-62"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-62" tabindex="-1"></a>    target <span class="op">+=</span> beta_lpdf<span class="op">(</span>eps<span class="op">[</span>tt<span class="op">]|</span> prior_eps<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_eps<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb165-63"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-63" tabindex="-1"></a>    </span>
<span id="cb165-64"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-64" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb165-65"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-65" tabindex="-1"></a></span>
<span id="cb165-66"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb165-66" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="results-2" class="section level2 hasAnchor" number="12.4">
<h2><span class="header-section-number">12.4</span> Results<a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Table <a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#tab:Anwar2024results">12.2</a> shows the posterior estimates from the most general model, where strategy frequencies and tremble probabilities can vary by treatment. Here we can see that the G&amp;M strategy accounts for a substantial fraction of decisions in all three treatments. For perspective with the Dirichlet prior, the prior stanard deviation for the mixing probabilities is about 0.19, which is quite a bit larget than the posterior standard deviations: we have learned substantially from the data.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-1" tabindex="-1"></a>fmt<span class="ot">&lt;-</span><span class="st">&quot;%.3f&quot;</span></span>
<span id="cb166-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-2" tabindex="-1"></a></span>
<span id="cb166-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-3" tabindex="-1"></a>strgList<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;G&amp;M&quot;</span>,<span class="st">&quot;Free rider&quot;</span>,<span class="st">&quot;Altruist&quot;</span>,<span class="st">&quot;Conditional cooperator&quot;</span>)</span>
<span id="cb166-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-4" tabindex="-1"></a></span>
<span id="cb166-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-5" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="st">&quot;Code/Anwar2024/Fit_SFEM.rds&quot;</span> <span class="sc">|&gt;</span> <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb166-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-6" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb166-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-7" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;par&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb166-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-8" tabindex="-1"></a>  <span class="fu">filter</span>(par<span class="sc">!=</span><span class="st">&quot;lp__&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb166-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-9" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb166-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-10" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">ifelse</span>(<span class="fu">grepl</span>(<span class="st">&quot;mix&quot;</span>,par),<span class="st">&quot;mix&quot;</span>,<span class="st">&quot;epsilon&quot;</span>)</span>
<span id="cb166-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-11" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb166-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-12" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb166-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-13" tabindex="-1"></a>    <span class="at">treatment =</span> <span class="fu">ifelse</span>(parameter<span class="sc">==</span><span class="st">&quot;mix&quot;</span>,</span>
<span id="cb166-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-14" tabindex="-1"></a>                       <span class="fu">str_split_i</span>(par,<span class="st">&quot;,&quot;</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">parse_number</span>(),</span>
<span id="cb166-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-15" tabindex="-1"></a>                       par <span class="sc">|&gt;</span> <span class="fu">parse_number</span>()</span>
<span id="cb166-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-16" tabindex="-1"></a>                       ),</span>
<span id="cb166-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-17" tabindex="-1"></a>    <span class="at">strg =</span> <span class="fu">str_split_i</span>(par,<span class="st">&quot;,&quot;</span>,<span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">parse_number</span>() ,</span>
<span id="cb166-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-18" tabindex="-1"></a>    <span class="at">strategy =</span> <span class="fu">ifelse</span>(parameter<span class="sc">==</span><span class="st">&quot;mix&quot;</span>,strgList[strg],<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">epsilon$&quot;</span>)</span>
<span id="cb166-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-19" tabindex="-1"></a>  ) </span>
<span id="cb166-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-20" tabindex="-1"></a></span>
<span id="cb166-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-21" tabindex="-1"></a>means<span class="ot">&lt;-</span>Fit <span class="sc">|&gt;</span></span>
<span id="cb166-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-22" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb166-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-23" tabindex="-1"></a>    <span class="at">mean =</span> <span class="fu">sprintf</span>(fmt,mean)</span>
<span id="cb166-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-24" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb166-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-25" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb166-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-26" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="st">&quot;strategy&quot;</span>,</span>
<span id="cb166-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-27" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb166-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-28" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;mean&quot;</span></span>
<span id="cb166-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-29" tabindex="-1"></a>  )</span>
<span id="cb166-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-30" tabindex="-1"></a></span>
<span id="cb166-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-31" tabindex="-1"></a>sds<span class="ot">&lt;-</span>Fit <span class="sc">|&gt;</span></span>
<span id="cb166-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-32" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb166-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-33" tabindex="-1"></a>    <span class="at">sd =</span> <span class="fu">paste0</span>(<span class="st">&quot;(&quot;</span>,<span class="fu">sprintf</span>(fmt,sd),<span class="st">&quot;)&quot;</span>)</span>
<span id="cb166-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-34" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb166-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-35" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb166-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-36" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="st">&quot;strategy&quot;</span>,</span>
<span id="cb166-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-37" tabindex="-1"></a>    <span class="at">names_from =</span> <span class="st">&quot;treatment&quot;</span>,</span>
<span id="cb166-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-38" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="st">&quot;sd&quot;</span></span>
<span id="cb166-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-39" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb166-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-40" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb166-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-41" tabindex="-1"></a>    <span class="at">strategy =</span> <span class="st">&quot;&quot;</span></span>
<span id="cb166-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-42" tabindex="-1"></a>  )</span>
<span id="cb166-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-43" tabindex="-1"></a></span>
<span id="cb166-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-44" tabindex="-1"></a>TAB<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb166-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-45" tabindex="-1"></a></span>
<span id="cb166-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-46" tabindex="-1"></a><span class="cf">for</span> (rr <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(means)[<span class="dv">1</span>]) {</span>
<span id="cb166-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-47" tabindex="-1"></a>  </span>
<span id="cb166-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-48" tabindex="-1"></a>  TAB<span class="ot">&lt;-</span><span class="fu">rbind</span>(TAB,</span>
<span id="cb166-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-49" tabindex="-1"></a>             means[rr,],</span>
<span id="cb166-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-50" tabindex="-1"></a>             sds[rr,],</span>
<span id="cb166-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-51" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&quot;  &quot;</span>,<span class="dv">4</span>)</span>
<span id="cb166-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-52" tabindex="-1"></a>             )</span>
<span id="cb166-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-53" tabindex="-1"></a>}</span>
<span id="cb166-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-54" tabindex="-1"></a></span>
<span id="cb166-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-55" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb166-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-56" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Strategy frequencies and tremble probabilities from the most general model allowing for strategy frequencies and tremble probabilities to vary by treatment. &quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb166-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-57" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb166-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb166-58" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot;&quot;</span>,<span class="st">&quot;Treatment&quot;</span><span class="ot">=</span><span class="dv">3</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:Anwar2024results">Table 12.2: </span>Strategy frequencies and tremble probabilities from the most general model allowing for strategy frequencies and tremble probabilities to vary by treatment.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
Treatment
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
strategy
</th>
<th style="text-align:left;">
1
</th>
<th style="text-align:left;">
2
</th>
<th style="text-align:left;">
3
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
G&amp;M
</td>
<td style="text-align:left;">
0.186
</td>
<td style="text-align:left;">
0.252
</td>
<td style="text-align:left;">
0.142
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.069)
</td>
<td style="text-align:left;">
(0.091)
</td>
<td style="text-align:left;">
(0.093)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Free rider
</td>
<td style="text-align:left;">
0.083
</td>
<td style="text-align:left;">
0.112
</td>
<td style="text-align:left;">
0.144
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.045)
</td>
<td style="text-align:left;">
(0.051)
</td>
<td style="text-align:left;">
(0.092)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Altruist
</td>
<td style="text-align:left;">
0.312
</td>
<td style="text-align:left;">
0.392
</td>
<td style="text-align:left;">
0.097
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.079)
</td>
<td style="text-align:left;">
(0.091)
</td>
<td style="text-align:left;">
(0.056)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
Conditional cooperator
</td>
<td style="text-align:left;">
0.419
</td>
<td style="text-align:left;">
0.244
</td>
<td style="text-align:left;">
0.616
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.088)
</td>
<td style="text-align:left;">
(0.078)
</td>
<td style="text-align:left;">
(0.087)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\epsilon\)</span>
</td>
<td style="text-align:left;">
0.136
</td>
<td style="text-align:left;">
0.109
</td>
<td style="text-align:left;">
0.182
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
(0.013)
</td>
<td style="text-align:left;">
(0.015)
</td>
<td style="text-align:left;">
(0.014)
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>In Table <a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#tab:Anwar2024postprobs">12.3</a> I show the five models’ posterior probabilities assuming equal prior probabilities. Here we can see most starkly that the final two models do <em>not</em> organize the data well relative to the others. Specifically (i) the G&amp;M strategy on its own does not do well, and (ii) eliminating the G&amp;M strategy only does not do well. Of the remaining models, the most general does the best, but the support for this unrestricted model is not overwhelming. It seems that assuming that strategy frequencies are common across all thre treatments is not too terrible of a restriction.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-1" tabindex="-1"></a>postprobs<span class="ot">&lt;-</span><span class="st">&quot;Code/Anwar2024/postprobs.rds&quot;</span><span class="sc">|&gt;</span> <span class="fu">readRDS</span>()</span>
<span id="cb167-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-2" tabindex="-1"></a></span>
<span id="cb167-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-3" tabindex="-1"></a>TAB<span class="ot">&lt;-</span><span class="fu">tibble</span>(</span>
<span id="cb167-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-4" tabindex="-1"></a>  <span class="at">model =</span> <span class="fu">c</span>(<span class="st">&quot;Unrestricted&quot;</span>,<span class="st">&quot;Pooled frequencies&quot;</span>,<span class="st">&quot;Pooled frequencies and trembles&quot;</span>,<span class="st">&quot;G&amp;M strategy only&quot;</span>,<span class="st">&quot;Excluding G&amp;M strategy&quot;</span>),</span>
<span id="cb167-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-5" tabindex="-1"></a>  <span class="st">`</span><span class="at">posterior probability</span><span class="st">`</span> <span class="ot">=</span> postprobs</span>
<span id="cb167-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-6" tabindex="-1"></a>)</span>
<span id="cb167-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-7" tabindex="-1"></a></span>
<span id="cb167-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-8" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb167-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-9" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits=</span><span class="dv">3</span>,<span class="at">caption =</span> <span class="st">&quot;Model posterior probabilities assuming equal prior probabilities. &quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb167-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb167-10" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:Anwar2024postprobs">Table 12.3: </span>Model posterior probabilities assuming equal prior probabilities.
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:right;">
posterior probability
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Unrestricted
</td>
<td style="text-align:right;">
0.548
</td>
</tr>
<tr>
<td style="text-align:left;">
Pooled frequencies
</td>
<td style="text-align:right;">
0.204
</td>
</tr>
<tr>
<td style="text-align:left;">
Pooled frequencies and trembles
</td>
<td style="text-align:right;">
0.247
</td>
</tr>
<tr>
<td style="text-align:left;">
G&amp;M strategy only
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
<tr>
<td style="text-align:left;">
Excluding G&amp;M strategy
</td>
<td style="text-align:right;">
0.000
</td>
</tr>
</tbody>
</table>
</div>
<div id="r-code-used-to-estimate-the-models" class="section level2 hasAnchor" number="12.5">
<h2><span class="header-section-number">12.5</span> <em>R</em> code used to estimate the models<a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb168-2"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb168-3"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-3" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb168-4"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-4" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb168-5"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-5" tabindex="-1"></a><span class="fu">library</span>(bridgesampling)</span>
<span id="cb168-6"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-6" tabindex="-1"></a></span>
<span id="cb168-7"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-7" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------</span></span>
<span id="cb168-8"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-8" tabindex="-1"></a><span class="co"># Here I am following &quot;SFEM.R&quot; in the replication files to wrangle the data</span></span>
<span id="cb168-9"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-9" tabindex="-1"></a></span>
<span id="cb168-10"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-10" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="st">&quot;Data/AG2024PositionUncertainty.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb168-11"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-11" tabindex="-1"></a>  <span class="fu">read.csv</span>()</span>
<span id="cb168-12"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-12" tabindex="-1"></a>dt2<span class="ot">=</span>data[data<span class="sc">$</span>treatment<span class="sc">==</span><span class="dv">2</span>,]</span>
<span id="cb168-13"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-13" tabindex="-1"></a>dt3<span class="ot">=</span>data[data<span class="sc">$</span>treatment<span class="sc">==</span><span class="dv">3</span>,]</span>
<span id="cb168-14"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-14" tabindex="-1"></a>dt4<span class="ot">=</span>data[data<span class="sc">$</span>treatment<span class="sc">==</span><span class="dv">4</span>,]</span>
<span id="cb168-15"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-15" tabindex="-1"></a></span>
<span id="cb168-16"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-16" tabindex="-1"></a>t2<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb168-17"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-17" tabindex="-1"></a><span class="co">#Order the data per treatment, player, round and position.</span></span>
<span id="cb168-18"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-18" tabindex="-1"></a><span class="cf">for</span> (round <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb168-19"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-19" tabindex="-1"></a>  position<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.id_in_group&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-20"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-20" tabindex="-1"></a>  c0p1<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.response_0p1&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-21"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-21" tabindex="-1"></a>  c0p2<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.response_0p2&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-22"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-22" tabindex="-1"></a>  c0p34<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.response_0p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-23"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-23" tabindex="-1"></a>  c1p2<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.response_1p2&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-24"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-24" tabindex="-1"></a>  c1p34<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.response_1p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]  </span>
<span id="cb168-25"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-25" tabindex="-1"></a>  c2p34<span class="ot">=</span>dt2[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt2)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T2.&quot;</span>,round,<span class="st">&quot;.player.response_2p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-26"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-26" tabindex="-1"></a>  </span>
<span id="cb168-27"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-27" tabindex="-1"></a>  </span>
<span id="cb168-28"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-28" tabindex="-1"></a>  t2<span class="ot">=</span><span class="fu">rbind</span>(t2,<span class="fu">cbind</span>(<span class="at">sbj=</span>dt2<span class="sc">$</span>sbj,<span class="at">treatment=</span><span class="fu">rep</span>(<span class="dv">2</span>,<span class="dv">32</span>),position,<span class="at">rnd=</span><span class="fu">rep</span>(round,<span class="dv">32</span>),c0p1,c0p2,c0p34,c1p2,c1p34,c2p34))</span>
<span id="cb168-29"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-29" tabindex="-1"></a>}</span>
<span id="cb168-30"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-30" tabindex="-1"></a></span>
<span id="cb168-31"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-31" tabindex="-1"></a></span>
<span id="cb168-32"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-32" tabindex="-1"></a></span>
<span id="cb168-33"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-33" tabindex="-1"></a>t3<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb168-34"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-34" tabindex="-1"></a><span class="co">#Order the data per treatment, player, round and position.</span></span>
<span id="cb168-35"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-35" tabindex="-1"></a><span class="cf">for</span> (round <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb168-36"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-36" tabindex="-1"></a>  position<span class="ot">=</span>dt3[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt3)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T3.&quot;</span>,round,<span class="st">&quot;.player.id_in_group&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-37"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-37" tabindex="-1"></a>  c0p1<span class="ot">=</span>dt3[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt3)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T3.&quot;</span>,round,<span class="st">&quot;.player.response_0p1&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-38"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-38" tabindex="-1"></a>  c0p2<span class="ot">=</span>dt3[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt3)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T3.&quot;</span>,round,<span class="st">&quot;.player.response_0p2&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-39"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-39" tabindex="-1"></a>  c0p34<span class="ot">=</span>dt3[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt3)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T3.&quot;</span>,round,<span class="st">&quot;.player.response_0p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-40"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-40" tabindex="-1"></a>  c1p2<span class="ot">=</span>dt3[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt3)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T3.&quot;</span>,round,<span class="st">&quot;.player.response_1p2&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-41"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-41" tabindex="-1"></a>  c1p34<span class="ot">=</span>dt3[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt3)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T3.&quot;</span>,round,<span class="st">&quot;.player.response_1p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))] </span>
<span id="cb168-42"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-42" tabindex="-1"></a>  </span>
<span id="cb168-43"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-43" tabindex="-1"></a>  t3<span class="ot">=</span><span class="fu">rbind</span>(t3,<span class="fu">cbind</span>(<span class="at">sbj=</span>dt3<span class="sc">$</span>sbj,<span class="at">treatment=</span><span class="fu">rep</span>(<span class="dv">3</span>,<span class="dv">32</span>),position,<span class="at">rnd=</span><span class="fu">rep</span>(round,<span class="dv">32</span>),c0p1,c0p2,c0p34,c1p2,c1p34))</span>
<span id="cb168-44"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-44" tabindex="-1"></a>}</span>
<span id="cb168-45"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-45" tabindex="-1"></a></span>
<span id="cb168-46"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-46" tabindex="-1"></a></span>
<span id="cb168-47"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-47" tabindex="-1"></a></span>
<span id="cb168-48"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-48" tabindex="-1"></a>t4<span class="ot">=</span><span class="fu">c</span>()</span>
<span id="cb168-49"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-49" tabindex="-1"></a><span class="co">#Order the data per treatment, player, round and position.</span></span>
<span id="cb168-50"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-50" tabindex="-1"></a><span class="cf">for</span> (round <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>){</span>
<span id="cb168-51"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-51" tabindex="-1"></a>  position<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.id_in_group&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-52"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-52" tabindex="-1"></a>  c0p1<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.response_0p1&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-53"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-53" tabindex="-1"></a>  c0p2<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.response_0p2&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-54"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-54" tabindex="-1"></a>  c0p34<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.response_0p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-55"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-55" tabindex="-1"></a>  c1p2<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.response_1p2&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-56"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-56" tabindex="-1"></a>  c1p34<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.response_1p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]  </span>
<span id="cb168-57"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-57" tabindex="-1"></a>  c2p34<span class="ot">=</span>dt4[,<span class="fu">which</span>(<span class="fu">colnames</span>(dt4)<span class="sc">==</span><span class="fu">paste</span>(<span class="st">&quot;pg_T4.&quot;</span>,round,<span class="st">&quot;.player.response_2p34&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>))]</span>
<span id="cb168-58"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-58" tabindex="-1"></a>  </span>
<span id="cb168-59"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-59" tabindex="-1"></a>  t4<span class="ot">=</span><span class="fu">rbind</span>(t4,<span class="fu">cbind</span>(<span class="at">sbj=</span>dt4<span class="sc">$</span>sbj,<span class="at">treatment=</span><span class="fu">rep</span>(<span class="dv">4</span>,<span class="dv">32</span>),position,<span class="at">rnd=</span><span class="fu">rep</span>(round,<span class="dv">32</span>),c0p1,c0p2,c0p34,c1p2,c1p34,c2p34))</span>
<span id="cb168-60"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-60" tabindex="-1"></a>}</span>
<span id="cb168-61"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-61" tabindex="-1"></a></span>
<span id="cb168-62"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-62" tabindex="-1"></a></span>
<span id="cb168-63"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-63" tabindex="-1"></a>t2<span class="ot">=</span><span class="fu">data.frame</span>(t2)</span>
<span id="cb168-64"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-64" tabindex="-1"></a>t3<span class="ot">=</span><span class="fu">data.frame</span>(t3)</span>
<span id="cb168-65"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-65" tabindex="-1"></a>t4<span class="ot">=</span><span class="fu">data.frame</span>(t4)</span>
<span id="cb168-66"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-66" tabindex="-1"></a>sbj2<span class="ot">=</span><span class="fu">unique</span>(t2<span class="sc">$</span>sbj)</span>
<span id="cb168-67"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-67" tabindex="-1"></a>sbj3<span class="ot">=</span><span class="fu">unique</span>(t3<span class="sc">$</span>sbj)</span>
<span id="cb168-68"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-68" tabindex="-1"></a>sbj4<span class="ot">=</span><span class="fu">unique</span>(t4<span class="sc">$</span>sbj)</span>
<span id="cb168-69"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-69" tabindex="-1"></a></span>
<span id="cb168-70"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-70" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb168-71"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-71" tabindex="-1"></a><span class="co"># JB&#39;s code starts here</span></span>
<span id="cb168-72"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-72" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb168-73"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-73" tabindex="-1"></a></span>
<span id="cb168-74"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-74" tabindex="-1"></a><span class="co"># Get data into long summarized form</span></span>
<span id="cb168-75"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-75" tabindex="-1"></a></span>
<span id="cb168-76"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-76" tabindex="-1"></a>D<span class="ot">&lt;-</span>t2 <span class="sc">|&gt;</span></span>
<span id="cb168-77"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-77" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> c0p1<span class="sc">:</span>c2p34) <span class="sc">|&gt;</span></span>
<span id="cb168-78"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-78" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb168-79"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-79" tabindex="-1"></a>    t3 <span class="sc">|&gt;</span></span>
<span id="cb168-80"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-80" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="at">cols =</span> c0p1<span class="sc">:</span>c1p34)</span>
<span id="cb168-81"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-81" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb168-82"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-82" tabindex="-1"></a>  <span class="fu">rbind</span>(</span>
<span id="cb168-83"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-83" tabindex="-1"></a>    t4 <span class="sc">|&gt;</span></span>
<span id="cb168-84"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-84" tabindex="-1"></a>      <span class="fu">pivot_longer</span>(<span class="at">cols =</span> c0p1<span class="sc">:</span>c2p34)</span>
<span id="cb168-85"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-85" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb168-86"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-86" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb168-87"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-87" tabindex="-1"></a>    <span class="at">coop =</span> value<span class="sc">==</span><span class="dv">10</span></span>
<span id="cb168-88"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-88" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb168-89"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-89" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(coop)) <span class="sc">|&gt;</span></span>
<span id="cb168-90"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-90" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>value) <span class="sc">|&gt;</span></span>
<span id="cb168-91"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-91" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb168-92"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-92" tabindex="-1"></a>    <span class="at">pos =</span> <span class="fu">str_split_i</span>(name,<span class="st">&quot;p&quot;</span>,<span class="dv">2</span>),</span>
<span id="cb168-93"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-93" tabindex="-1"></a>    <span class="at">history_length =</span> <span class="fu">ifelse</span>(pos<span class="sc">==</span><span class="st">&quot;1&quot;</span>,<span class="dv">0</span>,<span class="fu">nchar</span>(pos)),</span>
<span id="cb168-94"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-94" tabindex="-1"></a>    <span class="at">history_coop =</span> <span class="fu">str_split_i</span>(name,<span class="st">&quot;p&quot;</span>,<span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">parse_number</span>()</span>
<span id="cb168-95"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-95" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb168-96"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-96" tabindex="-1"></a>  <span class="fu">group_by</span>(sbj,treatment,history_length,history_coop) <span class="sc">|&gt;</span></span>
<span id="cb168-97"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-97" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb168-98"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-98" tabindex="-1"></a>    <span class="at">coop_count =</span> <span class="fu">sum</span>(coop),</span>
<span id="cb168-99"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-99" tabindex="-1"></a>    <span class="at">action_count =</span> <span class="fu">n</span>()</span>
<span id="cb168-100"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-100" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb168-101"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-101" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb168-102"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-102" tabindex="-1"></a>    <span class="at">treatment =</span> treatment<span class="dv">-1</span>,</span>
<span id="cb168-103"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-103" tabindex="-1"></a>    <span class="at">ps =</span> <span class="fu">paste0</span>(<span class="st">&quot;p&quot;</span>,history_length<span class="sc">+</span><span class="dv">1</span>,<span class="st">&quot;c&quot;</span>,history_coop)</span>
<span id="cb168-104"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-104" tabindex="-1"></a>  )</span>
<span id="cb168-105"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-105" tabindex="-1"></a></span>
<span id="cb168-106"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-106" tabindex="-1"></a>dwide<span class="ot">&lt;-</span> D <span class="sc">|&gt;</span></span>
<span id="cb168-107"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-107" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb168-108"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-108" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(sbj,treatment),</span>
<span id="cb168-109"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-109" tabindex="-1"></a>    <span class="at">names_from =</span> ps,</span>
<span id="cb168-110"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-110" tabindex="-1"></a>    <span class="at">values_from =</span> <span class="fu">c</span>(coop_count,action_count),</span>
<span id="cb168-111"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-111" tabindex="-1"></a>    <span class="at">values_fill =</span> <span class="dv">0</span></span>
<span id="cb168-112"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-112" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb168-113"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-113" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb168-114"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-114" tabindex="-1"></a></span>
<span id="cb168-115"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-115" tabindex="-1"></a>t1<span class="ot">&lt;-</span>dwide <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span><span class="dv">1</span>)</span>
<span id="cb168-116"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-116" tabindex="-1"></a>coop_t1<span class="ot">&lt;-</span>t1 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;coop_count&quot;</span>))</span>
<span id="cb168-117"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-117" tabindex="-1"></a>count_t1<span class="ot">&lt;-</span>t1 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;action_count&quot;</span>))</span>
<span id="cb168-118"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-118" tabindex="-1"></a></span>
<span id="cb168-119"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-119" tabindex="-1"></a>t2<span class="ot">&lt;-</span>dwide <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span><span class="dv">2</span>)</span>
<span id="cb168-120"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-120" tabindex="-1"></a>coop_t2<span class="ot">&lt;-</span>t2 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;coop_count&quot;</span>))</span>
<span id="cb168-121"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-121" tabindex="-1"></a>count_t2<span class="ot">&lt;-</span>t2 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;action_count&quot;</span>))</span>
<span id="cb168-122"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-122" tabindex="-1"></a></span>
<span id="cb168-123"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-123" tabindex="-1"></a>t3<span class="ot">&lt;-</span>dwide <span class="sc">|&gt;</span> <span class="fu">filter</span>(treatment<span class="sc">==</span><span class="dv">3</span>)</span>
<span id="cb168-124"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-124" tabindex="-1"></a>coop_t3<span class="ot">&lt;-</span>t3 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;coop_count&quot;</span>))</span>
<span id="cb168-125"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-125" tabindex="-1"></a>count_t3<span class="ot">&lt;-</span>t3 <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="fu">contains</span>(<span class="st">&quot;action_count&quot;</span>))</span>
<span id="cb168-126"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-126" tabindex="-1"></a></span>
<span id="cb168-127"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-127" tabindex="-1"></a></span>
<span id="cb168-128"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-128" tabindex="-1"></a></span>
<span id="cb168-129"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-129" tabindex="-1"></a></span>
<span id="cb168-130"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-130" tabindex="-1"></a><span class="co">#-------------------------------------------------------------------------------</span></span>
<span id="cb168-131"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-131" tabindex="-1"></a></span>
<span id="cb168-132"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-132" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">&quot;Code/Anwar2024/SFEM.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb168-133"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-133" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb168-134"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-134" tabindex="-1"></a></span>
<span id="cb168-135"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-135" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb168-136"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-136" tabindex="-1"></a>  </span>
<span id="cb168-137"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-137" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fl">0.528</span>,</span>
<span id="cb168-138"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-138" tabindex="-1"></a>  </span>
<span id="cb168-139"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-139" tabindex="-1"></a>  <span class="at">n_t1 =</span> <span class="fu">dim</span>(coop_t1)[<span class="dv">1</span>],</span>
<span id="cb168-140"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-140" tabindex="-1"></a>  <span class="at">coop_t1 =</span> coop_t1,</span>
<span id="cb168-141"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-141" tabindex="-1"></a>  <span class="at">count_t1 =</span> count_t1,</span>
<span id="cb168-142"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-142" tabindex="-1"></a>  </span>
<span id="cb168-143"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-143" tabindex="-1"></a>  <span class="at">n_t2 =</span> <span class="fu">dim</span>(coop_t2)[<span class="dv">1</span>],</span>
<span id="cb168-144"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-144" tabindex="-1"></a>  <span class="at">coop_t2 =</span> coop_t2,</span>
<span id="cb168-145"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-145" tabindex="-1"></a>  <span class="at">count_t2 =</span> count_t2,</span>
<span id="cb168-146"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-146" tabindex="-1"></a>  </span>
<span id="cb168-147"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-147" tabindex="-1"></a>  <span class="at">n_t3 =</span> <span class="fu">dim</span>(coop_t3)[<span class="dv">1</span>],</span>
<span id="cb168-148"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-148" tabindex="-1"></a>  <span class="at">coop_t3 =</span> coop_t3,</span>
<span id="cb168-149"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-149" tabindex="-1"></a>  <span class="at">count_t3 =</span> count_t3,</span>
<span id="cb168-150"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-150" tabindex="-1"></a>  </span>
<span id="cb168-151"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-151" tabindex="-1"></a>  <span class="at">prior_mix =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb168-152"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-152" tabindex="-1"></a>  <span class="at">prior_eps =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb168-153"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-153" tabindex="-1"></a>)</span>
<span id="cb168-154"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-154" tabindex="-1"></a></span>
<span id="cb168-155"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-155" tabindex="-1"></a>Fit<span class="ot">&lt;-</span>model <span class="sc">|&gt;</span></span>
<span id="cb168-156"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-156" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb168-157"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-157" tabindex="-1"></a></span>
<span id="cb168-158"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-158" tabindex="-1"></a></span>
<span id="cb168-159"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-159" tabindex="-1"></a></span>
<span id="cb168-160"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-160" tabindex="-1"></a>model_pooledfreq<span class="ot">&lt;-</span><span class="st">&quot;Code/Anwar2024/SFEM_pooledfrequencies.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb168-161"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-161" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb168-162"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-162" tabindex="-1"></a></span>
<span id="cb168-163"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-163" tabindex="-1"></a>Fit_pooledfreq<span class="ot">&lt;-</span>model_pooledfreq <span class="sc">|&gt;</span></span>
<span id="cb168-164"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-164" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb168-165"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-165" tabindex="-1"></a></span>
<span id="cb168-166"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-166" tabindex="-1"></a>model_pooledall<span class="ot">&lt;-</span><span class="st">&quot;Code/Anwar2024/SFEM_pooledall.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb168-167"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-167" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb168-168"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-168" tabindex="-1"></a></span>
<span id="cb168-169"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-169" tabindex="-1"></a>Fit_pooledall<span class="ot">&lt;-</span>model_pooledall <span class="sc">|&gt;</span></span>
<span id="cb168-170"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-170" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb168-171"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-171" tabindex="-1"></a></span>
<span id="cb168-172"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-172" tabindex="-1"></a>model_strg1only<span class="ot">&lt;-</span><span class="st">&quot;Code/Anwar2024/SFEM_strg1only.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb168-173"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-173" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb168-174"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-174" tabindex="-1"></a></span>
<span id="cb168-175"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-175" tabindex="-1"></a>Fit_strg1only<span class="ot">&lt;-</span>model_strg1only <span class="sc">|&gt;</span></span>
<span id="cb168-176"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-176" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb168-177"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-177" tabindex="-1"></a></span>
<span id="cb168-178"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-178" tabindex="-1"></a>model_notGM<span class="ot">&lt;-</span><span class="st">&quot;Code/Anwar2024/SFEM_notGM.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb168-179"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-179" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb168-180"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-180" tabindex="-1"></a></span>
<span id="cb168-181"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-181" tabindex="-1"></a>Fit_notGM<span class="ot">&lt;-</span>model_notGM <span class="sc">|&gt;</span></span>
<span id="cb168-182"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-182" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb168-183"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-183" tabindex="-1"></a></span>
<span id="cb168-184"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-184" tabindex="-1"></a>bs_unrestricted<span class="ot">&lt;-</span>Fit <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb168-185"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-185" tabindex="-1"></a>bs_pooledfreq<span class="ot">&lt;-</span>Fit_pooledfreq <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb168-186"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-186" tabindex="-1"></a>bs_pooledall<span class="ot">&lt;-</span>Fit_pooledall <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb168-187"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-187" tabindex="-1"></a>bs_strg1only<span class="ot">&lt;-</span>Fit_strg1only <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb168-188"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-188" tabindex="-1"></a>bs_notGM<span class="ot">&lt;-</span>Fit_notGM <span class="sc">|&gt;</span> <span class="fu">bridge_sampler</span>()</span>
<span id="cb168-189"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-189" tabindex="-1"></a></span>
<span id="cb168-190"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-190" tabindex="-1"></a>Fit <span class="sc">|&gt;</span></span>
<span id="cb168-191"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-191" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/Anwar2024/Fit_SFEM.rds&quot;</span>)</span>
<span id="cb168-192"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-192" tabindex="-1"></a></span>
<span id="cb168-193"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-193" tabindex="-1"></a></span>
<span id="cb168-194"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-194" tabindex="-1"></a>(postprobs<span class="ot">&lt;-</span><span class="fu">post_prob</span>(bs_unrestricted,bs_pooledfreq,bs_pooledall,bs_strg1only,bs_notGM))</span>
<span id="cb168-195"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-195" tabindex="-1"></a></span>
<span id="cb168-196"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-196" tabindex="-1"></a>postprobs <span class="sc">|&gt;</span></span>
<span id="cb168-197"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#cb168-197" tabindex="-1"></a>  <span class="fu">saveRDS</span>(<span class="st">&quot;Code/Anwar2024/postprobs.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Anwar2024" class="csl-entry">
Anwar, Chowdhury Mohammad Sakib, and Konstantinos Georgalos. 2024. <span>“Position Uncertainty in a Sequential Public Goods Game: An Experiment.”</span> <em>Experimental Economics</em>, 1–34.
</div>
<div id="ref-Gallice2019" class="csl-entry">
Gallice, Andrea, and Ignacio Monzón. 2019. <span>“Co-Operation in Social Dilemmas Through Position Uncertainty.”</span> <em>The Economic Journal</em> 129 (621): 2137–54.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="55">
<li id="fn55"><p>This is the same as the original implimentation in <span class="citation">Anwar and Georgalos (<a href="#ref-Anwar2024">2024</a>)</span>. An alternative implementation could be to keep <span class="math inline">\(\tilde\sigma_s\)</span> as it is described above. In this case, the participant mixes <em>and</em> trembles. <a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#fnref55" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-strategy-frequency-estimation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="computing-quantal-response-equilibrium.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
