<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Considerations for choosing a prior | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="4 Considerations for choosing a prior | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Considerations for choosing a prior | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Considerations for choosing a prior | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-03-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="probabilistic-models-of-behavior.html"/>
<link rel="next" href="building-blocks.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>8</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="8.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>8.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="8.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>8.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="8.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>8.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="8.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>8.4</b> Vectorization</a></li>
<li class="chapter" data-level="8.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>8.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="8.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>8.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>8.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="8.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>8.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>8.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>8.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="8.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>8.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="9" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>9</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>9.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="9.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>9.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="9.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>9.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>9.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="9.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>9.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="9.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results"><i class="fa fa-check"></i><b>9.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>9.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>9.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="9.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>9.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="9.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>9.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>9.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>9.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="9.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>9.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="9.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>9.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>10</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>10.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="10.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>10.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>10.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="10.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>10.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>10.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>11</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="11.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>11.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="11.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>11.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>11.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="11.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>11.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="11.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>11.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="11.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>11.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>11.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="11.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>11.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>11.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="11.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>11.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="11.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>11.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>12</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>12.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="12.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>12.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>12.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="12.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>12.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="12.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>12.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="12.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-2"><i class="fa fa-check"></i><b>12.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>12.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>13</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models"><i class="fa fa-check"></i><b>13.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="13.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>13.2</b> A note on replication</a></li>
<li class="chapter" data-level="13.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>13.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>13.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="13.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>13.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="13.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>13.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-3"><i class="fa fa-check"></i><b>13.4</b> Results</a></li>
<li class="chapter" data-level="13.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>13.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>14</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>14.1</b> Data and game</a></li>
<li class="chapter" data-level="14.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>14.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>14.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="14.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>14.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>14.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="14.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>14.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>14.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="14.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-4"><i class="fa fa-check"></i><b>14.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>14.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="14.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>14.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-5"><i class="fa fa-check"></i><b>14.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>14.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="14.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>14.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>14.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="14.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>14.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>14.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>14.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="14.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>14.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>14.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>14.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>14.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="14.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>14.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>14.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="14.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>14.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="14.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>14.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="14.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>14.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="14.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>14.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="14.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>14.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="15" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>15</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="15.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>15.1</b> Example dataset</a></li>
<li class="chapter" data-level="15.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>15.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="15.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>15.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>15.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="15.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>15.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="15.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>15.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>15.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>15.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="15.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>15.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="15.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>15.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>16</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>16.1</b> Data</a></li>
<li class="chapter" data-level="16.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>16.2</b> A basic model</a></li>
<li class="chapter" data-level="16.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>16.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="16.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>16.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="16.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>16.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="16.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>16.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>17</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>17.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="17.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>17.2</b> Computational issues</a></li>
<li class="chapter" data-level="17.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>17.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="17.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>17.4</b> A representative agent model</a></li>
<li class="chapter" data-level="17.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>17.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="17.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>17.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="considerations-for-choosing-a-prior" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Considerations for choosing a prior<a href="considerations-for-choosing-a-prior.html#considerations-for-choosing-a-prior" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Conceptually, the Bayesian techniques I am teaching you in the book are very similar to how we would approach the same inferential goals using maximum likelihood estimation.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a> Both work with a likelihood function that specifies the distribution of data given the model’s parameters. The big difference between the two is that when using Bayesian techniques, we also need to specify a prior. That is, the likelihood is our formal statement about how our model’s parameters and the experiment generate data, and the prior is our formal statement about how much uncertainty we have about our model’s parameters before running an experiment. Whether we have had a good hard think about the prior we want to use, whether we have just thrown up our hands and gone for an improper “uninformative” flat prior, or anything in between, these are modeling choices. We should therefore pay at least some attention to our priors, and how they affect our estimates. This is especially the case for economic experiments, where sample sizes can be relatively small, and so the prior may still have substantial influence over the posterior.</p>
<p>We can assess our priors in several ways. If we want to take a stand on priors representing our <em>actual prior beliefs</em> about the uncertainty in our parameters, we can calibrate our priors using our expert knowledge of what reasonable and unreasonable parameter values are. For example, this could include choosing distributions that pin down what we think are reasonable 5% and 95% lower and upper bounds on the parameters.<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a> We can also scrutinize our priors on <em>parameters</em> to check that they say about behavior. For example, we may check to see whether our calibrated prior makes reasonable predictions for behavior in the experiment. This might be useful if we are very uncertain about what reasonable values of our parameters are, but we have a better idea of what behavior might look like. Additionally, we can assess our prior’s performance in recovering the parameters of the model. That is, is there a prior that results in an estimator with better sampling properties than other choices?</p>
<p>A prior is useful not just in the <em>estimation</em> stage of our research, but also in the <em>design</em> stage. Priors can be immensely useful for tuning an experiment to best estimate our parameters of interest. A prior that actually reflects what we believe are plausible parameter values can help us choose experimental conditions that are the most informative of these parameters. This chapter is focused on ways for us to <em>select</em> a prior, not how to use it to design an experiment. I will devote a chapter to this at some point.</p>
<div id="example-model-and-experiment" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Example model and experiment<a href="considerations-for-choosing-a-prior.html#example-model-and-experiment" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For this chapter I will use as an example the modified dictator game part of <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019">2019</a>)</span>, where participants made 78 pairwise choices of allocations between themselves and another participant. For this chapter, we will focus on estimating a simple one-parameter<a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> other-regarding utility function:</p>
<p><span class="math display">\[
\begin{aligned}
U(\pi_1,\pi_2,\alpha)&amp;=\alpha\pi_1+(1-\alpha)\pi_2,\quad0\leq \alpha \leq 1
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span> are the payoffs of the self and the other, respectively, and <span class="math inline">\(\alpha\in[0,1]\)</span> is the weight placed on the self’s payoff. Hence, <span class="math inline">\(\alpha=1\)</span> corresponds to self-regarding preferences. We will also assume a logit probabilistic choice rule with choice precision <span class="math inline">\(\lambda&gt;0\)</span>. Given the two allocations <span class="math inline">\((\pi_1^X,\pi_2^X)\)</span> and <span class="math inline">\((\pi_1^Y,\pi_2^Y)\)</span>, we can write the likelihood as:</p>
<p><span class="math display">\[
\begin{aligned}
p(y_t=1\mid \alpha,\lambda,\pi_t)&amp;=\Lambda\left(\lambda\left(\alpha\pi_{t,1}^X+(1-\alpha)\pi_{t,2}^X-\alpha\pi_{t,1}^Y-(1-\alpha)\pi_{t,2}^Y\right)\right)\\
&amp;=\Lambda\left(\lambda\left(\alpha(\pi_{t,1}^X-\pi_{t,1}^Y)+(1-\alpha)(\pi_{t,2}^X-\pi_{t,2}^Y)\right)\right)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(y_t=1\)</span> iff allocation <span class="math inline">\(X\)</span> is chosen in decision <span class="math inline">\(t\)</span>, zero otherwise. <span class="math inline">\(\Lambda(x)=(1+\exp(-x))^{-1}\)</span> is the inverse logit function.</p>
<p>The 78 pairwise choices in <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019">2019</a>)</span> are shown in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsBFS2019">4.1</a>. Each line segment represents a pairwise choice, with the coordinates of the endpoints showing the two allocations.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="considerations-for-choosing-a-prior.html#cb42-1" tabindex="-1"></a>d1<span class="ot">&lt;-</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data/BFS2019_choices_exp1.csv&quot;</span>)</span>
<span id="cb42-2"><a href="considerations-for-choosing-a-prior.html#cb42-2" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">experiment=</span><span class="dv">1</span>)</span>
<span id="cb42-3"><a href="considerations-for-choosing-a-prior.html#cb42-3" tabindex="-1"></a>)</span>
<span id="cb42-4"><a href="considerations-for-choosing-a-prior.html#cb42-4" tabindex="-1"></a>d2<span class="ot">&lt;-</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data/BFS2019_choices_exp2.csv&quot;</span>)</span>
<span id="cb42-5"><a href="considerations-for-choosing-a-prior.html#cb42-5" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">experiment=</span><span class="dv">2</span>)    </span>
<span id="cb42-6"><a href="considerations-for-choosing-a-prior.html#cb42-6" tabindex="-1"></a>)</span>
<span id="cb42-7"><a href="considerations-for-choosing-a-prior.html#cb42-7" tabindex="-1"></a>D<span class="ot">&lt;-</span>(<span class="fu">rbind</span>(d1,d2)</span>
<span id="cb42-8"><a href="considerations-for-choosing-a-prior.html#cb42-8" tabindex="-1"></a>     <span class="co"># Just use the dictator game data</span></span>
<span id="cb42-9"><a href="considerations-for-choosing-a-prior.html#cb42-9" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">filter</span>(dg<span class="sc">==</span><span class="dv">1</span>)  </span>
<span id="cb42-10"><a href="considerations-for-choosing-a-prior.html#cb42-10" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb42-11"><a href="considerations-for-choosing-a-prior.html#cb42-11" tabindex="-1"></a>       <span class="at">self_alloc =</span> <span class="fu">ifelse</span>(choice_x<span class="sc">==</span><span class="dv">1</span>,self_x,self_y),</span>
<span id="cb42-12"><a href="considerations-for-choosing-a-prior.html#cb42-12" tabindex="-1"></a>       <span class="at">other_alloc =</span> <span class="fu">ifelse</span>(choice_x<span class="sc">==</span><span class="dv">1</span>,other_x,other_y)</span>
<span id="cb42-13"><a href="considerations-for-choosing-a-prior.html#cb42-13" tabindex="-1"></a>     )</span>
<span id="cb42-14"><a href="considerations-for-choosing-a-prior.html#cb42-14" tabindex="-1"></a>)</span>
<span id="cb42-15"><a href="considerations-for-choosing-a-prior.html#cb42-15" tabindex="-1"></a></span>
<span id="cb42-16"><a href="considerations-for-choosing-a-prior.html#cb42-16" tabindex="-1"></a><span class="co"># We just need one participant&#39;s data because everything in this chapter will be simulation</span></span>
<span id="cb42-17"><a href="considerations-for-choosing-a-prior.html#cb42-17" tabindex="-1"></a>BFS2019<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span> <span class="fu">filter</span>(sid<span class="sc">==</span><span class="dv">102010050706</span>)</span>
<span id="cb42-18"><a href="considerations-for-choosing-a-prior.html#cb42-18" tabindex="-1"></a></span>
<span id="cb42-19"><a href="considerations-for-choosing-a-prior.html#cb42-19" tabindex="-1"></a>(</span>
<span id="cb42-20"><a href="considerations-for-choosing-a-prior.html#cb42-20" tabindex="-1"></a>  <span class="fu">ggplot</span>(</span>
<span id="cb42-21"><a href="considerations-for-choosing-a-prior.html#cb42-21" tabindex="-1"></a>    BFS2019,</span>
<span id="cb42-22"><a href="considerations-for-choosing-a-prior.html#cb42-22" tabindex="-1"></a>    </span>
<span id="cb42-23"><a href="considerations-for-choosing-a-prior.html#cb42-23" tabindex="-1"></a>  )</span>
<span id="cb42-24"><a href="considerations-for-choosing-a-prior.html#cb42-24" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>self_x,<span class="at">y=</span>other_x,<span class="at">xend=</span>self_y,<span class="at">yend=</span>other_y))</span>
<span id="cb42-25"><a href="considerations-for-choosing-a-prior.html#cb42-25" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb42-26"><a href="considerations-for-choosing-a-prior.html#cb42-26" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Own payoff&quot;</span>)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Other&#39;s payoff&quot;</span>)</span>
<span id="cb42-27"><a href="considerations-for-choosing-a-prior.html#cb42-27" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_abline</span>(<span class="at">slope=</span><span class="dv">1</span>,<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb42-28"><a href="considerations-for-choosing-a-prior.html#cb42-28" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">coord_fixed</span>()</span>
<span id="cb42-29"><a href="considerations-for-choosing-a-prior.html#cb42-29" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsBFS2019"></span>
<img src="index_files/figure-html/PriorsBFS2019-1.png" alt="The 78 pairwise choices over allocations of money in the modified dictator game. Each pariwise choice is denoted by the endpoints of a line." width="672" />
<p class="caption">
Figure 4.1: The 78 pairwise choices over allocations of money in the modified dictator game. Each pariwise choice is denoted by the endpoints of a line.
</p>
</div>
</div>
<div id="getting-the-support-right" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Getting the support right<a href="considerations-for-choosing-a-prior.html#getting-the-support-right" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To begin with, we need to choose which <em>family</em> of distributions we will use for our prior. This is where we rule out any nonsensical values, and make sure we do <em>not</em> rule out anything that could be reasonable. For example, if a parameter could in principle take on any real number, then a normal distribution makes sense. This allows us the freedom of choosing two properties of the prior distribution (the mean and standard deviation) to appropriately express our prior uncertainty in a parameter.</p>
<p>For the preference parameter <span class="math inline">\(\alpha\)</span>, we have been given the restriction <span class="math inline">\(\alpha\in[0,1]\)</span>, so here we need to choose a distribution that has a support of the unit interval. In this case, choosing something like the Beta distribution:</p>
<p><span class="math display">\[
\alpha\sim B(a_\alpha,b_\alpha)
\]</span></p>
<p>the probit-normal distribution:</p>
<p><span class="math display">\[
\Phi^{-1}(\alpha)\sim N(m_\alpha,s_\alpha^2)
\]</span>
or the logit-normal distribution:</p>
<p><span class="math display">\[
\log(\alpha)-\log(1-\alpha)\sim N(m_\alpha,s^2_\alpha)
\]</span></p>
<p>could be reasonable choices, as they all permit us to independently choose two properties of the distribution. Furthermore, if the <em>uniform</em> distribution is something we would want to consider using, the Beta distribution (setting <span class="math inline">\(a_\alpha=b_\alpha=1\)</span>) and the probit-normal distribution (setting <span class="math inline">\(m_\alpha=0\)</span>, <span class="math inline">\(s_\alpha=1\)</span>) nest this distribution, so these may be useful choices. For this example, I will choose the probit-normal distribution, as I use it quite commonly in my hierarchical models when I need to make this parameter restriction on an individual-level parameter.</p>
<p>For the choice precision parameter <span class="math inline">\(\lambda\)</span>, we need to ensure that it is positive: negative values would imply that participants are <em>less</em> likely to choose the action with the greater utility, which is nonsensical. A good choice in this instance is the log-normal distribution. Again, this permits us to independently pin down two properties of the distribution.</p>
<p><span class="math display">\[
\log\lambda\sim N(m_\lambda,s^2_\lambda)
\]</span></p>
<p>With the likelihood and the family of prior specified, we can go ahead and code this model up in <em>Stan</em>. This will be useful even before we have data, because we can use the <em>Stan</em> model to simulate data and explore the sampling properties of our estimator. Here you will see a few extras added to the model so we can do some more with it. In particular the <code>UseData</code> variable lets us turn the likelihood contribution on or off. That way we can get draws from both the prior and the posterior with the same model. Also, the <code>UsePrior</code> variable turns the prior on and off. This will enable us to see what happens when we use improper, flat, “uninformative” priors. It will also permit us to do maximum likelihood estimation.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb43-1"><a href="considerations-for-choosing-a-prior.html#cb43-1" tabindex="-1"></a></span>
<span id="cb43-2"><a href="considerations-for-choosing-a-prior.html#cb43-2" tabindex="-1"></a><span class="co">// BFS2019priors.stan</span></span>
<span id="cb43-3"><a href="considerations-for-choosing-a-prior.html#cb43-3" tabindex="-1"></a></span>
<span id="cb43-4"><a href="considerations-for-choosing-a-prior.html#cb43-4" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb43-5"><a href="considerations-for-choosing-a-prior.html#cb43-5" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> n<span class="op">;</span> <span class="co">// number of decisions</span></span>
<span id="cb43-6"><a href="considerations-for-choosing-a-prior.html#cb43-6" tabindex="-1"></a>  <span class="dt">int</span> y<span class="op">[</span>n<span class="op">];</span> <span class="co">// choices. 1=X, 0=Y</span></span>
<span id="cb43-7"><a href="considerations-for-choosing-a-prior.html#cb43-7" tabindex="-1"></a>  </span>
<span id="cb43-8"><a href="considerations-for-choosing-a-prior.html#cb43-8" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> self_x<span class="op">;</span> <span class="co">// payoff to self with allocation x</span></span>
<span id="cb43-9"><a href="considerations-for-choosing-a-prior.html#cb43-9" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> other_x<span class="op">;</span> <span class="co">// payoff to other with allocation x</span></span>
<span id="cb43-10"><a href="considerations-for-choosing-a-prior.html#cb43-10" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> self_y<span class="op">;</span> <span class="co">// payoff to self with allocation y</span></span>
<span id="cb43-11"><a href="considerations-for-choosing-a-prior.html#cb43-11" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> other_y<span class="op">;</span> <span class="co">// payoff to other with allocation y</span></span>
<span id="cb43-12"><a href="considerations-for-choosing-a-prior.html#cb43-12" tabindex="-1"></a>  </span>
<span id="cb43-13"><a href="considerations-for-choosing-a-prior.html#cb43-13" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb43-14"><a href="considerations-for-choosing-a-prior.html#cb43-14" tabindex="-1"></a>  real prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">];</span> <span class="co">// log-normal</span></span>
<span id="cb43-15"><a href="considerations-for-choosing-a-prior.html#cb43-15" tabindex="-1"></a>  real prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">];</span> <span class="co">// probit-normal</span></span>
<span id="cb43-16"><a href="considerations-for-choosing-a-prior.html#cb43-16" tabindex="-1"></a>  </span>
<span id="cb43-17"><a href="considerations-for-choosing-a-prior.html#cb43-17" tabindex="-1"></a>  <span class="co">// Turns on and off whether we are using the data</span></span>
<span id="cb43-18"><a href="considerations-for-choosing-a-prior.html#cb43-18" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> UseData<span class="op">;</span> </span>
<span id="cb43-19"><a href="considerations-for-choosing-a-prior.html#cb43-19" tabindex="-1"></a>  </span>
<span id="cb43-20"><a href="considerations-for-choosing-a-prior.html#cb43-20" tabindex="-1"></a>  <span class="co">// Turns on or off whether we are using the prior, or </span></span>
<span id="cb43-21"><a href="considerations-for-choosing-a-prior.html#cb43-21" tabindex="-1"></a>  <span class="co">// &quot;uninformative&quot; priors</span></span>
<span id="cb43-22"><a href="considerations-for-choosing-a-prior.html#cb43-22" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> UsePrior<span class="op">;</span></span>
<span id="cb43-23"><a href="considerations-for-choosing-a-prior.html#cb43-23" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-24"><a href="considerations-for-choosing-a-prior.html#cb43-24" tabindex="-1"></a></span>
<span id="cb43-25"><a href="considerations-for-choosing-a-prior.html#cb43-25" tabindex="-1"></a></span>
<span id="cb43-26"><a href="considerations-for-choosing-a-prior.html#cb43-26" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb43-27"><a href="considerations-for-choosing-a-prior.html#cb43-27" tabindex="-1"></a>  real probitAlpha<span class="op">;</span></span>
<span id="cb43-28"><a href="considerations-for-choosing-a-prior.html#cb43-28" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb43-29"><a href="considerations-for-choosing-a-prior.html#cb43-29" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-30"><a href="considerations-for-choosing-a-prior.html#cb43-30" tabindex="-1"></a></span>
<span id="cb43-31"><a href="considerations-for-choosing-a-prior.html#cb43-31" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb43-32"><a href="considerations-for-choosing-a-prior.html#cb43-32" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> alpha <span class="op">=</span> Phi<span class="op">(</span>probitAlpha<span class="op">);</span></span>
<span id="cb43-33"><a href="considerations-for-choosing-a-prior.html#cb43-33" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-34"><a href="considerations-for-choosing-a-prior.html#cb43-34" tabindex="-1"></a></span>
<span id="cb43-35"><a href="considerations-for-choosing-a-prior.html#cb43-35" tabindex="-1"></a></span>
<span id="cb43-36"><a href="considerations-for-choosing-a-prior.html#cb43-36" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb43-37"><a href="considerations-for-choosing-a-prior.html#cb43-37" tabindex="-1"></a>  </span>
<span id="cb43-38"><a href="considerations-for-choosing-a-prior.html#cb43-38" tabindex="-1"></a>  <span class="co">// priors</span></span>
<span id="cb43-39"><a href="considerations-for-choosing-a-prior.html#cb43-39" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>UsePrior<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-40"><a href="considerations-for-choosing-a-prior.html#cb43-40" tabindex="-1"></a>    probitAlpha <span class="op">~</span> normal<span class="op">(</span>prior_alpha<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_alpha<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb43-41"><a href="considerations-for-choosing-a-prior.html#cb43-41" tabindex="-1"></a>    lambda <span class="op">~</span> lognormal<span class="op">(</span>prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb43-42"><a href="considerations-for-choosing-a-prior.html#cb43-42" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb43-43"><a href="considerations-for-choosing-a-prior.html#cb43-43" tabindex="-1"></a>  </span>
<span id="cb43-44"><a href="considerations-for-choosing-a-prior.html#cb43-44" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">==</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-45"><a href="considerations-for-choosing-a-prior.html#cb43-45" tabindex="-1"></a>    y <span class="op">~</span> bernoulli_logit<span class="op">(</span>lambda<span class="op">*(</span></span>
<span id="cb43-46"><a href="considerations-for-choosing-a-prior.html#cb43-46" tabindex="-1"></a>      alpha<span class="op">*(</span>self_x<span class="op">-</span>self_y<span class="op">)+(</span><span class="dv">1</span><span class="op">-</span>alpha<span class="op">)*(</span>other_x<span class="op">-</span>other_y<span class="op">)</span></span>
<span id="cb43-47"><a href="considerations-for-choosing-a-prior.html#cb43-47" tabindex="-1"></a>       <span class="op">));</span></span>
<span id="cb43-48"><a href="considerations-for-choosing-a-prior.html#cb43-48" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb43-49"><a href="considerations-for-choosing-a-prior.html#cb43-49" tabindex="-1"></a>  </span>
<span id="cb43-50"><a href="considerations-for-choosing-a-prior.html#cb43-50" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb43-51"><a href="considerations-for-choosing-a-prior.html#cb43-51" tabindex="-1"></a></span>
<span id="cb43-52"><a href="considerations-for-choosing-a-prior.html#cb43-52" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb43-53"><a href="considerations-for-choosing-a-prior.html#cb43-53" tabindex="-1"></a>  </span>
<span id="cb43-54"><a href="considerations-for-choosing-a-prior.html#cb43-54" tabindex="-1"></a>  <span class="co">// predicted probability of choosing allocation X</span></span>
<span id="cb43-55"><a href="considerations-for-choosing-a-prior.html#cb43-55" tabindex="-1"></a>  vector<span class="op">[</span>n<span class="op">]</span> probX <span class="op">=</span> inv_logit<span class="op">(</span>lambda<span class="op">*(</span></span>
<span id="cb43-56"><a href="considerations-for-choosing-a-prior.html#cb43-56" tabindex="-1"></a>      alpha<span class="op">*(</span>self_x<span class="op">-</span>self_y<span class="op">)+(</span><span class="dv">1</span><span class="op">-</span>alpha<span class="op">)*(</span>other_x<span class="op">-</span>other_y<span class="op">)</span></span>
<span id="cb43-57"><a href="considerations-for-choosing-a-prior.html#cb43-57" tabindex="-1"></a>       <span class="op">));</span></span>
<span id="cb43-58"><a href="considerations-for-choosing-a-prior.html#cb43-58" tabindex="-1"></a>  </span>
<span id="cb43-59"><a href="considerations-for-choosing-a-prior.html#cb43-59" tabindex="-1"></a>  <span class="co">// Simulated data, 1 = chose allocation X</span></span>
<span id="cb43-60"><a href="considerations-for-choosing-a-prior.html#cb43-60" tabindex="-1"></a>  <span class="dt">int</span> simX<span class="op">[</span>n<span class="op">]</span> <span class="op">=</span> bernoulli_logit_rng<span class="op">(</span>lambda<span class="op">*(</span></span>
<span id="cb43-61"><a href="considerations-for-choosing-a-prior.html#cb43-61" tabindex="-1"></a>      alpha<span class="op">*(</span>self_x<span class="op">-</span>self_y<span class="op">)+(</span><span class="dv">1</span><span class="op">-</span>alpha<span class="op">)*(</span>other_x<span class="op">-</span>other_y<span class="op">)</span></span>
<span id="cb43-62"><a href="considerations-for-choosing-a-prior.html#cb43-62" tabindex="-1"></a>       <span class="op">));</span></span>
<span id="cb43-63"><a href="considerations-for-choosing-a-prior.html#cb43-63" tabindex="-1"></a>  </span>
<span id="cb43-64"><a href="considerations-for-choosing-a-prior.html#cb43-64" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="eliciting-reasonable-priors" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Eliciting reasonable priors<a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As discussed in detail in <span class="citation">Betancourt (<a href="#ref-Betancourt2020">2020</a>)</span> (Section 1.1), it is important for our models not to be built on assumptions that are in conflict with our “domain expertise”. That is as experts in the field, we may have a reasonable understanding of what are likely and unlikely parameter values before running an experiment, and we should incorporate this information into our prior. However translating a likely qualitative, general understanding of how participants might behave into a mathematical statement about the distribution of some parameters may not be straightforward. Two techniques <span class="citation">Betancourt (<a href="#ref-Betancourt2020">2020</a>)</span> advocates for are the <em>prior pushforward</em> check, which checks whether our prior about a <em>parameter</em> is consistent with our understanding of our participants, and the <em>prior predictive</em> check, which checks whether our prior about a parameter is consistent with our understanding of our prior belief about <em>summaries of the data</em> that we might get. That is, a prior pushforward check is to check whether our chosen prior places too much, or not enough, mass in the wrong places of the parameter’s support, whereas the prior predictive check is to check whether our prior implies something implausible about summaries of our data (such as participants’ choices).</p>
<div id="parameter-values-and-the-prior-pushforward-check" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Parameter values and the prior pushforward check<a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once we have settled on a family of distributions, perhaps the most direct way to hone in on the distribution within that family that we will actually use is by exploring the properties of these distributions. If we are just choosing a prior for a single (i.e. scalar) parameter, then we will most often have only a handful of degrees of freedom in our prior choice once we have selected a family of distributions. For example, the normal and beta families each allow us to independently pin down two properties of the distribution, while the exponential, Cauchy, and LKJ priors only allow for one. It is therefore very feasible to explore the properties of these distributions graphically.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="considerations-for-choosing-a-prior.html#cb44-1" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">expand_grid</span>(</span>
<span id="cb44-2"><a href="considerations-for-choosing-a-prior.html#cb44-2" tabindex="-1"></a>  <span class="at">m =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.4</span>,<span class="dv">0</span>,<span class="fl">0.4</span>,<span class="fl">0.8</span>,<span class="fl">1.2</span>),</span>
<span id="cb44-3"><a href="considerations-for-choosing-a-prior.html#cb44-3" tabindex="-1"></a>  <span class="at">s =</span> <span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb44-4"><a href="considerations-for-choosing-a-prior.html#cb44-4" tabindex="-1"></a>  <span class="at">sim =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span></span>
<span id="cb44-5"><a href="considerations-for-choosing-a-prior.html#cb44-5" tabindex="-1"></a>) <span class="sc">|&gt;</span></span>
<span id="cb44-6"><a href="considerations-for-choosing-a-prior.html#cb44-6" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">|&gt;</span></span>
<span id="cb44-7"><a href="considerations-for-choosing-a-prior.html#cb44-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">alpha =</span> <span class="fu">rnorm</span>(<span class="dv">1</span>,<span class="at">mean=</span>m,<span class="at">sd=</span>s) <span class="sc">|&gt;</span> <span class="fu">pnorm</span>()) <span class="sc">|&gt;</span></span>
<span id="cb44-8"><a href="considerations-for-choosing-a-prior.html#cb44-8" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb44-9"><a href="considerations-for-choosing-a-prior.html#cb44-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mtag =</span> <span class="fu">paste</span>(<span class="st">&quot;m =&quot;</span>,m),</span>
<span id="cb44-10"><a href="considerations-for-choosing-a-prior.html#cb44-10" tabindex="-1"></a>         <span class="at">stag =</span> <span class="fu">paste</span>(<span class="st">&quot;s =&quot;</span>,s))</span>
<span id="cb44-11"><a href="considerations-for-choosing-a-prior.html#cb44-11" tabindex="-1"></a></span>
<span id="cb44-12"><a href="considerations-for-choosing-a-prior.html#cb44-12" tabindex="-1"></a>(</span>
<span id="cb44-13"><a href="considerations-for-choosing-a-prior.html#cb44-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>d,<span class="fu">aes</span>(<span class="at">x=</span>alpha))</span>
<span id="cb44-14"><a href="considerations-for-choosing-a-prior.html#cb44-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>)</span>
<span id="cb44-15"><a href="considerations-for-choosing-a-prior.html#cb44-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_grid</span>(stag<span class="sc">~</span>mtag)</span>
<span id="cb44-16"><a href="considerations-for-choosing-a-prior.html#cb44-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb44-17"><a href="considerations-for-choosing-a-prior.html#cb44-17" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(alpha))</span>
<span id="cb44-18"><a href="considerations-for-choosing-a-prior.html#cb44-18" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">n.breaks=</span><span class="dv">4</span>)</span>
<span id="cb44-19"><a href="considerations-for-choosing-a-prior.html#cb44-19" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsParameterValuesAlpha"></span>
<img src="index_files/figure-html/PriorsParameterValuesAlpha-1.png" alt="Histograms of 10,000 draws from the probit-normal distribution for various location ($m$) and scale ($s$) parameters. " width="672" />
<p class="caption">
Figure 4.2: Histograms of 10,000 draws from the probit-normal distribution for various location (<span class="math inline">\(m\)</span>) and scale (<span class="math inline">\(s\)</span>) parameters.
</p>
</div>
<p>For example Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsParameterValuesAlpha">4.2</a> shows a range of priors from the probit-normal family of distributions that we could use for our prior for the other-regarding preference parameter <span class="math inline">\(\alpha\)</span>. In this figure, I especially want to draw your attention to the bottom row, which sets the prior scale parameter <span class="math inline">\(s_\alpha\)</span> to 2. If limited to these sixteen options, but without seeing Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsParameterValuesAlpha">4.2</a>, one may be tempted to choose one of the priors with <span class="math inline">\(s_\alpha=2\)</span>. This is because these priors have the largest variance. However inspection of the figure reveals that choosing one of these priors implies a starkly bi-model distribution for <span class="math inline">\(\alpha\)</span>. To put this into context, these “uninformative” priors imply that it is very likely that <span class="math inline">\(\alpha\)</span> is close to one or zero, but very <em>unlikely</em> that it is anywhere in between. While <span class="math inline">\(\alpha=1\)</span> corresponds to self-regarding preferences, and so we may in fact like to have a fair chunk of prior probability mass near this value, the bunching at <span class="math inline">\(\alpha=0\)</span> should be particularly worrisome: this participant is completely selfless! In fact, we may even want to be worried about there being any appreciable mass in the <span class="math inline">\(\alpha&lt;0.5\)</span> region, as this participant would place more weight on the other’s payoff than they do their own. My own assessment of this figure is that the <span class="math inline">\(m=0.8\)</span>, <span class="math inline">\(s=0.5\)</span> panel covers the <span class="math inline">\(0.5&lt;\alpha&lt;1\)</span> region fairly well, and while not ruling it out, does not place too much mass in the <span class="math inline">\(\alpha&lt;0.5\)</span> region.</p>
<p>While plotting alternative priors in something like Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsParameterValuesAlpha">4.2</a> can be helpful, another useful tool can be to write down a system of equations that pins down some properties that we would like the prior to have. Suppose for example that we think our prior should only place 1% probability mass on the <span class="math inline">\(\alpha&lt;0.5\)</span> region. This could be because we believe that it is highly unlikey that people will care more about the other person’s payoff than their own. This condition tells us that:</p>
<p><span class="math display">\[
\begin{aligned}
p(\alpha&lt;0.5)&amp;=0.01\\
p(\Phi^{-1}(\alpha)&lt;\Phi^{-1}(0.5))&amp;=0.01\\
p(X&lt;0)&amp;=0.01,\quad \text{where: }X=\Phi^{-1}(\alpha)\sim N(m_\alpha,s_\alpha^2)\\
\Phi\left(\frac{-m_\alpha}{s_\alpha}\right)&amp;=0.01\\
-m_\alpha&amp;=-2.33s_\alpha
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\Phi(x)\)</span> is the standard normal cumulative density function, and <span class="math inline">\(\Phi^{-1}(x)\)</span> is its inverse.</p>
<p>As we have two parameters in the prior distribution to play with, we can choose one more property of the distribution. Therefore suppose that we want 20% of the probability mass to be in the <span class="math inline">\(0.95&lt;\alpha\)</span> range, meaning that we expect there to be a large fraction of very self-regarding participants. This sets up the following equation:</p>
<p><span class="math display">\[
\begin{aligned}
p(\alpha&lt;0.95)&amp;=0.8\\
p(X&lt;1.64)&amp;=0.8\\
\Phi\left(\frac{1.64-m_\alpha}{s_\alpha}\right)&amp;=0.8\\
\frac{1.64-m_\alpha}{s_\alpha}&amp;=0.842\\
m_\alpha&amp;=1.64-0.842s_\alpha
\end{aligned}
\]</span></p>
<p>Adding the two conditions together gets us:</p>
<p><span class="math display">\[
\begin{aligned}
0&amp;=1.64-3.17s_\alpha\\
s_\alpha&amp; \approx 0.52
\end{aligned}
\]</span></p>
<p>And then subtracting the first from the second:</p>
<p><span class="math display">\[
\begin{aligned}
2m_\alpha&amp;=1.64-3.17\times 0.52+2.33\times0.52\\
m_\alpha\approx 1.2
\end{aligned}
\]</span></p>
<p>which is not too far off the prior I selected by eyeballing Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsParameterValuesAlpha">4.2</a>. Note that the parameter <span class="math inline">\(m_\alpha\)</span> pins down the prior <em>median</em> for <span class="math inline">\(\alpha\)</span>, which is <span class="math inline">\(\Phi(1.2)\approx0.88\)</span>. While an explicit expression for the mean of the probit-normal distribution does not exist, we can approximate it with Monte Carlo integration:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="considerations-for-choosing-a-prior.html#cb45-1" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1000</span>,<span class="at">mean =</span> <span class="fl">1.2</span>,<span class="at">sd=</span><span class="fl">0.52</span>) <span class="sc">|&gt;</span> <span class="fu">pnorm</span>() <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] 0.85508</code></pre>
<p>Of course, if we had some estimates of our parameters from previous studies, then these could also aid us in choosing a prior. For example in <span class="citation">Bland (<a href="#ref-Bland2023">2023b</a>)</span>, I calibrate a prior for risk-aversion using a distribution of estimates for a treatment reported in <span class="citation">Holt and Laury (<a href="#ref-Holt2002">2002</a>)</span>.
Even better than this, the population-level estimates we get from hierarchical models have exactly the right interpretation we need to be priors for individual-level parameters. Therefore, if we have existing data that could speak to the parameters of a model we want to estimate, using these data to appropriately calibrate our priors could be very helpful.</p>
</div>
<div id="predictions-and-other-derived-quantities-the-prior-predictive-check" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Predictions and other derived quantities: The prior predictive check<a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A parameter like <span class="math inline">\(\alpha\)</span> can be relatively easy to interpret on its own: it represents the weight a participant places on their own payoff. However this is not always the case. For example, I find the logit choice precision parameter <span class="math inline">\(\lambda\)</span> difficult to interpret. For one thing, its units are inverse utility units, whatever they are. Furthermore, without a sense of the <em>scale</em> of payoffs in an experiment, it is difficult to know what a particular value of <span class="math inline">\(\lambda\)</span> implies for actual behavior. Fortunately, we can always transform a parameter, or group of parameters, into probabilistic predictions of behavior in our experiment (otherwise we would not be able to write down a likelihood), and so we can explore the implications of the more difficult-to-interpret parameters’ priors using these predictions. Additionally, we can also transform our parameters into other, economically meaningful quantities, that may be easier to interpret. For example in an experiment on decision-making under risk, the parameters in our structural model might permit us to compute a certainty equivalent, which is a translation of von-Neumann-Morgenstern utility units into currency. The latter I find much easier to interpret.</p>
<p>For the logit choice precision parameter <span class="math inline">\(\lambda\)</span>, I like to think about its implications for choice <em>probabilities</em>. To see how to do this, note that for a given utility difference <span class="math inline">\(\Delta&gt;0\)</span>, the probability of choosing the action that yields the greatest utility is <span class="math inline">\((1+\exp(-\lambda\Delta))^{-1}\)</span>. Hence, if we have a sense of the scale of utility differences in our experiment, we can get a sense of the influence <span class="math inline">\(\lambda\)</span> has on choice probabilities. For <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019">2019</a>)</span> for example, we can look at the unique values of the utility difference, evaluated at the prior median <span class="math inline">\(\alpha\)</span> of 0.88:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="considerations-for-choosing-a-prior.html#cb47-1" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fl">0.88</span></span>
<span id="cb47-2"><a href="considerations-for-choosing-a-prior.html#cb47-2" tabindex="-1"></a>Delta<span class="ot">&lt;-</span>BFS2019 <span class="sc">|&gt;</span></span>
<span id="cb47-3"><a href="considerations-for-choosing-a-prior.html#cb47-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DU =</span> (alpha<span class="sc">*</span>self_x<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span>other_x<span class="sc">-</span>alpha<span class="sc">*</span>self_y<span class="sc">-</span>(<span class="dv">1</span><span class="sc">-</span>alpha)<span class="sc">*</span>other_y) <span class="sc">|&gt;</span> <span class="fu">abs</span>()) <span class="sc">|&gt;</span></span>
<span id="cb47-4"><a href="considerations-for-choosing-a-prior.html#cb47-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(DU) <span class="sc">|&gt;</span>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">unlist</span>() <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb47-5"><a href="considerations-for-choosing-a-prior.html#cb47-5" tabindex="-1"></a></span>
<span id="cb47-6"><a href="considerations-for-choosing-a-prior.html#cb47-6" tabindex="-1"></a>Delta</span></code></pre></div>
<pre><code>##  [1]  80.0 214.4 334.4 247.2 148.8 214.4 116.0  80.8 212.8 199.2 247.2 212.8
## [13]  45.6  80.0  10.4 184.0 116.0 148.8  45.6  10.4 302.4 334.4  80.8 302.4
## [25] 199.2  80.8  80.0 247.2 184.0  10.4 148.8 199.2  45.6 116.0</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="considerations-for-choosing-a-prior.html#cb49-1" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">expand.grid</span>(</span>
<span id="cb49-2"><a href="considerations-for-choosing-a-prior.html#cb49-2" tabindex="-1"></a>  <span class="at">Delta =</span> Delta,</span>
<span id="cb49-3"><a href="considerations-for-choosing-a-prior.html#cb49-3" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="dv">10</span><span class="sc">^</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="dv">1</span>,<span class="at">length=</span><span class="dv">1000</span>))</span>
<span id="cb49-4"><a href="considerations-for-choosing-a-prior.html#cb49-4" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb49-5"><a href="considerations-for-choosing-a-prior.html#cb49-5" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb49-6"><a href="considerations-for-choosing-a-prior.html#cb49-6" tabindex="-1"></a>    <span class="at">Pr =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>lambda<span class="sc">*</span>Delta))</span>
<span id="cb49-7"><a href="considerations-for-choosing-a-prior.html#cb49-7" tabindex="-1"></a>  )</span>
<span id="cb49-8"><a href="considerations-for-choosing-a-prior.html#cb49-8" tabindex="-1"></a></span>
<span id="cb49-9"><a href="considerations-for-choosing-a-prior.html#cb49-9" tabindex="-1"></a>(</span>
<span id="cb49-10"><a href="considerations-for-choosing-a-prior.html#cb49-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(d,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>Pr,<span class="at">group=</span>Delta))</span>
<span id="cb49-11"><a href="considerations-for-choosing-a-prior.html#cb49-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_path</span>()</span>
<span id="cb49-12"><a href="considerations-for-choosing-a-prior.html#cb49-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb49-13"><a href="considerations-for-choosing-a-prior.html#cb49-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb49-14"><a href="considerations-for-choosing-a-prior.html#cb49-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Probability of choosing action with higher utility&quot;</span>)</span>
<span id="cb49-15"><a href="considerations-for-choosing-a-prior.html#cb49-15" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsLambdaScale"></span>
<img src="index_files/figure-html/PriorsLambdaScale-1.png" alt="The implications of choice precision $\lambda$ on choice probabilities." width="672" />
<p class="caption">
Figure 4.3: The implications of choice precision <span class="math inline">\(\lambda\)</span> on choice probabilities.
</p>
</div>
<p>We can then plot the logit choice rule as a function of <span class="math inline">\(\lambda\)</span> to see how choice probabilities could change with <span class="math inline">\(\lambda\)</span>. This is done in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsLambdaScale">4.3</a>. Here we can see that for <span class="math inline">\(\lambda&lt;10^{-4}\)</span>, all decisions are effectively coin flips: we might not want to assign too much prior probability in this region. Likewise for <span class="math inline">\(\lambda&gt;1\)</span>, decisions are effectively deterministic. Suppose then, that we decide to assign 99% of our prior probability to the region <span class="math inline">\(10^{-4}&lt;\lambda&lt;1\)</span>, and use these endpoints as the 0.5th and 99.5th percentiles of the prior. This gives us a system of equations to solve for <span class="math inline">\(m_\lambda\)</span> and <span class="math inline">\(s_\lambda\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
-2.57s_\lambda&amp;=\log(10^{-4})-m_\lambda\\
2.57s_\lambda&amp;=\log(1)-m_\lambda
\end{aligned}
\]</span></p>
<p>Adding them together yields:</p>
<p><span class="math display">\[
\begin{aligned}
2m_\lambda&amp;=\log(10^{-4})+\log(1)\\
m_\lambda&amp;\approx-4.61
\end{aligned}
\]</span>
Subtracting the first from the second yields:</p>
<p><span class="math display">\[
\begin{aligned}
2\times2.57 s_\lambda &amp;=\log(1)-\log(10^{-4})\\
s_\lambda&amp;\approx 1.79
\end{aligned}
\]</span></p>
<p>If we code it up the right way, we can also have our <em>Stan</em> model help us in choosing a prior. This is because we can always turn off the likelihood contribution with an appropriately-placed <code>if</code> statement. This is done using the <code>UseData</code> variable in the <em>Stan</em> model above. For the calibrated priors for <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\lambda\)</span>, I simulate the <em>prior predictive</em> distribution of choices. I then summarize these distributions in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsStanPriorCheck">4.4</a>. This provides a useful “sanity check” to test whether or not our priors are implying anything weird about choices in the experiment.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="considerations-for-choosing-a-prior.html#cb50-1" tabindex="-1"></a>PriorCheck<span class="ot">&lt;-</span><span class="st">&quot;Code/Priors/priorCheck.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb50-2"><a href="considerations-for-choosing-a-prior.html#cb50-2" tabindex="-1"></a>  <span class="fu">readRDS</span>() <span class="sc">|&gt;</span></span>
<span id="cb50-3"><a href="considerations-for-choosing-a-prior.html#cb50-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb50-4"><a href="considerations-for-choosing-a-prior.html#cb50-4" tabindex="-1"></a>  <span class="fu">arrange</span>(mean)</span>
<span id="cb50-5"><a href="considerations-for-choosing-a-prior.html#cb50-5" tabindex="-1"></a></span>
<span id="cb50-6"><a href="considerations-for-choosing-a-prior.html#cb50-6" tabindex="-1"></a>PriorCheck<span class="ot">&lt;-</span>PriorCheck[<span class="fu">rownames</span>(PriorCheck)<span class="sc">!=</span><span class="st">&quot;lp__&quot;</span>,]</span>
<span id="cb50-7"><a href="considerations-for-choosing-a-prior.html#cb50-7" tabindex="-1"></a>  </span>
<span id="cb50-8"><a href="considerations-for-choosing-a-prior.html#cb50-8" tabindex="-1"></a>PriorCheck<span class="ot">&lt;-</span>PriorCheck <span class="sc">|&gt;</span></span>
<span id="cb50-9"><a href="considerations-for-choosing-a-prior.html#cb50-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cumul =</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())<span class="sc">/</span><span class="fu">n</span>())</span>
<span id="cb50-10"><a href="considerations-for-choosing-a-prior.html#cb50-10" tabindex="-1"></a></span>
<span id="cb50-11"><a href="considerations-for-choosing-a-prior.html#cb50-11" tabindex="-1"></a>(</span>
<span id="cb50-12"><a href="considerations-for-choosing-a-prior.html#cb50-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(PriorCheck,<span class="fu">aes</span>(<span class="at">x=</span>mean,<span class="at">y=</span>cumul))</span>
<span id="cb50-13"><a href="considerations-for-choosing-a-prior.html#cb50-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>()</span>
<span id="cb50-14"><a href="considerations-for-choosing-a-prior.html#cb50-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> X25.,<span class="at">xmax =</span> X75.))</span>
<span id="cb50-15"><a href="considerations-for-choosing-a-prior.html#cb50-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> X2.<span class="fl">5.</span>,<span class="at">xmax =</span> X97.<span class="fl">5.</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb50-16"><a href="considerations-for-choosing-a-prior.html#cb50-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb50-17"><a href="considerations-for-choosing-a-prior.html#cb50-17" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Cumulative density of prior mean&quot;</span>)</span>
<span id="cb50-18"><a href="considerations-for-choosing-a-prior.html#cb50-18" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;Choice probability&quot;</span>)</span>
<span id="cb50-19"><a href="considerations-for-choosing-a-prior.html#cb50-19" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsStanPriorCheck"></span>
<img src="index_files/figure-html/PriorsStanPriorCheck-1.png" alt="Prior distribution of choice probabilities. Dots show prior means. Heavy error bars show a 50% Bayesian credible region, and light error bars show a 95% Bayesian credible region." width="672" />
<p class="caption">
Figure 4.4: Prior distribution of choice probabilities. Dots show prior means. Heavy error bars show a 50% Bayesian credible region, and light error bars show a 95% Bayesian credible region.
</p>
</div>
</div>
</div>
<div id="assessing-the-sampling-performance-of-a-prior" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Assessing the sampling performance of a prior<a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another way to investigate the implications of a prior is to explore the sampling properties of our estimator. As we have a probabilistic model, this can be done through simulation. That is, since we have a likelihood, we can draw simulated data from <span class="math inline">\(y\mid \theta\)</span>, the distribution of <span class="math inline">\(y\)</span> given a specific realization of parameters <span class="math inline">\(\theta\)</span>. Furthermore, since we also have a prior, we can simulate data that are consistent with our prior belief about these <span class="math inline">\(\theta\)</span>s. In particular, the following simulation process:</p>
<ol style="list-style-type: decimal">
<li>Draw parameters <span class="math inline">\(\tilde\theta\)</span> from the prior</li>
<li>Draw data <span class="math inline">\(y\mid\tilde\theta\)</span> using the likelihood</li>
<li>Simulate the posterior <span class="math inline">\(\theta\mid y\)</span> using the simulated data.</li>
</ol>
<p>produces data (in step 2) and estimates (in step 3) that are consistent with our prior. This information will let us do two important diagnostics of our estimation process. Firstly, we can ask if the model <em>recovers its parameters well</em>. That is, are our estimates <span class="math inline">\(\hat\theta\)</span> in some sense “close” to their true value <span class="math inline">\(\theta\)</span>? Secondly, we can check whether our model is showing any pathologies by comparing the posterior distributions to the prior distribution. That is if all is working correctly, then draws from the prior in step 1 should have the same distribution as the posterior draws from step 3.</p>
<p>I demonstrate how this simulation is done in the <em>R</em> code at the end of this chapter. Basically, we first use <em>Stan</em> to get us some parameter draws from the prior distribution, and one simulated dataset consistent with each of these prior draws. I do this by running my <em>Stan</em> program with the <code>UseData</code> variable set to zero. Then for each of these simulated datasets, we fit the model and store the posterior draws.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a></p>
<div id="does-our-model-recover-its-parameters-well" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Does our model recover its parameters well?<a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A useful diagnostic for our model is to ask whether it estimates our parameters or quantities of interest well. Using the simulation described above, we can compare our posterior means to the prior draws that generated them. I show an example of this in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsParamRecoveryAlphaBayes">4.5</a>. Each dot represents a simulated dataset, with the horizontal coordinate equal to the (true) prior draw of <span class="math inline">\(\alpha\)</span> that generated the dataset, and the vertical coordinate equal to the posterior mean of <span class="math inline">\(\alpha\)</span>. Ideally, all of these points would fall on the <span class="math inline">\(45^\circ\)</span> line (red dashed line), however we can expect the posterior mean to be pulled at least a little bit toward the prior mean, hence the smoothed fit (blue curve) crossing the <span class="math inline">\(45^\circ\)</span> line. Of course, this plot is just as much a function of your chosen prior as it is of your likelihood and experiment design. If this plot is not to your liking, then re-designing your experiment at this stage could go a long way.<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="considerations-for-choosing-a-prior.html#cb51-1" tabindex="-1"></a>ParamRecovery<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;Code/Priors/SimSummary.rds&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb51-2"><a href="considerations-for-choosing-a-prior.html#cb51-2" tabindex="-1"></a>  <span class="fu">group_by</span>(SimStep,alpha_true,lambda_true,alpha_MLE,lambda_MLE) <span class="sc">|&gt;</span></span>
<span id="cb51-3"><a href="considerations-for-choosing-a-prior.html#cb51-3" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">alpha =</span> <span class="fu">mean</span>(alpha),<span class="at">lambda =</span> <span class="fu">mean</span>(lambda))</span>
<span id="cb51-4"><a href="considerations-for-choosing-a-prior.html#cb51-4" tabindex="-1"></a></span>
<span id="cb51-5"><a href="considerations-for-choosing-a-prior.html#cb51-5" tabindex="-1"></a>(</span>
<span id="cb51-6"><a href="considerations-for-choosing-a-prior.html#cb51-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(ParamRecovery,<span class="fu">aes</span>(<span class="at">x=</span>alpha_true,<span class="at">y=</span>alpha))</span>
<span id="cb51-7"><a href="considerations-for-choosing-a-prior.html#cb51-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb51-8"><a href="considerations-for-choosing-a-prior.html#cb51-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb51-9"><a href="considerations-for-choosing-a-prior.html#cb51-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">slope=</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb51-10"><a href="considerations-for-choosing-a-prior.html#cb51-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">formula=</span><span class="st">&quot;y~x&quot;</span>,<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)</span>
<span id="cb51-11"><a href="considerations-for-choosing-a-prior.html#cb51-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">pnorm</span>(<span class="fl">1.2</span>),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb51-12"><a href="considerations-for-choosing-a-prior.html#cb51-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;True value&quot;</span>)</span>
<span id="cb51-13"><a href="considerations-for-choosing-a-prior.html#cb51-13" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Posterior mean&quot;</span>)</span>
<span id="cb51-14"><a href="considerations-for-choosing-a-prior.html#cb51-14" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb51-15"><a href="considerations-for-choosing-a-prior.html#cb51-15" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsParamRecoveryAlphaBayes"></span>
<img src="index_files/figure-html/PriorsParamRecoveryAlphaBayes-1.png" alt="Parameter recovery plot for $\alpha$" width="672" />
<p class="caption">
Figure 4.5: Parameter recovery plot for <span class="math inline">\(\alpha\)</span>
</p>
</div>
<p>In fairness to the Bayesian model, I also did the same exercise using the maximum likelihood estimator. The calibration plot can be seen below in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsParamRecoveryAlphaMLE">4.6</a>. Here there is clearly much more variance in the estimates, with a fair number of instances where the estimate falls at one of the endpoints of the parameter space.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="considerations-for-choosing-a-prior.html#cb52-1" tabindex="-1"></a>(</span>
<span id="cb52-2"><a href="considerations-for-choosing-a-prior.html#cb52-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(ParamRecovery,<span class="fu">aes</span>(<span class="at">x=</span>alpha_true,<span class="at">y=</span>alpha_MLE))</span>
<span id="cb52-3"><a href="considerations-for-choosing-a-prior.html#cb52-3" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">1</span>,<span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb52-4"><a href="considerations-for-choosing-a-prior.html#cb52-4" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb52-5"><a href="considerations-for-choosing-a-prior.html#cb52-5" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">slope=</span><span class="dv">1</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>,<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb52-6"><a href="considerations-for-choosing-a-prior.html#cb52-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">formula=</span><span class="st">&quot;y~x&quot;</span>,<span class="at">method=</span><span class="st">&quot;loess&quot;</span>)</span>
<span id="cb52-7"><a href="considerations-for-choosing-a-prior.html#cb52-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="fu">pnorm</span>(<span class="fl">1.2</span>),<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb52-8"><a href="considerations-for-choosing-a-prior.html#cb52-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="st">&quot;True value&quot;</span>)</span>
<span id="cb52-9"><a href="considerations-for-choosing-a-prior.html#cb52-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Posterior mean&quot;</span>)</span>
<span id="cb52-10"><a href="considerations-for-choosing-a-prior.html#cb52-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb52-11"><a href="considerations-for-choosing-a-prior.html#cb52-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsParamRecoveryAlphaMLE"></span>
<img src="index_files/figure-html/PriorsParamRecoveryAlphaMLE-1.png" alt="Parameter recovery plot for $\alpha$ using maximum likelihood estimation" width="672" />
<p class="caption">
Figure 4.6: Parameter recovery plot for <span class="math inline">\(\alpha\)</span> using maximum likelihood estimation
</p>
</div>
</div>
<div id="do-we-see-any-pathologies-in-the-estimation-process" class="section level3 hasAnchor" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Do we see any pathologies in the estimation process?<a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Another sanity check for our prior and model that we can do with the above simulation process is to compare the draws from the prior to the draws from the posteriors. This is because the <em>average</em> posterior distribution should be the prior distribution (see <span class="citation">Betancourt (<a href="#ref-Betancourt2020">2020</a>)</span> Section 1.2). We can do this by computing the rank of each prior draw within its corresponding posterior distribution (that we estimated using the dataset simulated from that prior draw). Then, if we plot the histogram of these ranks, we should get something close to a uniform distribution, which is what we get in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsSimulationBasedCalibrationHist">4.7</a>. I show these histograms alongside a 95% range for the binomial distribution (using the normal approximation) in order to give you a perspective for what normal statistical variation should look like.<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a> It is common for computational problems to manifest themselves in easy-to recognize ways in these plots <span class="citation">(<a href="#ref-Betancourt2020">Betancourt 2020</a>)</span>.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="considerations-for-choosing-a-prior.html#cb53-1" tabindex="-1"></a>Rank<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;Code/Priors/SimSummary.rds&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb53-2"><a href="considerations-for-choosing-a-prior.html#cb53-2" tabindex="-1"></a>  <span class="fu">group_by</span>(SimStep) <span class="sc">|&gt;</span></span>
<span id="cb53-3"><a href="considerations-for-choosing-a-prior.html#cb53-3" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb53-4"><a href="considerations-for-choosing-a-prior.html#cb53-4" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fu">sum</span>(<span class="fu">mean</span>(alpha_true)<span class="sc">&lt;</span>alpha),</span>
<span id="cb53-5"><a href="considerations-for-choosing-a-prior.html#cb53-5" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">sum</span>(<span class="fu">mean</span>(lambda_true)<span class="sc">&lt;</span>lambda),</span>
<span id="cb53-6"><a href="considerations-for-choosing-a-prior.html#cb53-6" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb53-7"><a href="considerations-for-choosing-a-prior.html#cb53-7" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(alpha,lambda),<span class="at">names_to=</span><span class="st">&quot;parameter&quot;</span>,<span class="at">values_to =</span> <span class="st">&quot;rank&quot;</span>)</span>
<span id="cb53-8"><a href="considerations-for-choosing-a-prior.html#cb53-8" tabindex="-1"></a></span>
<span id="cb53-9"><a href="considerations-for-choosing-a-prior.html#cb53-9" tabindex="-1"></a></span>
<span id="cb53-10"><a href="considerations-for-choosing-a-prior.html#cb53-10" tabindex="-1"></a>SimSize<span class="ot">&lt;-</span>Rank<span class="sc">$</span>SimStep <span class="sc">|&gt;</span> <span class="fu">max</span>()</span>
<span id="cb53-11"><a href="considerations-for-choosing-a-prior.html#cb53-11" tabindex="-1"></a>nbins<span class="ot">&lt;-</span><span class="dv">20</span></span>
<span id="cb53-12"><a href="considerations-for-choosing-a-prior.html#cb53-12" tabindex="-1"></a></span>
<span id="cb53-13"><a href="considerations-for-choosing-a-prior.html#cb53-13" tabindex="-1"></a>(</span>
<span id="cb53-14"><a href="considerations-for-choosing-a-prior.html#cb53-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(Rank,<span class="fu">aes</span>(<span class="at">x=</span>rank))</span>
<span id="cb53-15"><a href="considerations-for-choosing-a-prior.html#cb53-15" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span>nbins)</span>
<span id="cb53-16"><a href="considerations-for-choosing-a-prior.html#cb53-16" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter)</span>
<span id="cb53-17"><a href="considerations-for-choosing-a-prior.html#cb53-17" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb53-18"><a href="considerations-for-choosing-a-prior.html#cb53-18" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> SimSize<span class="sc">/</span>nbins,<span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span>
<span id="cb53-19"><a href="considerations-for-choosing-a-prior.html#cb53-19" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> SimSize<span class="sc">/</span>nbins<span class="fl">+1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(SimSize<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>nbins)<span class="sc">*</span>(<span class="dv">1-1</span><span class="sc">/</span>nbins)),<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb53-20"><a href="considerations-for-choosing-a-prior.html#cb53-20" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_hline</span>(<span class="at">yintercept =</span> SimSize<span class="sc">/</span>nbins<span class="fl">-1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(SimSize<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span>nbins)<span class="sc">*</span>(<span class="dv">1-1</span><span class="sc">/</span>nbins)),<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb53-21"><a href="considerations-for-choosing-a-prior.html#cb53-21" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsSimulationBasedCalibrationHist"></span>
<img src="index_files/figure-html/PriorsSimulationBasedCalibrationHist-1.png" alt="Histograms of ranks of prior draws within their corresponding posterior simulations." width="672" />
<p class="caption">
Figure 4.7: Histograms of ranks of prior draws within their corresponding posterior simulations.
</p>
</div>
<p>Alternatively, we could visualize these ranks as an empirical cumulative density function, as I have done in Figure <a href="considerations-for-choosing-a-prior.html#fig:PriorsSimulationBasedCalibrationECDF">4.8</a>. Here, we are hoping that the plot will be of a straight line.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="considerations-for-choosing-a-prior.html#cb54-1" tabindex="-1"></a>(</span>
<span id="cb54-2"><a href="considerations-for-choosing-a-prior.html#cb54-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(Rank,<span class="fu">aes</span>(<span class="at">x=</span>rank))</span>
<span id="cb54-3"><a href="considerations-for-choosing-a-prior.html#cb54-3" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">stat_ecdf</span>()</span>
<span id="cb54-4"><a href="considerations-for-choosing-a-prior.html#cb54-4" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>parameter)</span>
<span id="cb54-5"><a href="considerations-for-choosing-a-prior.html#cb54-5" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb54-6"><a href="considerations-for-choosing-a-prior.html#cb54-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_abline</span>(<span class="at">intercept=</span><span class="dv">0</span>,<span class="at">slope =</span> <span class="dv">1</span><span class="sc">/</span>SimSize,<span class="at">color=</span><span class="st">&quot;red&quot;</span>,<span class="at">linetype=</span><span class="st">&quot;dashed&quot;</span>)</span>
<span id="cb54-7"><a href="considerations-for-choosing-a-prior.html#cb54-7" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:PriorsSimulationBasedCalibrationECDF"></span>
<img src="index_files/figure-html/PriorsSimulationBasedCalibrationECDF-1.png" alt="Empirical cumulative density function of ranks of prior draws within their corresponding posterior simulations. Dashed red line shows the ideal case of a uniform distribution." width="672" />
<p class="caption">
Figure 4.8: Empirical cumulative density function of ranks of prior draws within their corresponding posterior simulations. Dashed red line shows the ideal case of a uniform distribution.
</p>
</div>
</div>
</div>
<div id="r-code-used-for-this-chapter" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> <em>R</em> code used for this chapter<a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="considerations-for-choosing-a-prior.html#cb55-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb55-2"><a href="considerations-for-choosing-a-prior.html#cb55-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb55-3"><a href="considerations-for-choosing-a-prior.html#cb55-3" tabindex="-1"></a>  <span class="co"># These models estimate a lot faster without parallelization</span></span>
<span id="cb55-4"><a href="considerations-for-choosing-a-prior.html#cb55-4" tabindex="-1"></a>  <span class="co"># This is because the initialization of the cores takes much</span></span>
<span id="cb55-5"><a href="considerations-for-choosing-a-prior.html#cb55-5" tabindex="-1"></a>  <span class="co"># longer than the estimation itself</span></span>
<span id="cb55-6"><a href="considerations-for-choosing-a-prior.html#cb55-6" tabindex="-1"></a>  <span class="fu">options</span>(<span class="at">mc.cores =</span> <span class="dv">1</span>)</span>
<span id="cb55-7"><a href="considerations-for-choosing-a-prior.html#cb55-7" tabindex="-1"></a>  <span class="co">#options(mc.cores = parallel::detectCores())</span></span>
<span id="cb55-8"><a href="considerations-for-choosing-a-prior.html#cb55-8" tabindex="-1"></a>  <span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb55-9"><a href="considerations-for-choosing-a-prior.html#cb55-9" tabindex="-1"></a>  <span class="fu">rstan_options</span>(<span class="at">threads_per_chain =</span> <span class="dv">1</span>)</span>
<span id="cb55-10"><a href="considerations-for-choosing-a-prior.html#cb55-10" tabindex="-1"></a>  </span>
<span id="cb55-11"><a href="considerations-for-choosing-a-prior.html#cb55-11" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">stan_model</span>(<span class="st">&quot;Code/Priors/BFS2019priors.stan&quot;</span>)</span>
<span id="cb55-12"><a href="considerations-for-choosing-a-prior.html#cb55-12" tabindex="-1"></a></span>
<span id="cb55-13"><a href="considerations-for-choosing-a-prior.html#cb55-13" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb55-14"><a href="considerations-for-choosing-a-prior.html#cb55-14" tabindex="-1"></a></span>
<span id="cb55-15"><a href="considerations-for-choosing-a-prior.html#cb55-15" tabindex="-1"></a>d1<span class="ot">&lt;-</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data/BFS2019_choices_exp1.csv&quot;</span>)</span>
<span id="cb55-16"><a href="considerations-for-choosing-a-prior.html#cb55-16" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">experiment=</span><span class="dv">1</span>)</span>
<span id="cb55-17"><a href="considerations-for-choosing-a-prior.html#cb55-17" tabindex="-1"></a>)</span>
<span id="cb55-18"><a href="considerations-for-choosing-a-prior.html#cb55-18" tabindex="-1"></a>d2<span class="ot">&lt;-</span>(<span class="fu">read.csv</span>(<span class="st">&quot;Data/BFS2019_choices_exp2.csv&quot;</span>)</span>
<span id="cb55-19"><a href="considerations-for-choosing-a-prior.html#cb55-19" tabindex="-1"></a>     <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">experiment=</span><span class="dv">2</span>)    </span>
<span id="cb55-20"><a href="considerations-for-choosing-a-prior.html#cb55-20" tabindex="-1"></a>)</span>
<span id="cb55-21"><a href="considerations-for-choosing-a-prior.html#cb55-21" tabindex="-1"></a>D<span class="ot">&lt;-</span>(<span class="fu">rbind</span>(d1,d2)</span>
<span id="cb55-22"><a href="considerations-for-choosing-a-prior.html#cb55-22" tabindex="-1"></a>    <span class="co"># Just use the dictator game data</span></span>
<span id="cb55-23"><a href="considerations-for-choosing-a-prior.html#cb55-23" tabindex="-1"></a>    <span class="sc">|&gt;</span> <span class="fu">filter</span>(dg<span class="sc">==</span><span class="dv">1</span>)  </span>
<span id="cb55-24"><a href="considerations-for-choosing-a-prior.html#cb55-24" tabindex="-1"></a>    <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb55-25"><a href="considerations-for-choosing-a-prior.html#cb55-25" tabindex="-1"></a>      <span class="at">self_alloc =</span> <span class="fu">ifelse</span>(choice_x<span class="sc">==</span><span class="dv">1</span>,self_x,self_y),</span>
<span id="cb55-26"><a href="considerations-for-choosing-a-prior.html#cb55-26" tabindex="-1"></a>      <span class="at">other_alloc =</span> <span class="fu">ifelse</span>(choice_x<span class="sc">==</span><span class="dv">1</span>,other_x,other_y)</span>
<span id="cb55-27"><a href="considerations-for-choosing-a-prior.html#cb55-27" tabindex="-1"></a>    )</span>
<span id="cb55-28"><a href="considerations-for-choosing-a-prior.html#cb55-28" tabindex="-1"></a>)</span>
<span id="cb55-29"><a href="considerations-for-choosing-a-prior.html#cb55-29" tabindex="-1"></a></span>
<span id="cb55-30"><a href="considerations-for-choosing-a-prior.html#cb55-30" tabindex="-1"></a><span class="co"># Data from just one participant</span></span>
<span id="cb55-31"><a href="considerations-for-choosing-a-prior.html#cb55-31" tabindex="-1"></a>BFS2019<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span> <span class="fu">filter</span>(sid<span class="sc">==</span><span class="dv">102010050706</span>)</span>
<span id="cb55-32"><a href="considerations-for-choosing-a-prior.html#cb55-32" tabindex="-1"></a></span>
<span id="cb55-33"><a href="considerations-for-choosing-a-prior.html#cb55-33" tabindex="-1"></a><span class="co"># Checking that it works</span></span>
<span id="cb55-34"><a href="considerations-for-choosing-a-prior.html#cb55-34" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb55-35"><a href="considerations-for-choosing-a-prior.html#cb55-35" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">dim</span>(BFS2019)[<span class="dv">1</span>],</span>
<span id="cb55-36"><a href="considerations-for-choosing-a-prior.html#cb55-36" tabindex="-1"></a>  <span class="at">y =</span> BFS2019<span class="sc">$</span>choice_x,</span>
<span id="cb55-37"><a href="considerations-for-choosing-a-prior.html#cb55-37" tabindex="-1"></a>  <span class="at">self_x =</span> BFS2019<span class="sc">$</span>self_x,</span>
<span id="cb55-38"><a href="considerations-for-choosing-a-prior.html#cb55-38" tabindex="-1"></a>  <span class="at">self_y =</span> BFS2019<span class="sc">$</span>self_y,</span>
<span id="cb55-39"><a href="considerations-for-choosing-a-prior.html#cb55-39" tabindex="-1"></a>  <span class="at">other_x =</span> BFS2019<span class="sc">$</span>other_x,</span>
<span id="cb55-40"><a href="considerations-for-choosing-a-prior.html#cb55-40" tabindex="-1"></a>  <span class="at">other_y =</span> BFS2019<span class="sc">$</span>other_y,</span>
<span id="cb55-41"><a href="considerations-for-choosing-a-prior.html#cb55-41" tabindex="-1"></a>  </span>
<span id="cb55-42"><a href="considerations-for-choosing-a-prior.html#cb55-42" tabindex="-1"></a>  <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">4.61</span>,<span class="fl">1.79</span>),</span>
<span id="cb55-43"><a href="considerations-for-choosing-a-prior.html#cb55-43" tabindex="-1"></a>  <span class="at">prior_alpha =</span> <span class="fu">c</span>(<span class="fl">1.2</span>,<span class="fl">0.52</span>),</span>
<span id="cb55-44"><a href="considerations-for-choosing-a-prior.html#cb55-44" tabindex="-1"></a>  <span class="at">UseData =</span> <span class="dv">1</span>,</span>
<span id="cb55-45"><a href="considerations-for-choosing-a-prior.html#cb55-45" tabindex="-1"></a>  <span class="at">UsePrior =</span> <span class="dv">1</span></span>
<span id="cb55-46"><a href="considerations-for-choosing-a-prior.html#cb55-46" tabindex="-1"></a>)</span>
<span id="cb55-47"><a href="considerations-for-choosing-a-prior.html#cb55-47" tabindex="-1"></a></span>
<span id="cb55-48"><a href="considerations-for-choosing-a-prior.html#cb55-48" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>)  </span>
<span id="cb55-49"><a href="considerations-for-choosing-a-prior.html#cb55-49" tabindex="-1"></a></span>
<span id="cb55-50"><a href="considerations-for-choosing-a-prior.html#cb55-50" tabindex="-1"></a><span class="do">## Simulating the prior distribution of choices</span></span>
<span id="cb55-51"><a href="considerations-for-choosing-a-prior.html#cb55-51" tabindex="-1"></a></span>
<span id="cb55-52"><a href="considerations-for-choosing-a-prior.html#cb55-52" tabindex="-1"></a>dStan<span class="sc">$</span>UseData<span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb55-53"><a href="considerations-for-choosing-a-prior.html#cb55-53" tabindex="-1"></a>Fit<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb55-54"><a href="considerations-for-choosing-a-prior.html#cb55-54" tabindex="-1"></a>              <span class="at">pars =</span> <span class="st">&quot;probX&quot;</span>,<span class="at">include=</span><span class="cn">TRUE</span>)  </span>
<span id="cb55-55"><a href="considerations-for-choosing-a-prior.html#cb55-55" tabindex="-1"></a><span class="fu">summary</span>(Fit)<span class="sc">$</span>summary <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(<span class="st">&quot;Code/Priors/priorCheck.rds&quot;</span>)</span>
<span id="cb55-56"><a href="considerations-for-choosing-a-prior.html#cb55-56" tabindex="-1"></a></span>
<span id="cb55-57"><a href="considerations-for-choosing-a-prior.html#cb55-57" tabindex="-1"></a><span class="do">## Simulating some data from the prior, then estimating the models</span></span>
<span id="cb55-58"><a href="considerations-for-choosing-a-prior.html#cb55-58" tabindex="-1"></a><span class="co"># using those data</span></span>
<span id="cb55-59"><a href="considerations-for-choosing-a-prior.html#cb55-59" tabindex="-1"></a></span>
<span id="cb55-60"><a href="considerations-for-choosing-a-prior.html#cb55-60" tabindex="-1"></a>SimData<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb55-61"><a href="considerations-for-choosing-a-prior.html#cb55-61" tabindex="-1"></a>              <span class="at">pars =</span> <span class="st">&quot;probX&quot;</span>,<span class="at">include=</span><span class="cn">FALSE</span>)</span>
<span id="cb55-62"><a href="considerations-for-choosing-a-prior.html#cb55-62" tabindex="-1"></a></span>
<span id="cb55-63"><a href="considerations-for-choosing-a-prior.html#cb55-63" tabindex="-1"></a>SIMDATA<span class="ot">&lt;-</span><span class="fu">extract</span>(SimData)<span class="sc">$</span>simX</span>
<span id="cb55-64"><a href="considerations-for-choosing-a-prior.html#cb55-64" tabindex="-1"></a>  SIMDATA <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(<span class="st">&quot;Code/Priors/SimData.rds&quot;</span>)</span>
<span id="cb55-65"><a href="considerations-for-choosing-a-prior.html#cb55-65" tabindex="-1"></a>alpha<span class="ot">&lt;-</span><span class="fu">extract</span>(SimData)<span class="sc">$</span>alpha</span>
<span id="cb55-66"><a href="considerations-for-choosing-a-prior.html#cb55-66" tabindex="-1"></a>lambda<span class="ot">&lt;-</span><span class="fu">extract</span>(SimData)<span class="sc">$</span>lambda</span>
<span id="cb55-67"><a href="considerations-for-choosing-a-prior.html#cb55-67" tabindex="-1"></a></span>
<span id="cb55-68"><a href="considerations-for-choosing-a-prior.html#cb55-68" tabindex="-1"></a>dStan<span class="sc">$</span>UseData<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb55-69"><a href="considerations-for-choosing-a-prior.html#cb55-69" tabindex="-1"></a></span>
<span id="cb55-70"><a href="considerations-for-choosing-a-prior.html#cb55-70" tabindex="-1"></a>SimSummary<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb55-71"><a href="considerations-for-choosing-a-prior.html#cb55-71" tabindex="-1"></a></span>
<span id="cb55-72"><a href="considerations-for-choosing-a-prior.html#cb55-72" tabindex="-1"></a><span class="cf">for</span> (ss <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(SIMDATA)[<span class="dv">1</span>]) {</span>
<span id="cb55-73"><a href="considerations-for-choosing-a-prior.html#cb55-73" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Sim step&quot;</span>,ss,<span class="st">&quot;of&quot;</span>,<span class="fu">dim</span>(SIMDATA)[<span class="dv">1</span>]))</span>
<span id="cb55-74"><a href="considerations-for-choosing-a-prior.html#cb55-74" tabindex="-1"></a>  </span>
<span id="cb55-75"><a href="considerations-for-choosing-a-prior.html#cb55-75" tabindex="-1"></a>  <span class="co"># Estimate the model</span></span>
<span id="cb55-76"><a href="considerations-for-choosing-a-prior.html#cb55-76" tabindex="-1"></a>  dStan<span class="sc">$</span>y<span class="ot">&lt;-</span>SIMDATA[ss,] <span class="sc">|&gt;</span> <span class="fu">as.vector</span>()</span>
<span id="cb55-77"><a href="considerations-for-choosing-a-prior.html#cb55-77" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span><span class="fu">sampling</span>(model,<span class="at">data=</span>dStan,<span class="at">seed=</span><span class="dv">42</span>,</span>
<span id="cb55-78"><a href="considerations-for-choosing-a-prior.html#cb55-78" tabindex="-1"></a>                <span class="at">pars =</span> <span class="fu">c</span>(<span class="st">&quot;alpha&quot;</span>,<span class="st">&quot;lambda&quot;</span>),<span class="at">include=</span><span class="cn">TRUE</span>)</span>
<span id="cb55-79"><a href="considerations-for-choosing-a-prior.html#cb55-79" tabindex="-1"></a>  </span>
<span id="cb55-80"><a href="considerations-for-choosing-a-prior.html#cb55-80" tabindex="-1"></a>  <span class="co"># Also check to see what the MLE looks like</span></span>
<span id="cb55-81"><a href="considerations-for-choosing-a-prior.html#cb55-81" tabindex="-1"></a>  dStanMLE<span class="ot">&lt;-</span>dStan</span>
<span id="cb55-82"><a href="considerations-for-choosing-a-prior.html#cb55-82" tabindex="-1"></a>  dStanMLE<span class="sc">$</span>UsePrior<span class="ot">&lt;-</span><span class="dv">0</span></span>
<span id="cb55-83"><a href="considerations-for-choosing-a-prior.html#cb55-83" tabindex="-1"></a>  </span>
<span id="cb55-84"><a href="considerations-for-choosing-a-prior.html#cb55-84" tabindex="-1"></a>  MLE<span class="ot">&lt;-</span><span class="fu">optimizing</span>(model,<span class="at">data=</span>dStanMLE,<span class="at">seed=</span><span class="dv">42</span>)</span>
<span id="cb55-85"><a href="considerations-for-choosing-a-prior.html#cb55-85" tabindex="-1"></a>  </span>
<span id="cb55-86"><a href="considerations-for-choosing-a-prior.html#cb55-86" tabindex="-1"></a>  SimSummary<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb55-87"><a href="considerations-for-choosing-a-prior.html#cb55-87" tabindex="-1"></a>    SimSummary,</span>
<span id="cb55-88"><a href="considerations-for-choosing-a-prior.html#cb55-88" tabindex="-1"></a>    <span class="fu">tibble</span>(</span>
<span id="cb55-89"><a href="considerations-for-choosing-a-prior.html#cb55-89" tabindex="-1"></a>    <span class="at">SimStep =</span> ss,</span>
<span id="cb55-90"><a href="considerations-for-choosing-a-prior.html#cb55-90" tabindex="-1"></a>    <span class="at">alpha_true =</span> alpha[ss],</span>
<span id="cb55-91"><a href="considerations-for-choosing-a-prior.html#cb55-91" tabindex="-1"></a>    <span class="at">lambda_true =</span> lambda[ss],</span>
<span id="cb55-92"><a href="considerations-for-choosing-a-prior.html#cb55-92" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fu">extract</span>(Fit)<span class="sc">$</span>alpha,</span>
<span id="cb55-93"><a href="considerations-for-choosing-a-prior.html#cb55-93" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">extract</span>(Fit)<span class="sc">$</span>lambda,</span>
<span id="cb55-94"><a href="considerations-for-choosing-a-prior.html#cb55-94" tabindex="-1"></a>    <span class="at">alpha_MLE =</span> MLE<span class="sc">$</span>par[<span class="st">&quot;alpha&quot;</span>],</span>
<span id="cb55-95"><a href="considerations-for-choosing-a-prior.html#cb55-95" tabindex="-1"></a>    <span class="at">lambda_MLE =</span> MLE<span class="sc">$</span>par[<span class="st">&quot;lambda&quot;</span>]</span>
<span id="cb55-96"><a href="considerations-for-choosing-a-prior.html#cb55-96" tabindex="-1"></a>    )</span>
<span id="cb55-97"><a href="considerations-for-choosing-a-prior.html#cb55-97" tabindex="-1"></a>  )</span>
<span id="cb55-98"><a href="considerations-for-choosing-a-prior.html#cb55-98" tabindex="-1"></a>}</span>
<span id="cb55-99"><a href="considerations-for-choosing-a-prior.html#cb55-99" tabindex="-1"></a></span>
<span id="cb55-100"><a href="considerations-for-choosing-a-prior.html#cb55-100" tabindex="-1"></a>SimSummary <span class="sc">|&gt;</span> <span class="fu">saveRDS</span>(<span class="st">&quot;Code/Priors/SimSummary.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Betancourt2020" class="csl-entry">
Betancourt, Michael. 2020. <span>“Towards a Principled Bayesian Workflow.”</span> <a href="https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html">https://betanalpha.github.io/assets/case_studies/principled_bayesian_workflow.html</a>.
</div>
<div id="ref-Bland2023" class="csl-entry">
———. 2023b. <span>“Bayesian Model Selection and Prior Calibration for Models of Behavior in Economic Experiments.”</span> <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4334267">https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4334267</a>.
</div>
<div id="ref-BFS2019" class="csl-entry">
Bruhin, Adrian, Ernst Fehr, and Daniel Schunk. 2019. <span>“The Many Faces of Human Sociality: Uncovering the Distribution and Stability of Social Preferences.”</span> <em>Journal of the European Economic Association</em> 17 (4): 1025–69.
</div>
<div id="ref-Holt2002" class="csl-entry">
Holt, Charles A, and Susan K Laury. 2002. <span>“Risk Aversion and Incentive Effects.”</span> <em>American Economic Review</em> 92 (5): 1644–55.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>Probably the biggest difference other than the prior is the differing approach to dealing with unobservable heterogeneity, which we will get to in the hierarchical models chapter.<a href="considerations-for-choosing-a-prior.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>If you have read other chapters of this book, you can see that I am a big fan of using this technique, at least as a starting point.<a href="considerations-for-choosing-a-prior.html#fnref11" class="footnote-back">↩︎</a></p></li>
<li id="fn12"><p>Coupled with the logit probabilistic choice rule, this means we will have two parameters total. This makes plotting parameter values much easier compared to a 3+ parameter model.<a href="considerations-for-choosing-a-prior.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>The process is simple, but took a while (a couple of hours on my laptop). If you’re playing at home, now would be a good time to slay a few lynels.<a href="considerations-for-choosing-a-prior.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p>For this experiment in particular, which was not designed to estimate this utility function, I suspect that including more decisions where the allocations are connected by a line segment with a negative slope would improve this plot dramatically. This is because the indifference curves of the utility function that we are using will be downward-sloping, parallel, straight lines. <span class="citation">Bruhin, Fehr, and Schunk (<a href="#ref-BFS2019">2019</a>)</span> designed this experiment with inequality-aversion in mind, rather than the efficiency-loving model that I use here. <a href="considerations-for-choosing-a-prior.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p><span class="citation">Betancourt (<a href="#ref-Betancourt2020">2020</a>)</span> also does this, it is not my original idea.<a href="considerations-for-choosing-a-prior.html#fnref15" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="probabilistic-models-of-behavior.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="building-blocks.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
