<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>18 Application: QRE in a Bayesian game and cursed equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="18 Application: QRE in a Bayesian game and cursed equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="18 Application: QRE in a Bayesian game and cursed equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="18 Application: QRE in a Bayesian game and cursed equilibrium | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-12-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-a-quantal-response-equilibrium-with-discrete-types.html"/>
<link rel="next" href="application-level-k-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html"><i class="fa fa-check"></i><b>4</b> Considerations for choosing a prior</a>
<ul>
<li class="chapter" data-level="4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#example-model-and-experiment"><i class="fa fa-check"></i><b>4.1</b> Example model and experiment</a></li>
<li class="chapter" data-level="4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#getting-the-support-right"><i class="fa fa-check"></i><b>4.2</b> Getting the support right</a></li>
<li class="chapter" data-level="4.3" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#eliciting-reasonable-priors"><i class="fa fa-check"></i><b>4.3</b> Eliciting reasonable priors</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#parameter-values-and-the-prior-pushforward-check"><i class="fa fa-check"></i><b>4.3.1</b> Parameter values and the prior pushforward check</a></li>
<li class="chapter" data-level="4.3.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#predictions-and-other-derived-quantities-the-prior-predictive-check"><i class="fa fa-check"></i><b>4.3.2</b> Predictions and other derived quantities: The prior predictive check</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#assessing-the-sampling-performance-of-a-prior"><i class="fa fa-check"></i><b>4.4</b> Assessing the sampling performance of a prior</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#does-our-model-recover-its-parameters-well"><i class="fa fa-check"></i><b>4.4.1</b> Does our model recover its parameters well?</a></li>
<li class="chapter" data-level="4.4.2" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#do-we-see-any-pathologies-in-the-estimation-process"><i class="fa fa-check"></i><b>4.4.2</b> Do we see any pathologies in the estimation process?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="considerations-for-choosing-a-prior.html"><a href="considerations-for-choosing-a-prior.html#r-code-used-for-this-chapter"><i class="fa fa-check"></i><b>4.5</b> <em>R</em> code used for this chapter</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>5</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>5.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>5.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="5.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>5.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="5.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>5.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="5.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>5.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="5.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>5.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="5.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>5.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="5.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>5.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>5.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>6</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="6.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>6.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="6.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>6.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="6.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>6.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>6.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="6.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>6.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>6.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>6.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="6.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>6.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>6.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="6.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>6.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="mixture-models.html"><a href="mixture-models.html"><i class="fa fa-check"></i><b>7</b> Mixture models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="mixture-models.html"><a href="mixture-models.html#a-menu-of-models"><i class="fa fa-check"></i><b>7.1</b> A menu of models</a></li>
<li class="chapter" data-level="7.2" data-path="mixture-models.html"><a href="mixture-models.html#dichotomous-and-toolbox-mixture-models"><i class="fa fa-check"></i><b>7.2</b> Dichotomous and toolbox mixture models</a></li>
<li class="chapter" data-level="7.3" data-path="mixture-models.html"><a href="mixture-models.html#coding-peculearities"><i class="fa fa-check"></i><b>7.3</b> Coding peculearities</a></li>
<li class="chapter" data-level="7.4" data-path="mixture-models.html"><a href="mixture-models.html#example-experiment-av2001"><i class="fa fa-check"></i><b>7.4</b> Example experiment: <span class="citation">Andreoni and Vesterlund (2001)</span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="mixture-models.html"><a href="mixture-models.html#as-basic-as-it-gets"><i class="fa fa-check"></i><b>7.4.1</b> As basic as it gets</a></li>
<li class="chapter" data-level="7.4.2" data-path="mixture-models.html"><a href="mixture-models.html#adding-some-heterogeneity"><i class="fa fa-check"></i><b>7.4.2</b> Adding some heterogeneity</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="mixture-models.html"><a href="mixture-models.html#some-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>7.5</b> Some code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html"><i class="fa fa-check"></i><b>8</b> Filling in the blanks: Imputation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#example-model-and-dataset-yet-again-with-bfs2019"><i class="fa fa-check"></i><b>8.1</b> Example model and dataset: yet again with <span class="citation">Bruhin, Fehr, and Schunk (2019)</span></a></li>
<li class="chapter" data-level="8.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#how-is-this-going-to-work"><i class="fa fa-check"></i><b>8.2</b> How is this going to work?</a></li>
<li class="chapter" data-level="8.3" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#implementation"><i class="fa fa-check"></i><b>8.3</b> Implementation</a></li>
<li class="chapter" data-level="8.4" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#results"><i class="fa fa-check"></i><b>8.4</b> Results</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#using-the-correlation-matrix"><i class="fa fa-check"></i><b>8.4.1</b> Using the correlation matrix</a></li>
<li class="chapter" data-level="8.4.2" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#the-correlation-matrix-is-doing-a-lot-of-heavy-lifting-here"><i class="fa fa-check"></i><b>8.4.2</b> The correlation matrix is doing a lot of heavy lifting here</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#conclusion"><i class="fa fa-check"></i><b>8.5</b> Conclusion</a></li>
<li class="chapter" data-level="8.6" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#r-code-used-for-this-chapter-1"><i class="fa fa-check"></i><b>8.6</b> <em>R</em> code used for this chapter</a></li>
<li class="chapter" data-level="" data-path="filling-in-the-blanks-imputation.html"><a href="filling-in-the-blanks-imputation.html#acknowedgements"><i class="fa fa-check"></i>Acknowedgements</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><i class="fa fa-check"></i><b>9</b> Using your structural estimates as explanatory variables in regression models</a>
<ul>
<li class="chapter" data-level="9.1" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1-a-probit-model-with-risk-preferences-measured-by-holt2002."><i class="fa fa-check"></i><b>9.1</b> Example 1: a probit model with risk preferences measured by <span class="citation">Holt and Laury (2002)</span>.</a></li>
<li class="chapter" data-level="9.2" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2-a-random-effects-logit-model-with-risk-and-time-preferences."><i class="fa fa-check"></i><b>9.2</b> Example 2: A random effects logit model with risk and time preferences.</a></li>
<li class="chapter" data-level="9.3" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3-logit-and-ordered-logit-with-risk-preferences-from-gneezy1997"><i class="fa fa-check"></i><b>9.3</b> Example 3: Logit and ordered logit with risk preferences from <span class="citation">Gneezy and Potters (1997)</span></a></li>
<li class="chapter" data-level="9.4" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#a-note-of-caution"><i class="fa fa-check"></i><b>9.4</b> A note of caution</a></li>
<li class="chapter" data-level="9.5" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#conclusion-1"><i class="fa fa-check"></i><b>9.5</b> Conclusion</a></li>
<li class="chapter" data-level="9.6" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#r-code-used-for-this-chapter-2"><i class="fa fa-check"></i><b>9.6</b> <em>R</em> code used for this chapter</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-1"><i class="fa fa-check"></i><b>9.6.1</b> Example 1</a></li>
<li class="chapter" data-level="9.6.2" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-2"><i class="fa fa-check"></i><b>9.6.2</b> Example 2</a></li>
<li class="chapter" data-level="9.6.3" data-path="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html"><a href="using-your-structural-estimates-as-explanatory-variables-in-regression-models.html#example-3"><i class="fa fa-check"></i><b>9.6.3</b> Example 3</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>10</b> Model evaluation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="model-evaluation.html"><a href="model-evaluation.html#example-dataset-and-models"><i class="fa fa-check"></i><b>10.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="10.2" data-path="model-evaluation.html"><a href="model-evaluation.html#model-posterior-probabilities"><i class="fa fa-check"></i><b>10.2</b> Model posterior probabilities</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="model-evaluation.html"><a href="model-evaluation.html#implementation-using-bridge-sampling-and-the-bridgesampling-library"><i class="fa fa-check"></i><b>10.2.1</b> Implementation using bridge sampling and the <code>bridgesampling</code> library</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-evaluation.html"><a href="model-evaluation.html#cross-validation"><i class="fa fa-check"></i><b>10.3</b> Cross-validation</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="model-evaluation.html"><a href="model-evaluation.html#expected-log-predicted-density-elpd-and-other-measures-of-goodness-of-fit"><i class="fa fa-check"></i><b>10.3.1</b> Expected Log Predicted Density (ELPD) and other measures of goodness of fit</a></li>
<li class="chapter" data-level="10.3.2" data-path="model-evaluation.html"><a href="model-evaluation.html#round-cross-validation"><i class="fa fa-check"></i><b>10.3.2</b> 1-round cross-validation</a></li>
<li class="chapter" data-level="10.3.3" data-path="model-evaluation.html"><a href="model-evaluation.html#leave-one-out-cross-validation-loo"><i class="fa fa-check"></i><b>10.3.3</b> Leave-one-out cross-validation (LOO)</a></li>
<li class="chapter" data-level="10.3.4" data-path="model-evaluation.html"><a href="model-evaluation.html#approximate-loo"><i class="fa fa-check"></i><b>10.3.4</b> Approximate LOO</a></li>
<li class="chapter" data-level="10.3.5" data-path="model-evaluation.html"><a href="model-evaluation.html#k-fold-cross-validation"><i class="fa fa-check"></i><b>10.3.5</b> <span class="math inline">\(k\)</span>-fold cross-validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html"><i class="fa fa-check"></i><b>11</b> Speeding up your <em>Stan</em> code</a>
<ul>
<li class="chapter" data-level="11.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#example-dataset-and-model-1"><i class="fa fa-check"></i><b>11.1</b> Example dataset and model</a></li>
<li class="chapter" data-level="11.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#a-really-slow-way-to-estimate-the-model"><i class="fa fa-check"></i><b>11.2</b> A really slow way to estimate the model</a></li>
<li class="chapter" data-level="11.3" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-things"><i class="fa fa-check"></i><b>11.3</b> Pre-computing things</a></li>
<li class="chapter" data-level="11.4" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#vectorization"><i class="fa fa-check"></i><b>11.4</b> Vectorization</a></li>
<li class="chapter" data-level="11.5" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization-with-reduce_sum"><i class="fa fa-check"></i><b>11.5</b> Within-chain parallelization with <code>reduce_sum()</code></a></li>
<li class="chapter" data-level="11.6" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#evaluating-the-implementations"><i class="fa fa-check"></i><b>11.6</b> Evaluating the implementations</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#pre-computing-and-vectorization"><i class="fa fa-check"></i><b>11.6.1</b> Pre-computing and vectorization</a></li>
<li class="chapter" data-level="11.6.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#within-chain-parallelization"><i class="fa fa-check"></i><b>11.6.2</b> Within-chain parallelization</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#r-code-to-estimate-models"><i class="fa fa-check"></i><b>11.7</b> <em>R</em> code to estimate models</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#slow-pre-computed-and-vectorized-models"><i class="fa fa-check"></i><b>11.7.1</b> Slow, pre-computed, and vectorized models</a></li>
<li class="chapter" data-level="11.7.2" data-path="speeding-up-your-stan-code.html"><a href="speeding-up-your-stan-code.html#parallelized-model"><i class="fa fa-check"></i><b>11.7.2</b> Parallelized model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="12" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html"><i class="fa fa-check"></i><b>12</b> Application: Experience-Weighted Attraction</a>
<ul>
<li class="chapter" data-level="12.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-model-at-the-individual-level"><i class="fa fa-check"></i><b>12.1</b> The model at the individual level</a></li>
<li class="chapter" data-level="12.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-computational-and-coding-issues"><i class="fa fa-check"></i><b>12.2</b> Some computational and coding issues</a></li>
<li class="chapter" data-level="12.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#representative-agent-models"><i class="fa fa-check"></i><b>12.3</b> Representative agent models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration"><i class="fa fa-check"></i><b>12.3.1</b> Prior calibration</a></li>
<li class="chapter" data-level="12.3.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model"><i class="fa fa-check"></i><b>12.3.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="12.3.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-1"><i class="fa fa-check"></i><b>12.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#hierarchical-model"><i class="fa fa-check"></i><b>12.4</b> Hierarchical model</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#prior-calibration-1"><i class="fa fa-check"></i><b>12.4.1</b> Prior calibration</a></li>
<li class="chapter" data-level="12.4.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#the-stan-model-1"><i class="fa fa-check"></i><b>12.4.2</b> The <em>Stan</em> model</a></li>
<li class="chapter" data-level="12.4.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#results-2"><i class="fa fa-check"></i><b>12.4.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#some-code-used-to-estimate-the-models-1"><i class="fa fa-check"></i><b>12.5</b> Some code used to estimate the models</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#loading-the-data"><i class="fa fa-check"></i><b>12.5.1</b> Loading the data</a></li>
<li class="chapter" data-level="12.5.2" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-representative-agent-models"><i class="fa fa-check"></i><b>12.5.2</b> Estimating the representative agent models</a></li>
<li class="chapter" data-level="12.5.3" data-path="application-experience-weighted-attraction.html"><a href="application-experience-weighted-attraction.html#estimating-the-hierarchical-model"><i class="fa fa-check"></i><b>12.5.3</b> Estimating the hierarchical model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>13</b> Application: Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="13.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#simplifying-the-individual-likelihood-functions"><i class="fa fa-check"></i><b>13.1</b> Simplifying the individual likelihood functions</a></li>
<li class="chapter" data-level="13.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#example-experiment-dbf2011"><i class="fa fa-check"></i><b>13.2</b> Example experiment: <span class="citation">Dal Bó and Fréchette (2011)</span></a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#the-sfem-with-homogeneous-trembles"><i class="fa fa-check"></i><b>13.2.1</b> The SFEM with homogeneous trembles</a></li>
<li class="chapter" data-level="13.2.2" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#adding-heterogeneous-trembles-and-integrating-the-likelihood"><i class="fa fa-check"></i><b>13.2.2</b> Adding heterogeneous trembles and integrating the likelihood</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="application-strategy-frequency-estimation.html"><a href="application-strategy-frequency-estimation.html#r-code-to-do-these-estimations"><i class="fa fa-check"></i><b>13.3</b> <em>R</em> code to do these estimations</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><i class="fa fa-check"></i><b>14</b> Application: Strategy frequency estimation with a mixed strategy</a>
<ul>
<li class="chapter" data-level="14.1" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#example-dataset-and-strategies"><i class="fa fa-check"></i><b>14.1</b> Example dataset and strategies</a></li>
<li class="chapter" data-level="14.2" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#the-likelihood-function"><i class="fa fa-check"></i><b>14.2</b> The likelihood function</a></li>
<li class="chapter" data-level="14.3" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#implementation-in-stan"><i class="fa fa-check"></i><b>14.3</b> Implementation in <em>Stan</em></a></li>
<li class="chapter" data-level="14.4" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#results-3"><i class="fa fa-check"></i><b>14.4</b> Results</a></li>
<li class="chapter" data-level="14.5" data-path="application-strategy-frequency-estimation-with-a-mixed-strategy.html"><a href="application-strategy-frequency-estimation-with-a-mixed-strategy.html#r-code-used-to-estimate-the-models"><i class="fa fa-check"></i><b>14.5</b> <em>R</em> code used to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html"><i class="fa fa-check"></i><b>15</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="15.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#overview-of-quantal-response-equilibrium"><i class="fa fa-check"></i><b>15.1</b> Overview of quantal response equilibrium</a></li>
<li class="chapter" data-level="15.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#computing-quantal-response-equilibrium-1"><i class="fa fa-check"></i><b>15.2</b> Computing Quantal Response Equilibrium</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#setting-up-the-problem"><i class="fa fa-check"></i><b>15.2.1</b> Setting up the problem</a></li>
<li class="chapter" data-level="15.2.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#a-predictor-corrector-algorithm"><i class="fa fa-check"></i><b>15.2.2</b> A predictor-corrector algorithm</a></li>
<li class="chapter" data-level="15.2.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#initial-conditions"><i class="fa fa-check"></i><b>15.2.3</b> Initial conditions</a></li>
<li class="chapter" data-level="15.2.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#algorithm-tuning"><i class="fa fa-check"></i><b>15.2.4</b> Algorithm tuning</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#the-predictor-corrector-algorithm-in-r"><i class="fa fa-check"></i><b>15.3</b> The predictor-corrector algorithm in <em>R</em></a></li>
<li class="chapter" data-level="15.4" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#some-example-games"><i class="fa fa-check"></i><b>15.4</b> Some example games</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#generalized-matching-pennies-ochs1995"><i class="fa fa-check"></i><b>15.4.1</b> Generalized matching pennies <span class="citation">(Ochs 1995)</span></a></li>
<li class="chapter" data-level="15.4.2" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#stag-hunt"><i class="fa fa-check"></i><b>15.4.2</b> Stag hunt</a></li>
<li class="chapter" data-level="15.4.3" data-path="computing-quantal-response-equilibrium.html"><a href="computing-quantal-response-equilibrium.html#n-player-volunteers-dilemma-imposing-symmetric-strategies"><i class="fa fa-check"></i><b>15.4.3</b> <span class="math inline">\(n\)</span>-player Volunteer’s Dilemma imposing symmetric strategies</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><i class="fa fa-check"></i><b>16</b> Application: Quantal Response Equilibrium and the Volunteer’s Dilemma <span class="citation">(Goeree, Holt, and Smith 2017)</span></a>
<ul>
<li class="chapter" data-level="16.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#solving-logit-qre-and-estimating-the-model"><i class="fa fa-check"></i><b>16.1</b> Solving logit QRE and estimating the model</a></li>
<li class="chapter" data-level="16.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#adding-some-heterogeneity-1"><i class="fa fa-check"></i><b>16.2</b> Adding some heterogeneity</a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#computing-quantal-response-equilibrium-with-heterogeneous-parameters"><i class="fa fa-check"></i><b>16.2.1</b> Computing quantal response equilibrium with heterogeneous parameters</a></li>
<li class="chapter" data-level="16.2.2" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#warm-glow-volunteering"><i class="fa fa-check"></i><b>16.2.2</b> Warm glow volunteering</a></li>
<li class="chapter" data-level="16.2.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#duplicate-aversion"><i class="fa fa-check"></i><b>16.2.3</b> Duplicate aversion</a></li>
<li class="chapter" data-level="16.2.4" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#results-4"><i class="fa fa-check"></i><b>16.2.4</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html"><a href="application-quantal-response-equilibrium-and-the-volunteers-dilemma-goeree2017.html#r-code-to-run-estimations"><i class="fa fa-check"></i><b>16.3</b> <em>R</em> code to run estimations</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html"><i class="fa fa-check"></i><b>17</b> Application: A Quantal Response Equilibrium with discrete types</a>
<ul>
<li class="chapter" data-level="17.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#example-dataset-and-models-1"><i class="fa fa-check"></i><b>17.1</b> Example dataset and models</a></li>
<li class="chapter" data-level="17.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-note-on-replication"><i class="fa fa-check"></i><b>17.2</b> A note on replication</a></li>
<li class="chapter" data-level="17.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#three-models-that-make-different-assumptions-about-bracketing"><i class="fa fa-check"></i><b>17.3</b> Three models that make different assumptions about bracketing</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#broad-bracketing-only"><i class="fa fa-check"></i><b>17.3.1</b> Broad bracketing only</a></li>
<li class="chapter" data-level="17.3.2" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#narrow-bracketing-only"><i class="fa fa-check"></i><b>17.3.2</b> Narrow bracketing only</a></li>
<li class="chapter" data-level="17.3.3" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#a-mixture-of-broad-and-narrow-bracketing"><i class="fa fa-check"></i><b>17.3.3</b> A mixture of broad and narrow bracketing</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#results-5"><i class="fa fa-check"></i><b>17.4</b> Results</a></li>
<li class="chapter" data-level="17.5" data-path="application-a-quantal-response-equilibrium-with-discrete-types.html"><a href="application-a-quantal-response-equilibrium-with-discrete-types.html#r-code-used-to-estimate-these-models"><i class="fa fa-check"></i><b>17.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><i class="fa fa-check"></i><b>18</b> Application: QRE in a Bayesian game and cursed equilibrium</a>
<ul>
<li class="chapter" data-level="18.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#example-game-and-dataset"><i class="fa fa-check"></i><b>18.1</b> Example game and dataset</a></li>
<li class="chapter" data-level="18.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#solving-for-qre"><i class="fa fa-check"></i><b>18.2</b> Solving for QRE</a>
<ul>
<li class="chapter" data-level="18.2.1" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#baseline-model"><i class="fa fa-check"></i><b>18.2.1</b> Baseline model</a></li>
<li class="chapter" data-level="18.2.2" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cursed-equilibrium"><i class="fa fa-check"></i><b>18.2.2</b> Cursed equilibrium</a></li>
</ul></li>
<li class="chapter" data-level="18.3" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#a-quick-prior-calibration-1"><i class="fa fa-check"></i><b>18.3</b> A quick prior calibration</a></li>
<li class="chapter" data-level="18.4" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-results"><i class="fa fa-check"></i><b>18.4</b> Model results</a></li>
<li class="chapter" data-level="18.5" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-evaluation-1"><i class="fa fa-check"></i><b>18.5</b> Model evaluation</a></li>
<li class="chapter" data-level="18.6" data-path="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#r-code-used-in-this-chapter"><i class="fa fa-check"></i><b>18.6</b> <em>R</em> code used in this chapter</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="application-level-k-models.html"><a href="application-level-k-models.html"><i class="fa fa-check"></i><b>19</b> Application: Level-<span class="math inline">\(k\)</span> models</a>
<ul>
<li class="chapter" data-level="19.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#data-and-game"><i class="fa fa-check"></i><b>19.1</b> Data and game</a></li>
<li class="chapter" data-level="19.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-level-k-model"><i class="fa fa-check"></i><b>19.2</b> The level-<span class="math inline">\(k\)</span> model</a>
<ul>
<li class="chapter" data-level="19.2.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-deterministic-component-of-the-model"><i class="fa fa-check"></i><b>19.2.1</b> The deterministic component of the model</a></li>
<li class="chapter" data-level="19.2.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#exact-and-probabilistic-play"><i class="fa fa-check"></i><b>19.2.2</b> Exact and probabilistic play</a></li>
</ul></li>
<li class="chapter" data-level="19.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#assigning-probabilities-to-types-for-each-participant-separately"><i class="fa fa-check"></i><b>19.3</b> Assigning probabilities to types for each participant separately</a>
<ul>
<li class="chapter" data-level="19.3.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program"><i class="fa fa-check"></i><b>19.3.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.3.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-2"><i class="fa fa-check"></i><b>19.3.2</b> Prior calibration</a></li>
<li class="chapter" data-level="19.3.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-6"><i class="fa fa-check"></i><b>19.3.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#doing-the-averaging-within-one-program"><i class="fa fa-check"></i><b>19.4</b> Doing the averaging within one program</a>
<ul>
<li class="chapter" data-level="19.4.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#the-stan-program-1"><i class="fa fa-check"></i><b>19.4.1</b> The <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.4.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-7"><i class="fa fa-check"></i><b>19.4.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-model"><i class="fa fa-check"></i><b>19.5</b> A mixture model</a>
<ul>
<li class="chapter" data-level="19.5.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program"><i class="fa fa-check"></i><b>19.5.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.5.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-prior-for-psi"><i class="fa fa-check"></i><b>19.5.2</b> A prior for <span class="math inline">\(\psi\)</span></a></li>
<li class="chapter" data-level="19.5.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-8"><i class="fa fa-check"></i><b>19.5.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.6" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-mixture-over-levels-and-hierarchical-nuisance-parameters"><i class="fa fa-check"></i><b>19.6</b> A mixture over levels and hierarchical nuisance parameters</a>
<ul>
<li class="chapter" data-level="19.6.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#prior-calibration-3"><i class="fa fa-check"></i><b>19.6.1</b> Prior calibration</a></li>
<li class="chapter" data-level="19.6.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-1"><i class="fa fa-check"></i><b>19.6.2</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.6.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-9"><i class="fa fa-check"></i><b>19.6.3</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.7" data-path="application-level-k-models.html"><a href="application-level-k-models.html#a-different-assumption-about-mixing"><i class="fa fa-check"></i><b>19.7</b> A different assumption about mixing</a>
<ul>
<li class="chapter" data-level="19.7.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#stan-program-2"><i class="fa fa-check"></i><b>19.7.1</b> <em>Stan</em> program</a></li>
<li class="chapter" data-level="19.7.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#results-10"><i class="fa fa-check"></i><b>19.7.2</b> Results</a></li>
</ul></li>
<li class="chapter" data-level="19.8" data-path="application-level-k-models.html"><a href="application-level-k-models.html#r-code-to-estimate-the-models"><i class="fa fa-check"></i><b>19.8</b> <em>R</em> code to estimate the models</a>
<ul>
<li class="chapter" data-level="19.8.1" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-conditional-on-k-with-bayesian-model-averaging"><i class="fa fa-check"></i><b>19.8.1</b> Participant-specific estimation conditional on <span class="math inline">\(k\)</span> with Bayesian model averaging</a></li>
<li class="chapter" data-level="19.8.2" data-path="application-level-k-models.html"><a href="application-level-k-models.html#participant-specific-estimation-with-a-prior-over-k"><i class="fa fa-check"></i><b>19.8.2</b> Participant-specific estimation with a prior over <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="19.8.3" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model"><i class="fa fa-check"></i><b>19.8.3</b> Mixture model</a></li>
<li class="chapter" data-level="19.8.4" data-path="application-level-k-models.html"><a href="application-level-k-models.html#hierarchical-model-1"><i class="fa fa-check"></i><b>19.8.4</b> Hierarchical model</a></li>
<li class="chapter" data-level="19.8.5" data-path="application-level-k-models.html"><a href="application-level-k-models.html#mixture-model-with-beliefs-consistent-with-truncated-type-distribution"><i class="fa fa-check"></i><b>19.8.5</b> Mixture model with beliefs consistent with truncated type distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="20" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html"><i class="fa fa-check"></i><b>20</b> Application: Estimating risk preferences</a>
<ul>
<li class="chapter" data-level="20.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#example-dataset"><i class="fa fa-check"></i><b>20.1</b> Example dataset</a></li>
<li class="chapter" data-level="20.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#we-might-not-just-be-interested-in-the-parameters"><i class="fa fa-check"></i><b>20.2</b> We might not just be interested in the parameters</a></li>
<li class="chapter" data-level="20.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#introducing-some-important-models"><i class="fa fa-check"></i><b>20.3</b> Introducing some important models</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#expected-utility-theory"><i class="fa fa-check"></i><b>20.3.1</b> Expected utility theory</a></li>
<li class="chapter" data-level="20.3.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#rank-dependent-utility-quiggin1982"><i class="fa fa-check"></i><b>20.3.2</b> Rank-dependent utility <span class="citation">(Quiggin 1982)</span></a></li>
<li class="chapter" data-level="20.3.3" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#comparing-the-certainty-equivalents-estimated-using-eut-and-rdu"><i class="fa fa-check"></i><b>20.3.3</b> Comparing the certainty equivalents estimated using EUT and RDU</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#a-hierarchical-specification"><i class="fa fa-check"></i><b>20.4</b> A hierarchical specification</a>
<ul>
<li class="chapter" data-level="20.4.1" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#population-level-estimates"><i class="fa fa-check"></i><b>20.4.1</b> Population-level estimates</a></li>
<li class="chapter" data-level="20.4.2" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#participant-level-estimates"><i class="fa fa-check"></i><b>20.4.2</b> Participant-level estimates</a></li>
</ul></li>
<li class="chapter" data-level="20.5" data-path="application-estimating-risk-preferences.html"><a href="application-estimating-risk-preferences.html#r-code-used-to-estimate-these-models-1"><i class="fa fa-check"></i><b>20.5</b> <em>R</em> code used to estimate these models</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html"><i class="fa fa-check"></i><b>21</b> Application: Meta-analysis using (some of) the METARET data</a>
<ul>
<li class="chapter" data-level="21.1" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#data"><i class="fa fa-check"></i><b>21.1</b> Data</a></li>
<li class="chapter" data-level="21.2" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#a-basic-model"><i class="fa fa-check"></i><b>21.2</b> A basic model</a></li>
<li class="chapter" data-level="21.3" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#but-the-data-are-really-interval-valued"><i class="fa fa-check"></i><b>21.3</b> But the data are really interval-valued!</a></li>
<li class="chapter" data-level="21.4" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#heterogeneous-standard-deviations"><i class="fa fa-check"></i><b>21.4</b> Heterogeneous standard deviations</a></li>
<li class="chapter" data-level="21.5" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#student-t-distributions-because-why-not"><i class="fa fa-check"></i><b>21.5</b> Student-<span class="math inline">\(t\)</span> distributions, because why not?</a></li>
<li class="chapter" data-level="21.6" data-path="application-meta-analysis-using-some-of-the-metaret-data.html"><a href="application-meta-analysis-using-some-of-the-metaret-data.html#r-code-to-estimate-the-models-1"><i class="fa fa-check"></i><b>21.6</b> <em>R</em> code to estimate the models</a></li>
</ul></li>
<li class="chapter" data-level="22" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html"><i class="fa fa-check"></i><b>22</b> Application: choice bracketing</a>
<ul>
<li class="chapter" data-level="22.1" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#data-and-model"><i class="fa fa-check"></i><b>22.1</b> Data and model</a></li>
<li class="chapter" data-level="22.2" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#representative-agent-and-individual-estimation"><i class="fa fa-check"></i><b>22.2</b> Representative agent and individual estimation</a></li>
<li class="chapter" data-level="22.3" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#hierarchical-model-2"><i class="fa fa-check"></i><b>22.3</b> Hierarchical model</a></li>
<li class="chapter" data-level="22.4" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#a-mixture-model-1"><i class="fa fa-check"></i><b>22.4</b> A mixture model</a></li>
<li class="chapter" data-level="22.5" data-path="application-choice-bracketing.html"><a href="application-choice-bracketing.html#what-do-we-get-out-of-the-structural-models-and-what-could-we-miss"><i class="fa fa-check"></i><b>22.5</b> What do we get out of the structural models, and what could we miss?</a></li>
</ul></li>
<li class="chapter" data-level="23" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html"><i class="fa fa-check"></i><b>23</b> Application: Ranked choices and the Thurstonian model</a>
<ul>
<li class="chapter" data-level="23.1" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#the-thurstonian-model"><i class="fa fa-check"></i><b>23.1</b> The Thurstonian model</a></li>
<li class="chapter" data-level="23.2" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#computational-issues"><i class="fa fa-check"></i><b>23.2</b> Computational issues</a></li>
<li class="chapter" data-level="23.3" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#example-dataset-and-model-2"><i class="fa fa-check"></i><b>23.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="23.4" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-representative-agent-model"><i class="fa fa-check"></i><b>23.4</b> A representative agent model</a></li>
<li class="chapter" data-level="23.5" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#a-hierarchical-model"><i class="fa fa-check"></i><b>23.5</b> A hierarchical model</a></li>
<li class="chapter" data-level="23.6" data-path="application-ranked-choices-and-the-thurstonian-model.html"><a href="application-ranked-choices-and-the-thurstonian-model.html#r-code-used-to-run-this"><i class="fa fa-check"></i><b>23.6</b> <em>R</em> code used to run this</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="links-to-data.html"><a href="links-to-data.html"><i class="fa fa-check"></i>Links to data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="application-qre-in-a-bayesian-game-and-cursed-equilibrium" class="section level1 hasAnchor" number="18">
<h1><span class="header-section-number">18</span> Application: QRE in a Bayesian game and cursed equilibrium<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#application-qre-in-a-bayesian-game-and-cursed-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Many games we study in the lab are <em>Bayesian</em> games. These could include, but are not limited to, auctions, signaling games, and poker. Bayesian games involve heterogeneous players. This adds a lot of realism to the model, but also makes things more complicated, because we need to keep track of player <em>types</em>. For quantal response equilibrium, this usually means solving for the equilibrium mixed strategy for <em>every</em> type.<a href="#fn78" class="footnote-ref" id="fnref78"><sup>78</sup></a> Once the sytem of equations describing the QRE is set up, solving for QRE is done in exactly the same way as a non-Bayesian game.</p>
<div id="example-game-and-dataset" class="section level2 hasAnchor" number="18.1">
<h2><span class="header-section-number">18.1</span> Example game and dataset<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#example-game-and-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will use a game studied experimentally in <span class="citation">Bochet and Magnani (<a href="#ref-BM2024">2024</a>)</span>. In this game, two players are randomly endowed with a quality <span class="math inline">\(q_i\in\{H,M,L\}\)</span>, and a signal <span class="math inline">\(s_i\in\{h,m,l\}\)</span> that is informative of their opponent’s quality. Each of the three qualities are equally likely to be drawn, and players’ qualities are independent draws. After observing their qualities and signals, players play a one-shot game, whose payoffs depend on the players’ qualities. This game is shown in Table <a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#tab:BM2024payoffs">18.1</a>. Here <span class="math inline">\(\mu(\cdot)\)</span> and <span class="math inline">\(\rho(\cdot)\)</span> are funtions of qualities. In particular, note that if player <span class="math inline">\(i\)</span> chooses to not propose (<span class="math inline">\(N\)</span>), then they guarantee a known payoff of <span class="math inline">\(\rho(q_i)\)</span> (since they know their own quality). They also earn this payoff if their opponent chooses <span class="math inline">\(N\)</span>, irrespective of their own action. On the other hand, if both players choose to propose (<span class="math inline">\(P\)</span>), then each player earns a payoff that is a function of their <em>opponent’s</em> quality. The payoff values for <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\rho\)</span> are shown in Table <a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#tab:BM2024payoffvalues">18.2</a>. Here there are two treatments, with Game A having a larger reservation payoff for the high type compared to Game B.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-1" tabindex="-1"></a>payoffs<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb218-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-2" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">mu(q_2)$, $</span><span class="sc">\\</span><span class="st">mu(q_1)$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">rho(q_1)$, $</span><span class="sc">\\</span><span class="st">rho(q_2)$&quot;</span>),</span>
<span id="cb218-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-3" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">rho(q_1)$, $</span><span class="sc">\\</span><span class="st">rho(q_2)$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">rho(q_1)$, $</span><span class="sc">\\</span><span class="st">rho(q_2)$&quot;</span>)</span>
<span id="cb218-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-4" tabindex="-1"></a>)</span>
<span id="cb218-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-5" tabindex="-1"></a><span class="fu">colnames</span>(payoffs)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;P&quot;</span>,<span class="st">&quot;N&quot;</span>)<span class="ot">-&gt;</span><span class="fu">rownames</span>(payoffs)</span>
<span id="cb218-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-6" tabindex="-1"></a>payoffs <span class="sc">|&gt;</span> </span>
<span id="cb218-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-7" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Proposal game studied in Bochet and Magnani (2024)&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb218-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb218-8" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:BM2024payoffs">Table 18.1: </span>Proposal game studied in Bochet and Magnani (2024)
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
P
</th>
<th style="text-align:left;">
N
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
P
</td>
<td style="text-align:left;">
<span class="math inline">\(\mu(q_2)\)</span>, <span class="math inline">\(\mu(q_1)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\rho(q_1)\)</span>, <span class="math inline">\(\rho(q_2)\)</span>
</td>
</tr>
<tr>
<td style="text-align:left;">
N
</td>
<td style="text-align:left;">
<span class="math inline">\(\rho(q_1)\)</span>, <span class="math inline">\(\rho(q_2)\)</span>
</td>
<td style="text-align:left;">
<span class="math inline">\(\rho(q_1)\)</span>, <span class="math inline">\(\rho(q_2)\)</span>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-1" tabindex="-1"></a>TAB<span class="ot">&lt;-</span><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">80</span>,<span class="dv">40</span>),</span>
<span id="cb219-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-2" tabindex="-1"></a>           <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">75</span>,<span class="dv">25</span>),</span>
<span id="cb219-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-3" tabindex="-1"></a>           <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">75</span>,<span class="dv">25</span>)</span>
<span id="cb219-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-4" tabindex="-1"></a>           )</span>
<span id="cb219-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-5" tabindex="-1"></a></span>
<span id="cb219-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-6" tabindex="-1"></a><span class="fu">rownames</span>(TAB)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">mu(q)$&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">rho(q)$ (Game A)&quot;</span>,<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">rho(q)$ (Game B)&quot;</span>)</span>
<span id="cb219-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-7" tabindex="-1"></a><span class="fu">colnames</span>(TAB)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;$H$&quot;</span>,<span class="st">&quot;$M$&quot;</span>,<span class="st">&quot;$L$&quot;</span>)</span>
<span id="cb219-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-8" tabindex="-1"></a></span>
<span id="cb219-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-9" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb219-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-10" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">&quot;Payoff values in game studied in Bochet and Magnani (2024)</span></span>
<span id="cb219-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-11" tabindex="-1"></a><span class="st">&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb219-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-12" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb219-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb219-13" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">&quot; &quot;</span><span class="ot">=</span><span class="dv">1</span>,<span class="st">&quot;$q$&quot;</span><span class="ot">=</span><span class="dv">3</span>))</span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:BM2024payoffvalues">Table 18.2: </span>Payoff values in game studied in Bochet and Magnani (2024)
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="border-bottom: 1px solid #111111; margin-bottom: -1px; ">
<span class="math inline">\(q\)</span>
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
<span class="math inline">\(H\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(M\)</span>
</th>
<th style="text-align:right;">
<span class="math inline">\(L\)</span>
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\mu(q)\)</span>
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
40
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\rho(q)\)</span> (Game A)
</td>
<td style="text-align:right;">
100
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
25
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\rho(q)\)</span> (Game B)
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
25
</td>
</tr>
</tbody>
</table>
</div>
<div id="solving-for-qre" class="section level2 hasAnchor" number="18.2">
<h2><span class="header-section-number">18.2</span> Solving for QRE<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#solving-for-qre" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As in <span class="citation">Bochet and Magnani (<a href="#ref-BM2024">2024</a>)</span>, we will here focus on the <em>symmetric</em> equilibrium of the game, where all players with the same type choose <span class="math inline">\(P\)</span> with the same probability. Since there are three different qualities that a player could have, and three different signals a player could receive, this means that there are <span class="math inline">\(3\times 3=9\)</span> types in this game. That is, the types indexed by the quality-signal combination are:</p>
<p><span class="math display">\[
(q,s)=\tau\in \{Hh,Mh,Lh, Hm, Mm, Lm, Hl, Ml, Ll\}
\]</span></p>
<p>In the code below you will see that there are a lot of 9-dimensional vectors and <span class="math inline">\(9\times9\)</span> matrices for this reason. I will use this ordering of types as a convention for indexing these vectors and matrices. For example, the fourth element of the vector of mixed strategies will correspond to the proposal probability for players who are quality <span class="math inline">\(q=H\)</span> and receive signal <span class="math inline">\(s=m\)</span>.</p>
<p>We will start by deriving equations that describe the quantal response equilibrium of the game assuming that players properly condition their beliefs on whether or not their opponent proposes. This will be our “baseline” model. We will then implement a 1-parameter extension that permits players to not fully take the informational content of the opponent’s strategy into account. This is called “cursed equilibrium” <span class="citation">(<a href="#ref-Eyster2005">Eyster and Rabin 2005</a>)</span>.</p>
<div id="baseline-model" class="section level3 hasAnchor" number="18.2.1">
<h3><span class="header-section-number">18.2.1</span> Baseline model<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#baseline-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note here that I am not following the notation of the original paper. I found it very helpful to work my way through this with using the joint distribution of qualities and signals, which I denote <span class="math inline">\(\pi(q,s,q&#39;,s&#39;)\)</span>. From here, all expected utilities can be expressed as a conditional distribution <span class="math inline">\(\pi(q&#39;,s&#39;\mid q,s)\)</span> which is a player with quality <span class="math inline">\(q\)</span> and signal <span class="math inline">\(s\)</span>’s belief about the quality and signal of their opponent.</p>
<p>A player with quality <span class="math inline">\(q\)</span> and signal <span class="math inline">\(s\)</span> proposes with probability <span class="math inline">\(\sigma(q,s)\)</span>. Let <span class="math inline">\(\pi(q,s)\)</span> be the joint distribution of quality and signals.</p>
<p>Given signal <span class="math inline">\(s\)</span>, a player’s posterior beliefs about their opponent’s quality is:</p>
<p><span class="math display">\[
\pi(q&#39;\mid s)=\frac{\pi(q&#39;,s)}{\pi(s)}=\frac{\pi(q&#39;,s)}{\sum_{q&#39;&#39;}\pi(q&#39;&#39;,s)}
\]</span></p>
<p>Note that the player’s quality <span class="math inline">\(q\)</span> is informative of the signal the opponent received. That is:</p>
<p><span class="math display">\[
\pi(s&#39;\mid q)=\frac{\pi(q,s&#39;)}{\pi(q)}=\frac{\pi(q,s&#39;)}{\sum_{s&#39;&#39;}\pi(q,s&#39;&#39;)}
\]</span></p>
<p>Hence, the player has informed beliefs about their opponent’s quality, <span class="math inline">\(\pi(q&#39;\mid s)\)</span>, and informed beliefs about their opponent’s signal <span class="math inline">\(\pi(s&#39;\mid q)\)</span>. We can summarize this as joint beliefs over the opponent’s quality and signal as follows:</p>
<p><span class="math display">\[
\begin{aligned}
\pi(q&#39;,s&#39;\mid q,s)&amp;=\frac{\pi(q,s,q&#39;,s&#39;)}{\sum_{q&#39;,s&#39;}\pi(q,s,q&#39;,s&#39;)}
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\pi(q&#39;,s&#39;,q,s)&amp;=\pi(s,s&#39;\mid q,q&#39;)\pi(q,q&#39;)\\
&amp;=\pi(s&#39;\mid q)\pi(s\mid q&#39;)\pi(q)\pi(q&#39;)
\end{aligned}
\]</span></p>
<p>where the second line follows because qualities are unconditionally independent, and signals are independent conditional on opponent’s quality.<a href="#fn79" class="footnote-ref" id="fnref79"><sup>79</sup></a> Since <span class="math inline">\(\pi(q&#39;,s&#39;\mid q,s)\)</span> is only a function of the type-generating process, which is exogenous in the game, we can pre-compute these quantities in <em>Stan</em>’s <code>transformed data</code> block. You will see these computed there as <code>PI</code>(for the joint distribution), and <code>PI_cond</code> (for the conditional distribution).</p>
<p>It follows that the expected utility of proposing with quality <span class="math inline">\(q\)</span> and signal <span class="math inline">\(s\)</span> is:</p>
<p><span class="math display">\[
\begin{aligned}
U^P(q,s)&amp;=E_{q&#39;,s&#39;}\left[\mu(q&#39;)\sigma(q&#39;,s&#39;)+(1-\sigma(q&#39;,s&#39;))\rho(q) \mid q,s\right]
\\
&amp;=\sum_{q&#39;,s&#39;}\left[\mu(q&#39;)\sigma(q&#39;,s&#39;)+(1-\sigma(q&#39;,s&#39;))\rho(q)\right]\pi(q&#39;,s&#39;\mid q,s)
\end{aligned}
\]</span></p>
<p>and the utility of not proposing is <span class="math inline">\(U^N(q,s)=\rho(q)\)</span>.</p>
<p>We can therefore write the QRE conditions in logit form, with <span class="math inline">\(\ell(q,s)=\mathrm{logit}(\sigma(q,s))\)</span>, as:</p>
<p><span class="math display">\[
\begin{aligned}
H_{q,s}(\lambda,\sigma)&amp;=\ell(q,s)-\lambda\left[\sum_{q&#39;,s&#39;}\left[\mu(q&#39;)\sigma(q&#39;,s&#39;)+(1-\sigma(q&#39;,s&#39;))\rho(q)\right]\pi(q&#39;,s&#39;\mid q,s)-\rho(q)\right]
\end{aligned}
\]</span></p>
<p>with derivatives:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial H_{q,s}(\lambda,\sigma)}{\partial \ell(t,v)}
&amp;=I((q,s)=(t,v))-\lambda\left[\mu(t)-\rho(q)\right]\pi(t,v\mid q,s)\frac{\partial \sigma(t,v)}{\partial \ell(t,v)}\\
&amp;=I((q,s)=(t,v))-\lambda\left[\mu(t)-\rho(q)\right]\pi(t,v\mid q,s)\sigma(t,v)(1-\sigma(t,v))
\end{aligned}
\]</span></p>
<p>and:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial H_{q,s}}{\partial \lambda}&amp;=-\sum_{q&#39;,s&#39;}\left[\mu(q&#39;)\sigma(q&#39;,s&#39;)+(1-\sigma(q&#39;,s&#39;))\rho(q)\right]\pi(q&#39;,s&#39;\mid q,s)-\rho(q)
\end{aligned}
\]</span></p>
<p>I then implement a predictor-corrector algorithm as follows:<a href="#fn80" class="footnote-ref" id="fnref80"><sup>80</sup></a></p>
<ol start="0" style="list-style-type: decimal">
<li><strong>Initialization:</strong> Start at a known QRE. This is <span class="math inline">\(\lambda=0\)</span>, <span class="math inline">\(\sigma(q,s)=0.5\ \forall q,s\)</span>; or <span class="math inline">\(\lambda=0\)</span>, <span class="math inline">\(\ell(q,s)=0\ \forall q,s\)</span>.</li>
<li><strong>Predictor step:</strong> Use the derivative <span class="math inline">\(\frac{\partial H}{\partial \lambda}\)</span> to predict the direction of <span class="math inline">\(\ell\)</span> for a small increase in <span class="math inline">\(\lambda\)</span>. That is: <span class="math inline">\(\ell^{t+1}=\ell^t+\frac{\partial H}{\partial \lambda}(\lambda^{t+1}-\lambda^t)\)</span></li>
<li><strong>Corrector steps:</strong> Correct for any errors made with the linear approximation in (1) using Newton’s method. That is, iterate on <span class="math inline">\(\ell^{t+1}=\ell^t-\left(\frac{\partial H(\lambda,\ell)}{\partial \ell^\top}\right)^{-1}H(\lambda,\ell)\)</span> until a desired level of accuracy is achieved.</li>
<li><strong>Repeat:</strong> If <span class="math inline">\(\lambda^t\)</span> is less than the required <span class="math inline">\(\lambda\)</span>, go back to step (1).</li>
</ol>
<p>Here is the <em>Stan</em> program I wrote to estimate this baseline QRE model. Note that I am passing an array of integers called <code>UseData</code> to <em>Stan</em>. This is a list of rows of the data that will contribute to the likelihood. This will be useful for cross-validation, as we will need to estimate the model several times leaving out different groups of observations.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb220-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-1" tabindex="-1"></a></span>
<span id="cb220-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-2" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb220-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-3" tabindex="-1"></a>  </span>
<span id="cb220-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-4" tabindex="-1"></a>  vector H<span class="op">(</span>real lambda<span class="op">,</span> vector ell<span class="op">,</span></span>
<span id="cb220-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-5" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb220-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-6" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb220-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-7" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS</span>
<span id="cb220-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-8" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-9" tabindex="-1"></a>    </span>
<span id="cb220-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-10" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma <span class="op">=</span> inv_logit<span class="op">(</span>ell<span class="op">);</span></span>
<span id="cb220-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-11" tabindex="-1"></a>    </span>
<span id="cb220-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-12" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> ell<span class="op">;</span></span>
<span id="cb220-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-13" tabindex="-1"></a>    </span>
<span id="cb220-14"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-14" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-15"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-15" tabindex="-1"></a>      </span>
<span id="cb220-16"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-16" tabindex="-1"></a>      result<span class="op">[</span>rr<span class="op">]</span> <span class="op">-=</span> lambda<span class="op">*(</span>sum<span class="op">(</span></span>
<span id="cb220-17"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-17" tabindex="-1"></a>        <span class="op">(</span>mu<span class="op">[</span>QQ<span class="op">].*</span>sigma<span class="op">+(</span><span class="fl">1.0</span><span class="op">-</span>sigma<span class="op">)*</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]).*</span>PI_cond<span class="op">[,</span>rr<span class="op">]</span></span>
<span id="cb220-18"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-18" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb220-19"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-19" tabindex="-1"></a>        <span class="op">-</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]</span></span>
<span id="cb220-20"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-20" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb220-21"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-21" tabindex="-1"></a></span>
<span id="cb220-22"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-22" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-23"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-23" tabindex="-1"></a>    </span>
<span id="cb220-24"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-24" tabindex="-1"></a>    </span>
<span id="cb220-25"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-25" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span>    </span>
<span id="cb220-26"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-26" tabindex="-1"></a>    </span>
<span id="cb220-27"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-27" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-28"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-28" tabindex="-1"></a>  </span>
<span id="cb220-29"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-29" tabindex="-1"></a>  </span>
<span id="cb220-30"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-30" tabindex="-1"></a>  matrix DH<span class="op">(</span>real lambda<span class="op">,</span> vector ell<span class="op">,</span></span>
<span id="cb220-31"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-31" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb220-32"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-32" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb220-33"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-33" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS</span>
<span id="cb220-34"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-34" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-35"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-35" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma <span class="op">=</span> inv_logit<span class="op">(</span>ell<span class="op">);</span></span>
<span id="cb220-36"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-36" tabindex="-1"></a>   </span>
<span id="cb220-37"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-37" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> diag_matrix<span class="op">(</span>rep_vector<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span><span class="dv">9</span><span class="op">));</span></span>
<span id="cb220-38"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-38" tabindex="-1"></a>   </span>
<span id="cb220-39"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-39" tabindex="-1"></a>   <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-40"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-40" tabindex="-1"></a>     <span class="cf">for</span> <span class="op">(</span>cc in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-41"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-41" tabindex="-1"></a>       </span>
<span id="cb220-42"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-42" tabindex="-1"></a>       </span>
<span id="cb220-43"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-43" tabindex="-1"></a>       result<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]+=</span> <span class="op">-</span>lambda<span class="op">*(</span>mu<span class="op">[</span>QQ<span class="op">[</span>cc<span class="op">]]-</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]])*</span>PI_cond<span class="op">[</span>cc<span class="op">,</span>rr<span class="op">]*</span>sigma<span class="op">[</span>cc<span class="op">]*(</span><span class="fl">1.0</span><span class="op">-</span>sigma<span class="op">[</span>cc<span class="op">]);</span></span>
<span id="cb220-44"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-44" tabindex="-1"></a>       </span>
<span id="cb220-45"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-45" tabindex="-1"></a>     <span class="op">}</span></span>
<span id="cb220-46"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-46" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb220-47"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-47" tabindex="-1"></a>   <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb220-48"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-48" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-49"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-49" tabindex="-1"></a>  </span>
<span id="cb220-50"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-50" tabindex="-1"></a>  vector dlH<span class="op">(</span>real lambda<span class="op">,</span> vector ell<span class="op">,</span></span>
<span id="cb220-51"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-51" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb220-52"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-52" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb220-53"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-53" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS</span>
<span id="cb220-54"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-54" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-55"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-55" tabindex="-1"></a>    </span>
<span id="cb220-56"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-56" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma <span class="op">=</span> inv_logit<span class="op">(</span>ell<span class="op">);</span></span>
<span id="cb220-57"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-57" tabindex="-1"></a>    </span>
<span id="cb220-58"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-58" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> ell<span class="op">;</span></span>
<span id="cb220-59"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-59" tabindex="-1"></a>    </span>
<span id="cb220-60"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-60" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-61"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-61" tabindex="-1"></a>      </span>
<span id="cb220-62"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-62" tabindex="-1"></a>      result<span class="op">[</span>rr<span class="op">]</span> <span class="op">-=</span> <span class="op">(</span>sum<span class="op">(</span></span>
<span id="cb220-63"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-63" tabindex="-1"></a>        <span class="op">(</span>mu<span class="op">[</span>QQ<span class="op">].*</span>sigma<span class="op">+(</span><span class="fl">1.0</span><span class="op">-</span>sigma<span class="op">)*</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]).*</span>PI_cond<span class="op">[,</span>rr<span class="op">]</span></span>
<span id="cb220-64"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-64" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb220-65"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-65" tabindex="-1"></a>        <span class="op">-</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]</span></span>
<span id="cb220-66"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-66" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb220-67"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-67" tabindex="-1"></a></span>
<span id="cb220-68"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-68" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-69"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-69" tabindex="-1"></a>    </span>
<span id="cb220-70"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-70" tabindex="-1"></a>    </span>
<span id="cb220-71"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-71" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span>    </span>
<span id="cb220-72"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-72" tabindex="-1"></a>    </span>
<span id="cb220-73"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-73" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-74"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-74" tabindex="-1"></a>  </span>
<span id="cb220-75"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-75" tabindex="-1"></a>  </span>
<span id="cb220-76"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-76" tabindex="-1"></a>  </span>
<span id="cb220-77"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-77" tabindex="-1"></a>  vector solve_QRE<span class="op">(</span>real lambda<span class="op">,</span></span>
<span id="cb220-78"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-78" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb220-79"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-79" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb220-80"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-80" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS<span class="op">,</span></span>
<span id="cb220-81"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-81" tabindex="-1"></a>    data <span class="dt">int</span> maxiter<span class="op">,</span> data real tol<span class="op">,</span> data vector lxgrid</span>
<span id="cb220-82"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-82" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-83"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-83" tabindex="-1"></a>       vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span><span class="dv">9</span><span class="op">);</span></span>
<span id="cb220-84"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-84" tabindex="-1"></a>       </span>
<span id="cb220-85"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-85" tabindex="-1"></a>       <span class="dt">int</span> nx <span class="op">=</span> dims<span class="op">(</span>lxgrid<span class="op">)[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb220-86"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-86" tabindex="-1"></a>       </span>
<span id="cb220-87"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-87" tabindex="-1"></a>       <span class="cf">for</span> <span class="op">(</span>ll in <span class="dv">2</span><span class="op">:</span>nx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-88"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-88" tabindex="-1"></a>         </span>
<span id="cb220-89"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-89" tabindex="-1"></a>         <span class="co">// predictor step</span></span>
<span id="cb220-90"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-90" tabindex="-1"></a>         </span>
<span id="cb220-91"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-91" tabindex="-1"></a>         real l <span class="op">=</span> lambda<span class="op">*</span><span class="fl">0.5</span><span class="op">*(</span>lxgrid<span class="op">[</span>ll<span class="op">-</span><span class="dv">1</span><span class="op">]+</span>lxgrid<span class="op">[</span>ll<span class="op">]);</span></span>
<span id="cb220-92"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-92" tabindex="-1"></a>         vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> Hlambda <span class="op">=</span> dlH<span class="op">(</span>l<span class="op">,</span>result<span class="op">,</span>PI_cond<span class="op">,</span>mu<span class="op">,</span>rho<span class="op">,</span>QQ<span class="op">,</span>SS<span class="op">);</span></span>
<span id="cb220-93"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-93" tabindex="-1"></a>         result <span class="op">+=</span> Hlambda<span class="op">*(</span>lxgrid<span class="op">[</span>ll<span class="op">]-</span>lxgrid<span class="op">[</span>ll<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb220-94"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-94" tabindex="-1"></a>         </span>
<span id="cb220-95"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-95" tabindex="-1"></a>         l <span class="op">=</span> lambda<span class="op">*</span>lxgrid<span class="op">[</span>ll<span class="op">];</span></span>
<span id="cb220-96"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-96" tabindex="-1"></a>         </span>
<span id="cb220-97"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-97" tabindex="-1"></a>         <span class="co">// corrector step</span></span>
<span id="cb220-98"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-98" tabindex="-1"></a>         <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-99"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-99" tabindex="-1"></a>           </span>
<span id="cb220-100"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-100" tabindex="-1"></a>           matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> J <span class="op">=</span> DH<span class="op">(</span>l<span class="op">,</span>result<span class="op">,</span>PI_cond<span class="op">,</span>mu<span class="op">,</span>rho<span class="op">,</span>QQ<span class="op">,</span>SS<span class="op">);</span></span>
<span id="cb220-101"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-101" tabindex="-1"></a>           vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span>   F <span class="op">=</span> H<span class="op">(</span>l<span class="op">,</span>result<span class="op">,</span>PI_cond<span class="op">,</span>mu<span class="op">,</span>rho<span class="op">,</span>QQ<span class="op">,</span>SS<span class="op">);</span></span>
<span id="cb220-102"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-102" tabindex="-1"></a>           </span>
<span id="cb220-103"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-103" tabindex="-1"></a>           vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> dx <span class="op">=</span> <span class="op">-</span>J\F<span class="op">;</span></span>
<span id="cb220-104"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-104" tabindex="-1"></a>           </span>
<span id="cb220-105"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-105" tabindex="-1"></a>           result <span class="op">+=</span> dx<span class="op">;</span></span>
<span id="cb220-106"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-106" tabindex="-1"></a>           </span>
<span id="cb220-107"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-107" tabindex="-1"></a>           <span class="cf">if</span> <span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>dx<span class="op">))&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-108"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-108" tabindex="-1"></a>             </span>
<span id="cb220-109"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-109" tabindex="-1"></a>             <span class="cf">break</span><span class="op">;</span></span>
<span id="cb220-110"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-110" tabindex="-1"></a>           <span class="op">}</span></span>
<span id="cb220-111"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-111" tabindex="-1"></a>           </span>
<span id="cb220-112"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-112" tabindex="-1"></a>           <span class="cf">if</span> <span class="op">(</span>ii <span class="op">==</span> maxiter <span class="op">&amp;&amp;</span> ll<span class="op">==</span>nx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-113"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-113" tabindex="-1"></a>             </span>
<span id="cb220-114"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-114" tabindex="-1"></a>             print<span class="op">(</span><span class="st">&quot;Corrector step did not converge for lambda =&quot;</span><span class="op">,</span>l<span class="op">);</span></span>
<span id="cb220-115"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-115" tabindex="-1"></a>             </span>
<span id="cb220-116"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-116" tabindex="-1"></a>           <span class="op">}</span></span>
<span id="cb220-117"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-117" tabindex="-1"></a>           </span>
<span id="cb220-118"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-118" tabindex="-1"></a>         <span class="op">}</span></span>
<span id="cb220-119"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-119" tabindex="-1"></a>         </span>
<span id="cb220-120"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-120" tabindex="-1"></a>         <span class="co">//</span></span>
<span id="cb220-121"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-121" tabindex="-1"></a>       <span class="op">}</span></span>
<span id="cb220-122"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-122" tabindex="-1"></a>       </span>
<span id="cb220-123"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-123" tabindex="-1"></a>       <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb220-124"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-124" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-125"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-125" tabindex="-1"></a>  </span>
<span id="cb220-126"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-126" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-127"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-127" tabindex="-1"></a></span>
<span id="cb220-128"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-128" tabindex="-1"></a></span>
<span id="cb220-129"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-129" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb220-130"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-130" tabindex="-1"></a>  </span>
<span id="cb220-131"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-131" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span></span>
<span id="cb220-132"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-132" tabindex="-1"></a>  </span>
<span id="cb220-133"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-133" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">9</span><span class="op">&gt;</span> type<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb220-134"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-134" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">2</span><span class="op">&gt;</span> game<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb220-135"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-135" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> action<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb220-136"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-136" tabindex="-1"></a>  </span>
<span id="cb220-137"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-137" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span>N<span class="op">&gt;</span> nUseData<span class="op">;</span></span>
<span id="cb220-138"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-138" tabindex="-1"></a>  <span class="dt">int</span> UseData<span class="op">[</span>nUseData<span class="op">];</span></span>
<span id="cb220-139"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-139" tabindex="-1"></a>  </span>
<span id="cb220-140"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-140" tabindex="-1"></a>  </span>
<span id="cb220-141"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-141" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_lambda<span class="op">;</span></span>
<span id="cb220-142"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-142" tabindex="-1"></a>  </span>
<span id="cb220-143"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-143" tabindex="-1"></a>  <span class="dt">int</span> maxiter<span class="op">;</span></span>
<span id="cb220-144"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-144" tabindex="-1"></a>  real tol<span class="op">;</span></span>
<span id="cb220-145"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-145" tabindex="-1"></a>  <span class="dt">int</span> nlxgrid<span class="op">;</span></span>
<span id="cb220-146"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-146" tabindex="-1"></a>  </span>
<span id="cb220-147"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-147" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-148"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-148" tabindex="-1"></a></span>
<span id="cb220-149"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-149" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb220-150"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-150" tabindex="-1"></a>  </span>
<span id="cb220-151"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-151" tabindex="-1"></a>  <span class="co">// grid to trace out QRE</span></span>
<span id="cb220-152"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-152" tabindex="-1"></a>  </span>
<span id="cb220-153"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-153" tabindex="-1"></a>  vector<span class="op">[</span>nlxgrid<span class="op">]</span> lxgrid<span class="op">;</span></span>
<span id="cb220-154"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-154" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nlxgrid<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-155"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-155" tabindex="-1"></a>    lxgrid<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>ii<span class="op">-</span><span class="fl">1.0</span><span class="op">)/(</span>nlxgrid<span class="op">-</span><span class="fl">1.0</span><span class="op">);</span></span>
<span id="cb220-156"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-156" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-157"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-157" tabindex="-1"></a>  </span>
<span id="cb220-158"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-158" tabindex="-1"></a>  </span>
<span id="cb220-159"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-159" tabindex="-1"></a>  </span>
<span id="cb220-160"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-160" tabindex="-1"></a>  <span class="co">// game parameters</span></span>
<span id="cb220-161"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-161" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> mu <span class="op">=</span> <span class="op">[</span><span class="dv">160</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">40</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb220-162"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-162" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> rho<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb220-163"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-163" tabindex="-1"></a>    rho<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">100</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">25</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb220-164"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-164" tabindex="-1"></a>    rho<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">80</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">25</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb220-165"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-165" tabindex="-1"></a>  </span>
<span id="cb220-166"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-166" tabindex="-1"></a>  </span>
<span id="cb220-167"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-167" tabindex="-1"></a>  <span class="co">// data that actually contributes to the likelihood</span></span>
<span id="cb220-168"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-168" tabindex="-1"></a>  <span class="dt">int</span> type_training<span class="op">[</span>nUseData<span class="op">]</span> <span class="op">=</span> type<span class="op">[</span>UseData<span class="op">];</span></span>
<span id="cb220-169"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-169" tabindex="-1"></a>  <span class="dt">int</span> game_training<span class="op">[</span>nUseData<span class="op">]</span> <span class="op">=</span> game<span class="op">[</span>UseData<span class="op">];</span></span>
<span id="cb220-170"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-170" tabindex="-1"></a>  <span class="dt">int</span> action_training<span class="op">[</span>nUseData<span class="op">]</span> <span class="op">=</span> action<span class="op">[</span>UseData<span class="op">];</span></span>
<span id="cb220-171"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-171" tabindex="-1"></a>  </span>
<span id="cb220-172"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-172" tabindex="-1"></a>  <span class="co">// data used for testing</span></span>
<span id="cb220-173"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-173" tabindex="-1"></a>  <span class="dt">int</span> type_test<span class="op">[</span>N<span class="op">-</span>nUseData<span class="op">];</span></span>
<span id="cb220-174"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-174" tabindex="-1"></a>  <span class="dt">int</span> game_test<span class="op">[</span>N<span class="op">-</span>nUseData<span class="op">];</span></span>
<span id="cb220-175"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-175" tabindex="-1"></a>  <span class="dt">int</span> action_test<span class="op">[</span>N<span class="op">-</span>nUseData<span class="op">];</span></span>
<span id="cb220-176"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-176" tabindex="-1"></a>  </span>
<span id="cb220-177"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-177" tabindex="-1"></a>  <span class="dt">int</span> count_test <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb220-178"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-178" tabindex="-1"></a>  <span class="dt">int</span> count_train <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb220-179"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-179" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-180"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-180" tabindex="-1"></a>    </span>
<span id="cb220-181"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-181" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>nUseData<span class="op">&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-182"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-182" tabindex="-1"></a>    </span>
<span id="cb220-183"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-183" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">[</span>count_train<span class="op">]==</span>ii<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-184"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-184" tabindex="-1"></a>        </span>
<span id="cb220-185"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-185" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>count_train <span class="op">&lt;</span> nUseData<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-186"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-186" tabindex="-1"></a>          count_train <span class="op">+=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb220-187"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-187" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb220-188"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-188" tabindex="-1"></a>        </span>
<span id="cb220-189"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-189" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb220-190"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-190" tabindex="-1"></a>        type_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> type<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb220-191"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-191" tabindex="-1"></a>        game_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> game<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb220-192"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-192" tabindex="-1"></a>        action_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> action<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb220-193"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-193" tabindex="-1"></a>        count_test<span class="op">+=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb220-194"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-194" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb220-195"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-195" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb220-196"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-196" tabindex="-1"></a>        type_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> type<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb220-197"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-197" tabindex="-1"></a>        game_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> game<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb220-198"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-198" tabindex="-1"></a>        action_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> action<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb220-199"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-199" tabindex="-1"></a>        count_test<span class="op">+=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb220-200"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-200" tabindex="-1"></a>      </span>
<span id="cb220-201"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-201" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-202"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-202" tabindex="-1"></a>    </span>
<span id="cb220-203"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-203" tabindex="-1"></a>    </span>
<span id="cb220-204"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-204" tabindex="-1"></a>    </span>
<span id="cb220-205"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-205" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-206"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-206" tabindex="-1"></a>  </span>
<span id="cb220-207"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-207" tabindex="-1"></a>  </span>
<span id="cb220-208"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-208" tabindex="-1"></a>  <span class="co">// some indices for identifying types</span></span>
<span id="cb220-209"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-209" tabindex="-1"></a>  </span>
<span id="cb220-210"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-210" tabindex="-1"></a>  </span>
<span id="cb220-211"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-211" tabindex="-1"></a>  <span class="dt">int</span> QQ<span class="op">[</span><span class="dv">9</span><span class="op">];</span></span>
<span id="cb220-212"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-212" tabindex="-1"></a>  <span class="dt">int</span> SS<span class="op">[</span><span class="dv">9</span><span class="op">];</span></span>
<span id="cb220-213"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-213" tabindex="-1"></a>  </span>
<span id="cb220-214"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-214" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>qq in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-215"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-215" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-216"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-216" tabindex="-1"></a>      </span>
<span id="cb220-217"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-217" tabindex="-1"></a>      <span class="dt">int</span> tt <span class="op">=</span> qq<span class="op">+</span><span class="dv">3</span><span class="op">*(</span>ss<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb220-218"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-218" tabindex="-1"></a>      </span>
<span id="cb220-219"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-219" tabindex="-1"></a>      QQ<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> qq<span class="op">;</span></span>
<span id="cb220-220"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-220" tabindex="-1"></a>      SS<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> ss<span class="op">;</span></span>
<span id="cb220-221"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-221" tabindex="-1"></a>      </span>
<span id="cb220-222"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-222" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-223"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-223" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-224"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-224" tabindex="-1"></a>  </span>
<span id="cb220-225"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-225" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">3</span><span class="op">,</span><span class="dv">3</span><span class="op">]</span> signal_likelihoods <span class="op">=</span> <span class="op">[</span></span>
<span id="cb220-226"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-226" tabindex="-1"></a>    <span class="op">[</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.0</span><span class="op">],</span></span>
<span id="cb220-227"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-227" tabindex="-1"></a>    <span class="op">[</span><span class="fl">0.0</span><span class="op">,</span><span class="fl">1.0</span><span class="op">,</span><span class="fl">0.0</span><span class="op">],</span></span>
<span id="cb220-228"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-228" tabindex="-1"></a>    <span class="op">[</span><span class="fl">0.0</span><span class="op">,</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.5</span><span class="op">]</span></span>
<span id="cb220-229"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-229" tabindex="-1"></a>    <span class="op">];</span></span>
<span id="cb220-230"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-230" tabindex="-1"></a>    </span>
<span id="cb220-231"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-231" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> PI<span class="op">;</span></span>
<span id="cb220-232"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-232" tabindex="-1"></a>  </span>
<span id="cb220-233"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-233" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-234"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-234" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>cc in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-235"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-235" tabindex="-1"></a>      </span>
<span id="cb220-236"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-236" tabindex="-1"></a>      PI<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1.0</span><span class="op">/</span><span class="fl">3.0</span><span class="op">)*(</span><span class="fl">1.0</span><span class="op">/</span><span class="fl">3.0</span><span class="op">)*</span>signal_likelihoods<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">],</span>SS<span class="op">[</span>cc<span class="op">]]*</span>signal_likelihoods<span class="op">[</span>QQ<span class="op">[</span>cc<span class="op">],</span>SS<span class="op">[</span>rr<span class="op">]];</span></span>
<span id="cb220-237"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-237" tabindex="-1"></a>      </span>
<span id="cb220-238"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-238" tabindex="-1"></a>      </span>
<span id="cb220-239"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-239" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-240"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-240" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-241"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-241" tabindex="-1"></a>  </span>
<span id="cb220-242"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-242" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> PI_cond <span class="op">=</span> rep_matrix<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">);</span></span>
<span id="cb220-243"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-243" tabindex="-1"></a>  </span>
<span id="cb220-244"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-244" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-245"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-245" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>cc in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-246"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-246" tabindex="-1"></a>      </span>
<span id="cb220-247"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-247" tabindex="-1"></a>      <span class="co">//if (sum(PI[,cc])&gt;0) {</span></span>
<span id="cb220-248"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-248" tabindex="-1"></a>        PI_cond<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]</span> <span class="op">+=</span> PI<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]/</span>sum<span class="op">(</span>PI<span class="op">[,</span>cc<span class="op">]);</span></span>
<span id="cb220-249"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-249" tabindex="-1"></a>      <span class="co">//}</span></span>
<span id="cb220-250"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-250" tabindex="-1"></a>      </span>
<span id="cb220-251"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-251" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb220-252"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-252" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-253"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-253" tabindex="-1"></a>  </span>
<span id="cb220-254"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-254" tabindex="-1"></a>  </span>
<span id="cb220-255"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-255" tabindex="-1"></a>  </span>
<span id="cb220-256"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-256" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-257"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-257" tabindex="-1"></a></span>
<span id="cb220-258"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-258" tabindex="-1"></a></span>
<span id="cb220-259"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-259" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb220-260"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-260" tabindex="-1"></a> </span>
<span id="cb220-261"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-261" tabindex="-1"></a> real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb220-262"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-262" tabindex="-1"></a> </span>
<span id="cb220-263"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-263" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-264"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-264" tabindex="-1"></a></span>
<span id="cb220-265"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-265" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb220-266"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-266" tabindex="-1"></a>  </span>
<span id="cb220-267"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-267" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> ELL<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb220-268"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-268" tabindex="-1"></a>  </span>
<span id="cb220-269"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-269" tabindex="-1"></a>  ELL<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> solve_QRE<span class="op">(</span>lambda<span class="op">,</span></span>
<span id="cb220-270"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-270" tabindex="-1"></a>    PI_cond<span class="op">,</span></span>
<span id="cb220-271"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-271" tabindex="-1"></a>    mu<span class="op">,</span> rho<span class="op">[</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb220-272"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-272" tabindex="-1"></a>    QQ<span class="op">,</span>SS<span class="op">,</span></span>
<span id="cb220-273"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-273" tabindex="-1"></a>    maxiter<span class="op">,</span>tol<span class="op">,</span>lxgrid</span>
<span id="cb220-274"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-274" tabindex="-1"></a>  <span class="op">)</span> <span class="op">;</span></span>
<span id="cb220-275"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-275" tabindex="-1"></a>  ELL<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> solve_QRE<span class="op">(</span>lambda<span class="op">,</span></span>
<span id="cb220-276"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-276" tabindex="-1"></a>    PI_cond<span class="op">,</span></span>
<span id="cb220-277"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-277" tabindex="-1"></a>    mu<span class="op">,</span> rho<span class="op">[</span><span class="dv">2</span><span class="op">],</span></span>
<span id="cb220-278"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-278" tabindex="-1"></a>    QQ<span class="op">,</span>SS<span class="op">,</span></span>
<span id="cb220-279"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-279" tabindex="-1"></a>    maxiter<span class="op">,</span>tol<span class="op">,</span>lxgrid</span>
<span id="cb220-280"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-280" tabindex="-1"></a>  <span class="op">)</span> <span class="op">;</span></span>
<span id="cb220-281"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-281" tabindex="-1"></a>  </span>
<span id="cb220-282"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-282" tabindex="-1"></a>  </span>
<span id="cb220-283"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-283" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-284"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-284" tabindex="-1"></a></span>
<span id="cb220-285"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-285" tabindex="-1"></a></span>
<span id="cb220-286"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-286" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb220-287"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-287" tabindex="-1"></a>  </span>
<span id="cb220-288"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-288" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb220-289"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-289" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>lambda <span class="op">|</span> prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb220-290"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-290" tabindex="-1"></a>  </span>
<span id="cb220-291"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-291" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb220-292"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-292" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nUseData<span class="op">)</span> <span class="op">{</span></span>
<span id="cb220-293"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-293" tabindex="-1"></a>    target <span class="op">+=</span> bernoulli_logit_lpmf<span class="op">(</span>action_training<span class="op">[</span>ii<span class="op">]</span> <span class="op">|</span>  ELL<span class="op">[</span>game_training<span class="op">[</span>ii<span class="op">]][</span>type_training<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb220-294"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-294" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-295"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-295" tabindex="-1"></a>  </span>
<span id="cb220-296"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-296" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb220-297"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-297" tabindex="-1"></a></span>
<span id="cb220-298"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-298" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb220-299"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-299" tabindex="-1"></a>  </span>
<span id="cb220-300"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-300" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb220-301"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-301" tabindex="-1"></a>    sigma<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> inv_logit<span class="op">(</span>ELL<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb220-302"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-302" tabindex="-1"></a>    sigma<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> inv_logit<span class="op">(</span>ELL<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb220-303"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-303" tabindex="-1"></a>    </span>
<span id="cb220-304"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-304" tabindex="-1"></a>  real logL_test <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb220-305"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-305" tabindex="-1"></a>  </span>
<span id="cb220-306"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-306" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:(</span>N<span class="op">-</span>nUseData<span class="op">))</span> <span class="op">{</span></span>
<span id="cb220-307"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-307" tabindex="-1"></a>    logL_test <span class="op">+=</span> bernoulli_logit_lpmf<span class="op">(</span>action_test<span class="op">[</span>ii<span class="op">]</span> <span class="op">|</span>  ELL<span class="op">[</span>game_test<span class="op">[</span>ii<span class="op">]][</span>type_test<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb220-308"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-308" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb220-309"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-309" tabindex="-1"></a>  </span>
<span id="cb220-310"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-310" tabindex="-1"></a>  </span>
<span id="cb220-311"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-311" tabindex="-1"></a>  <span class="co">//matrix[9,9] PI_cond_test = PI_cond;</span></span>
<span id="cb220-312"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-312" tabindex="-1"></a>  </span>
<span id="cb220-313"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-313" tabindex="-1"></a>  <span class="co">//matrix[9,9] PI_test = PI;</span></span>
<span id="cb220-314"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb220-314" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="cursed-equilibrium" class="section level3 hasAnchor" number="18.2.2">
<h3><span class="header-section-number">18.2.2</span> Cursed equilibrium<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cursed-equilibrium" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In Bayesian games, a popular one-parameter extension is the “Cursed Equilibrium” <span class="citation">(<a href="#ref-Eyster2005">Eyster and Rabin 2005</a>)</span>. In this model, players maintain correct beliefs about opponents’ strategies, but underestimate the information that is contained in these strategies. In this game, this means that a participant might not fully factor in that if an opponent proposes, that tells us something about their quality. In the most extreme “fully cursed” case, the player believes that their payoff if both propose is the <em>average</em> <span class="math inline">\(\mu(q)\)</span> (i.e. integrating out <span class="math inline">\(q\)</span>), which I will denote <span class="math inline">\(\bar\mu\)</span>. In the <span class="math inline">\(\chi\)</span>-cursed model, players <em>partially</em> incorporate this information, and so their expected utility from proposing is:</p>
<p><span class="math display">\[
\begin{aligned}
U_\chi^P(q,s)&amp;=\sum_{q&#39;,s&#39;}\left[\underbrace{\left((1-\chi)\mu(q&#39;)+\chi\bar \mu\right)}_\text{the new part}\sigma(q&#39;,s&#39;)-(1-\sigma(q&#39;,s&#39;))\rho(q)\right]\pi(q&#39;,s&#39;\mid q,s)
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\chi\in[0,1]\)</span> measures the degree of “cursedness”. Modifying the QRE equations here is relatively simple: whenever you see a <span class="math inline">\(\mu(\cdot)\)</span>, just replace it with <span class="math inline">\((1-\chi)\mu(\cdot)+\chi\bar\mu\)</span>.</p>
<p>Here is the <em>Stan</em> program I wrote to estimate the cursed model:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode cpp"><code class="sourceCode cpp"><span id="cb221-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-1" tabindex="-1"></a></span>
<span id="cb221-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-2" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb221-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-3" tabindex="-1"></a>  </span>
<span id="cb221-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-4" tabindex="-1"></a>  vector H<span class="op">(</span>real lambda<span class="op">,</span> vector ell<span class="op">,</span></span>
<span id="cb221-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-5" tabindex="-1"></a>    real chi<span class="op">,</span></span>
<span id="cb221-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-6" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb221-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-7" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb221-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-8" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS</span>
<span id="cb221-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-9" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-10" tabindex="-1"></a>    </span>
<span id="cb221-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-11" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma <span class="op">=</span> inv_logit<span class="op">(</span>ell<span class="op">);</span></span>
<span id="cb221-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-12" tabindex="-1"></a>    </span>
<span id="cb221-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-13" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> ell<span class="op">;</span></span>
<span id="cb221-14"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-14" tabindex="-1"></a>    </span>
<span id="cb221-15"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-15" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-16"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-16" tabindex="-1"></a>      </span>
<span id="cb221-17"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-17" tabindex="-1"></a>      result<span class="op">[</span>rr<span class="op">]</span> <span class="op">-=</span> lambda<span class="op">*(</span>sum<span class="op">(</span></span>
<span id="cb221-18"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-18" tabindex="-1"></a>        <span class="op">(((</span><span class="fl">1.0</span><span class="op">-</span>chi<span class="op">)*</span>mu<span class="op">[</span>QQ<span class="op">]+</span>chi<span class="op">*</span>mean<span class="op">(</span>mu<span class="op">)).*</span>sigma<span class="op">+(</span><span class="fl">1.0</span><span class="op">-</span>sigma<span class="op">)*</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]).*</span>PI_cond<span class="op">[,</span>rr<span class="op">]</span></span>
<span id="cb221-19"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-19" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb221-20"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-20" tabindex="-1"></a>        <span class="op">-</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]</span></span>
<span id="cb221-21"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-21" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb221-22"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-22" tabindex="-1"></a></span>
<span id="cb221-23"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-23" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb221-24"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-24" tabindex="-1"></a>    </span>
<span id="cb221-25"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-25" tabindex="-1"></a>    </span>
<span id="cb221-26"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-26" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span>    </span>
<span id="cb221-27"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-27" tabindex="-1"></a>    </span>
<span id="cb221-28"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-28" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-29"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-29" tabindex="-1"></a>  </span>
<span id="cb221-30"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-30" tabindex="-1"></a>  </span>
<span id="cb221-31"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-31" tabindex="-1"></a>  matrix DH<span class="op">(</span>real lambda<span class="op">,</span> vector ell<span class="op">,</span></span>
<span id="cb221-32"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-32" tabindex="-1"></a>    real chi<span class="op">,</span></span>
<span id="cb221-33"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-33" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb221-34"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-34" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb221-35"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-35" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS</span>
<span id="cb221-36"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-36" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-37"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-37" tabindex="-1"></a>   vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma <span class="op">=</span> inv_logit<span class="op">(</span>ell<span class="op">);</span></span>
<span id="cb221-38"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-38" tabindex="-1"></a>   </span>
<span id="cb221-39"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-39" tabindex="-1"></a>   matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> diag_matrix<span class="op">(</span>rep_vector<span class="op">(</span><span class="fl">1.0</span><span class="op">,</span><span class="dv">9</span><span class="op">));</span></span>
<span id="cb221-40"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-40" tabindex="-1"></a>   </span>
<span id="cb221-41"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-41" tabindex="-1"></a>   <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-42"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-42" tabindex="-1"></a>     <span class="cf">for</span> <span class="op">(</span>cc in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-43"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-43" tabindex="-1"></a>       </span>
<span id="cb221-44"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-44" tabindex="-1"></a>       </span>
<span id="cb221-45"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-45" tabindex="-1"></a>       result<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]+=</span> <span class="op">-</span>lambda<span class="op">*((</span><span class="dv">1</span><span class="op">-</span>chi<span class="op">)*</span>mu<span class="op">[</span>QQ<span class="op">[</span>cc<span class="op">]]+</span>chi<span class="op">*</span>mean<span class="op">(</span>mu<span class="op">)-</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]])*</span>PI_cond<span class="op">[</span>cc<span class="op">,</span>rr<span class="op">]*</span>sigma<span class="op">[</span>cc<span class="op">]*(</span><span class="fl">1.0</span><span class="op">-</span>sigma<span class="op">[</span>cc<span class="op">]);</span></span>
<span id="cb221-46"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-46" tabindex="-1"></a>       </span>
<span id="cb221-47"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-47" tabindex="-1"></a>     <span class="op">}</span></span>
<span id="cb221-48"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-48" tabindex="-1"></a>   <span class="op">}</span></span>
<span id="cb221-49"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-49" tabindex="-1"></a>   <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb221-50"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-50" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-51"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-51" tabindex="-1"></a>  </span>
<span id="cb221-52"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-52" tabindex="-1"></a>  vector dlH<span class="op">(</span>real lambda<span class="op">,</span> vector ell<span class="op">,</span></span>
<span id="cb221-53"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-53" tabindex="-1"></a>    real chi<span class="op">,</span></span>
<span id="cb221-54"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-54" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb221-55"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-55" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb221-56"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-56" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS</span>
<span id="cb221-57"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-57" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-58"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-58" tabindex="-1"></a>    </span>
<span id="cb221-59"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-59" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma <span class="op">=</span> inv_logit<span class="op">(</span>ell<span class="op">);</span></span>
<span id="cb221-60"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-60" tabindex="-1"></a>    </span>
<span id="cb221-61"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-61" tabindex="-1"></a>    vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> ell<span class="op">;</span></span>
<span id="cb221-62"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-62" tabindex="-1"></a>    </span>
<span id="cb221-63"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-63" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-64"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-64" tabindex="-1"></a>      </span>
<span id="cb221-65"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-65" tabindex="-1"></a>      result<span class="op">[</span>rr<span class="op">]</span> <span class="op">-=</span> <span class="op">(</span>sum<span class="op">(</span></span>
<span id="cb221-66"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-66" tabindex="-1"></a>        <span class="op">(((</span><span class="fl">1.0</span><span class="op">-</span>chi<span class="op">)*</span>mu<span class="op">[</span>QQ<span class="op">]+</span>chi<span class="op">*</span>mean<span class="op">(</span>mu<span class="op">)).*</span>sigma<span class="op">+(</span><span class="fl">1.0</span><span class="op">-</span>sigma<span class="op">)*</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]).*</span>PI_cond<span class="op">[,</span>rr<span class="op">]</span></span>
<span id="cb221-67"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-67" tabindex="-1"></a>        <span class="op">)</span></span>
<span id="cb221-68"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-68" tabindex="-1"></a>        <span class="op">-</span>rho<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">]]</span></span>
<span id="cb221-69"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-69" tabindex="-1"></a>      <span class="op">);</span></span>
<span id="cb221-70"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-70" tabindex="-1"></a></span>
<span id="cb221-71"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-71" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb221-72"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-72" tabindex="-1"></a>    </span>
<span id="cb221-73"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-73" tabindex="-1"></a>    </span>
<span id="cb221-74"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-74" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span>    </span>
<span id="cb221-75"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-75" tabindex="-1"></a>    </span>
<span id="cb221-76"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-76" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-77"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-77" tabindex="-1"></a>  </span>
<span id="cb221-78"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-78" tabindex="-1"></a>  </span>
<span id="cb221-79"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-79" tabindex="-1"></a>  </span>
<span id="cb221-80"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-80" tabindex="-1"></a>  vector solve_QRE<span class="op">(</span>real lambda<span class="op">,</span> real chi<span class="op">,</span></span>
<span id="cb221-81"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-81" tabindex="-1"></a>    data matrix PI_cond<span class="op">,</span></span>
<span id="cb221-82"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-82" tabindex="-1"></a>    data vector mu<span class="op">,</span> data vector rho<span class="op">,</span></span>
<span id="cb221-83"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-83" tabindex="-1"></a>    data <span class="dt">int</span><span class="op">[]</span> QQ<span class="op">,</span> data <span class="dt">int</span><span class="op">[]</span> SS<span class="op">,</span></span>
<span id="cb221-84"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-84" tabindex="-1"></a>    data <span class="dt">int</span> maxiter<span class="op">,</span> data real tol<span class="op">,</span> data vector lxgrid</span>
<span id="cb221-85"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-85" tabindex="-1"></a>  <span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-86"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-86" tabindex="-1"></a>       vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> result <span class="op">=</span> rep_vector<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span><span class="dv">9</span><span class="op">);</span></span>
<span id="cb221-87"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-87" tabindex="-1"></a>       </span>
<span id="cb221-88"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-88" tabindex="-1"></a>       <span class="dt">int</span> nx <span class="op">=</span> dims<span class="op">(</span>lxgrid<span class="op">)[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb221-89"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-89" tabindex="-1"></a>       </span>
<span id="cb221-90"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-90" tabindex="-1"></a>       <span class="cf">for</span> <span class="op">(</span>ll in <span class="dv">2</span><span class="op">:</span>nx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-91"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-91" tabindex="-1"></a>         </span>
<span id="cb221-92"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-92" tabindex="-1"></a>         <span class="co">// predictor step</span></span>
<span id="cb221-93"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-93" tabindex="-1"></a>         </span>
<span id="cb221-94"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-94" tabindex="-1"></a>         real l <span class="op">=</span> lambda<span class="op">*</span><span class="fl">0.5</span><span class="op">*(</span>lxgrid<span class="op">[</span>ll<span class="op">-</span><span class="dv">1</span><span class="op">]+</span>lxgrid<span class="op">[</span>ll<span class="op">]);</span></span>
<span id="cb221-95"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-95" tabindex="-1"></a>         vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> Hlambda <span class="op">=</span> dlH<span class="op">(</span>l<span class="op">,</span>result<span class="op">,</span>chi<span class="op">,</span>PI_cond<span class="op">,</span>mu<span class="op">,</span>rho<span class="op">,</span>QQ<span class="op">,</span>SS<span class="op">);</span></span>
<span id="cb221-96"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-96" tabindex="-1"></a>         result <span class="op">+=</span> Hlambda<span class="op">*(</span>lxgrid<span class="op">[</span>ll<span class="op">]-</span>lxgrid<span class="op">[</span>ll<span class="op">-</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb221-97"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-97" tabindex="-1"></a>         </span>
<span id="cb221-98"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-98" tabindex="-1"></a>         l <span class="op">=</span> lambda<span class="op">*</span>lxgrid<span class="op">[</span>ll<span class="op">];</span></span>
<span id="cb221-99"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-99" tabindex="-1"></a>         </span>
<span id="cb221-100"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-100" tabindex="-1"></a>         <span class="co">// corrector step</span></span>
<span id="cb221-101"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-101" tabindex="-1"></a>         <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>maxiter<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-102"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-102" tabindex="-1"></a>           </span>
<span id="cb221-103"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-103" tabindex="-1"></a>           matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> J <span class="op">=</span> DH<span class="op">(</span>l<span class="op">,</span>result<span class="op">,</span>chi<span class="op">,</span>PI_cond<span class="op">,</span>mu<span class="op">,</span>rho<span class="op">,</span>QQ<span class="op">,</span>SS<span class="op">);</span></span>
<span id="cb221-104"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-104" tabindex="-1"></a>           vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span>   F <span class="op">=</span> H<span class="op">(</span>l<span class="op">,</span>result<span class="op">,</span>chi<span class="op">,</span>PI_cond<span class="op">,</span>mu<span class="op">,</span>rho<span class="op">,</span>QQ<span class="op">,</span>SS<span class="op">);</span></span>
<span id="cb221-105"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-105" tabindex="-1"></a>           </span>
<span id="cb221-106"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-106" tabindex="-1"></a>           vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> dx <span class="op">=</span> <span class="op">-</span>J\F<span class="op">;</span></span>
<span id="cb221-107"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-107" tabindex="-1"></a>           </span>
<span id="cb221-108"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-108" tabindex="-1"></a>           result <span class="op">+=</span> dx<span class="op">;</span></span>
<span id="cb221-109"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-109" tabindex="-1"></a>           </span>
<span id="cb221-110"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-110" tabindex="-1"></a>           <span class="cf">if</span> <span class="op">(</span>max<span class="op">(</span>abs<span class="op">(</span>dx<span class="op">))&lt;</span>tol<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-111"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-111" tabindex="-1"></a>             </span>
<span id="cb221-112"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-112" tabindex="-1"></a>             <span class="cf">break</span><span class="op">;</span></span>
<span id="cb221-113"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-113" tabindex="-1"></a>           <span class="op">}</span></span>
<span id="cb221-114"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-114" tabindex="-1"></a>           </span>
<span id="cb221-115"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-115" tabindex="-1"></a>           <span class="cf">if</span> <span class="op">(</span>ii <span class="op">==</span> maxiter <span class="op">&amp;&amp;</span> ll<span class="op">==</span>nx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-116"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-116" tabindex="-1"></a>             </span>
<span id="cb221-117"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-117" tabindex="-1"></a>             print<span class="op">(</span><span class="st">&quot;Corrector step did not converge for lambda =&quot;</span><span class="op">,</span>l<span class="op">);</span></span>
<span id="cb221-118"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-118" tabindex="-1"></a>             </span>
<span id="cb221-119"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-119" tabindex="-1"></a>           <span class="op">}</span></span>
<span id="cb221-120"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-120" tabindex="-1"></a>           </span>
<span id="cb221-121"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-121" tabindex="-1"></a>         <span class="op">}</span></span>
<span id="cb221-122"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-122" tabindex="-1"></a>         </span>
<span id="cb221-123"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-123" tabindex="-1"></a>         <span class="co">//</span></span>
<span id="cb221-124"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-124" tabindex="-1"></a>       <span class="op">}</span></span>
<span id="cb221-125"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-125" tabindex="-1"></a>       </span>
<span id="cb221-126"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-126" tabindex="-1"></a>       <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb221-127"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-127" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-128"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-128" tabindex="-1"></a>  </span>
<span id="cb221-129"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-129" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb221-130"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-130" tabindex="-1"></a></span>
<span id="cb221-131"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-131" tabindex="-1"></a></span>
<span id="cb221-132"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-132" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb221-133"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-133" tabindex="-1"></a>  </span>
<span id="cb221-134"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-134" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span></span>
<span id="cb221-135"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-135" tabindex="-1"></a>  </span>
<span id="cb221-136"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-136" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">9</span><span class="op">&gt;</span> type<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb221-137"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-137" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">1</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">2</span><span class="op">&gt;</span> game<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb221-138"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-138" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> action<span class="op">[</span>N<span class="op">];</span></span>
<span id="cb221-139"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-139" tabindex="-1"></a>  </span>
<span id="cb221-140"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-140" tabindex="-1"></a>  <span class="dt">int</span><span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span>N<span class="op">&gt;</span> nUseData<span class="op">;</span></span>
<span id="cb221-141"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-141" tabindex="-1"></a>  <span class="dt">int</span> UseData<span class="op">[</span>nUseData<span class="op">];</span></span>
<span id="cb221-142"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-142" tabindex="-1"></a>  </span>
<span id="cb221-143"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-143" tabindex="-1"></a>  </span>
<span id="cb221-144"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-144" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_lambda<span class="op">;</span></span>
<span id="cb221-145"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-145" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">2</span><span class="op">]</span> prior_chi<span class="op">;</span></span>
<span id="cb221-146"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-146" tabindex="-1"></a>  </span>
<span id="cb221-147"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-147" tabindex="-1"></a>  <span class="dt">int</span> maxiter<span class="op">;</span></span>
<span id="cb221-148"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-148" tabindex="-1"></a>  real tol<span class="op">;</span></span>
<span id="cb221-149"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-149" tabindex="-1"></a>  <span class="dt">int</span> nlxgrid<span class="op">;</span></span>
<span id="cb221-150"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-150" tabindex="-1"></a>  </span>
<span id="cb221-151"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-151" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb221-152"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-152" tabindex="-1"></a></span>
<span id="cb221-153"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-153" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb221-154"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-154" tabindex="-1"></a>  </span>
<span id="cb221-155"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-155" tabindex="-1"></a>  <span class="co">// grid to trace out QRE</span></span>
<span id="cb221-156"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-156" tabindex="-1"></a>  </span>
<span id="cb221-157"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-157" tabindex="-1"></a>  vector<span class="op">[</span>nlxgrid<span class="op">]</span> lxgrid<span class="op">;</span></span>
<span id="cb221-158"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-158" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nlxgrid<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-159"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-159" tabindex="-1"></a>    lxgrid<span class="op">[</span>ii<span class="op">]</span> <span class="op">=</span> <span class="op">(</span>ii<span class="op">-</span><span class="fl">1.0</span><span class="op">)/(</span>nlxgrid<span class="op">-</span><span class="fl">1.0</span><span class="op">);</span></span>
<span id="cb221-160"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-160" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-161"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-161" tabindex="-1"></a>  </span>
<span id="cb221-162"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-162" tabindex="-1"></a>  </span>
<span id="cb221-163"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-163" tabindex="-1"></a>  </span>
<span id="cb221-164"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-164" tabindex="-1"></a>  <span class="co">// game parameters</span></span>
<span id="cb221-165"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-165" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> mu <span class="op">=</span> <span class="op">[</span><span class="dv">160</span><span class="op">,</span><span class="dv">80</span><span class="op">,</span><span class="dv">40</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb221-166"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-166" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">3</span><span class="op">]</span> rho<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb221-167"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-167" tabindex="-1"></a>    rho<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">100</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">25</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb221-168"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-168" tabindex="-1"></a>    rho<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="op">[</span><span class="dv">80</span><span class="op">,</span><span class="dv">75</span><span class="op">,</span><span class="dv">25</span><span class="op">]</span><span class="ch">&#39;;</span></span>
<span id="cb221-169"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-169" tabindex="-1"></a>  </span>
<span id="cb221-170"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-170" tabindex="-1"></a>  </span>
<span id="cb221-171"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-171" tabindex="-1"></a>  <span class="co">// data that actually contributes to the likelihood</span></span>
<span id="cb221-172"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-172" tabindex="-1"></a>  <span class="dt">int</span> type_training<span class="op">[</span>nUseData<span class="op">]</span> <span class="op">=</span> type<span class="op">[</span>UseData<span class="op">];</span></span>
<span id="cb221-173"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-173" tabindex="-1"></a>  <span class="dt">int</span> game_training<span class="op">[</span>nUseData<span class="op">]</span> <span class="op">=</span> game<span class="op">[</span>UseData<span class="op">];</span></span>
<span id="cb221-174"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-174" tabindex="-1"></a>  <span class="dt">int</span> action_training<span class="op">[</span>nUseData<span class="op">]</span> <span class="op">=</span> action<span class="op">[</span>UseData<span class="op">];</span></span>
<span id="cb221-175"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-175" tabindex="-1"></a>  </span>
<span id="cb221-176"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-176" tabindex="-1"></a>  <span class="co">// data used for testing</span></span>
<span id="cb221-177"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-177" tabindex="-1"></a>  <span class="dt">int</span> type_test<span class="op">[</span>N<span class="op">-</span>nUseData<span class="op">];</span></span>
<span id="cb221-178"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-178" tabindex="-1"></a>  <span class="dt">int</span> game_test<span class="op">[</span>N<span class="op">-</span>nUseData<span class="op">];</span></span>
<span id="cb221-179"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-179" tabindex="-1"></a>  <span class="dt">int</span> action_test<span class="op">[</span>N<span class="op">-</span>nUseData<span class="op">];</span></span>
<span id="cb221-180"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-180" tabindex="-1"></a>  </span>
<span id="cb221-181"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-181" tabindex="-1"></a>  <span class="dt">int</span> count_test <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb221-182"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-182" tabindex="-1"></a>  <span class="dt">int</span> count_train <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb221-183"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-183" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>N<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-184"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-184" tabindex="-1"></a>    </span>
<span id="cb221-185"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-185" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>nUseData<span class="op">&gt;</span><span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-186"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-186" tabindex="-1"></a>    </span>
<span id="cb221-187"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-187" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>UseData<span class="op">[</span>count_train<span class="op">]==</span>ii<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-188"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-188" tabindex="-1"></a>      </span>
<span id="cb221-189"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-189" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>count_train <span class="op">&lt;</span> nUseData<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-190"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-190" tabindex="-1"></a>          count_train <span class="op">+=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb221-191"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-191" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb221-192"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-192" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb221-193"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-193" tabindex="-1"></a>        type_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> type<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb221-194"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-194" tabindex="-1"></a>        game_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> game<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb221-195"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-195" tabindex="-1"></a>        action_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> action<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb221-196"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-196" tabindex="-1"></a>        count_test<span class="op">+=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb221-197"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-197" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb221-198"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-198" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb221-199"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-199" tabindex="-1"></a>        type_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> type<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb221-200"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-200" tabindex="-1"></a>        game_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> game<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb221-201"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-201" tabindex="-1"></a>        action_test<span class="op">[</span>count_test<span class="op">]</span> <span class="op">=</span> action<span class="op">[</span>ii<span class="op">];</span></span>
<span id="cb221-202"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-202" tabindex="-1"></a>        count_test<span class="op">+=</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb221-203"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-203" tabindex="-1"></a>      </span>
<span id="cb221-204"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-204" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb221-205"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-205" tabindex="-1"></a>    </span>
<span id="cb221-206"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-206" tabindex="-1"></a>    </span>
<span id="cb221-207"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-207" tabindex="-1"></a>    </span>
<span id="cb221-208"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-208" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-209"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-209" tabindex="-1"></a>  </span>
<span id="cb221-210"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-210" tabindex="-1"></a>  </span>
<span id="cb221-211"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-211" tabindex="-1"></a>  <span class="co">// some indices for identifying types</span></span>
<span id="cb221-212"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-212" tabindex="-1"></a>  </span>
<span id="cb221-213"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-213" tabindex="-1"></a>  </span>
<span id="cb221-214"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-214" tabindex="-1"></a>  <span class="dt">int</span> QQ<span class="op">[</span><span class="dv">9</span><span class="op">];</span></span>
<span id="cb221-215"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-215" tabindex="-1"></a>  <span class="dt">int</span> SS<span class="op">[</span><span class="dv">9</span><span class="op">];</span></span>
<span id="cb221-216"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-216" tabindex="-1"></a>  </span>
<span id="cb221-217"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-217" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>qq in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-218"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-218" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>ss in <span class="dv">1</span><span class="op">:</span><span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-219"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-219" tabindex="-1"></a>      </span>
<span id="cb221-220"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-220" tabindex="-1"></a>      <span class="dt">int</span> tt <span class="op">=</span> qq<span class="op">+</span><span class="dv">3</span><span class="op">*(</span>ss<span class="op">-</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb221-221"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-221" tabindex="-1"></a>      </span>
<span id="cb221-222"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-222" tabindex="-1"></a>      QQ<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> qq<span class="op">;</span></span>
<span id="cb221-223"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-223" tabindex="-1"></a>      SS<span class="op">[</span>tt<span class="op">]</span> <span class="op">=</span> ss<span class="op">;</span></span>
<span id="cb221-224"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-224" tabindex="-1"></a>      </span>
<span id="cb221-225"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-225" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb221-226"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-226" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-227"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-227" tabindex="-1"></a>  </span>
<span id="cb221-228"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-228" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">3</span><span class="op">,</span><span class="dv">3</span><span class="op">]</span> signal_likelihoods <span class="op">=</span> <span class="op">[</span></span>
<span id="cb221-229"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-229" tabindex="-1"></a>    <span class="op">[</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.0</span><span class="op">],</span></span>
<span id="cb221-230"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-230" tabindex="-1"></a>    <span class="op">[</span><span class="fl">0.0</span><span class="op">,</span><span class="fl">1.0</span><span class="op">,</span><span class="fl">0.0</span><span class="op">],</span></span>
<span id="cb221-231"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-231" tabindex="-1"></a>    <span class="op">[</span><span class="fl">0.0</span><span class="op">,</span><span class="fl">0.5</span><span class="op">,</span><span class="fl">0.5</span><span class="op">]</span></span>
<span id="cb221-232"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-232" tabindex="-1"></a>    <span class="op">];</span></span>
<span id="cb221-233"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-233" tabindex="-1"></a>    </span>
<span id="cb221-234"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-234" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> PI<span class="op">;</span></span>
<span id="cb221-235"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-235" tabindex="-1"></a>  </span>
<span id="cb221-236"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-236" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-237"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-237" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>cc in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-238"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-238" tabindex="-1"></a>      </span>
<span id="cb221-239"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-239" tabindex="-1"></a>      PI<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]</span> <span class="op">=</span> <span class="op">(</span><span class="fl">1.0</span><span class="op">/</span><span class="fl">3.0</span><span class="op">)*(</span><span class="fl">1.0</span><span class="op">/</span><span class="fl">3.0</span><span class="op">)*</span>signal_likelihoods<span class="op">[</span>QQ<span class="op">[</span>rr<span class="op">],</span>SS<span class="op">[</span>cc<span class="op">]]*</span>signal_likelihoods<span class="op">[</span>QQ<span class="op">[</span>cc<span class="op">],</span>SS<span class="op">[</span>rr<span class="op">]];</span></span>
<span id="cb221-240"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-240" tabindex="-1"></a>      </span>
<span id="cb221-241"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-241" tabindex="-1"></a>      </span>
<span id="cb221-242"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-242" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb221-243"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-243" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-244"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-244" tabindex="-1"></a>  </span>
<span id="cb221-245"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-245" tabindex="-1"></a>  matrix<span class="op">[</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">]</span> PI_cond <span class="op">=</span> rep_matrix<span class="op">(</span><span class="fl">0.0</span><span class="op">,</span><span class="dv">9</span><span class="op">,</span><span class="dv">9</span><span class="op">);</span></span>
<span id="cb221-246"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-246" tabindex="-1"></a>  </span>
<span id="cb221-247"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-247" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>rr in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-248"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-248" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>cc in <span class="dv">1</span><span class="op">:</span><span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-249"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-249" tabindex="-1"></a>      </span>
<span id="cb221-250"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-250" tabindex="-1"></a>      <span class="co">//if (sum(PI[,cc])&gt;0) {</span></span>
<span id="cb221-251"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-251" tabindex="-1"></a>        PI_cond<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]</span> <span class="op">+=</span> PI<span class="op">[</span>rr<span class="op">,</span>cc<span class="op">]/</span>sum<span class="op">(</span>PI<span class="op">[,</span>cc<span class="op">]);</span></span>
<span id="cb221-252"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-252" tabindex="-1"></a>      <span class="co">//}</span></span>
<span id="cb221-253"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-253" tabindex="-1"></a>      </span>
<span id="cb221-254"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-254" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb221-255"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-255" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-256"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-256" tabindex="-1"></a>  </span>
<span id="cb221-257"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-257" tabindex="-1"></a>  </span>
<span id="cb221-258"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-258" tabindex="-1"></a>  </span>
<span id="cb221-259"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-259" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb221-260"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-260" tabindex="-1"></a></span>
<span id="cb221-261"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-261" tabindex="-1"></a></span>
<span id="cb221-262"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-262" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb221-263"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-263" tabindex="-1"></a> </span>
<span id="cb221-264"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-264" tabindex="-1"></a> real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">&gt;</span> lambda<span class="op">;</span></span>
<span id="cb221-265"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-265" tabindex="-1"></a> real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="dv">1</span><span class="op">&gt;</span> chi<span class="op">;</span></span>
<span id="cb221-266"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-266" tabindex="-1"></a> </span>
<span id="cb221-267"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-267" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb221-268"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-268" tabindex="-1"></a></span>
<span id="cb221-269"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-269" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb221-270"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-270" tabindex="-1"></a>  </span>
<span id="cb221-271"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-271" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> ELL<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb221-272"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-272" tabindex="-1"></a>  </span>
<span id="cb221-273"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-273" tabindex="-1"></a>  ELL<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> solve_QRE<span class="op">(</span>lambda<span class="op">,</span>chi<span class="op">,</span></span>
<span id="cb221-274"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-274" tabindex="-1"></a>    PI_cond<span class="op">,</span></span>
<span id="cb221-275"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-275" tabindex="-1"></a>    mu<span class="op">,</span> rho<span class="op">[</span><span class="dv">1</span><span class="op">],</span></span>
<span id="cb221-276"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-276" tabindex="-1"></a>    QQ<span class="op">,</span>SS<span class="op">,</span></span>
<span id="cb221-277"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-277" tabindex="-1"></a>    maxiter<span class="op">,</span>tol<span class="op">,</span>lxgrid</span>
<span id="cb221-278"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-278" tabindex="-1"></a>  <span class="op">)</span> <span class="op">;</span></span>
<span id="cb221-279"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-279" tabindex="-1"></a>  ELL<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> solve_QRE<span class="op">(</span>lambda<span class="op">,</span>chi<span class="op">,</span></span>
<span id="cb221-280"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-280" tabindex="-1"></a>    PI_cond<span class="op">,</span></span>
<span id="cb221-281"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-281" tabindex="-1"></a>    mu<span class="op">,</span> rho<span class="op">[</span><span class="dv">2</span><span class="op">],</span></span>
<span id="cb221-282"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-282" tabindex="-1"></a>    QQ<span class="op">,</span>SS<span class="op">,</span></span>
<span id="cb221-283"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-283" tabindex="-1"></a>    maxiter<span class="op">,</span>tol<span class="op">,</span>lxgrid</span>
<span id="cb221-284"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-284" tabindex="-1"></a>  <span class="op">)</span> <span class="op">;</span></span>
<span id="cb221-285"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-285" tabindex="-1"></a>  </span>
<span id="cb221-286"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-286" tabindex="-1"></a>  </span>
<span id="cb221-287"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-287" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb221-288"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-288" tabindex="-1"></a></span>
<span id="cb221-289"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-289" tabindex="-1"></a></span>
<span id="cb221-290"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-290" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb221-291"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-291" tabindex="-1"></a>  </span>
<span id="cb221-292"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-292" tabindex="-1"></a>  <span class="co">// prior</span></span>
<span id="cb221-293"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-293" tabindex="-1"></a>  target <span class="op">+=</span> lognormal_lpdf<span class="op">(</span>lambda <span class="op">|</span> prior_lambda<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_lambda<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb221-294"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-294" tabindex="-1"></a>  target <span class="op">+=</span> beta_lpdf<span class="op">(</span>chi <span class="op">|</span> prior_chi<span class="op">[</span><span class="dv">1</span><span class="op">],</span>prior_chi<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb221-295"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-295" tabindex="-1"></a>  </span>
<span id="cb221-296"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-296" tabindex="-1"></a>  <span class="co">// likelihood</span></span>
<span id="cb221-297"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-297" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:</span>nUseData<span class="op">)</span> <span class="op">{</span></span>
<span id="cb221-298"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-298" tabindex="-1"></a>    target <span class="op">+=</span> bernoulli_logit_lpmf<span class="op">(</span>action_training<span class="op">[</span>ii<span class="op">]</span> <span class="op">|</span>  ELL<span class="op">[</span>game_training<span class="op">[</span>ii<span class="op">]][</span>type_training<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb221-299"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-299" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-300"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-300" tabindex="-1"></a>  </span>
<span id="cb221-301"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-301" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb221-302"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-302" tabindex="-1"></a></span>
<span id="cb221-303"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-303" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb221-304"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-304" tabindex="-1"></a>  </span>
<span id="cb221-305"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-305" tabindex="-1"></a>  vector<span class="op">[</span><span class="dv">9</span><span class="op">]</span> sigma<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb221-306"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-306" tabindex="-1"></a>    sigma<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> inv_logit<span class="op">(</span>ELL<span class="op">[</span><span class="dv">1</span><span class="op">]);</span></span>
<span id="cb221-307"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-307" tabindex="-1"></a>    sigma<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> inv_logit<span class="op">(</span>ELL<span class="op">[</span><span class="dv">2</span><span class="op">]);</span></span>
<span id="cb221-308"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-308" tabindex="-1"></a>    </span>
<span id="cb221-309"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-309" tabindex="-1"></a>  real logL_test <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb221-310"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-310" tabindex="-1"></a>  </span>
<span id="cb221-311"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-311" tabindex="-1"></a>  <span class="cf">for</span> <span class="op">(</span>ii in <span class="dv">1</span><span class="op">:(</span>N<span class="op">-</span>nUseData<span class="op">))</span> <span class="op">{</span></span>
<span id="cb221-312"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-312" tabindex="-1"></a>    logL_test <span class="op">+=</span> bernoulli_logit_lpmf<span class="op">(</span>action_test<span class="op">[</span>ii<span class="op">]</span> <span class="op">|</span>  ELL<span class="op">[</span>game_test<span class="op">[</span>ii<span class="op">]][</span>type_test<span class="op">[</span>ii<span class="op">]]);</span></span>
<span id="cb221-313"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-313" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb221-314"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-314" tabindex="-1"></a>  </span>
<span id="cb221-315"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb221-315" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
</div>
<div id="a-quick-prior-calibration-1" class="section level2 hasAnchor" number="18.3">
<h2><span class="header-section-number">18.3</span> A quick prior calibration<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#a-quick-prior-calibration-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The cursed model has two parameters: <span class="math inline">\(\lambda&gt;0\)</span> and <span class="math inline">\(\chi\in(0,1)\)</span>. For <span class="math inline">\(\chi\)</span> I am going to assume a uniform prior, meaning that in the prior each level of cursedness is equally likely. I do this because the parameter has natural bounds, and we don’t want to rule out or favor any particular values of <span class="math inline">\(\chi\)</span>. On the other hand, I found it much harder to think about a prior for <span class="math inline">\(\lambda\)</span>. Without looking at the model’s predictions, it is hard to have any idea what values of <span class="math inline">\(\lambda\)</span> seem reasonable. So we will do just that: look at the predictions. To do this, I traced out the QRE mixed strategies for a wide range of <span class="math inline">\(\lambda\)</span> using <em>Stan</em>’s <code>Fixed_param</code> algorithm. Here are what the predictions look like for the baseline model (<span class="math inline">\(\chi=0\)</span>):</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-1" tabindex="-1"></a>QRE<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/QRE.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb222-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-2" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">|&gt;</span></span>
<span id="cb222-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb222-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-4" tabindex="-1"></a>    <span class="at">quality =</span> <span class="fu">paste</span>(<span class="st">&quot;quality =&quot;</span>,quality) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;quality =&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;L&quot;</span>)) ),</span>
<span id="cb222-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-5" tabindex="-1"></a>    <span class="at">signal =</span> <span class="fu">paste</span>(<span class="st">&quot;signal =&quot;</span>,signal) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;signal =&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;h&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;l&quot;</span>)) )</span>
<span id="cb222-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-6" tabindex="-1"></a>  )</span>
<span id="cb222-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-7" tabindex="-1"></a></span>
<span id="cb222-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-8" tabindex="-1"></a> (</span>
<span id="cb222-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-9" tabindex="-1"></a>    <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>sigma,<span class="at">linetype=</span>game))</span>
<span id="cb222-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-10" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">facet_grid</span>(quality<span class="sc">~</span>signal)</span>
<span id="cb222-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-11" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb222-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-12" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb222-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-13" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb222-14"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-14" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb222-15"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-15" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">ylab</span>(<span class="fu">expression</span>(sigma<span class="sc">~</span>(proposal<span class="sc">~</span>rate)))</span>
<span id="cb222-16"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb222-16" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:BM2024qretrace"></span>
<img src="index_files/figure-html/BM2024qretrace-1.png" alt="QRE predictions for the baseline ($\chi=0$) model. " width="672" />
<p class="caption">
Figure 18.1: QRE predictions for the baseline (<span class="math inline">\(\chi=0\)</span>) model.
</p>
</div>
<p>Looking at Figure <a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fig:BM2024qretrace">18.1</a>, I noticed that (i) play is effectively coin-flipping for <span class="math inline">\(\lambda&lt;10^{-3}\)</span>, and (ii) play appears to have converged for <span class="math inline">\(\lambda&gt;1\)</span>. I will deem this the “interesting” part of the QRE correspondence, and place 95% prior probability in this region. That is, if we use a log-normal prior <span class="math inline">\(\log\lambda\sim N(m,s^2)\)</span>, then:</p>
<p><span class="math display">\[
\begin{aligned}
\log(10^{-3})&amp;=m-1.96s\\
\log(1)&amp;=m+1.96s\\
\log(10^{-3})+\log(1)&amp;=2m\\
m&amp;=\frac{1}{2}(\log(10^{-3})+\log(1))\approx-3.45\\
\log(1)-\log(10^{-3})&amp;=2\times 1.96s\\
s&amp;=\frac{\log(1)-\log(10^{-3})}{2\times 1.96}\approx1.76
\end{aligned}
\]</span></p>
<p>Which, for another sanity check, gets us a prior median for <span class="math inline">\(\lambda\)</span> of <span class="math inline">\(\exp(-3.45)\approx 0.032\)</span> and prior mean of <span class="math inline">\(\exp(-3.45+0.5\times 1.76^2)\approx0.149\)</span>.</p>
</div>
<div id="model-results" class="section level2 hasAnchor" number="18.4">
<h2><span class="header-section-number">18.4</span> Model results<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here are <em>Stan</em>’s summaries of the models’ parameters:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-1" tabindex="-1"></a>Fit_baseline<span class="ot">&lt;-</span> <span class="fu">summary</span>(<span class="st">&quot;Code/BM2024/Fit_baseline_qre.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb223-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-2" tabindex="-1"></a>  <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb223-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-3" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb223-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-4" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-5" tabindex="-1"></a>  <span class="fu">filter</span>(parameter<span class="sc">==</span><span class="st">&quot;lambda&quot;</span> <span class="sc">|</span> parameter<span class="sc">==</span><span class="st">&quot;chi&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;baseline&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;model&quot;</span>,<span class="st">&quot;parameter&quot;</span>,<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;se_mean&quot;</span>,<span class="st">&quot;sd&quot;</span>,<span class="st">&quot;X2.5.&quot;</span>,<span class="st">&quot;X25.&quot;</span>,<span class="st">&quot;X50.&quot;</span>,<span class="st">&quot;X75.&quot;</span>,<span class="st">&quot;X97.5.&quot;</span>,<span class="st">&quot;n_eff&quot;</span>,<span class="st">&quot;Rhat&quot;</span>)</span>
<span id="cb223-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-8" tabindex="-1"></a></span>
<span id="cb223-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-9" tabindex="-1"></a>Fit_cursed<span class="ot">&lt;-</span><span class="fu">summary</span>(<span class="st">&quot;Code/BM2024/Fit_cursed_qre.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb223-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-10" tabindex="-1"></a>  <span class="fu">readRDS</span>())<span class="sc">$</span>summary <span class="sc">|&gt;</span></span>
<span id="cb223-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-11" tabindex="-1"></a>  <span class="fu">data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb223-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-12" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;parameter&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-13" tabindex="-1"></a>  <span class="fu">filter</span>(parameter<span class="sc">==</span><span class="st">&quot;lambda&quot;</span> <span class="sc">|</span> parameter<span class="sc">==</span><span class="st">&quot;chi&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-14"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-14" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="st">&quot;cursed&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-15"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-15" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">&quot;model&quot;</span>,<span class="st">&quot;parameter&quot;</span>,<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;se_mean&quot;</span>,<span class="st">&quot;sd&quot;</span>,<span class="st">&quot;X2.5.&quot;</span>,<span class="st">&quot;X25.&quot;</span>,<span class="st">&quot;X50.&quot;</span>,<span class="st">&quot;X75.&quot;</span>,<span class="st">&quot;X97.5.&quot;</span>,<span class="st">&quot;n_eff&quot;</span>,<span class="st">&quot;Rhat&quot;</span>)</span>
<span id="cb223-16"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-16" tabindex="-1"></a></span>
<span id="cb223-17"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-17" tabindex="-1"></a>TAB<span class="ot">&lt;-</span><span class="fu">rbind</span>(Fit_baseline,Fit_cursed) <span class="sc">|&gt;</span></span>
<span id="cb223-18"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-18" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb223-19"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-19" tabindex="-1"></a>    <span class="at">parameter =</span> <span class="fu">paste0</span>(<span class="st">&quot;$</span><span class="sc">\\</span><span class="st">&quot;</span>,parameter,<span class="st">&quot;$&quot;</span>)</span>
<span id="cb223-20"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-20" tabindex="-1"></a>  )</span>
<span id="cb223-21"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-21" tabindex="-1"></a></span>
<span id="cb223-22"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-22" tabindex="-1"></a>TAB <span class="sc">|&gt;</span></span>
<span id="cb223-23"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-23" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">digits=</span><span class="dv">3</span>,<span class="at">caption =</span> <span class="st">&quot;Summary of the two models&#39; posterior distributions&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb223-24"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb223-24" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>) </span></code></pre></div>
<table class=" lightable-classic" style="color: black; font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:BM2024summarytable">Table 18.3: </span>Summary of the two models’ posterior distributions
</caption>
<thead>
<tr>
<th style="text-align:left;">
model
</th>
<th style="text-align:left;">
parameter
</th>
<th style="text-align:right;">
mean
</th>
<th style="text-align:right;">
se_mean
</th>
<th style="text-align:right;">
sd
</th>
<th style="text-align:right;">
X2.5.
</th>
<th style="text-align:right;">
X25.
</th>
<th style="text-align:right;">
X50.
</th>
<th style="text-align:right;">
X75.
</th>
<th style="text-align:right;">
X97.5.
</th>
<th style="text-align:right;">
n_eff
</th>
<th style="text-align:right;">
Rhat
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
baseline
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda\)</span>
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.083
</td>
<td style="text-align:right;">
0.088
</td>
<td style="text-align:right;">
0.091
</td>
<td style="text-align:right;">
0.094
</td>
<td style="text-align:right;">
0.099
</td>
<td style="text-align:right;">
1124.232
</td>
<td style="text-align:right;">
1.001
</td>
</tr>
<tr>
<td style="text-align:left;">
cursed
</td>
<td style="text-align:left;">
<span class="math inline">\(\lambda\)</span>
</td>
<td style="text-align:right;">
0.097
</td>
<td style="text-align:right;">
0.000
</td>
<td style="text-align:right;">
0.004
</td>
<td style="text-align:right;">
0.090
</td>
<td style="text-align:right;">
0.095
</td>
<td style="text-align:right;">
0.097
</td>
<td style="text-align:right;">
0.100
</td>
<td style="text-align:right;">
0.105
</td>
<td style="text-align:right;">
3600.401
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
<tr>
<td style="text-align:left;">
cursed
</td>
<td style="text-align:left;">
<span class="math inline">\(\chi\)</span>
</td>
<td style="text-align:right;">
0.350
</td>
<td style="text-align:right;">
0.001
</td>
<td style="text-align:right;">
0.030
</td>
<td style="text-align:right;">
0.289
</td>
<td style="text-align:right;">
0.330
</td>
<td style="text-align:right;">
0.351
</td>
<td style="text-align:right;">
0.371
</td>
<td style="text-align:right;">
0.406
</td>
<td style="text-align:right;">
3454.873
</td>
<td style="text-align:right;">
1.000
</td>
</tr>
</tbody>
</table>
<p>So we can be fairly certain that <span class="math inline">\(\chi\in(0.2,0.4)\)</span> for the cursed model.<a href="#fn81" class="footnote-ref" id="fnref81"><sup>81</sup></a></p>
<p>Interpreting <span class="math inline">\(\chi\)</span> is something we can do. <span class="math inline">\(\chi\approx0.35\)</span> is closer to the baseline model than full cursedness, but it is still substantially far away from zero. So we should conclude that players are substantially cursed, but not fully cursed.</p>
<p>It is also useful with QRE to look at what they say about choices. To do this, I plot the posterior distributions of the mixed strategy alongside the empirical frequencies of actions in the experiment. These are shown in Figures <a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fig:BM2024gameA">18.2</a> and <a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fig:BM2024gameB">18.3</a>. Firstly, it looks like the cursed model does slightly better at matching the data than does the baseline model. We will be a bit more rigorous in the next section with a model evaluation. But what I <em>really</em> like about these models is that they are organizing the data very well for just one or two parameters! The cursed model only has two parameters, but it is making predictions about eighteen empirical choice frequencies.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-1" tabindex="-1"></a>predictions_cursed<span class="ot">&lt;-</span><span class="fu">extract</span>(<span class="st">&quot;Code/BM2024/Fit_cursed_qre.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb224-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-2" tabindex="-1"></a>  <span class="fu">readRDS</span>())<span class="sc">$</span>sigma</span>
<span id="cb224-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-3" tabindex="-1"></a></span>
<span id="cb224-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-4" tabindex="-1"></a>predictions_baseline<span class="ot">&lt;-</span><span class="fu">extract</span>(<span class="st">&quot;Code/BM2024/Fit_baseline_qre.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb224-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-5" tabindex="-1"></a>  <span class="fu">readRDS</span>())<span class="sc">$</span>sigma</span>
<span id="cb224-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-6" tabindex="-1"></a></span>
<span id="cb224-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-7" tabindex="-1"></a>quality<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;L&quot;</span>),<span class="dv">3</span>)</span>
<span id="cb224-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-8" tabindex="-1"></a>signal<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;h&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;m&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;l&quot;</span>,<span class="dv">3</span>))</span>
<span id="cb224-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-9" tabindex="-1"></a></span>
<span id="cb224-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-10" tabindex="-1"></a>PREDICTIONS<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb224-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-11" tabindex="-1"></a></span>
<span id="cb224-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-12" tabindex="-1"></a><span class="cf">for</span> (tt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) {</span>
<span id="cb224-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-13" tabindex="-1"></a>  <span class="cf">for</span> (gg <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) {</span>
<span id="cb224-14"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-14" tabindex="-1"></a>    </span>
<span id="cb224-15"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-15" tabindex="-1"></a>    PREDICTIONS<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb224-16"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-16" tabindex="-1"></a>      PREDICTIONS,</span>
<span id="cb224-17"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-17" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb224-18"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-18" tabindex="-1"></a>        <span class="at">game =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)[gg],<span class="at">type=</span>tt,<span class="at">model=</span><span class="st">&quot;baseline&quot;</span>,</span>
<span id="cb224-19"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-19" tabindex="-1"></a>        <span class="at">sigma =</span> predictions_baseline[,gg,tt]</span>
<span id="cb224-20"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-20" tabindex="-1"></a>      ),</span>
<span id="cb224-21"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-21" tabindex="-1"></a>      <span class="fu">tibble</span>(</span>
<span id="cb224-22"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-22" tabindex="-1"></a>        <span class="at">game =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)[gg],<span class="at">type=</span>tt,<span class="at">model=</span><span class="st">&quot;cursed&quot;</span>,</span>
<span id="cb224-23"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-23" tabindex="-1"></a>        <span class="at">sigma =</span> predictions_cursed[,gg,tt]</span>
<span id="cb224-24"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-24" tabindex="-1"></a>      )</span>
<span id="cb224-25"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-25" tabindex="-1"></a>      )</span>
<span id="cb224-26"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-26" tabindex="-1"></a>    </span>
<span id="cb224-27"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-27" tabindex="-1"></a>  }</span>
<span id="cb224-28"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-28" tabindex="-1"></a>}</span>
<span id="cb224-29"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-29" tabindex="-1"></a></span>
<span id="cb224-30"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-30" tabindex="-1"></a>PREDICTIONS<span class="ot">&lt;-</span>PREDICTIONS <span class="sc">|&gt;</span></span>
<span id="cb224-31"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-31" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-32"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-32" tabindex="-1"></a>    <span class="at">quality =</span> quality[type],</span>
<span id="cb224-33"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-33" tabindex="-1"></a>    <span class="at">signal =</span> signal[type]</span>
<span id="cb224-34"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-34" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb224-35"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-35" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-36"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-36" tabindex="-1"></a>    <span class="at">quality =</span> <span class="fu">paste</span>(<span class="st">&quot;quality =&quot;</span>,quality) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;quality =&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;L&quot;</span>)) ),</span>
<span id="cb224-37"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-37" tabindex="-1"></a>    <span class="at">signal =</span> <span class="fu">paste</span>(<span class="st">&quot;signal =&quot;</span>,signal) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;signal =&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;h&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;l&quot;</span>)) )</span>
<span id="cb224-38"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-38" tabindex="-1"></a>  )</span>
<span id="cb224-39"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-39" tabindex="-1"></a></span>
<span id="cb224-40"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-40" tabindex="-1"></a>min_round<span class="ot">&lt;-</span><span class="dv">21</span></span>
<span id="cb224-41"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-41" tabindex="-1"></a></span>
<span id="cb224-42"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-42" tabindex="-1"></a>empirical<span class="ot">&lt;-</span><span class="st">&quot;Data/BochetMagnani2024/data_analysis/data/Main_data_base_game.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb224-43"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-43" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">%&gt;%</span></span>
<span id="cb224-44"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-44" tabindex="-1"></a>  <span class="fu">filter</span>(subsession.round_number<span class="sc">&gt;=</span>min_round) <span class="sc">%&gt;%</span></span>
<span id="cb224-45"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-45" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.type=</span><span class="fu">factor</span>(player.type)) <span class="sc">%&gt;%</span></span>
<span id="cb224-46"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-46" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.type=</span><span class="fu">fct_recode</span>(player.type,</span>
<span id="cb224-47"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-47" tabindex="-1"></a>                                <span class="st">&quot;H&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>,</span>
<span id="cb224-48"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-48" tabindex="-1"></a>                                <span class="st">&quot;M&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb224-49"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-49" tabindex="-1"></a>                                <span class="st">&quot;L&quot;</span><span class="ot">=</span><span class="st">&quot;3&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb224-50"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-50" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.signal=</span><span class="fu">factor</span>(player.signal)) <span class="sc">%&gt;%</span></span>
<span id="cb224-51"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-51" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.signal=</span><span class="fu">fct_recode</span>(player.signal,</span>
<span id="cb224-52"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-52" tabindex="-1"></a>                                  <span class="st">&quot;h&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>,</span>
<span id="cb224-53"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-53" tabindex="-1"></a>                                  <span class="st">&quot;m&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb224-54"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-54" tabindex="-1"></a>                                  <span class="st">&quot;l&quot;</span><span class="ot">=</span><span class="st">&quot;3&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb224-55"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-55" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subsession.game_name=</span><span class="fu">factor</span>(subsession.game_name)) <span class="sc">|&gt;</span></span>
<span id="cb224-56"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-56" tabindex="-1"></a>  <span class="co"># now for JB&#39;s but coding up things to pass to Stan --------------------------</span></span>
<span id="cb224-57"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-57" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-58"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-58" tabindex="-1"></a>    <span class="at">type_code =</span> <span class="fu">paste0</span>(player.type,player.signal) <span class="sc">|&gt;</span></span>
<span id="cb224-59"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-59" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Hh&quot;</span>,<span class="st">&quot;Mh&quot;</span>,<span class="st">&quot;Lh&quot;</span>,<span class="st">&quot;Hm&quot;</span>,<span class="st">&quot;Mm&quot;</span>,<span class="st">&quot;Lm&quot;</span>,<span class="st">&quot;Hl&quot;</span>,<span class="st">&quot;Ml&quot;</span>,<span class="st">&quot;Ll&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb224-60"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-60" tabindex="-1"></a>      <span class="fu">as.numeric</span>(),</span>
<span id="cb224-61"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-61" tabindex="-1"></a>    </span>
<span id="cb224-62"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-62" tabindex="-1"></a>    <span class="at">game_code =</span> <span class="fu">ifelse</span>(subsession.game_name<span class="sc">==</span><span class="st">&quot;A&quot;</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb224-63"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-63" tabindex="-1"></a>    </span>
<span id="cb224-64"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-64" tabindex="-1"></a>    <span class="at">action =</span> player.choice,</span>
<span id="cb224-65"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-65" tabindex="-1"></a>    </span>
<span id="cb224-66"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-66" tabindex="-1"></a>    <span class="at">uid =</span> participant.code <span class="sc">|&gt;</span> <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb224-67"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-67" tabindex="-1"></a>    </span>
<span id="cb224-68"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-68" tabindex="-1"></a>    <span class="at">ugroupid =</span> <span class="fu">paste</span>(session.code,group.id_in_subsession) <span class="sc">|&gt;</span> <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb224-69"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-69" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb224-70"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-70" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb224-71"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-71" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-72"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-72" tabindex="-1"></a>    <span class="at">rownum =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()</span>
<span id="cb224-73"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-73" tabindex="-1"></a>  )<span class="sc">|&gt;</span></span>
<span id="cb224-74"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-74" tabindex="-1"></a>  <span class="fu">group_by</span>(player.type,player.signal,game_code) <span class="sc">|&gt;</span></span>
<span id="cb224-75"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-75" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb224-76"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-76" tabindex="-1"></a>    <span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(action)</span>
<span id="cb224-77"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-77" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb224-78"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-78" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb224-79"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-79" tabindex="-1"></a>    <span class="at">quality =</span> <span class="fu">paste</span>(<span class="st">&quot;quality =&quot;</span>,player.type) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;quality =&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;L&quot;</span>)) ),</span>
<span id="cb224-80"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-80" tabindex="-1"></a>    <span class="at">signal =</span> <span class="fu">paste</span>(<span class="st">&quot;signal =&quot;</span>,player.signal) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">paste</span>(<span class="st">&quot;signal =&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;h&quot;</span>,<span class="st">&quot;m&quot;</span>,<span class="st">&quot;l&quot;</span>)) )</span>
<span id="cb224-81"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-81" tabindex="-1"></a>  )</span>
<span id="cb224-82"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-82" tabindex="-1"></a></span>
<span id="cb224-83"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-83" tabindex="-1"></a></span>
<span id="cb224-84"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-84" tabindex="-1"></a>(</span>
<span id="cb224-85"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-85" tabindex="-1"></a>  <span class="fu">ggplot</span>(PREDICTIONS <span class="sc">|&gt;</span> <span class="fu">filter</span>(game<span class="sc">==</span><span class="st">&quot;A&quot;</span>),<span class="fu">aes</span>(<span class="at">x=</span>sigma,<span class="at">fill=</span>model))</span>
<span id="cb224-86"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-86" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">bins=</span><span class="dv">100</span>)</span>
<span id="cb224-87"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-87" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">data=</span>empirical <span class="sc">|&gt;</span> <span class="fu">filter</span>(game_code<span class="sc">==</span><span class="dv">1</span>),<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span>))</span>
<span id="cb224-88"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-88" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_grid</span>(quality<span class="sc">~</span>signal)</span>
<span id="cb224-89"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-89" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb224-90"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-90" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(sigma<span class="sc">~</span>(proposal<span class="sc">~</span>rate)))</span>
<span id="cb224-91"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-91" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;posterior density&quot;</span>)</span>
<span id="cb224-92"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-92" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb224-93"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-93" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Game A&quot;</span>)</span>
<span id="cb224-94"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb224-94" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:BM2024gameA"></span>
<img src="index_files/figure-html/BM2024gameA-1.png" alt="Posterior distribution of mixed strategies (histograms) and empirical choice frequencies (vertical black lines) for Game A" width="672" />
<p class="caption">
Figure 18.2: Posterior distribution of mixed strategies (histograms) and empirical choice frequencies (vertical black lines) for Game A
</p>
</div>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-1" tabindex="-1"></a>(</span>
<span id="cb225-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(PREDICTIONS <span class="sc">|&gt;</span> <span class="fu">filter</span>(game<span class="sc">==</span><span class="st">&quot;B&quot;</span>),<span class="fu">aes</span>(<span class="at">x=</span>sigma,<span class="at">fill=</span>model))</span>
<span id="cb225-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-3" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">bins=</span><span class="dv">100</span>)</span>
<span id="cb225-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-4" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_vline</span>(<span class="at">data=</span>empirical <span class="sc">|&gt;</span> <span class="fu">filter</span>(game_code<span class="sc">==</span><span class="dv">2</span>),<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span>))</span>
<span id="cb225-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-5" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">facet_grid</span>(quality<span class="sc">~</span>signal)</span>
<span id="cb225-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb225-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(sigma<span class="sc">~</span>(proposal<span class="sc">~</span>rate)))</span>
<span id="cb225-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;posterior density&quot;</span>)</span>
<span id="cb225-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))</span>
<span id="cb225-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Game B&quot;</span>)</span>
<span id="cb225-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb225-11" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:BM2024gameB"></span>
<img src="index_files/figure-html/BM2024gameB-1.png" alt="Posterior distribution of mixed strategies (histograms) and empirical choice frequencies (vertical black lines) for Game B" width="672" />
<p class="caption">
Figure 18.3: Posterior distribution of mixed strategies (histograms) and empirical choice frequencies (vertical black lines) for Game B
</p>
</div>
</div>
<div id="model-evaluation-1" class="section level2 hasAnchor" number="18.5">
<h2><span class="header-section-number">18.5</span> Model evaluation<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#model-evaluation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since we have taken two models to the data, we should do some kind of model evaluation to see which model we should work with. Here, I divided up the data into the six independent groups of participants (they were randomly re-matched within these groups) and performed 6-fold cross-validation based on these groups. Using ELPD as the measure of out-of-sample goodness-of-fit, it looks like the cursed model performs better here.</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb226-1" tabindex="-1"></a>kfoldCV<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/kfoldCV.rds&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb226-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb226-2" tabindex="-1"></a>  <span class="fu">readRDS</span>()</span>
<span id="cb226-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb226-3" tabindex="-1"></a></span>
<span id="cb226-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb226-4" tabindex="-1"></a>kfoldCV<span class="sc">$</span>baseline<span class="sc">%*%</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] -811.7324</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb228-1" tabindex="-1"></a>kfoldCV<span class="sc">$</span>cursed<span class="sc">%*%</span><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">6</span>) <span class="sc">|&gt;</span> <span class="fu">mean</span>()</span></code></pre></div>
<pre><code>## [1] -758.2627</code></pre>
</div>
<div id="r-code-used-in-this-chapter" class="section level2 hasAnchor" number="18.6">
<h2><span class="header-section-number">18.6</span> <em>R</em> code used in this chapter<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#r-code-used-in-this-chapter" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb230-2"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-2" tabindex="-1"></a><span class="fu">library</span>(rstan)</span>
<span id="cb230-3"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-3" tabindex="-1"></a><span class="fu">rstan_options</span>(<span class="at">auto_write =</span> <span class="cn">TRUE</span>)</span>
<span id="cb230-4"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb230-5"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-5" tabindex="-1"></a></span>
<span id="cb230-6"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-6" tabindex="-1"></a>RERUN<span class="ot">&lt;-</span><span class="cn">FALSE</span></span>
<span id="cb230-7"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-7" tabindex="-1"></a></span>
<span id="cb230-8"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-8" tabindex="-1"></a><span class="co"># Here I am following the replication package in importing the data -----------</span></span>
<span id="cb230-9"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-9" tabindex="-1"></a></span>
<span id="cb230-10"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-10" tabindex="-1"></a><span class="co"># set min round ---------------------------------------------------</span></span>
<span id="cb230-11"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-11" tabindex="-1"></a>min_round <span class="ot">&lt;-</span> <span class="dv">21</span></span>
<span id="cb230-12"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-12" tabindex="-1"></a></span>
<span id="cb230-13"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-13" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="st">&quot;Data/BochetMagnani2024/data_analysis/data/Main_data_base_game.csv&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb230-14"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-14" tabindex="-1"></a>  <span class="fu">read.csv</span>() <span class="sc">%&gt;%</span></span>
<span id="cb230-15"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-15" tabindex="-1"></a>  <span class="fu">filter</span>(subsession.round_number<span class="sc">&gt;=</span>min_round) <span class="sc">%&gt;%</span></span>
<span id="cb230-16"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-16" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.type=</span><span class="fu">factor</span>(player.type)) <span class="sc">%&gt;%</span></span>
<span id="cb230-17"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-17" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.type=</span><span class="fu">fct_recode</span>(player.type,</span>
<span id="cb230-18"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-18" tabindex="-1"></a>                                <span class="st">&quot;H&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>,</span>
<span id="cb230-19"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-19" tabindex="-1"></a>                                <span class="st">&quot;M&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb230-20"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-20" tabindex="-1"></a>                                <span class="st">&quot;L&quot;</span><span class="ot">=</span><span class="st">&quot;3&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb230-21"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.signal=</span><span class="fu">factor</span>(player.signal)) <span class="sc">%&gt;%</span></span>
<span id="cb230-22"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">player.signal=</span><span class="fu">fct_recode</span>(player.signal,</span>
<span id="cb230-23"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-23" tabindex="-1"></a>                                  <span class="st">&quot;h&quot;</span><span class="ot">=</span><span class="st">&quot;1&quot;</span>,</span>
<span id="cb230-24"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-24" tabindex="-1"></a>                                  <span class="st">&quot;m&quot;</span><span class="ot">=</span><span class="st">&quot;2&quot;</span>,</span>
<span id="cb230-25"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-25" tabindex="-1"></a>                                  <span class="st">&quot;l&quot;</span><span class="ot">=</span><span class="st">&quot;3&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb230-26"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-26" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">subsession.game_name=</span><span class="fu">factor</span>(subsession.game_name)) <span class="sc">|&gt;</span></span>
<span id="cb230-27"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-27" tabindex="-1"></a>  <span class="co"># now for JB&#39;s but coding up things to pass to Stan --------------------------</span></span>
<span id="cb230-28"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-28" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb230-29"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-29" tabindex="-1"></a>    <span class="at">type_code =</span> <span class="fu">paste0</span>(player.type,player.signal) <span class="sc">|&gt;</span></span>
<span id="cb230-30"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-30" tabindex="-1"></a>      <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;Hh&quot;</span>,<span class="st">&quot;Mh&quot;</span>,<span class="st">&quot;Lh&quot;</span>,<span class="st">&quot;Hm&quot;</span>,<span class="st">&quot;Mm&quot;</span>,<span class="st">&quot;Lm&quot;</span>,<span class="st">&quot;Hl&quot;</span>,<span class="st">&quot;Ml&quot;</span>,<span class="st">&quot;Ll&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb230-31"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-31" tabindex="-1"></a>      <span class="fu">as.numeric</span>(),</span>
<span id="cb230-32"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-32" tabindex="-1"></a>    </span>
<span id="cb230-33"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-33" tabindex="-1"></a>    <span class="at">game_code =</span> <span class="fu">ifelse</span>(subsession.game_name<span class="sc">==</span><span class="st">&quot;A&quot;</span>,<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb230-34"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-34" tabindex="-1"></a>    </span>
<span id="cb230-35"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-35" tabindex="-1"></a>    <span class="at">action =</span> player.choice,</span>
<span id="cb230-36"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-36" tabindex="-1"></a>    </span>
<span id="cb230-37"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-37" tabindex="-1"></a>    <span class="at">uid =</span> participant.code <span class="sc">|&gt;</span> <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>(),</span>
<span id="cb230-38"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-38" tabindex="-1"></a>    </span>
<span id="cb230-39"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-39" tabindex="-1"></a>    <span class="at">ugroupid =</span> <span class="fu">paste</span>(session.code,group.id_in_subsession) <span class="sc">|&gt;</span> <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb230-40"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-40" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb230-41"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-41" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb230-42"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-42" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb230-43"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-43" tabindex="-1"></a>    <span class="at">rownum =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>()</span>
<span id="cb230-44"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-44" tabindex="-1"></a>  )</span>
<span id="cb230-45"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-45" tabindex="-1"></a></span>
<span id="cb230-46"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-46" tabindex="-1"></a><span class="co"># My attempt to replicate Figure 5</span></span>
<span id="cb230-47"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-47" tabindex="-1"></a></span>
<span id="cb230-48"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-48" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span></span>
<span id="cb230-49"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-49" tabindex="-1"></a>  <span class="fu">filter</span>(game_code<span class="sc">==</span><span class="dv">1</span>) <span class="sc">|&gt;</span></span>
<span id="cb230-50"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-50" tabindex="-1"></a>  <span class="fu">group_by</span>(player.type,player.signal) <span class="sc">|&gt;</span></span>
<span id="cb230-51"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-51" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb230-52"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-52" tabindex="-1"></a>    <span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(action)</span>
<span id="cb230-53"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-53" tabindex="-1"></a>  )</span>
<span id="cb230-54"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-54" tabindex="-1"></a></span>
<span id="cb230-55"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-55" tabindex="-1"></a>(</span>
<span id="cb230-56"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-56" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt,<span class="fu">aes</span>(<span class="at">x=</span>player.type,<span class="at">y=</span><span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span>,<span class="at">fill =</span> player.signal))</span>
<span id="cb230-57"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-57" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>())</span>
<span id="cb230-58"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-58" tabindex="-1"></a>)</span>
<span id="cb230-59"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-59" tabindex="-1"></a></span>
<span id="cb230-60"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-60" tabindex="-1"></a><span class="co"># and Figure 6</span></span>
<span id="cb230-61"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-61" tabindex="-1"></a></span>
<span id="cb230-62"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-62" tabindex="-1"></a>dplt<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span></span>
<span id="cb230-63"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-63" tabindex="-1"></a>  <span class="fu">filter</span>(game_code<span class="sc">==</span><span class="dv">2</span>) <span class="sc">|&gt;</span></span>
<span id="cb230-64"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-64" tabindex="-1"></a>  <span class="fu">group_by</span>(player.type,player.signal) <span class="sc">|&gt;</span></span>
<span id="cb230-65"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-65" tabindex="-1"></a>  <span class="fu">summarize</span>(</span>
<span id="cb230-66"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-66" tabindex="-1"></a>    <span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">mean</span>(action)</span>
<span id="cb230-67"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-67" tabindex="-1"></a>  )</span>
<span id="cb230-68"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-68" tabindex="-1"></a></span>
<span id="cb230-69"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-69" tabindex="-1"></a>(</span>
<span id="cb230-70"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-70" tabindex="-1"></a>  <span class="fu">ggplot</span>(dplt,<span class="fu">aes</span>(<span class="at">x=</span>player.type,<span class="at">y=</span><span class="st">`</span><span class="at">Proposal rate</span><span class="st">`</span>,<span class="at">fill =</span> player.signal))</span>
<span id="cb230-71"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-71" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="fu">position_dodge</span>())</span>
<span id="cb230-72"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-72" tabindex="-1"></a>)</span>
<span id="cb230-73"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-73" tabindex="-1"></a></span>
<span id="cb230-74"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-74" tabindex="-1"></a></span>
<span id="cb230-75"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-75" tabindex="-1"></a><span class="co"># I&#39;m happy with that</span></span>
<span id="cb230-76"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-76" tabindex="-1"></a></span>
<span id="cb230-77"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-77" tabindex="-1"></a>dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb230-78"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-78" tabindex="-1"></a>  <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb230-79"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-79" tabindex="-1"></a>  </span>
<span id="cb230-80"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-80" tabindex="-1"></a>  <span class="at">type =</span> D<span class="sc">$</span>type_code,</span>
<span id="cb230-81"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-81" tabindex="-1"></a>  <span class="at">game =</span> D<span class="sc">$</span>game_code,</span>
<span id="cb230-82"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-82" tabindex="-1"></a>  <span class="at">action =</span> D<span class="sc">$</span>action,</span>
<span id="cb230-83"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-83" tabindex="-1"></a>  </span>
<span id="cb230-84"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-84" tabindex="-1"></a>  <span class="at">nUseData =</span> <span class="dv">0</span>,</span>
<span id="cb230-85"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-85" tabindex="-1"></a>  <span class="at">UseData =</span> <span class="fu">array</span>(<span class="at">dim=</span><span class="dv">0</span>),</span>
<span id="cb230-86"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-86" tabindex="-1"></a>  </span>
<span id="cb230-87"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-87" tabindex="-1"></a>  <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.45</span>,<span class="fl">1.76</span>),</span>
<span id="cb230-88"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-88" tabindex="-1"></a>  </span>
<span id="cb230-89"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-89" tabindex="-1"></a>  <span class="at">maxiter =</span> <span class="dv">100</span>,</span>
<span id="cb230-90"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-90" tabindex="-1"></a>  <span class="at">tol =</span> <span class="fl">1e-6</span>,</span>
<span id="cb230-91"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-91" tabindex="-1"></a>  <span class="at">nlxgrid =</span> <span class="dv">100</span></span>
<span id="cb230-92"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-92" tabindex="-1"></a>)</span>
<span id="cb230-93"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-93" tabindex="-1"></a></span>
<span id="cb230-94"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-94" tabindex="-1"></a></span>
<span id="cb230-95"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-95" tabindex="-1"></a></span>
<span id="cb230-96"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-96" tabindex="-1"></a></span>
<span id="cb230-97"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-97" tabindex="-1"></a></span>
<span id="cb230-98"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-98" tabindex="-1"></a></span>
<span id="cb230-99"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-99" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/baseline_qre.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb230-100"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-100" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb230-101"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-101" tabindex="-1"></a></span>
<span id="cb230-102"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-102" tabindex="-1"></a>cursed_model<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/cursed_qre.stan&quot;</span> <span class="sc">|&gt;</span></span>
<span id="cb230-103"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-103" tabindex="-1"></a>  <span class="fu">stan_model</span>()</span>
<span id="cb230-104"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-104" tabindex="-1"></a></span>
<span id="cb230-105"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-105" tabindex="-1"></a><span class="co"># Check that the thing works</span></span>
<span id="cb230-106"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-106" tabindex="-1"></a></span>
<span id="cb230-107"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-107" tabindex="-1"></a></span>
<span id="cb230-108"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-108" tabindex="-1"></a>Fit<span class="ot">&lt;-</span>model <span class="sc">|&gt;</span> </span>
<span id="cb230-109"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-109" tabindex="-1"></a>  <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">chains=</span><span class="dv">1</span>,<span class="at">iter=</span><span class="dv">10</span>,</span>
<span id="cb230-110"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-110" tabindex="-1"></a>           <span class="at">algorithm =</span> <span class="st">&quot;Fixed_param&quot;</span>,<span class="at">init =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">lambda =</span> <span class="dv">1</span>))</span>
<span id="cb230-111"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-111" tabindex="-1"></a>           )</span>
<span id="cb230-112"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-112" tabindex="-1"></a><span class="co"># trace out a grid of lambda to get the QRE correspondence</span></span>
<span id="cb230-113"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-113" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/QRE.csv&quot;</span></span>
<span id="cb230-114"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-114" tabindex="-1"></a></span>
<span id="cb230-115"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-115" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file) <span class="sc">|</span> RERUN) {</span>
<span id="cb230-116"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-116" tabindex="-1"></a>  QRE<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb230-117"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-117" tabindex="-1"></a>  </span>
<span id="cb230-118"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-118" tabindex="-1"></a>  <span class="cf">for</span> (lambda <span class="cf">in</span>  (<span class="fl">0.001</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">by=</span><span class="fl">0.01</span>))) {</span>
<span id="cb230-119"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-119" tabindex="-1"></a>    </span>
<span id="cb230-120"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-120" tabindex="-1"></a>    Fit<span class="ot">&lt;-</span>model <span class="sc">|&gt;</span> </span>
<span id="cb230-121"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-121" tabindex="-1"></a>      <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">chains=</span><span class="dv">1</span>,<span class="at">iter=</span><span class="dv">1</span>,</span>
<span id="cb230-122"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-122" tabindex="-1"></a>               <span class="at">algorithm =</span> <span class="st">&quot;Fixed_param&quot;</span>,<span class="at">init =</span> <span class="fu">list</span>(<span class="fu">list</span>(<span class="at">lambda =</span> lambda))</span>
<span id="cb230-123"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-123" tabindex="-1"></a>      )</span>
<span id="cb230-124"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-124" tabindex="-1"></a>    </span>
<span id="cb230-125"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-125" tabindex="-1"></a>    SIGMA<span class="ot">&lt;-</span><span class="fu">extract</span>(Fit)<span class="sc">$</span>sigma[<span class="dv">1</span>,,]</span>
<span id="cb230-126"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-126" tabindex="-1"></a>    </span>
<span id="cb230-127"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-127" tabindex="-1"></a>    QRE<span class="ot">&lt;-</span><span class="fu">rbind</span>(QRE,</span>
<span id="cb230-128"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-128" tabindex="-1"></a>               <span class="fu">tibble</span>(</span>
<span id="cb230-129"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-129" tabindex="-1"></a>                 <span class="at">lambda =</span> lambda,</span>
<span id="cb230-130"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-130" tabindex="-1"></a>                 <span class="at">sigma1=</span>SIGMA[<span class="dv">1</span>,],</span>
<span id="cb230-131"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-131" tabindex="-1"></a>                 <span class="at">sigma2=</span>SIGMA[<span class="dv">2</span>,],</span>
<span id="cb230-132"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-132" tabindex="-1"></a>                 <span class="at">logL =</span> <span class="fu">extract</span>(Fit)<span class="sc">$</span>logL_test</span>
<span id="cb230-133"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-133" tabindex="-1"></a>               )<span class="sc">|&gt;</span></span>
<span id="cb230-134"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-134" tabindex="-1"></a>                 <span class="fu">mutate</span>(<span class="at">type=</span><span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb230-135"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-135" tabindex="-1"></a>               )</span>
<span id="cb230-136"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-136" tabindex="-1"></a>    </span>
<span id="cb230-137"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-137" tabindex="-1"></a>  }</span>
<span id="cb230-138"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-138" tabindex="-1"></a>  </span>
<span id="cb230-139"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-139" tabindex="-1"></a>  quality<span class="ot">&lt;-</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;H&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;L&quot;</span>),<span class="dv">3</span>)</span>
<span id="cb230-140"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-140" tabindex="-1"></a>  signal<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">rep</span>(<span class="st">&quot;h&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;m&quot;</span>,<span class="dv">3</span>),<span class="fu">rep</span>(<span class="st">&quot;l&quot;</span>,<span class="dv">3</span>))</span>
<span id="cb230-141"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-141" tabindex="-1"></a>  </span>
<span id="cb230-142"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-142" tabindex="-1"></a>  QRE<span class="ot">&lt;-</span>QRE <span class="sc">|&gt;</span></span>
<span id="cb230-143"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-143" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb230-144"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-144" tabindex="-1"></a>      <span class="at">quality =</span> quality[type],</span>
<span id="cb230-145"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-145" tabindex="-1"></a>      <span class="at">signal =</span> signal[type]</span>
<span id="cb230-146"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-146" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb230-147"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-147" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb230-148"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-148" tabindex="-1"></a>      <span class="at">cols =</span> sigma1<span class="sc">:</span>sigma2,</span>
<span id="cb230-149"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-149" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">&quot;var&quot;</span>,</span>
<span id="cb230-150"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-150" tabindex="-1"></a>      <span class="at">values_to=</span><span class="st">&quot;sigma&quot;</span></span>
<span id="cb230-151"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-151" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb230-152"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-152" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb230-153"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-153" tabindex="-1"></a>      <span class="at">game =</span> <span class="fu">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)[var <span class="sc">|&gt;</span> <span class="fu">parse_number</span>()]</span>
<span id="cb230-154"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-154" tabindex="-1"></a>    )</span>
<span id="cb230-155"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-155" tabindex="-1"></a>  </span>
<span id="cb230-156"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-156" tabindex="-1"></a>  QRE <span class="sc">|&gt;</span> </span>
<span id="cb230-157"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-157" tabindex="-1"></a>    <span class="fu">write.csv</span>(file)</span>
<span id="cb230-158"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-158" tabindex="-1"></a>  </span>
<span id="cb230-159"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-159" tabindex="-1"></a>  (</span>
<span id="cb230-160"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-160" tabindex="-1"></a>    <span class="fu">ggplot</span>(QRE,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>sigma,<span class="at">linetype=</span>game))</span>
<span id="cb230-161"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-161" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">facet_grid</span>(quality<span class="sc">~</span>signal)</span>
<span id="cb230-162"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-162" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb230-163"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-163" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb230-164"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-164" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb230-165"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-165" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">xlab</span>(<span class="fu">expression</span>(lambda))</span>
<span id="cb230-166"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-166" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">ylab</span>(<span class="fu">expression</span>(sigma))</span>
<span id="cb230-167"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-167" tabindex="-1"></a>  )</span>
<span id="cb230-168"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-168" tabindex="-1"></a>  </span>
<span id="cb230-169"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-169" tabindex="-1"></a>  plotThis<span class="ot">&lt;-</span>QRE <span class="sc">|&gt;</span></span>
<span id="cb230-170"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-170" tabindex="-1"></a>    <span class="fu">filter</span>(game<span class="sc">==</span><span class="st">&quot;A&quot;</span>,quality<span class="sc">==</span><span class="st">&quot;H&quot;</span>,signal<span class="sc">==</span><span class="st">&quot;h&quot;</span>)</span>
<span id="cb230-171"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-171" tabindex="-1"></a>  </span>
<span id="cb230-172"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-172" tabindex="-1"></a>  (</span>
<span id="cb230-173"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-173" tabindex="-1"></a>    <span class="fu">ggplot</span>(plotThis,<span class="fu">aes</span>(<span class="at">x=</span>lambda,<span class="at">y=</span>logL))</span>
<span id="cb230-174"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-174" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb230-175"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-175" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">trans=</span><span class="st">&quot;log10&quot;</span>)</span>
<span id="cb230-176"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-176" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb230-177"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-177" tabindex="-1"></a>    <span class="sc">+</span><span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3000</span>,<span class="dv">0</span>))</span>
<span id="cb230-178"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-178" tabindex="-1"></a>  )</span>
<span id="cb230-179"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-179" tabindex="-1"></a>  </span>
<span id="cb230-180"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-180" tabindex="-1"></a>}</span>
<span id="cb230-181"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-181" tabindex="-1"></a><span class="co"># Estimate the baseline model</span></span>
<span id="cb230-182"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-182" tabindex="-1"></a></span>
<span id="cb230-183"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-183" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/Fit_baseline_qre.rds&quot;</span></span>
<span id="cb230-184"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-184" tabindex="-1"></a></span>
<span id="cb230-185"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-185" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file) <span class="sc">|</span> RERUN) {</span>
<span id="cb230-186"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-186" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;fitting baseline model&quot;</span>)</span>
<span id="cb230-187"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-187" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb230-188"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-188" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb230-189"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-189" tabindex="-1"></a>    </span>
<span id="cb230-190"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-190" tabindex="-1"></a>    <span class="at">type =</span> D<span class="sc">$</span>type_code,</span>
<span id="cb230-191"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-191" tabindex="-1"></a>    <span class="at">game =</span> D<span class="sc">$</span>game_code,</span>
<span id="cb230-192"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-192" tabindex="-1"></a>    <span class="at">action =</span> D<span class="sc">$</span>action,</span>
<span id="cb230-193"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-193" tabindex="-1"></a>    </span>
<span id="cb230-194"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-194" tabindex="-1"></a>    <span class="at">nUseData =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb230-195"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-195" tabindex="-1"></a>    <span class="at">UseData =</span> D<span class="sc">$</span>rownum,<span class="co">#UseData = array(dim=0),</span></span>
<span id="cb230-196"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-196" tabindex="-1"></a>    </span>
<span id="cb230-197"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-197" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.45</span>,<span class="fl">1.76</span>),</span>
<span id="cb230-198"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-198" tabindex="-1"></a>    </span>
<span id="cb230-199"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-199" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">100</span>,</span>
<span id="cb230-200"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-200" tabindex="-1"></a>    <span class="at">tol =</span> <span class="fl">1e-3</span>,</span>
<span id="cb230-201"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-201" tabindex="-1"></a>    <span class="at">nlxgrid =</span> <span class="dv">100</span></span>
<span id="cb230-202"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-202" tabindex="-1"></a>  )</span>
<span id="cb230-203"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-203" tabindex="-1"></a>  </span>
<span id="cb230-204"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-204" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span>model <span class="sc">|&gt;</span> </span>
<span id="cb230-205"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-205" tabindex="-1"></a>    <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb230-206"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-206" tabindex="-1"></a>             <span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb230-207"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-207" tabindex="-1"></a>    )</span>
<span id="cb230-208"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-208" tabindex="-1"></a>  </span>
<span id="cb230-209"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-209" tabindex="-1"></a>  Fit <span class="sc">|&gt;</span></span>
<span id="cb230-210"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-210" tabindex="-1"></a>    <span class="fu">saveRDS</span>(file)</span>
<span id="cb230-211"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-211" tabindex="-1"></a>  </span>
<span id="cb230-212"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-212" tabindex="-1"></a>}</span>
<span id="cb230-213"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-213" tabindex="-1"></a></span>
<span id="cb230-214"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-214" tabindex="-1"></a></span>
<span id="cb230-215"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-215" tabindex="-1"></a><span class="co"># Estimate the baseline model</span></span>
<span id="cb230-216"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-216" tabindex="-1"></a></span>
<span id="cb230-217"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-217" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/Fit_cursed_qre.rds&quot;</span></span>
<span id="cb230-218"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-218" tabindex="-1"></a></span>
<span id="cb230-219"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-219" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file) <span class="sc">|</span> RERUN) {</span>
<span id="cb230-220"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-220" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;fitting cursed model&quot;</span>)</span>
<span id="cb230-221"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-221" tabindex="-1"></a>  <span class="fu">print</span>(<span class="st">&quot;https://www.youtube.com/watch?v=CI1-74VQgUk&quot;</span>)</span>
<span id="cb230-222"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-222" tabindex="-1"></a>  dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb230-223"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-223" tabindex="-1"></a>    <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb230-224"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-224" tabindex="-1"></a>    </span>
<span id="cb230-225"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-225" tabindex="-1"></a>    <span class="at">type =</span> D<span class="sc">$</span>type_code,</span>
<span id="cb230-226"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-226" tabindex="-1"></a>    <span class="at">game =</span> D<span class="sc">$</span>game_code,</span>
<span id="cb230-227"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-227" tabindex="-1"></a>    <span class="at">action =</span> D<span class="sc">$</span>action,</span>
<span id="cb230-228"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-228" tabindex="-1"></a>    </span>
<span id="cb230-229"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-229" tabindex="-1"></a>    <span class="at">nUseData =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb230-230"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-230" tabindex="-1"></a>    <span class="at">UseData =</span> D<span class="sc">$</span>rownum,</span>
<span id="cb230-231"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-231" tabindex="-1"></a>    </span>
<span id="cb230-232"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-232" tabindex="-1"></a>    <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="fu">log</span>(<span class="fl">0.1</span>),<span class="dv">1</span>),</span>
<span id="cb230-233"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-233" tabindex="-1"></a>    <span class="at">prior_chi =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb230-234"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-234" tabindex="-1"></a>    </span>
<span id="cb230-235"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-235" tabindex="-1"></a>    <span class="at">maxiter =</span> <span class="dv">100</span>,</span>
<span id="cb230-236"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-236" tabindex="-1"></a>    <span class="at">tol =</span> <span class="fl">1e-3</span>,</span>
<span id="cb230-237"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-237" tabindex="-1"></a>    <span class="at">nlxgrid =</span> <span class="dv">100</span></span>
<span id="cb230-238"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-238" tabindex="-1"></a>  )</span>
<span id="cb230-239"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-239" tabindex="-1"></a>  </span>
<span id="cb230-240"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-240" tabindex="-1"></a>  Fit<span class="ot">&lt;-</span>cursed_model <span class="sc">|&gt;</span> </span>
<span id="cb230-241"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-241" tabindex="-1"></a>    <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb230-242"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-242" tabindex="-1"></a>             <span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb230-243"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-243" tabindex="-1"></a>    )</span>
<span id="cb230-244"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-244" tabindex="-1"></a>  </span>
<span id="cb230-245"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-245" tabindex="-1"></a>  Fit <span class="sc">|&gt;</span></span>
<span id="cb230-246"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-246" tabindex="-1"></a>    <span class="fu">saveRDS</span>(file)</span>
<span id="cb230-247"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-247" tabindex="-1"></a>  </span>
<span id="cb230-248"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-248" tabindex="-1"></a>}</span>
<span id="cb230-249"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-249" tabindex="-1"></a></span>
<span id="cb230-250"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-250" tabindex="-1"></a><span class="co"># k-fold CV --------------------------------------------------------------------</span></span>
<span id="cb230-251"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-251" tabindex="-1"></a></span>
<span id="cb230-252"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-252" tabindex="-1"></a>file<span class="ot">&lt;-</span><span class="st">&quot;Code/BM2024/kfoldCV.rds&quot;</span></span>
<span id="cb230-253"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-253" tabindex="-1"></a></span>
<span id="cb230-254"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-254" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">file.exists</span>(file) <span class="sc">|</span> RERUN) {</span>
<span id="cb230-255"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-255" tabindex="-1"></a>  </span>
<span id="cb230-256"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-256" tabindex="-1"></a>  ll_baseline<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb230-257"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-257" tabindex="-1"></a>  ll_cursed<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb230-258"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-258" tabindex="-1"></a>  </span>
<span id="cb230-259"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-259" tabindex="-1"></a>  <span class="cf">for</span> (gg <span class="cf">in</span> <span class="fu">sort</span>(<span class="fu">unique</span>(D<span class="sc">$</span>ugroupid))) {</span>
<span id="cb230-260"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-260" tabindex="-1"></a>  </span>
<span id="cb230-261"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-261" tabindex="-1"></a>    <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;estimating leaving out group&quot;</span>,gg))</span>
<span id="cb230-262"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-262" tabindex="-1"></a>  </span>
<span id="cb230-263"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-263" tabindex="-1"></a>    UseData<span class="ot">&lt;-</span>D <span class="sc">|&gt;</span></span>
<span id="cb230-264"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-264" tabindex="-1"></a>      <span class="fu">filter</span>(ugroupid<span class="sc">!=</span>gg)</span>
<span id="cb230-265"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-265" tabindex="-1"></a>    </span>
<span id="cb230-266"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-266" tabindex="-1"></a>    dStan<span class="ot">&lt;-</span><span class="fu">list</span>(</span>
<span id="cb230-267"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-267" tabindex="-1"></a>      <span class="at">N =</span> <span class="fu">dim</span>(D)[<span class="dv">1</span>],</span>
<span id="cb230-268"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-268" tabindex="-1"></a>      </span>
<span id="cb230-269"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-269" tabindex="-1"></a>      <span class="at">type =</span> D<span class="sc">$</span>type_code,</span>
<span id="cb230-270"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-270" tabindex="-1"></a>      <span class="at">game =</span> D<span class="sc">$</span>game_code,</span>
<span id="cb230-271"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-271" tabindex="-1"></a>      <span class="at">action =</span> D<span class="sc">$</span>action,</span>
<span id="cb230-272"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-272" tabindex="-1"></a>      </span>
<span id="cb230-273"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-273" tabindex="-1"></a>      <span class="at">nUseData =</span> <span class="fu">dim</span>(UseData)[<span class="dv">1</span>],</span>
<span id="cb230-274"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-274" tabindex="-1"></a>      <span class="at">UseData =</span> UseData<span class="sc">$</span>rownum,</span>
<span id="cb230-275"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-275" tabindex="-1"></a>      </span>
<span id="cb230-276"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-276" tabindex="-1"></a>      <span class="at">prior_lambda =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.45</span>,<span class="fl">1.76</span>),</span>
<span id="cb230-277"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-277" tabindex="-1"></a>      <span class="at">prior_chi =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb230-278"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-278" tabindex="-1"></a>      </span>
<span id="cb230-279"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-279" tabindex="-1"></a>      <span class="at">maxiter =</span> <span class="dv">100</span>,</span>
<span id="cb230-280"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-280" tabindex="-1"></a>      <span class="at">tol =</span> <span class="fl">1e-3</span>,</span>
<span id="cb230-281"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-281" tabindex="-1"></a>      <span class="at">nlxgrid =</span> <span class="dv">100</span></span>
<span id="cb230-282"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-282" tabindex="-1"></a>    )</span>
<span id="cb230-283"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-283" tabindex="-1"></a>    </span>
<span id="cb230-284"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-284" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;     Estimating baseline model&quot;</span>)</span>
<span id="cb230-285"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-285" tabindex="-1"></a>    </span>
<span id="cb230-286"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-286" tabindex="-1"></a>    Fit_baseline<span class="ot">&lt;-</span>model <span class="sc">|&gt;</span> </span>
<span id="cb230-287"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-287" tabindex="-1"></a>      <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb230-288"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-288" tabindex="-1"></a>               <span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb230-289"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-289" tabindex="-1"></a>      )</span>
<span id="cb230-290"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-290" tabindex="-1"></a>    </span>
<span id="cb230-291"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-291" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">&quot;     Estimating cursed model&quot;</span>)</span>
<span id="cb230-292"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-292" tabindex="-1"></a>    </span>
<span id="cb230-293"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-293" tabindex="-1"></a>    Fit_cursed<span class="ot">&lt;-</span>cursed_model <span class="sc">|&gt;</span> </span>
<span id="cb230-294"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-294" tabindex="-1"></a>      <span class="fu">sampling</span>(<span class="at">data=</span>dStan,<span class="at">chains=</span><span class="dv">4</span>,<span class="at">iter=</span><span class="dv">2000</span>,</span>
<span id="cb230-295"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-295" tabindex="-1"></a>               <span class="at">seed=</span><span class="dv">42</span></span>
<span id="cb230-296"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-296" tabindex="-1"></a>      )</span>
<span id="cb230-297"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-297" tabindex="-1"></a>    </span>
<span id="cb230-298"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-298" tabindex="-1"></a>    </span>
<span id="cb230-299"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-299" tabindex="-1"></a>    ll_baseline<span class="ot">&lt;-</span><span class="fu">cbind</span>(ll_baseline,<span class="fu">extract</span>(Fit_baseline)<span class="sc">$</span>logL)</span>
<span id="cb230-300"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-300" tabindex="-1"></a>    ll_cursed<span class="ot">&lt;-</span><span class="fu">cbind</span>(ll_cursed,<span class="fu">extract</span>(Fit_cursed)<span class="sc">$</span>logL)</span>
<span id="cb230-301"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-301" tabindex="-1"></a>  }</span>
<span id="cb230-302"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-302" tabindex="-1"></a>  </span>
<span id="cb230-303"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-303" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb230-304"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-304" tabindex="-1"></a>    <span class="at">baseline =</span> ll_baseline,</span>
<span id="cb230-305"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-305" tabindex="-1"></a>    <span class="at">cursed =</span> ll_cursed</span>
<span id="cb230-306"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-306" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb230-307"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-307" tabindex="-1"></a>    <span class="fu">saveRDS</span>(file)</span>
<span id="cb230-308"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-308" tabindex="-1"></a>  </span>
<span id="cb230-309"><a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#cb230-309" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Bland2023computing" class="csl-entry">
———. 2023c. <span>“Computing Quantal Response Equilibrium in Some Bayesian Games Using Marginal Strategy Profiles.”</span> <em>Available at SSRN 4551341</em>.
</div>
<div id="ref-BM2024" class="csl-entry">
Bochet, Olivier, and Jacopo Magnani. 2024. <span>“Limited Strategic Thinking and the Cursed Match.”</span> <em>American Economic Journal: Microeconomics</em> 16 (3): 321–44. <a href="https://doi.org/10.1257/mic.20210344">https://doi.org/10.1257/mic.20210344</a>.
</div>
<div id="ref-Eyster2005" class="csl-entry">
Eyster, Erik, and Matthew Rabin. 2005. <span>“Cursed Equilibrium.”</span> <em>Econometrica</em> 73 (5): 1623–72.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="78">
<li id="fn78"><p>There are some Bayesian games where we need not do this. These are games where an opponent’s type does not affect the player’s utility function. See <span class="citation">Bland (<a href="#ref-Bland2023computing">2023c</a>)</span> for more details on this.<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fnref78" class="footnote-back">↩︎</a></p></li>
<li id="fn79"><p>Think about how you would simulate qualities and signals here. You would (1) draw each player’s quality, then (2) use this to draw their opponent’s signal. <a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fnref79" class="footnote-back">↩︎</a></p></li>
<li id="fn80"><p>This is a variant on the predictor-corrector algorithm discussed earlier in this book. Here, I fix a grid of <span class="math inline">\(\lambda\)</span>s, with the last <span class="math inline">\(\lambda\)</span> being the value we need to compute QRE, and trace out the QRE over this grid.<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fnref80" class="footnote-back">↩︎</a></p></li>
<li id="fn81"><p>I want to make it clear here that I am not trying to exactly replicate Table 9 of <span class="citation">Bochet and Magnani (<a href="#ref-BM2024">2024</a>)</span>, who estimate <span class="math inline">\(\chi\approx 0.9\)</span> for the games. My estimation just uses data from the games, whereas they include data from two other tasks.<a href="application-qre-in-a-bayesian-game-and-cursed-equilibrium.html#fnref81" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-a-quantal-response-equilibrium-with-discrete-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-level-k-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
