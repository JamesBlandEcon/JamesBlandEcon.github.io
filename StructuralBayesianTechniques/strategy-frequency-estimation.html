<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Strategy Frequency Estimation | Structural Bayesian Techniques for Experimental and Behavioral Economics</title>
  <meta name="description" content="6 Strategy Frequency Estimation | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Strategy Frequency Estimation | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Strategy Frequency Estimation | Structural Bayesian Techniques for Experimental and Behavioral Economics" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2023-02-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="applications.html"/>
<link rel="next" href="outline-of-future-chapters.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="section.html#section" id="toc-section"></a></li>
<li class="chapter" data-level="" data-path="setting-the-stage.html"><a href="setting-the-stage.html"><i class="fa fa-check"></i>Setting the stage</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#what-does-your-theory-say-about-your-data"><i class="fa fa-check"></i><b>1.1</b> What does your theory say about your data?</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#what-do-your-data-say-about-your-theory"><i class="fa fa-check"></i><b>1.2</b> What do your data say about your theory?</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#what-do-your-parameters-say-about-other-things"><i class="fa fa-check"></i><b>1.3</b> What do your parameters say about other things?</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#what-does-your-expertise-say-about-your-parameters"><i class="fa fa-check"></i><b>1.4</b> What does your expertise say about your parameters?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>Stan</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#installation-in-r"><i class="fa fa-check"></i><b>2.1</b> Installation in <em>R</em></a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-anatomy-of-a-stan-program"><i class="fa fa-check"></i><b>2.2</b> The anatomy of a <em>Stan</em> program</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#data-block"><i class="fa fa-check"></i><b>2.2.1</b> Data block</a></li>
<li class="chapter" data-level="2.2.2" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#transformed-data-block"><i class="fa fa-check"></i><b>2.2.2</b> Transformed data block</a></li>
<li class="chapter" data-level="2.2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#parameters-block"><i class="fa fa-check"></i><b>2.2.3</b> Parameters block</a></li>
<li class="chapter" data-level="2.2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#model-block"><i class="fa fa-check"></i><b>2.2.4</b> Model block</a></li>
<li class="chapter" data-level="2.2.5" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#generated-quantities-block"><i class="fa fa-check"></i><b>2.2.5</b> Generated quantities block</a></li>
<li class="chapter" data-level="2.2.6" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#the-final-product"><i class="fa fa-check"></i><b>2.2.6</b> The final product</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#estimating-a-model"><i class="fa fa-check"></i><b>2.3</b> Estimating a model</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-stan.html"><a href="getting-started-in-stan.html#looking-at-the-results"><i class="fa fa-check"></i><b>2.4</b> Looking at the results</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html"><i class="fa fa-check"></i><b>3</b> Probabilistic models of behavior</a>
<ul>
<li class="chapter" data-level="3.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#the-problem-with-deterministic-models"><i class="fa fa-check"></i><b>3.1</b> The problem with deterministic models</a></li>
<li class="chapter" data-level="3.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#what-is-a-probabilistic-model"><i class="fa fa-check"></i><b>3.2</b> What <em>is</em> a probabilistic model?</a></li>
<li class="chapter" data-level="3.3" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#example-dataset-and-model"><i class="fa fa-check"></i><b>3.3</b> Example dataset and model</a></li>
<li class="chapter" data-level="3.4" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#optimal-choice-plus-an-error"><i class="fa fa-check"></i><b>3.4</b> Optimal choice plus an error</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-1"><i class="fa fa-check"></i><b>3.4.1</b> Estimating a model</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#utility-based-models"><i class="fa fa-check"></i><b>3.5</b> Utility-based models</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#estimating-a-model-2"><i class="fa fa-check"></i><b>3.5.1</b> Estimating a model</a></li>
<li class="chapter" data-level="3.5.2" data-path="probabilistic-models-of-behavior.html"><a href="probabilistic-models-of-behavior.html#doing-something-with-the-estimates"><i class="fa fa-check"></i><b>3.5.2</b> Doing something with the estimates</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="building-blocks.html"><a href="building-blocks.html"><i class="fa fa-check"></i>Building blocks</a></li>
<li class="chapter" data-level="4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html"><i class="fa fa-check"></i><b>4</b> Representative agent and participant-specific models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#participant-specific-models"><i class="fa fa-check"></i><b>4.1</b> Participant-specific models</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#example-data-and-economic-model"><i class="fa fa-check"></i><b>4.1.1</b> Example data and economic model</a></li>
<li class="chapter" data-level="4.1.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#going-to-the-probabilistic-model"><i class="fa fa-check"></i><b>4.1.2</b> Going to the probabilistic model</a></li>
<li class="chapter" data-level="4.1.3" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#a-short-side-quest-into-canned-estimation-techniques"><i class="fa fa-check"></i><b>4.1.3</b> A short side quest into canned estimation techniques</a></li>
<li class="chapter" data-level="4.1.4" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#assigning-priors"><i class="fa fa-check"></i><b>4.1.4</b> Assigning priors</a></li>
<li class="chapter" data-level="4.1.5" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-one-participant"><i class="fa fa-check"></i><b>4.1.5</b> Estimating the model for one participant</a></li>
<li class="chapter" data-level="4.1.6" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#estimating-the-model-for-all-participants"><i class="fa fa-check"></i><b>4.1.6</b> Estimating the model for all participants</a></li>
<li class="chapter" data-level="4.1.7" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#but-we-could-be-learning-more"><i class="fa fa-check"></i><b>4.1.7</b> But we could be learning more!</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="representative-agent-and-participant-specific-models.html"><a href="representative-agent-and-participant-specific-models.html#actual-representative-agent-models-pooled-models"><i class="fa fa-check"></i><b>4.2</b> Actual representative agent models (pooled models)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="hierarchical-models.html"><a href="hierarchical-models.html"><i class="fa fa-check"></i><b>5</b> Hierarchical models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-random-sample-of-participants-walks-into-your-lab"><i class="fa fa-check"></i><b>5.1</b> A random sample of participants walks into your lab</a></li>
<li class="chapter" data-level="5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-anatomy-of-a-basic-hierarchical-model"><i class="fa fa-check"></i><b>5.2</b> The anatomy of a basic hierarchical model</a></li>
<li class="chapter" data-level="5.3" data-path="hierarchical-models.html"><a href="hierarchical-models.html#accounting-for-unobserved-heterogeneity"><i class="fa fa-check"></i><b>5.3</b> Accounting for unobserved heterogeneity</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#the-last-time-you-will-integrate-the-likelihood-probably"><i class="fa fa-check"></i><b>5.3.1</b> The last time you will integrate the likelihood, probably</a></li>
<li class="chapter" data-level="5.3.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#data-augmentation"><i class="fa fa-check"></i><b>5.3.2</b> Data augmentation</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="hierarchical-models.html"><a href="hierarchical-models.html#a-multivariate-normal-hierarchical-model"><i class="fa fa-check"></i><b>5.4</b> A multivariate normal hierarchical model</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#decomposing-the-variance-covariance-matrix"><i class="fa fa-check"></i><b>5.4.1</b> Decomposing the variance-covariance matrix</a></li>
<li class="chapter" data-level="5.4.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#transformed-parameters-and-normal-distributions"><i class="fa fa-check"></i><b>5.4.2</b> Transformed parameters and normal distributions</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="hierarchical-models.html"><a href="hierarchical-models.html#example-again-with-bfs2019"><i class="fa fa-check"></i><b>5.5</b> Example: again with <span class="citation">Bruhin, Fehr, and Schunk (<span>2019</span>)</span></a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="hierarchical-models.html"><a href="hierarchical-models.html#no-correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>5.5.1</b> No correlation between individual-level parameters</a></li>
<li class="chapter" data-level="5.5.2" data-path="hierarchical-models.html"><a href="hierarchical-models.html#correlation-between-individual-level-parameters"><i class="fa fa-check"></i><b>5.5.2</b> Correlation between individual-level parameters</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i>Applications</a></li>
<li class="chapter" data-level="6" data-path="strategy-frequency-estimation.html"><a href="strategy-frequency-estimation.html"><i class="fa fa-check"></i><b>6</b> Strategy Frequency Estimation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="strategy-frequency-estimation.html"><a href="strategy-frequency-estimation.html#basic-model-and-data"><i class="fa fa-check"></i><b>6.1</b> Basic model and data</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="strategy-frequency-estimation.html"><a href="strategy-frequency-estimation.html#data-wrangling"><i class="fa fa-check"></i><b>6.1.1</b> Data wrangling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="outline-of-future-chapters.html"><a href="outline-of-future-chapters.html"><i class="fa fa-check"></i>Outline of future chapters</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Structural Bayesian Techniques for Experimental and Behavioral Economics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="strategy-frequency-estimation" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Strategy Frequency Estimation<a href="strategy-frequency-estimation.html#strategy-frequency-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>One of the econometric models that most sparked my interest was the Strategy Frequency Estimation Method (SFEM), which first showed up in the following papers:</p>
<blockquote>
<p>Dal Bó, Pedro, and Guillaume R. Fréchette. “The evolution of cooperation in infinitely repeated games: Experimental evidence.” American Economic Review 101, no. 1 (2011): 411-29.</p>
</blockquote>
<blockquote>
<p>Fudenberg, Drew, David G. Rand, and Anna Dreber. “Slow to anger and fast to forgive: Cooperation in an uncertain world.” American Economic Review 102, no. 2 (2012): 720-49.</p>
</blockquote>
<p>In these applications, and a lot that followed, the SFEM is applied to data from infinitely repeated Prisoner’s Dilemma experiments. In these games, strategies can be quite complicated beasts, because they must prescribe an action to take after every possible history of play, and histories in an infinitely repeated game can be, well … infinite.</p>
<p>The simplifying assumption that the SFEM makes is that there is a fixed menu of strategies that players may choose, and that they stick to one for the entire experiment. For example, Dal Bó and Fréchette (2011) assume the following six strategies:</p>
<ol style="list-style-type: decimal">
<li>Always Defect (AD)</li>
<li>Always Cooperate (AC)</li>
<li>Grim Trigger (G), defect for ever once one person has defected</li>
<li>Tit for Tat (TFT)</li>
<li>Win Stay Lose Shit (WSLS)</li>
<li>Tit for two tats (T2)</li>
</ol>
<p>From their footnote 19:</p>
<blockquote>
<p>WSLS is a strategty hat starts cooperating and then conditionb behavior only on the outcome of the previous round. If either both cooperate or neither cooperate, th en WSLS cooperates; otherwise it defects. T2 startcs cooperating,
and a defection by the other triggers two rounds of defection, after which the strategy goes back to cooperation. These two strategies are cooperative st rategies with punishments of limited length.</p>
</blockquote>
<p>In this post, I will show you how to estimate the SFEM from their data (which you can download (and code to replicate it!) from <a href="https://www.aeaweb.org/articles?id=10.1257/aer.101.1.411">here</a>, but using a Bayesian estimator implemented in Stan (the original applications are maximum likelihood).</p>
<p>There are <span class="math inline">\(S\)</span> strategies under consideration (<span class="math inline">\(S=6\)</span> in this application). Each strategy specifies an action (for an infinitely repeated Prisoner’s Dilemma, either “Cooperate” or “Defect”) to be played after every possible combination of strategies. The trouble, with a few notable exceptions, is that we do not observe strategies, we only observe the actions that result from these strategies, and so we have data like this:</p>
<div id="basic-model-and-data" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Basic model and data<a href="strategy-frequency-estimation.html#basic-model-and-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="strategy-frequency-estimation.html#cb81-1" aria-hidden="true" tabindex="-1"></a>DBFData<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&#39;Data/SFEM/DBFData.rds&#39;</span>)</span>
<span id="cb81-2"><a href="strategy-frequency-estimation.html#cb81-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="fu">head</span>(DBFData))</span></code></pre></div>
<table>
<colgroup>
<col width="4%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="4%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">id</th>
<th align="right">follow1</th>
<th align="right">follow2</th>
<th align="right">follow3</th>
<th align="right">follow4</th>
<th align="right">follow5</th>
<th align="right">follow6</th>
<th align="right">n</th>
<th align="right">Treatment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">21</td>
<td align="right">4</td>
<td align="right">13</td>
<td align="right">13</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">25</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">25</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">16</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">25</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">25</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">17</td>
<td align="right">0</td>
<td align="right">13</td>
<td align="right">25</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">22</td>
<td align="right">3</td>
<td align="right">14</td>
<td align="right">15</td>
<td align="right">3</td>
<td align="right">12</td>
<td align="right">25</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">25</td>
<td align="right">0</td>
<td align="right">17</td>
<td align="right">15</td>
<td align="right">2</td>
<td align="right">13</td>
<td align="right">25</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">13</td>
<td align="right">12</td>
<td align="right">5</td>
<td align="right">11</td>
<td align="right">11</td>
<td align="right">9</td>
<td align="right">25</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>Each row here is a participant in the experiment. Follow1 is a count of the number of times this participant played the action consistent with AD, likewise for follow2, and so on. <span class="math inline">\(n\)</span> is the number of actions this participant played (some data from early rounds were excluded).</p>
<p>The parameters in the model are the mixing probabilities <span class="math inline">\(\rho\)</span>, i.e. what fraction of participants are using each strategy, and a tremble parameter <span class="math inline">\(\tau\in(0,0.5)\)</span>, which is the probability a participant makes a mistake in following their action (this is a necessity when working with likelihoods).</p>
<p>We first write down the likelihood of observing participant <span class="math inline">\(i\)</span>’s actions, conditional on them following strategy <span class="math inline">\(s\)</span>:
<span class="math display">\[
l_{i,s}(y\mid \rho,\tau)=(1-\tau)^{F_{i,s}}\tau^{n_i-F_{i,s}}
\]</span></p>
<p>where <span class="math inline">\(F_{i,s}\)</span> is the number times participant <span class="math inline">\(i\)</span> follows strategy <span class="math inline">\(s\)</span>.</p>
<p>Hence, the likelihood of observing <span class="math inline">\(i\)</span>’s decisions unconditional on their strategies, can be found by taking the average likelihood over the <span class="math inline">\(S\)</span> strategies:
<span class="math display">\[
L_i(y\mid \rho,\tau)=\sum_{s=1}^S\rho_sl_{i,s\mid\rho\tau}
\]</span>
The log of this can be added to the target in Stan, so all I need to do now is specify priors:
<span class="math display">\[
\begin{aligned}
\rho &amp;\sim \mathrm{Dirichlet}(1,1,1,1,1,1)\\
\tau &amp;\sim \mathrm{Uniform}(0,0.5)
\end{aligned}
\]</span>
We can estimate this model in <em>Stan</em> as follows:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb82-1"><a href="strategy-frequency-estimation.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">// SFEM.stan</span></span>
<span id="cb82-2"><a href="strategy-frequency-estimation.html#cb82-2" aria-hidden="true" tabindex="-1"></a>functions <span class="op">{</span></span>
<span id="cb82-3"><a href="strategy-frequency-estimation.html#cb82-3" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb82-4"><a href="strategy-frequency-estimation.html#cb82-4" aria-hidden="true" tabindex="-1"></a>              </span>
<span id="cb82-5"><a href="strategy-frequency-estimation.html#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb82-6"><a href="strategy-frequency-estimation.html#cb82-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">{</span></span>
<span id="cb82-7"><a href="strategy-frequency-estimation.html#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Tell Stan how to read in the data</span></span>
<span id="cb82-8"><a href="strategy-frequency-estimation.html#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> N<span class="op">;</span> <span class="co">// Number of subjects</span></span>
<span id="cb82-9"><a href="strategy-frequency-estimation.html#cb82-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> S<span class="op">;</span> <span class="co">// Number of strategies</span></span>
<span id="cb82-10"><a href="strategy-frequency-estimation.html#cb82-10" aria-hidden="true" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>S<span class="op">]</span> COUNTS<span class="op">;</span> <span class="co">// Number of decisions by each player, here I repeat the vector S times to make the stuff below a bit simpler</span></span>
<span id="cb82-11"><a href="strategy-frequency-estimation.html#cb82-11" aria-hidden="true" tabindex="-1"></a>  matrix<span class="op">[</span>N<span class="op">,</span>S<span class="op">]</span> FOLLOWS<span class="op">;</span> <span class="co">// counts of following each strategy</span></span>
<span id="cb82-12"><a href="strategy-frequency-estimation.html#cb82-12" aria-hidden="true" tabindex="-1"></a>  vector<span class="op">[</span>S<span class="op">]</span> priorMix<span class="op">;</span></span>
<span id="cb82-13"><a href="strategy-frequency-estimation.html#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb82-14"><a href="strategy-frequency-estimation.html#cb82-14" aria-hidden="true" tabindex="-1"></a>transformed data <span class="op">{</span></span>
<span id="cb82-15"><a href="strategy-frequency-estimation.html#cb82-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-16"><a href="strategy-frequency-estimation.html#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb82-17"><a href="strategy-frequency-estimation.html#cb82-17" aria-hidden="true" tabindex="-1"></a>parameters <span class="op">{</span></span>
<span id="cb82-18"><a href="strategy-frequency-estimation.html#cb82-18" aria-hidden="true" tabindex="-1"></a>  real<span class="op">&lt;</span>lower<span class="op">=</span><span class="dv">0</span><span class="op">,</span>upper<span class="op">=</span><span class="fl">0.5</span><span class="op">&gt;</span> trmb<span class="op">;</span> <span class="co">// tremble probability</span></span>
<span id="cb82-19"><a href="strategy-frequency-estimation.html#cb82-19" aria-hidden="true" tabindex="-1"></a>  simplex<span class="op">[</span>S<span class="op">]</span> mix<span class="op">;</span> <span class="co">// strategy mixing probabilities</span></span>
<span id="cb82-20"><a href="strategy-frequency-estimation.html#cb82-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-21"><a href="strategy-frequency-estimation.html#cb82-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-22"><a href="strategy-frequency-estimation.html#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb82-23"><a href="strategy-frequency-estimation.html#cb82-23" aria-hidden="true" tabindex="-1"></a>transformed parameters <span class="op">{</span></span>
<span id="cb82-24"><a href="strategy-frequency-estimation.html#cb82-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-25"><a href="strategy-frequency-estimation.html#cb82-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb82-26"><a href="strategy-frequency-estimation.html#cb82-26" aria-hidden="true" tabindex="-1"></a>model <span class="op">{</span></span>
<span id="cb82-27"><a href="strategy-frequency-estimation.html#cb82-27" aria-hidden="true" tabindex="-1"></a>    matrix<span class="op">[</span>N<span class="op">,</span>S<span class="op">]</span> like_i<span class="op">;</span> <span class="co">// Individual likelihoods</span></span>
<span id="cb82-28"><a href="strategy-frequency-estimation.html#cb82-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-29"><a href="strategy-frequency-estimation.html#cb82-29" aria-hidden="true" tabindex="-1"></a>    mix <span class="op">~</span> dirichlet<span class="op">(</span>priorMix<span class="op">);</span></span>
<span id="cb82-30"><a href="strategy-frequency-estimation.html#cb82-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-31"><a href="strategy-frequency-estimation.html#cb82-31" aria-hidden="true" tabindex="-1"></a>    like_i <span class="op">=</span> exp<span class="op">(</span>FOLLOWS<span class="op">*</span>log<span class="op">(</span><span class="dv">1</span><span class="op">-</span>trmb<span class="op">)+(</span>COUNTS<span class="op">-</span>FOLLOWS<span class="op">)*</span>log<span class="op">(</span>trmb<span class="op">));</span></span>
<span id="cb82-32"><a href="strategy-frequency-estimation.html#cb82-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-33"><a href="strategy-frequency-estimation.html#cb82-33" aria-hidden="true" tabindex="-1"></a>    target <span class="op">+=</span> log<span class="op">(</span>like_i<span class="op">*</span>mix<span class="op">);</span></span>
<span id="cb82-34"><a href="strategy-frequency-estimation.html#cb82-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-35"><a href="strategy-frequency-estimation.html#cb82-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb82-36"><a href="strategy-frequency-estimation.html#cb82-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-37"><a href="strategy-frequency-estimation.html#cb82-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-38"><a href="strategy-frequency-estimation.html#cb82-38" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb82-39"><a href="strategy-frequency-estimation.html#cb82-39" aria-hidden="true" tabindex="-1"></a>generated quantities <span class="op">{</span></span>
<span id="cb82-40"><a href="strategy-frequency-estimation.html#cb82-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-41"><a href="strategy-frequency-estimation.html#cb82-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="strategy-frequency-estimation.html#cb83-1" aria-hidden="true" tabindex="-1"></a>priorMix<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb83-2"><a href="strategy-frequency-estimation.html#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="strategy-frequency-estimation.html#cb83-3" aria-hidden="true" tabindex="-1"></a>Fits<span class="ot">&lt;-</span><span class="fu">c</span>()</span>
<span id="cb83-4"><a href="strategy-frequency-estimation.html#cb83-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-5"><a href="strategy-frequency-estimation.html#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (tt <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb83-6"><a href="strategy-frequency-estimation.html#cb83-6" aria-hidden="true" tabindex="-1"></a>  Dt<span class="ot">&lt;-</span> DBFData <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Treatment<span class="sc">==</span>tt)</span>
<span id="cb83-7"><a href="strategy-frequency-estimation.html#cb83-7" aria-hidden="true" tabindex="-1"></a>  d <span class="ot">=</span> <span class="fu">list</span>(</span>
<span id="cb83-8"><a href="strategy-frequency-estimation.html#cb83-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">FOLLOWS=</span>Dt[,<span class="dv">2</span><span class="sc">:</span><span class="dv">7</span>],</span>
<span id="cb83-9"><a href="strategy-frequency-estimation.html#cb83-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">N=</span><span class="fu">dim</span>(Dt)[<span class="dv">1</span>],</span>
<span id="cb83-10"><a href="strategy-frequency-estimation.html#cb83-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">S=</span><span class="dv">6</span>,</span>
<span id="cb83-11"><a href="strategy-frequency-estimation.html#cb83-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">COUNTS=</span><span class="fu">kronecker</span>(Dt[,<span class="st">&quot;n&quot;</span>],<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">6</span>)),</span>
<span id="cb83-12"><a href="strategy-frequency-estimation.html#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">priorMix=</span>priorMix)</span>
<span id="cb83-13"><a href="strategy-frequency-estimation.html#cb83-13" aria-hidden="true" tabindex="-1"></a>   Fit<span class="ot">&lt;-</span><span class="fu">stan</span>(<span class="st">&quot;Code/SFEM.stan&quot;</span>,<span class="at">data=</span>d,<span class="at">seed=</span><span class="dv">42</span>,<span class="at">control =</span> <span class="fu">list</span>(<span class="at">adapt_delta =</span> <span class="fl">0.8</span>))</span>
<span id="cb83-14"><a href="strategy-frequency-estimation.html#cb83-14" aria-hidden="true" tabindex="-1"></a>   S<span class="ot">&lt;-</span><span class="fu">summary</span>(Fit,<span class="at">pars=</span><span class="fu">c</span>(<span class="st">&quot;trmb&quot;</span>,<span class="st">&quot;mix&quot;</span>),<span class="at">probs=</span><span class="fl">0.025</span>,<span class="fl">0.975</span>)<span class="sc">$</span>summary[,<span class="fu">c</span>(<span class="st">&quot;mean&quot;</span>,<span class="st">&quot;sd&quot;</span>)]</span>
<span id="cb83-15"><a href="strategy-frequency-estimation.html#cb83-15" aria-hidden="true" tabindex="-1"></a>   Fits<span class="ot">&lt;-</span><span class="fu">cbind</span>(Fits,S)</span>
<span id="cb83-16"><a href="strategy-frequency-estimation.html#cb83-16" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Warning in system2(file.path(Sys.getenv(&quot;R_HOME&quot;), &quot;bin&quot;, &quot;R&quot;), args = &quot;CMD
## SHLIB --dry-run&quot;, : running command &#39;&quot;C:/PROGRA~1/R/R-42~1.1/bin/R&quot; CMD SHLIB --
## dry-run&#39; had status 1</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="strategy-frequency-estimation.html#cb85-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(Fits)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="5%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">trmb</td>
<td align="right">0.0604706</td>
<td align="right">0.0082919</td>
<td align="right">0.1371726</td>
<td align="right">0.0099680</td>
<td align="right">0.0891320</td>
<td align="right">0.0076857</td>
<td align="right">0.0965021</td>
<td align="right">0.0074323</td>
<td align="right">0.0924904</td>
<td align="right">0.0095374</td>
<td align="right">0.0303782</td>
<td align="right">0.0046473</td>
</tr>
<tr class="even">
<td align="left">mix[1]</td>
<td align="right">0.8300743</td>
<td align="right">0.0534996</td>
<td align="right">0.7158571</td>
<td align="right">0.0610815</td>
<td align="right">0.4898507</td>
<td align="right">0.0698263</td>
<td align="right">0.5899293</td>
<td align="right">0.0708431</td>
<td align="right">0.1178781</td>
<td align="right">0.0482840</td>
<td align="right">0.0202647</td>
<td align="right">0.0205825</td>
</tr>
<tr class="odd">
<td align="left">mix[2]</td>
<td align="right">0.0201116</td>
<td align="right">0.0200572</td>
<td align="right">0.0833506</td>
<td align="right">0.0396638</td>
<td align="right">0.0837338</td>
<td align="right">0.0399359</td>
<td align="right">0.0214798</td>
<td align="right">0.0214317</td>
<td align="right">0.2697801</td>
<td align="right">0.0941707</td>
<td align="right">0.1119124</td>
<td align="right">0.0721439</td>
</tr>
<tr class="even">
<td align="left">mix[3]</td>
<td align="right">0.0198984</td>
<td align="right">0.0191985</td>
<td align="right">0.0505430</td>
<td align="right">0.0319647</td>
<td align="right">0.0346748</td>
<td align="right">0.0328796</td>
<td align="right">0.0341247</td>
<td align="right">0.0289052</td>
<td align="right">0.2249193</td>
<td align="right">0.0964727</td>
<td align="right">0.1450180</td>
<td align="right">0.1000093</td>
</tr>
<tr class="odd">
<td align="left">mix[4]</td>
<td align="right">0.0901342</td>
<td align="right">0.0416457</td>
<td align="right">0.1067672</td>
<td align="right">0.0446332</td>
<td align="right">0.3319294</td>
<td align="right">0.0709951</td>
<td align="right">0.3141972</td>
<td align="right">0.0687706</td>
<td align="right">0.2969884</td>
<td align="right">0.1098426</td>
<td align="right">0.4545791</td>
<td align="right">0.1169555</td>
</tr>
<tr class="even">
<td align="left">mix[5]</td>
<td align="right">0.0200691</td>
<td align="right">0.0193866</td>
<td align="right">0.0212536</td>
<td align="right">0.0202132</td>
<td align="right">0.0374292</td>
<td align="right">0.0274918</td>
<td align="right">0.0199163</td>
<td align="right">0.0187456</td>
<td align="right">0.0454496</td>
<td align="right">0.0427475</td>
<td align="right">0.0572441</td>
<td align="right">0.0528104</td>
</tr>
<tr class="odd">
<td align="left">mix[6]</td>
<td align="right">0.0197124</td>
<td align="right">0.0191429</td>
<td align="right">0.0222284</td>
<td align="right">0.0216921</td>
<td align="right">0.0223821</td>
<td align="right">0.0221306</td>
<td align="right">0.0203527</td>
<td align="right">0.0199541</td>
<td align="right">0.0449845</td>
<td align="right">0.0413162</td>
<td align="right">0.2109817</td>
<td align="right">0.1120109</td>
</tr>
</tbody>
</table>
<!--
## Heterogeneous trembles

## Model selection and averaging

## Appendix {-}
-->
<div id="data-wrangling" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Data wrangling<a href="strategy-frequency-estimation.html#data-wrangling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="strategy-frequency-estimation.html#cb86-1" aria-hidden="true" tabindex="-1"></a>DBFData<span class="ot">&lt;-</span><span class="fu">data.frame</span>()</span>
<span id="cb86-2"><a href="strategy-frequency-estimation.html#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ff <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb86-3"><a href="strategy-frequency-estimation.html#cb86-3" aria-hidden="true" tabindex="-1"></a>  fname<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;Data/SFEM/dfformatlab_strg_&quot;</span>,ff,<span class="st">&quot;_special.txt&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb86-4"><a href="strategy-frequency-estimation.html#cb86-4" aria-hidden="true" tabindex="-1"></a>  d<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="fu">read.delim</span>(fname, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">&quot;</span><span class="sc">\t</span><span class="st">&quot;</span>, <span class="at">dec =</span> <span class="st">&quot;.&quot;</span>))</span>
<span id="cb86-5"><a href="strategy-frequency-estimation.html#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(d)<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="st">&quot;match&quot;</span>,<span class="st">&quot;round&quot;</span>,<span class="st">&quot;treatment&quot;</span>,<span class="st">&quot;coop&quot;</span>,<span class="st">&quot;id&quot;</span>,<span class="st">&quot;ocoop_all&quot;</span>,<span class="st">&quot;strg1&quot;</span>,<span class="st">&quot;strg2&quot;</span>,<span class="st">&quot;strg3&quot;</span>,<span class="st">&quot;strg4&quot;</span>,<span class="st">&quot;strg5&quot;</span>,<span class="st">&quot;strg6&quot;</span>,<span class="st">&quot;session&quot;</span>,<span class="st">&quot;id2_all&quot;</span>)</span>
<span id="cb86-6"><a href="strategy-frequency-estimation.html#cb86-6" aria-hidden="true" tabindex="-1"></a>  DBFData<span class="ot">&lt;-</span><span class="fu">rbind</span>(DBFData,d)</span>
<span id="cb86-7"><a href="strategy-frequency-estimation.html#cb86-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-8"><a href="strategy-frequency-estimation.html#cb86-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-9"><a href="strategy-frequency-estimation.html#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (ff <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) {</span>
<span id="cb86-10"><a href="strategy-frequency-estimation.html#cb86-10" aria-hidden="true" tabindex="-1"></a>  str<span class="ot">&lt;-</span><span class="fu">paste</span>(<span class="st">&quot;DBFData$follow&quot;</span>,ff,<span class="st">&quot;&lt;- as.integer(DBFData$coop == DBFData$strg&quot;</span>,ff,<span class="st">&quot;)&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb86-11"><a href="strategy-frequency-estimation.html#cb86-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text=</span>str))</span>
<span id="cb86-12"><a href="strategy-frequency-estimation.html#cb86-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb86-13"><a href="strategy-frequency-estimation.html#cb86-13" aria-hidden="true" tabindex="-1"></a>AggData<span class="ot">&lt;-</span><span class="fu">aggregate</span>(DBFData[,<span class="fu">c</span>(<span class="st">&quot;follow1&quot;</span>,<span class="st">&quot;follow2&quot;</span>,<span class="st">&quot;follow3&quot;</span>,<span class="st">&quot;follow4&quot;</span>,<span class="st">&quot;follow5&quot;</span>,<span class="st">&quot;follow6&quot;</span>)], <span class="at">by=</span><span class="fu">list</span>(DBFData<span class="sc">$</span>id),<span class="at">FUN=</span>sum)</span>
<span id="cb86-14"><a href="strategy-frequency-estimation.html#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(AggData)[<span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">&quot;id&quot;</span></span>
<span id="cb86-15"><a href="strategy-frequency-estimation.html#cb86-15" aria-hidden="true" tabindex="-1"></a>AggData<span class="sc">$</span>n<span class="ot">&lt;-</span><span class="fu">aggregate</span>(DBFData<span class="sc">$</span>id,<span class="at">by=</span><span class="fu">list</span>(DBFData<span class="sc">$</span>id),<span class="at">FUN=</span>length)<span class="sc">$</span>x</span>
<span id="cb86-16"><a href="strategy-frequency-estimation.html#cb86-16" aria-hidden="true" tabindex="-1"></a>AggData<span class="sc">$</span>Treatment<span class="ot">&lt;-</span><span class="fu">aggregate</span>(DBFData<span class="sc">$</span>treatment,<span class="at">by=</span><span class="fu">list</span>(DBFData<span class="sc">$</span>id),<span class="at">FUN=</span>mean)<span class="sc">$</span>x</span>
<span id="cb86-17"><a href="strategy-frequency-estimation.html#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(AggData,<span class="st">&quot;Data/SFEM/DBFData.rds&quot;</span>)</span></code></pre></div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="applications.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="outline-of-future-chapters.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
