<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span. { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>JamesBlandEcon: Estimating Quantal Response Equilibrium in an attacker-defender game</title>

<meta property="description" itemprop="description" content="A Bayesian implementation of some econometrics in Holt, Sahu, and Smith (2022)"/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-07-21"/>
<meta property="article:created" itemprop="dateCreated" content="2022-07-21"/>
<meta name="article:author" content="James Bland"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="JamesBlandEcon: Estimating Quantal Response Equilibrium in an attacker-defender game"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="A Bayesian implementation of some econometrics in Holt, Sahu, and Smith (2022)"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="JamesBlandEcon"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="JamesBlandEcon: Estimating Quantal Response Equilibrium in an attacker-defender game"/>
<meta property="twitter:description" content="A Bayesian implementation of some econometrics in Holt, Sahu, and Smith (2022)"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Estimating Quantal Response Equilibrium in an attacker-defender game"]},{"type":"character","attributes":{},"value":["A Bayesian implementation of some econometrics in Holt, Sahu, and Smith (2022)"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["James Bland"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["https://sites.google.com/site/jamesbland/"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":[]}},"value":[]}]}]}]},{"type":"character","attributes":{},"value":["2022-07-21"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["estimating-qre_files/anchor-4.2.2/anchor.min.js","estimating-qre_files/bowser-1.9.3/bowser.min.js","estimating-qre_files/distill-2.2.21/template.v2.js","estimating-qre_files/figure-html5/unnamed-chunk-3-1.png","estimating-qre_files/figure-html5/unnamed-chunk-4-1.png","estimating-qre_files/figure-html5/unnamed-chunk-5-1.png","estimating-qre_files/figure-html5/unnamed-chunk-8-1.png","estimating-qre_files/figure-html5/unnamed-chunk-8-2.png","estimating-qre_files/figure-html5/unnamed-chunk-9-1.png","estimating-qre_files/figure-html5/unnamed-chunk-9-2.png","estimating-qre_files/header-attrs-2.14/header-attrs.js","estimating-qre_files/jquery-3.6.0/jquery-3.6.0.js","estimating-qre_files/jquery-3.6.0/jquery-3.6.0.min.js","estimating-qre_files/jquery-3.6.0/jquery-3.6.0.min.map","estimating-qre_files/popper-2.6.0/popper.min.js","estimating-qre_files/tippy-6.2.7/tippy-bundle.umd.min.js","estimating-qre_files/tippy-6.2.7/tippy-light-border.css","estimating-qre_files/tippy-6.2.7/tippy.css","estimating-qre_files/tippy-6.2.7/tippy.umd.min.js","estimating-qre_files/webcomponents-2.0.0/webcomponents.js","HSS_QREEstimator.stan","HSSdata.xls"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

hr.section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  margin: 0px;
}


d-byline {
  border-top: none;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
  border-top: none;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // separator
  var separator = '<hr class="section-separator" style="clear: both"/>';
  // prepend separator above appendix
  $('.d-byline').before(separator);
  $('.d-article').before(separator);

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      var author_name = front_matter.authors[i].author
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', author_name ? 'ORCID ID for ' + author_name : 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Estimating Quantal Response Equilibrium in an attacker-defender game","description":"A Bayesian implementation of some econometrics in Holt, Sahu, and Smith (2022)","authors":[{"author":"James Bland","authorURL":{"https://sites.google.com/site/jamesbland/":{}},"affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-07-21T00:00:00.000-04:00","citationText":"Bland, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">JamesBlandEcon</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Home</a>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Estimating Quantal Response Equilibrium in an attacker-defender game</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A Bayesian implementation of some econometrics in Holt, Sahu, and Smith (2022)</p></p>
</div>

<div class="d-byline">
  James Bland true 
  
<br/>2022-07-21
</div>

<div class="d-article">
<p>One of the things I really like about quantal response equilibrium (QRE) is that it is right in the intersection of game theory, behavioral economics, and statistics. The game theory part should be pretty clear, because QRE is an equilibrium concept for games. It draws from behavioral economics because one can interpret the imprecision of players’ decisions as bounded rationality, which is empirically very relevant. The statistical part comes in because it permits the use of a likelihood function in estimating a model’s parameters, where Nash equilibrium sometimes does not (for example, when a player has a strictly dominant strategy).</p>
<p>As I have begun writing in this area, and was fortunate enough to attend the <em>25+ years of Quantal Response Equilibrium Conference</em> at Caltech in March this year, I thought I’d write a quick post about what QRE is, and show you how I am estimating its parameters using Bayesian techniques. Of course, if you are looking for my full working paper on how to do this, you should click <a href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3748586">here</a>, but what follows is a more introductory treatment of the process. I have also had many questions from people about how to get started with this, so I suppose I can direct them here from now on.</p>
<h1 id="sometimes-nash-equilibrium-makes-weird-predictions">Sometimes Nash equilibrium makes weird predictions</h1>
<p>A recent paper in <em>Southern Economic Journal</em> highlights one of the interesting features of QRE, in that it often predicts the direction in which play by human subjects will depart from Nash equilibrium. Here is the full citation with a link to the published paper:</p>
<blockquote>
<p>Holt, Charles A., Ricky Sahu, and Angela M. Smith. <a href="https://doi.org/10.1002/soej.12574">“An experimental analysis of risk effects in attacker‐defender games.”</a> <em>Southern Economic Journal</em> (2022).</p>
</blockquote>
<p>henceforth HSS.</p>
<p>Here are the payoff tables of HSS’ three treatments:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readxl.tidyverse.org'>readxl</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>payoffs</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>low</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>low</span><span class='op'>$</span><span class='va'>Urow</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>low</span><span class='op'>$</span><span class='va'>Ucol</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>0</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>medium</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>medium</span><span class='op'>$</span><span class='va'>Urow</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>medium</span><span class='op'>$</span><span class='va'>Ucol</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>high</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>high</span><span class='op'>$</span><span class='va'>Urow</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>1</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>,<span class='op'>-</span><span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>high</span><span class='op'>$</span><span class='va'>Ucol</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='op'>-</span><span class='fl'>4</span><span class='op'>)</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>,<span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#payoffs %&gt;% print()</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>ii</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>payoffs</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>pp</span><span class='op'>&lt;-</span><span class='va'>payoffs</span><span class='op'>[[</span><span class='va'>ii</span><span class='op'>]</span><span class='op'>]</span></span>
<span>  <span class='va'>tab</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='va'>pp</span><span class='op'>$</span><span class='va'>Urow</span>,<span class='st'>","</span>, <span class='va'>pp</span><span class='op'>$</span><span class='va'>Ucol</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/t.html'>t</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span>nrow<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"High alert"</span>,<span class='st'>"Low alert"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Wait"</span>,<span class='st'>"Attack"</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>payoffs</span><span class='op'>)</span><span class='op'>[</span><span class='va'>ii</span><span class='op'>]</span>,<span class='st'>"alert cost ------------------"</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='va'>tab</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='st'>""</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span></code></pre>
</div>
<pre><code>[1] &quot;low alert cost ------------------&quot;


|           |Wait  |Attack |
|:----------|:-----|:------|
|High alert |1 , 1 |1 , 0  |
|Low alert  |4 , 1 |-2 , 6 |
[1] &quot;&quot;
[1] &quot;medium alert cost ------------------&quot;


|           |Wait  |Attack |
|:----------|:-----|:------|
|High alert |1 , 1 |1 , -2 |
|Low alert  |4 , 1 |-2 , 4 |
[1] &quot;&quot;
[1] &quot;high alert cost ------------------&quot;


|           |Wait  |Attack |
|:----------|:-----|:------|
|High alert |1 , 1 |1 , -4 |
|Low alert  |4 , 1 |-2 , 2 |
[1] &quot;&quot;</code></pre>
</div>
<p>Note that the row player’s payoff do not change over these three treatments. That is, from the row player’s perspective, their part of the payoff matrix is always:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>payoffs</span><span class='op'>$</span><span class='va'>low</span><span class='op'>$</span><span class='va'>Urow</span></span></code></pre>
</div>
<pre><code>     [,1] [,2]
[1,]    1    1
[2,]    4   -2</code></pre>
</div>
<p>Because this game has a unique Nash equilibrium in mixed strategies, Nash equilibrium predicts that <em>the column player’s probability of choosing “Attack” should not change between treatments</em>.</p>
<p>What?</p>
<p>I just showed you that the <em>row</em> player’s payoffs remained the same, but that tells us something about the <em>column</em> player? To see why, let’s calculate the mixed strategy Nash equilibrium strategy for the column player, which must set the probability of attacking, call this <span class="math inline">\(p_A\)</span>, such that the row player is indifferent between being on low and high alert:</p>
<p><span class="math display">\[
\begin{aligned}
U_\text{High}&amp;=1p_A+1(1-p_A)=1\\
U_\text{Low}&amp;=-2p_A+4(1-p_A)=4-6p_A\\
\text{indifference}\implies 1&amp;=4-6p_A\\
6p_A&amp;=3\\
p_A=\frac{1}{2}
\end{aligned}
\]</span></p>
<p>Note here that we did not need to look at the column player’s payoffs in making this calculation, but we have calculated the column player’s mixed strategy! This is a property of all mixed strategy Nash predictions: if you only change the payoffs of one player, that player should not adjust their strategy,</p>
<p>So what happens in reality? The data for this experiment are are available at the group level in the paper (thanks, authors!), so one can just copy and paste them into a spreadsheet and then import them right into <em>R</em>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>d</span><span class='op'>&lt;-</span><span class='fu'><a href='https://readxl.tidyverse.org/reference/read_excel.html'>read_excel</a></span><span class='op'>(</span><span class='st'>"HSSdata.xls"</span>,sheet<span class='op'>=</span><span class='st'>"Final15"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>d</span><span class='op'>)</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Session"</span>,<span class='st'>"Treatment"</span>,<span class='st'>"PairID"</span>,<span class='st'>"attack"</span>,<span class='st'>"alert"</span><span class='op'>)</span></span>
<span><span class='va'>d</span><span class='op'>&lt;-</span><span class='op'>(</span></span>
<span>  <span class='va'>d</span></span>
<span>  <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>cost <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Treatment</span><span class='op'>==</span><span class='st'>"Low"</span>,<span class='fl'>0</span>,</span>
<span>                           <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>Treatment</span><span class='op'>==</span><span class='st'>"Medium"</span>,<span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span><span class='va'>d</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/sample_n.html'>sample_n</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Session</th>
<th style="text-align: left;">Treatment</th>
<th style="text-align: left;">PairID</th>
<th style="text-align: right;">attack</th>
<th style="text-align: right;">alert</th>
<th style="text-align: right;">cost</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ter7</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: left;">2022-01-07</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ter8</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">2022-05-11</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ter7</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: left;">2022-04-10</td>
<td style="text-align: right;">0.27</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">adnf10</td>
<td style="text-align: left;">High</td>
<td style="text-align: left;">2022-04-10</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ter9</td>
<td style="text-align: left;">High</td>
<td style="text-align: left;">2022-05-11</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">ter9</td>
<td style="text-align: left;">High</td>
<td style="text-align: left;">2022-04-10</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.13</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ter7</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: left;">2022-06-12</td>
<td style="text-align: right;">0.40</td>
<td style="text-align: right;">0.53</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">adnf9</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: left;">2022-02-08</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">adnf9</td>
<td style="text-align: left;">Medium</td>
<td style="text-align: left;">2022-01-07</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">ter8</td>
<td style="text-align: left;">Low</td>
<td style="text-align: left;">2022-06-12</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
<p>Here I (and HSS) am focusing on the final 15 rounds of play, as earlier rounds may be less likely to have equilibrium play.</p>
<p>But when we look at the probability that each player attacks, broken down by treatment, we see that higher attack costs result in lower attack probabilities.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>d</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span><span class='va'>attack</span>,color<span class='op'>=</span><span class='va'>Treatment</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/stat_ecdf.html'>stat_ecdf</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_abline.html'>geom_vline</a></span><span class='op'>(</span>xintercept<span class='op'>=</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>2</span>,linetype<span class='op'>=</span><span class='st'>"dashed"</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="estimating-qre_files/figure-html5/unnamed-chunk-4-1.png" width="624" /></p>
</div>
<p>Here I am plotting the empirical cumulative density function of the fraction of times each column player chose “Attack”. Looking at this, the red line (high attack cost) is at least as far to the left of the blue line (medium attack cost), which itself is almost always to the left of the green line (low attack cost). That is, <em>attack probabilities are increasing as attack costs go down</em>. This is quite intuitive to anyone who has taken a principles course: if you raise the price (cost of attacking), you are less likely to buy the good (attack), but it is <em>not</em> predicted by Nash equilibrium.</p>
<h1 id="introducing-quantal-response-equilibrium-qre">Introducing quantal response equilibrium (QRE)</h1>
<p>Fortunately, Nash equilibrium is not the only tool we have to work with. While it seems intuitively plausible that people should attack less when the attack cost goes up, Nash predicts that the opponent (row player) will adjust their strategy to keep the column player indifferent.</p>
<p>QRE replaces the Nash equilibrium’s best response function with a “probabilistic best response”, or “noisy best response” function. The idea is that while players respond to their payoffs, they don’t do it perfectly. In particular, we will assume that players are more likely to take actions that yield higher expected utility, but they don’t necessarily always choose the action with the highest expected utility. This is behaviorally plausible because boundedly rational players may correctly evaluate their expected utilities on average, but they make mistakes in their calculations.</p>
<p>A popular parameterization of a probabilistic best response function is logit choice, also called softmax:</p>
<p><span class="math display">\[
p(a\mid u)=\frac{\exp(\lambda u_a)}{\sum_j\exp(\lambda u_j)}
\]</span></p>
<p>where <span class="math inline">\(ui\)</span> is a vector of expected payoffs, <span class="math inline">\(\u_a\)</span> is the expected payoff of choosing action <span class="math inline">\(a\)</span>, and <span class="math inline">\(\lambda\geq 0\)</span> is the choice precision parameter. When there are only two actions to choose from, this becomes:</p>
<p><span class="math display">\[
\begin{aligned}
p(a\mid u_a,u_b)&amp;=\frac{\exp(\lambda u_a)}{\exp(\lambda u_a)+\exp(\lambda u_b)}\\
&amp;=\left(1+\exp(-\lambda(u_a-u_b))\right)^{-1}
\end{aligned}
\]</span></p>
<p>and it is also useful to express this in logit form:</p>
<p><span class="math display">\[
\log p_a-\log p_b=\lambda(u_a-u_b)
\]</span> which is true for an arbitrary number of actions. This is useful because it shows how players respond to utility differences: when <span class="math inline">\(u_a&gt;u_b\)</span> players will be more likely to choose <span class="math inline">\(a\)</span> than <span class="math inline">\(b\)</span>. Increasing this difference will make it even more likely, and so will increasing the choice precision parameter <span class="math inline">\(\lambda\)</span>. Furthermore, this model nests two important responses to payoffs that are empirically interesting:</p>
<ul>
<li>When <span class="math inline">\(\lambda = 0\)</span>, players uniformly randomize over their action space</li>
<li>When <span class="math inline">\(\lambda\to\infty\)</span>, the probabilistic best response approaches a deterministic best response. For me, this is best seen in a graph:</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lambda</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span>,<span class='fl'>10</span>,<span class='fl'>100</span><span class='op'>)</span></span>
<span><span class='va'>DU</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>1</span>,<span class='fl'>1</span>,length<span class='op'>=</span><span class='fl'>101</span><span class='op'>)</span></span>
<span><span class='va'>pltThis</span><span class='op'>&lt;-</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>ll</span> <span class='kw'>in</span> <span class='va'>lambda</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>tmp</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>DU <span class='op'>=</span> <span class='va'>DU</span>,lambda <span class='op'>=</span> <span class='va'>ll</span><span class='op'>)</span></span>
<span>           <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>pA <span class='op'>=</span> <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>lambda</span><span class='op'>*</span><span class='va'>DU</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span>  <span class='va'>pltThis</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>pltThis</span>,<span class='va'>tmp</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>pltThis</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>DU</span>,y<span class='op'>=</span><span class='va'>pA</span>,color<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/factor.html'>as.factor</a></span><span class='op'>(</span><span class='va'>lambda</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Ua - Ub"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"p(a)"</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="estimating-qre_files/figure-html5/unnamed-chunk-5-1.png" width="624" /></p>
</div>
<p>So what we have up to this point is a replacement for the best response function. What we need to do now is to tie it in with the fixed point condition of Nash equilibrium, where we impose that the row player’s best response to the column player’s strategy is the row player’s strategy. Likewise for the column player.</p>
<p>For quantal response equilibrium, this means that the row player’s probabilistic best response to the column player’s strategy is their own mixed strategy, so using the logit specification:</p>
<p><span class="math display">\[
\begin{aligned}
\log p_H-\log p_L&amp;=\lambda\left[u_H-u_L\right]\\
&amp;=\lambda\left[1-(4-6p_A)\right]\\
&amp;=\lambda(6p_A-3)
\end{aligned}
\]</span></p>
<p>and noting that <span class="math inline">\(p_L=1-p_L\)</span>, this becomes:</p>
<p><span class="math display">\[
\log(p_H)-\log(1-p_H)=\lambda(6p_A-3)
\]</span> Similarly for the column player, we need that:</p>
<p><span class="math display">\[
\begin{aligned}
\log(p_A)-\log(1-p_A)&amp;=\lambda\left[u_A-u_W\right]\\
&amp;=\lambda\left[6(1-p_H)-c-1\right]
\end{aligned}
\]</span> where <span class="math inline">\(c\in\{0,2,4\}\)</span> is the relevant attack cost for that treatment.</p>
<p>Putting these together, we have two equations in two unknowns, which written as zeros becomes: <span class="math display">\[
\begin{aligned}
0&amp;=\log (p_H)-\log (1-p_H)-\lambda(2-5p_A)\\
0&amp;=\log(p_A)-\log(1-p_A)-\lambda\left[6(1-p_H)-c-1\right]
\end{aligned}
\]</span> which is not solvable by hand, but fortunately a computer can do it for us. While solving the above directly will probably work just fine for this application, it is usually better for stability reasons to solve the problem in logs or logits directly, then transform back into probabilities:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='co'># Objective function: minimize the difference between the RHS of the above equations and zero</span></span>
<span><span class='va'>ObjFun</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>lp</span>,<span class='va'>c</span>,<span class='va'>lambda</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>p</span><span class='op'>&lt;-</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>lp</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># convert logit(p) to probabilities</span></span>
<span>  </span>
<span>  <span class='va'>x</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span></span>
<span>    <span class='va'>lp</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>-</span><span class='va'>lambda</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>*</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>-</span><span class='fl'>3</span><span class='op'>)</span>,</span>
<span>    <span class='va'>lp</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span><span class='op'>-</span><span class='va'>lambda</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>6</span><span class='op'>*</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span><span class='op'>-</span><span class='va'>c</span><span class='op'>-</span><span class='fl'>1</span><span class='op'>)</span></span>
<span>  <span class='op'>)</span></span>
<span>  </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>^</span><span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='co'># Equilibrium calculation: minimize the objective function given c and lambda</span></span>
<span><span class='va'>QRE</span><span class='op'>&lt;-</span><span class='kw'>function</span><span class='op'>(</span><span class='va'>c</span>,<span class='va'>lambda</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>  <span class='va'>par</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/stats/optim.html'>optim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0</span><span class='op'>)</span>,<span class='kw'>function</span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span> <span class='fu'>ObjFun</span><span class='op'>(</span><span class='va'>p</span>,<span class='va'>c</span>,<span class='va'>lambda</span><span class='op'>)</span><span class='op'>)</span><span class='op'>$</span><span class='va'>par</span></span>
<span>  <span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>+</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='op'>-</span><span class='va'>par</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='fu'>QRE</span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>[1] 0.7228955 0.6598094</code></pre>
</div>
<p>So now we can trace out the QRE (as a function of choice precision <span class="math inline">\(\lambda\)</span>) for the three treatments:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>QREdata</span><span class='op'>&lt;-</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>lambda</span><span class='op'>&lt;-</span><span class='fl'>1</span><span class='op'>/</span><span class='op'>(</span><span class='fl'>1</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>0.99999</span>,length<span class='op'>=</span><span class='fl'>100</span><span class='op'>)</span><span class='op'>)</span><span class='op'>-</span><span class='fl'>1</span></span>
<span></span>
<span><span class='kw'>for</span> <span class='op'>(</span><span class='va'>cc</span> <span class='kw'>in</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>2</span>,<span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span> </span>
<span>  <span class='kw'>for</span> <span class='op'>(</span><span class='va'>ll</span> <span class='kw'>in</span> <span class='va'>lambda</span><span class='op'>)</span> <span class='op'>{</span></span>
<span>    <span class='va'>p</span><span class='op'>&lt;-</span><span class='fu'>QRE</span><span class='op'>(</span><span class='va'>cc</span>,<span class='va'>ll</span><span class='op'>)</span></span>
<span>    <span class='va'>tmp</span><span class='op'>&lt;-</span><span class='fu'><a href='https://tibble.tidyverse.org/reference/tibble.html'>tibble</a></span><span class='op'>(</span>pH<span class='op'>=</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,pA<span class='op'>=</span><span class='va'>p</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>,lambda<span class='op'>=</span><span class='va'>ll</span>,c<span class='op'>=</span><span class='va'>cc</span>,ctxt <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"attack cost ="</span>,<span class='va'>cc</span><span class='op'>)</span><span class='op'>)</span></span>
<span>    <span class='va'>QREdata</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>rbind</a></span><span class='op'>(</span><span class='va'>QREdata</span>,<span class='va'>tmp</span><span class='op'>)</span></span>
<span>  <span class='op'>}</span></span>
<span><span class='op'>}</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>QREdata</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code># A tibble: 6 x 5
     pH    pA lambda     c ctxt           
  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          
1 0.5   0.5   0          0 attack cost = 0
2 0.500 0.505 0.0102     0 attack cost = 0
3 0.500 0.510 0.0206     0 attack cost = 0
4 0.501 0.516 0.0312     0 attack cost = 0
5 0.501 0.521 0.0421     0 attack cost = 0
6 0.502 0.526 0.0532     0 attack cost = 0</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>d</span><span class='op'>&lt;-</span><span class='va'>d</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/mutate.html'>mutate</a></span><span class='op'>(</span>ctxt <span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"attack cost ="</span>,<span class='va'>cost</span><span class='op'>)</span> <span class='op'>)</span></span>
<span></span>
<span><span class='op'>(</span></span>
<span>  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>QREdata</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>pA</span>,y<span class='op'>=</span><span class='va'>pH</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_path.html'>geom_path</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_bw</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/geom_point.html'>geom_point</a></span><span class='op'>(</span>data<span class='op'>=</span><span class='va'>d</span>,<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>attack</span>,y<span class='op'>=</span><span class='va'>alert</span><span class='op'>)</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>ctxt</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Attack probability"</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"High alert probability"</span><span class='op'>)</span></span>
<span>  <span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>xlim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/lims.html'>ylim</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="estimating-qre_files/figure-html5/unnamed-chunk-8-1.png" width="624" /></p>
</div>
<p>Note that for the medium attack cost, there appears to be no QRE prediction. This is because <span class="math inline">\((p_H,p_A)=(0.5,0.5)\)</span> for all <span class="math inline">\(\lambda\)</span> in this case. Risk-neutral QRE provides no additional predictions beyone Nash equilibrium (or coin-flipping, for that matter) in this case.</p>
<h1 id="estimating-the-model-in-stan">Estimating the model in <em>Stan</em></h1>
<p>Let’s estimate the choice precision parameter <span class="math inline">\(\lambda\)</span>. To do this, we will first need to specify the likelihood. This is fairly straightforward, as the model specifies a probability distribution over actions:</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal p(y\mid \lambda)&amp;=\prod_{c\in\{0,2,4\}}p_A^c(\lambda)^{A_c}(1-p_A^c(\lambda))^{N_c-A_c}p_H^c(\lambda)^{H_c}(1-p_H^c(\lambda))^{N_c-H_c}\\
\log p(y\mid\lambda)&amp;=\sum_{c\in\{0,2,4\}}\left[
A_c\log(p_A^c(\lambda))+(N_c-A_c)\log(1-p^c_A(\lambda))
+H_c\log(p_H^c(\lambda))+(N_c-H_c)\log(1-p^c_H(\lambda))
\right]
\end{aligned}
\]</span> where <span class="math inline">\(N_c\)</span> is the number of rounds played in treatment <span class="math inline">\(c\)</span>, <span class="math inline">\(A_c\)</span> is the number of times “Attack” was played in treatment <span class="math inline">\(c\)</span>, and <span class="math inline">\(H_c\)</span> is the number of times “High alert” was played in period <span class="math inline">\(c\)</span>.</p>
<p>While this is the easy part, the part I found not so easy in implementing this was to actually solve for the QRE. Remember that we cannot do this by hand, so we will need to pass instructions to <em>Stan</em> on how to do this. Fortunately <em>Stan</em> has a nonlinear equation solver, so in principle this is doable. What I found in practice in writing my working paper (see above), is that if you are willing to do a bit of math beforehand, you can make the problem a lot simpler for <em>Stan</em> to compute. I will not go into this here, but I encourage you to learn about the predictor-corrector algorithm in:</p>
<blockquote>
<p>Turocy, Theodore L. “Computing sequential equilibria using agent quantal response equilibria.” Economic Theory 42, no. 1 (2010): 255-269.</p>
</blockquote>
<p>What I ended up doing in my working paper was just using corrector steps (as my problem was relatively stable).</p>
<p>But for now, let’s make <em>Stan</em> do all of the heavy lifting, because this problem is a relatively quick one to solve, particularly since all of the information needed to compute the likelihood is in the following three-row table:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>dsummary</span><span class='op'>&lt;-</span><span class='op'>(</span><span class='va'>d</span></span>
<span>  <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>cost</span><span class='op'>)</span></span>
<span>  <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>H <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>alert</span><span class='op'>*</span><span class='fl'>15</span><span class='op'>)</span>,</span>
<span>                A <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>attack</span><span class='op'>*</span><span class='fl'>15</span><span class='op'>)</span>,</span>
<span>                N <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>15</span> <span class='co'># Each player played 15 rounds in the final 15 rounds</span></span>
<span>                <span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>dsummary</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span></span></code></pre>
</div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">cost</th>
<th style="text-align: right;">H</th>
<th style="text-align: right;">A</th>
<th style="text-align: right;">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">120.15</td>
<td style="text-align: right;">72.60</td>
<td style="text-align: right;">180</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">99.00</td>
<td style="text-align: right;">47.10</td>
<td style="text-align: right;">180</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">43.05</td>
<td style="text-align: right;">31.05</td>
<td style="text-align: right;">180</td>
</tr>
</tbody>
</table>
</div>
<p>(yes, I’m noting some rounding errors here. Let’s just go with it).</p>
<p>Here is the <em>Stan</em> program I wrote to estimate this QRE:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode" id="cb5"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb5-1"><a href="#cb5-1"></a>functions {</span>
<span id="cb5-2"><a href="#cb5-2"></a>  </span>
<span id="cb5-3"><a href="#cb5-3"></a>  </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="co">/*</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">  QRE fixed point condition</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">  This function is equal to zero when evaluated at the logit of the QRE probabilities</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">  Stan requires that functions passed to the algebra solver have a certain signature, so</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">  I had to add in the x_r and x_i inputs to get it to work, even though I don&#39;t</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">  need these</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">  */</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  vector QREFixedPoint(vector lp, vector pars,  data real[] x_r, data <span class="dt">int</span>[] x_i) {</span>
<span id="cb5-12"><a href="#cb5-12"></a>    vector[<span class="dv">2</span>] z;</span>
<span id="cb5-13"><a href="#cb5-13"></a>    </span>
<span id="cb5-14"><a href="#cb5-14"></a>    real lambda = pars[<span class="dv">1</span>]; <span class="co">// lambda is the first element of pars</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>    real cost = pars[<span class="dv">2</span>];   <span class="co">// attack cost is the second element of pars</span></span>
<span id="cb5-16"><a href="#cb5-16"></a>    </span>
<span id="cb5-17"><a href="#cb5-17"></a>    <span class="co">// convert logit probabilities into actual probabilities</span></span>
<span id="cb5-18"><a href="#cb5-18"></a>    vector[<span class="dv">2</span>] p = <span class="fl">1.0</span> ./(<span class="fl">1.0</span>+exp(-lp)); </span>
<span id="cb5-19"><a href="#cb5-19"></a>    </span>
<span id="cb5-20"><a href="#cb5-20"></a>    <span class="co">// fixed point condition for row player</span></span>
<span id="cb5-21"><a href="#cb5-21"></a>    z[<span class="dv">1</span>] = lp[<span class="dv">1</span>]-lambda*(<span class="dv">6</span>*p[<span class="dv">2</span>]-<span class="dv">3</span>);</span>
<span id="cb5-22"><a href="#cb5-22"></a>    <span class="co">// fixed point condition for column player</span></span>
<span id="cb5-23"><a href="#cb5-23"></a>    z[<span class="dv">2</span>] = lp[<span class="dv">2</span>]-lambda*(<span class="dv">6</span>*(<span class="dv">1</span>-p[<span class="dv">1</span>])-cost-<span class="dv">1</span>);</span>
<span id="cb5-24"><a href="#cb5-24"></a>    </span>
<span id="cb5-25"><a href="#cb5-25"></a>    <span class="cf">return</span> z;</span>
<span id="cb5-26"><a href="#cb5-26"></a>    </span>
<span id="cb5-27"><a href="#cb5-27"></a>  }</span>
<span id="cb5-28"><a href="#cb5-28"></a>}</span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a>data {</span>
<span id="cb5-31"><a href="#cb5-31"></a>  <span class="dt">int</span>&lt;lower=<span class="dv">0</span>&gt; n; <span class="co">// number of rows of data</span></span>
<span id="cb5-32"><a href="#cb5-32"></a>  vector[n] cost; <span class="co">// attack cost</span></span>
<span id="cb5-33"><a href="#cb5-33"></a>  vector[n] H;    <span class="co">// number of times High Alert is played in a treatment</span></span>
<span id="cb5-34"><a href="#cb5-34"></a>  vector[n] A;    <span class="co">// Number of times Attack is played</span></span>
<span id="cb5-35"><a href="#cb5-35"></a>  vector[n] N;    <span class="co">// total number of actions played</span></span>
<span id="cb5-36"><a href="#cb5-36"></a>  </span>
<span id="cb5-37"><a href="#cb5-37"></a>  vector[<span class="dv">2</span>] prior_lambda; <span class="co">// prior for lambda (lognormal)</span></span>
<span id="cb5-38"><a href="#cb5-38"></a>}</span>
<span id="cb5-39"><a href="#cb5-39"></a></span>
<span id="cb5-40"><a href="#cb5-40"></a>transformed data {</span>
<span id="cb5-41"><a href="#cb5-41"></a>  <span class="co">// The algebra solver needs to have some data to pass to it, so let&#39;s greate some</span></span>
<span id="cb5-42"><a href="#cb5-42"></a>  real x_r[<span class="dv">1</span>] = {<span class="fl">3.14</span>};</span>
<span id="cb5-43"><a href="#cb5-43"></a>  <span class="dt">int</span> x_i[<span class="dv">1</span>]  = {<span class="dv">42</span>};</span>
<span id="cb5-44"><a href="#cb5-44"></a>}</span>
<span id="cb5-45"><a href="#cb5-45"></a></span>
<span id="cb5-46"><a href="#cb5-46"></a>parameters {</span>
<span id="cb5-47"><a href="#cb5-47"></a>  <span class="co">// logit choice precision parameter</span></span>
<span id="cb5-48"><a href="#cb5-48"></a>  real&lt;lower=<span class="dv">0</span>&gt; lambda;</span>
<span id="cb5-49"><a href="#cb5-49"></a>  </span>
<span id="cb5-50"><a href="#cb5-50"></a>}</span>
<span id="cb5-51"><a href="#cb5-51"></a></span>
<span id="cb5-52"><a href="#cb5-52"></a>transformed parameters {</span>
<span id="cb5-53"><a href="#cb5-53"></a>  </span>
<span id="cb5-54"><a href="#cb5-54"></a>  <span class="co">/* sometimes we need to store some intermediate values from our calculations.</span></span>
<span id="cb5-55"><a href="#cb5-55"></a><span class="co">  In particular here, I want to store the model&#39;s predictions to plot later.</span></span>
<span id="cb5-56"><a href="#cb5-56"></a><span class="co">  I also store the log-likelihood, as it is useful for model evaluation ( although</span></span>
<span id="cb5-57"><a href="#cb5-57"></a><span class="co">  I&#39;, not doing one here).</span></span>
<span id="cb5-58"><a href="#cb5-58"></a><span class="co">  */</span></span>
<span id="cb5-59"><a href="#cb5-59"></a>  vector[n] log_like;</span>
<span id="cb5-60"><a href="#cb5-60"></a>  vector[<span class="dv">2</span>] predictions[n];</span>
<span id="cb5-61"><a href="#cb5-61"></a>  <span class="cf">for</span> (tt in <span class="dv">1</span>:n) {</span>
<span id="cb5-62"><a href="#cb5-62"></a>    </span>
<span id="cb5-63"><a href="#cb5-63"></a>    <span class="co">// set up some inputs for the fixed point calculation</span></span>
<span id="cb5-64"><a href="#cb5-64"></a>    vector[<span class="dv">2</span>] lp0 = to_vector({<span class="fl">0.0</span>,<span class="fl">0.0</span>}); <span class="co">// initial guess</span></span>
<span id="cb5-65"><a href="#cb5-65"></a>    vector[<span class="dv">2</span>] pars = to_vector({lambda,cost[tt]}); <span class="co">// parameters to pass to solver</span></span>
<span id="cb5-66"><a href="#cb5-66"></a>    </span>
<span id="cb5-67"><a href="#cb5-67"></a>    <span class="co">// solve QRE </span></span>
<span id="cb5-68"><a href="#cb5-68"></a>    vector[<span class="dv">2</span>] lp = algebra_solver(QREFixedPoint,lp0,pars,x_r,x_i);</span>
<span id="cb5-69"><a href="#cb5-69"></a>    </span>
<span id="cb5-70"><a href="#cb5-70"></a>    <span class="co">// convert logit probabilities to actual probabilities</span></span>
<span id="cb5-71"><a href="#cb5-71"></a>    vector[<span class="dv">2</span>] p = <span class="fl">1.0</span> ./(<span class="dv">1</span>+exp(-lp));</span>
<span id="cb5-72"><a href="#cb5-72"></a>    predictions[tt] = p;</span>
<span id="cb5-73"><a href="#cb5-73"></a>    </span>
<span id="cb5-74"><a href="#cb5-74"></a>    </span>
<span id="cb5-75"><a href="#cb5-75"></a>    <span class="co">// likelihood contribution</span></span>
<span id="cb5-76"><a href="#cb5-76"></a>    log_like[tt]=  H[tt]*log(p[<span class="dv">1</span>])+(N[tt]-H[tt])*log(<span class="fl">1.0</span>-p[<span class="dv">1</span>])</span>
<span id="cb5-77"><a href="#cb5-77"></a>            + A[tt]*log(p[<span class="dv">2</span>])+(N[tt]-A[tt])*log(<span class="fl">1.0</span>-p[<span class="dv">2</span>]);</span>
<span id="cb5-78"><a href="#cb5-78"></a>    </span>
<span id="cb5-79"><a href="#cb5-79"></a>  }</span>
<span id="cb5-80"><a href="#cb5-80"></a>}</span>
<span id="cb5-81"><a href="#cb5-81"></a></span>
<span id="cb5-82"><a href="#cb5-82"></a></span>
<span id="cb5-83"><a href="#cb5-83"></a>model {</span>
<span id="cb5-84"><a href="#cb5-84"></a>  </span>
<span id="cb5-85"><a href="#cb5-85"></a>  <span class="co">// prior</span></span>
<span id="cb5-86"><a href="#cb5-86"></a>  lambda ~ lognormal(prior_lambda[<span class="dv">1</span>],prior_lambda[<span class="dv">2</span>]);</span>
<span id="cb5-87"><a href="#cb5-87"></a>  </span>
<span id="cb5-88"><a href="#cb5-88"></a>  <span class="co">// likelihood contribution</span></span>
<span id="cb5-89"><a href="#cb5-89"></a>  target+=log_like;</span>
<span id="cb5-90"><a href="#cb5-90"></a>  </span>
<span id="cb5-91"><a href="#cb5-91"></a>  </span>
<span id="cb5-92"><a href="#cb5-92"></a>}</span></code></pre></div>
</div>
<p>And then we just need to get our data into the raight shape for <em>Stan</em> to understand it:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://mc-stan.org/rstan'>rstan</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/options.html'>options</a></span><span class='op'>(</span>mc.cores <span class='op'>=</span> <span class='fu'>parallel</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/r/parallel/detectCores.html'>detectCores</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://mc-stan.org/rstan/reference/rstan_options.html'>rstan_options</a></span><span class='op'>(</span>auto_write <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>StanData</span><span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span> </span>
<span>  n    <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>dsummary</span><span class='op'>)</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>,</span>
<span>  cost <span class='op'>=</span> <span class='va'>dsummary</span><span class='op'>$</span><span class='va'>cost</span>,</span>
<span>  A    <span class='op'>=</span> <span class='va'>dsummary</span><span class='op'>$</span><span class='va'>A</span>,</span>
<span>  H    <span class='op'>=</span> <span class='va'>dsummary</span><span class='op'>$</span><span class='va'>H</span>,</span>
<span>  N    <span class='op'>=</span> <span class='va'>dsummary</span><span class='op'>$</span><span class='va'>N</span>, </span>
<span>  prior_lambda <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span></span>
<span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>Fit</span><span class='op'>&lt;-</span><span class='fu'><a href='https://mc-stan.org/rstan/reference/stan.html'>stan</a></span><span class='op'>(</span><span class='st'>"HSS_QREEstimator.stan"</span>,data<span class='op'>=</span><span class='va'>StanData</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>Fit</span><span class='op'>)</span><span class='op'>$</span><span class='va'>summary</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> <span class='fu'>knitr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/knitr/man/kable.html'>kable</a></span><span class='op'>(</span><span class='op'>)</span>  </span></code></pre>
</div>
<table>
<colgroup>
<col style="width: 12%" />
<col style="width: 9%" />
<col style="width: 7%" />
<col style="width: 7%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 9%" />
<col style="width: 8%" />
<col style="width: 7%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">se_mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">2.5%</th>
<th style="text-align: right;">25%</th>
<th style="text-align: right;">50%</th>
<th style="text-align: right;">75%</th>
<th style="text-align: right;">97.5%</th>
<th style="text-align: right;">n_eff</th>
<th style="text-align: right;">Rhat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">lambda</td>
<td style="text-align: right;">1.0670076</td>
<td style="text-align: right;">0.0059422</td>
<td style="text-align: right;">0.2137486</td>
<td style="text-align: right;">0.7220692</td>
<td style="text-align: right;">0.9204513</td>
<td style="text-align: right;">1.0409649</td>
<td style="text-align: right;">1.1853911</td>
<td style="text-align: right;">1.5545090</td>
<td style="text-align: right;">1293.948081</td>
<td style="text-align: right;">1.0014610</td>
</tr>
<tr class="even">
<td style="text-align: left;">log_like[1]</td>
<td style="text-align: right;">-261.6190865</td>
<td style="text-align: right;">0.0099209</td>
<td style="text-align: right;">0.3598706</td>
<td style="text-align: right;">-261.9810071</td>
<td style="text-align: right;">-261.8953710</td>
<td style="text-align: right;">-261.7232159</td>
<td style="text-align: right;">-261.4495853</td>
<td style="text-align: right;">-260.6983400</td>
<td style="text-align: right;">1315.810402</td>
<td style="text-align: right;">1.0015946</td>
</tr>
<tr class="odd">
<td style="text-align: left;">log_like[2]</td>
<td style="text-align: right;">-249.5329850</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">-249.5329850</td>
<td style="text-align: right;">-249.5329850</td>
<td style="text-align: right;">-249.5329850</td>
<td style="text-align: right;">-249.5329850</td>
<td style="text-align: right;">-249.5329850</td>
<td style="text-align: right;">2.003004</td>
<td style="text-align: right;">0.9989995</td>
</tr>
<tr class="even">
<td style="text-align: left;">log_like[3]</td>
<td style="text-align: right;">-195.7950590</td>
<td style="text-align: right;">0.0259065</td>
<td style="text-align: right;">1.0000421</td>
<td style="text-align: right;">-198.6174376</td>
<td style="text-align: right;">-196.0307494</td>
<td style="text-align: right;">-195.4062060</td>
<td style="text-align: right;">-195.1584202</td>
<td style="text-align: right;">-195.0897782</td>
<td style="text-align: right;">1490.107677</td>
<td style="text-align: right;">1.0009788</td>
</tr>
<tr class="odd">
<td style="text-align: left;">predictions[1,1]</td>
<td style="text-align: right;">0.7275373</td>
<td style="text-align: right;">0.0007128</td>
<td style="text-align: right;">0.0258738</td>
<td style="text-align: right;">0.6731964</td>
<td style="text-align: right;">0.7108820</td>
<td style="text-align: right;">0.7285241</td>
<td style="text-align: right;">0.7455747</td>
<td style="text-align: right;">0.7750579</td>
<td style="text-align: right;">1317.572410</td>
<td style="text-align: right;">1.0014121</td>
</tr>
<tr class="even">
<td style="text-align: left;">predictions[1,2]</td>
<td style="text-align: right;">0.6558632</td>
<td style="text-align: right;">0.0002583</td>
<td style="text-align: right;">0.0093302</td>
<td style="text-align: right;">0.6326351</td>
<td style="text-align: right;">0.6511664</td>
<td style="text-align: right;">0.6580500</td>
<td style="text-align: right;">0.6629013</td>
<td style="text-align: right;">0.6666792</td>
<td style="text-align: right;">1304.276919</td>
<td style="text-align: right;">1.0015406</td>
</tr>
<tr class="odd">
<td style="text-align: left;">predictions[2,1]</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">NaN</td>
</tr>
<tr class="even">
<td style="text-align: left;">predictions[2,2]</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">0.5000000</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">NaN</td>
</tr>
<tr class="odd">
<td style="text-align: left;">predictions[3,1]</td>
<td style="text-align: right;">0.2724627</td>
<td style="text-align: right;">0.0007128</td>
<td style="text-align: right;">0.0258738</td>
<td style="text-align: right;">0.2249421</td>
<td style="text-align: right;">0.2544253</td>
<td style="text-align: right;">0.2714759</td>
<td style="text-align: right;">0.2891180</td>
<td style="text-align: right;">0.3268036</td>
<td style="text-align: right;">1317.572410</td>
<td style="text-align: right;">1.0014121</td>
</tr>
<tr class="even">
<td style="text-align: left;">predictions[3,2]</td>
<td style="text-align: right;">0.3441368</td>
<td style="text-align: right;">0.0002583</td>
<td style="text-align: right;">0.0093302</td>
<td style="text-align: right;">0.3333208</td>
<td style="text-align: right;">0.3370987</td>
<td style="text-align: right;">0.3419500</td>
<td style="text-align: right;">0.3488336</td>
<td style="text-align: right;">0.3673649</td>
<td style="text-align: right;">1304.276919</td>
<td style="text-align: right;">1.0015406</td>
</tr>
<tr class="odd">
<td style="text-align: left;">lp__</td>
<td style="text-align: right;">-706.9669551</td>
<td style="text-align: right;">0.0196114</td>
<td style="text-align: right;">0.7864392</td>
<td style="text-align: right;">-709.2127305</td>
<td style="text-align: right;">-707.1427199</td>
<td style="text-align: right;">-706.6617103</td>
<td style="text-align: right;">-706.4689288</td>
<td style="text-align: right;">-706.4151604</td>
<td style="text-align: right;">1608.102455</td>
<td style="text-align: right;">1.0006512</td>
</tr>
</tbody>
</table>
</div>
<p>My mean estimate of <span class="math inline">\(\lambda=1.053\)</span> is near enough (e.g. within much less of a standard deviation) to the paper’s maximum likelihood estimate of <span class="math inline">\(\lambda = 0.9782 \ (0.1618)\)</span>. This should not be too surprising, because with 180 decisions per treatment, the likelihood will be influencing my results <em>much</em> more than the prior.</p>
<h1 id="doing-something-with-the-model">Doing something with the model</h1>
<p>So why do I bother to implement my work using Bayesian techniques when MLE often works just fine? There are few reasons. One is that not relevant here is that a lot of my work involves handling unobservable heterogeneity, which is really easy to implement in Bayes. But another benefit is that once you have draws from the posterior distribution of your parameteres (in this case just <span class="math inline">\(\lambda\)</span>), you can easily simulate the posterior distribution of <em>predictions</em> of the model. For this example, I did this directly in the “transformed parameters” block of my <em>Stan</em> code, which among other things calculates the QRE choice probabilities. What if we wanted to show these predictions in a table, including an expression of uncertainty. In a frequentist MLE framework, we would have to do something like:</p>
<ol type="1">
<li>Carry through our standard errors of our parameters into this nonlinear transformation. This could involve the delta method approximation, which since we are making a nonlinear transformation may require computing a derivative by hand, or</li>
<li>Bootstrap the standard error, which for more complicated QRE models can be computationally intensive.</li>
</ol>
<p>On the other hand, with the posterior simulation in hand, we can just report the mean and standard deviation of our simulated variables, which <em>Stan</em> nicely calculated for us in the summary table above. Note that since the QRE for medium attack cost is always <span class="math inline">\(p=(0.5,0.5)\)</span> for all <span class="math inline">\(\lambda\)</span>, there is no uncertainty about the model’s predictions, even becore we estimate the model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
