<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>15 Time series – Forecasting | Econometrics notes</title>
  <meta name="description" content="15 Time series – Forecasting | Econometrics notes" />
  <meta name="generator" content="bookdown 0.38 and GitBook 2.6.7" />

  <meta property="og:title" content="15 Time series – Forecasting | Econometrics notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="15 Time series – Forecasting | Econometrics notes" />
  
  
  

<meta name="author" content="James R. Bland" />


<meta name="date" content="2025-09-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="time-series-introduction.html"/>
<link rel="next" href="additional-exercises.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction-to-the-course.html"><a href="introduction-to-the-course.html"><i class="fa fa-check"></i><b>1</b> Introduction to the course</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction-to-the-course.html"><a href="introduction-to-the-course.html#housekeeping"><i class="fa fa-check"></i><b>1.1</b> Housekeeping</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-the-course.html"><a href="introduction-to-the-course.html#two-important-skills-in-econometrics"><i class="fa fa-check"></i><b>1.2</b> Two important skills in econometrics</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-the-course.html"><a href="introduction-to-the-course.html#example-incumbency-advantage---lee-moretti-and-butler-2004"><i class="fa fa-check"></i><b>1.3</b> Example: incumbency advantage - Lee, Moretti, and Butler (2004)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html"><i class="fa fa-check"></i><b>2</b> Getting started in <em>R</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#installation"><i class="fa fa-check"></i><b>2.1</b> Installation</a></li>
<li class="chapter" data-level="2.2" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#scripts"><i class="fa fa-check"></i><b>2.2</b> Scripts</a></li>
<li class="chapter" data-level="2.3" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#the-working-directory"><i class="fa fa-check"></i><b>2.3</b> The working directory</a></li>
<li class="chapter" data-level="2.4" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#exercises"><i class="fa fa-check"></i><b>2.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="getting-started-in-r.html"><a href="getting-started-in-r.html#understanding-some-code"><i class="fa fa-check"></i><b>2.4.1</b> Understanding some code</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html"><i class="fa fa-check"></i><b>3</b> Review of some mathmatical concepts</a>
<ul>
<li class="chapter" data-level="3.1" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#summation"><i class="fa fa-check"></i><b>3.1</b> Summation</a></li>
<li class="chapter" data-level="3.2" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#describing-random-variables"><i class="fa fa-check"></i><b>3.2</b> Describing random variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#discrete-random-variables"><i class="fa fa-check"></i><b>3.2.1</b> Discrete random variables</a></li>
<li class="chapter" data-level="3.2.2" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#continuous-random-variables"><i class="fa fa-check"></i><b>3.2.2</b> Continuous random variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#completely-describing-random-variables"><i class="fa fa-check"></i><b>3.3</b> Completely describing random variables</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#cumulative-density-function"><i class="fa fa-check"></i><b>3.3.1</b> Cumulative density function</a></li>
<li class="chapter" data-level="3.3.2" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#probability-mass-function"><i class="fa fa-check"></i><b>3.3.2</b> Probability mass function</a></li>
<li class="chapter" data-level="3.3.3" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#probability-density-function"><i class="fa fa-check"></i><b>3.3.3</b> Probability density function</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#ways-to-summarize-a-distribution"><i class="fa fa-check"></i><b>3.4</b> Ways to summarize a distribution</a></li>
<li class="chapter" data-level="3.5" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#describing-the-relationship-between-two-or-more-random-variables"><i class="fa fa-check"></i><b>3.5</b> Describing the relationship between two or more random variables</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#joint-distribution-functions"><i class="fa fa-check"></i><b>3.5.1</b> Joint distribution functions</a></li>
<li class="chapter" data-level="3.5.2" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#conditional-probability"><i class="fa fa-check"></i><b>3.5.2</b> Conditional probability</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#exercises-1"><i class="fa fa-check"></i><b>3.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#four-sided-die-roll"><i class="fa fa-check"></i><b>3.6.1</b> Four-sided die roll</a></li>
<li class="chapter" data-level="3.6.2" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#exponential-distribution"><i class="fa fa-check"></i><b>3.6.2</b> Exponential distribution</a></li>
<li class="chapter" data-level="3.6.3" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#modeling-a-random-probability"><i class="fa fa-check"></i><b>3.6.3</b> Modeling a random probability</a></li>
<li class="chapter" data-level="3.6.4" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#an-unfair-coin"><i class="fa fa-check"></i><b>3.6.4</b> An unfair coin</a></li>
<li class="chapter" data-level="3.6.5" data-path="review-of-some-mathmatical-concepts.html"><a href="review-of-some-mathmatical-concepts.html#adding-two-random-variables"><i class="fa fa-check"></i><b>3.6.5</b> Adding two random variables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estimators.html"><a href="estimators.html"><i class="fa fa-check"></i><b>4</b> Estimators</a>
<ul>
<li class="chapter" data-level="4.1" data-path="estimators.html"><a href="estimators.html#estimators-and-the-sampling-distribution"><i class="fa fa-check"></i><b>4.1</b> Estimators and the sampling distribution</a></li>
<li class="chapter" data-level="4.2" data-path="estimators.html"><a href="estimators.html#small-sample-properties-of-estimators"><i class="fa fa-check"></i><b>4.2</b> Small sample properties of estimators</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="estimators.html"><a href="estimators.html#bias"><i class="fa fa-check"></i><b>4.2.1</b> Bias</a></li>
<li class="chapter" data-level="4.2.2" data-path="estimators.html"><a href="estimators.html#variance"><i class="fa fa-check"></i><b>4.2.2</b> Variance</a></li>
<li class="chapter" data-level="4.2.3" data-path="estimators.html"><a href="estimators.html#mean-squared-error"><i class="fa fa-check"></i><b>4.2.3</b> Mean squared error</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="estimators.html"><a href="estimators.html#exercises-2"><i class="fa fa-check"></i><b>4.3</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="estimators.html"><a href="estimators.html#modeling-a-random-probability-1"><i class="fa fa-check"></i><b>4.3.1</b> Modeling a random probability</a></li>
<li class="chapter" data-level="4.3.2" data-path="estimators.html"><a href="estimators.html#exponential-distribution-1"><i class="fa fa-check"></i><b>4.3.2</b> Exponential distribution</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="inference.html"><a href="inference.html"><i class="fa fa-check"></i><b>5</b> Inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="inference.html"><a href="inference.html#hypothesis-tests"><i class="fa fa-check"></i><b>5.1</b> Hypothesis tests</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="inference.html"><a href="inference.html#one-sided-hypothesis-tests"><i class="fa fa-check"></i><b>5.1.1</b> One-sided hypothesis tests</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="inference.html"><a href="inference.html#p-values"><i class="fa fa-check"></i><b>5.2</b> <span class="math inline">\(p\)</span>-values</a></li>
<li class="chapter" data-level="5.3" data-path="inference.html"><a href="inference.html#confidence-intervals"><i class="fa fa-check"></i><b>5.3</b> Confidence intervals</a></li>
<li class="chapter" data-level="5.4" data-path="inference.html"><a href="inference.html#test-power"><i class="fa fa-check"></i><b>5.4</b> Test power</a></li>
<li class="chapter" data-level="5.5" data-path="inference.html"><a href="inference.html#the-take-away"><i class="fa fa-check"></i><b>5.5</b> The take-away</a></li>
<li class="chapter" data-level="5.6" data-path="inference.html"><a href="inference.html#exercises-3"><i class="fa fa-check"></i><b>5.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="inference.html"><a href="inference.html#converting-a-continuous-variable-into-a-coin-flip"><i class="fa fa-check"></i><b>5.6.1</b> Converting a continuous variable into a coin flip</a></li>
<li class="chapter" data-level="5.6.2" data-path="inference.html"><a href="inference.html#the-maximum-of-a-sample"><i class="fa fa-check"></i><b>5.6.2</b> The maximum of a sample</a></li>
<li class="chapter" data-level="5.6.3" data-path="inference.html"><a href="inference.html#assessing-the-performance-of-a-cookbook-hypothesis-test"><i class="fa fa-check"></i><b>5.6.3</b> Assessing the performance of a “cookbook” hypothesis test</a></li>
<li class="chapter" data-level="5.6.4" data-path="inference.html"><a href="inference.html#hypothesis-tests-using-graphs"><i class="fa fa-check"></i><b>5.6.4</b> Hypothesis tests using graphs</a></li>
<li class="chapter" data-level="5.6.5" data-path="inference.html"><a href="inference.html#simulation-exercise"><i class="fa fa-check"></i><b>5.6.5</b> Simulation exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html"><i class="fa fa-check"></i><b>6</b> Inference using asymptotic assumptions</a>
<ul>
<li class="chapter" data-level="6.1" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#large-sample-properties-of-estimators"><i class="fa fa-check"></i><b>6.1</b> Large-sample properties of estimators</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#consistency"><i class="fa fa-check"></i><b>6.1.1</b> Consistency</a></li>
<li class="chapter" data-level="6.1.2" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#asymptotic-distribution"><i class="fa fa-check"></i><b>6.1.2</b> Asymptotic distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#large-sample-properties-of-sample-means"><i class="fa fa-check"></i><b>6.2</b> Large-sample properties of sample means</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#the-weak-law-of-large-numbers-wlln"><i class="fa fa-check"></i><b>6.2.1</b> The Weak Law of Large Numbers (WLLN)</a></li>
<li class="chapter" data-level="6.2.2" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#a-central-limit-theorem"><i class="fa fa-check"></i><b>6.2.2</b> A Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#using-large-sample-properties-to-make-inference-easier"><i class="fa fa-check"></i><b>6.3</b> Using large-sample properties to make inference easier</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#hypothesis-tests-with-asymptotic-approximations"><i class="fa fa-check"></i><b>6.3.1</b> Hypothesis tests with asymptotic approximations</a></li>
<li class="chapter" data-level="6.3.2" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#even-more-of-a-shortcut"><i class="fa fa-check"></i><b>6.3.2</b> Even more of a shortcut</a></li>
<li class="chapter" data-level="6.3.3" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#confidence-intervals-with-asymptotic-approximations"><i class="fa fa-check"></i><b>6.3.3</b> Confidence intervals with asymptotic approximations</a></li>
<li class="chapter" data-level="6.3.4" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#p-values-with-asymptotic-approximations"><i class="fa fa-check"></i><b>6.3.4</b> <span class="math inline">\(p\)</span>-values with asymptotic approximations</a></li>
<li class="chapter" data-level="6.3.5" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#tieing-this-in-with-the-previous-chapter"><i class="fa fa-check"></i><b>6.3.5</b> Tieing this in with the previous chapter</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#transforming-variables"><i class="fa fa-check"></i><b>6.4</b> Transforming variables</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#the-continuous-mapping-theorem"><i class="fa fa-check"></i><b>6.4.1</b> The continuous mapping theorem</a></li>
<li class="chapter" data-level="6.4.2" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#the-delta-method"><i class="fa fa-check"></i><b>6.4.2</b> The delta method</a></li>
<li class="chapter" data-level="6.4.3" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#jensens-inequality"><i class="fa fa-check"></i><b>6.4.3</b> Jensen’s inequality</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#exercises-4"><i class="fa fa-check"></i><b>6.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#exponential-distribution-2"><i class="fa fa-check"></i><b>6.5.1</b> Exponential distribution</a></li>
<li class="chapter" data-level="6.5.2" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#a-simulation"><i class="fa fa-check"></i><b>6.5.2</b> A simulation</a></li>
<li class="chapter" data-level="6.5.3" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#modeling-a-random-probability-2"><i class="fa fa-check"></i><b>6.5.3</b> Modeling a random probability</a></li>
<li class="chapter" data-level="6.5.4" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#a-sort-of-simulation-exercise"><i class="fa fa-check"></i><b>6.5.4</b> A (sort-of) simulation exercise</a></li>
<li class="chapter" data-level="6.5.5" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#one-test-three-ways"><i class="fa fa-check"></i><b>6.5.5</b> One test, three ways</a></li>
<li class="chapter" data-level="6.5.6" data-path="inference-using-asymptotic-assumptions.html"><a href="inference-using-asymptotic-assumptions.html#deriving-properties-of-estimators"><i class="fa fa-check"></i><b>6.5.6</b> Deriving properties of estimators</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>7</b> Linear regression</a>
<ul>
<li class="chapter" data-level="7.1" data-path="linear-regression.html"><a href="linear-regression.html#derivation-of-the-bivariate-ols-slope-estimator"><i class="fa fa-check"></i><b>7.1</b> Derivation of the bivariate OLS slope estimator</a></li>
<li class="chapter" data-level="7.2" data-path="linear-regression.html"><a href="linear-regression.html#unbiasedness"><i class="fa fa-check"></i><b>7.2</b> Unbiasedness</a></li>
<li class="chapter" data-level="7.3" data-path="linear-regression.html"><a href="linear-regression.html#variance-1"><i class="fa fa-check"></i><b>7.3</b> Variance</a></li>
<li class="chapter" data-level="7.4" data-path="linear-regression.html"><a href="linear-regression.html#inference-in-bivariate-ols"><i class="fa fa-check"></i><b>7.4</b> Inference in bivariate OLS</a></li>
<li class="chapter" data-level="7.5" data-path="linear-regression.html"><a href="linear-regression.html#exercises-5"><i class="fa fa-check"></i><b>7.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="linear-regression.html"><a href="linear-regression.html#municipal-expenditure"><i class="fa fa-check"></i><b>7.5.1</b> Municipal expenditure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html"><i class="fa fa-check"></i><b>8</b> The shape of the right-hand side</a>
<ul>
<li class="chapter" data-level="8.1" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#linear-regression-as-a-model-for-conditional-expectation"><i class="fa fa-check"></i><b>8.1</b> Linear regression as a model for conditional expectation</a></li>
<li class="chapter" data-level="8.2" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#an-example-dataset"><i class="fa fa-check"></i><b>8.2</b> An example dataset</a></li>
<li class="chapter" data-level="8.3" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#marginal-effects"><i class="fa fa-check"></i><b>8.3</b> Marginal effects</a></li>
<li class="chapter" data-level="8.4" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#categorical-variables"><i class="fa fa-check"></i><b>8.4</b> Categorical variables</a></li>
<li class="chapter" data-level="8.5" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#interactions"><i class="fa fa-check"></i><b>8.5</b> Interactions</a></li>
<li class="chapter" data-level="8.6" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#logarithms"><i class="fa fa-check"></i><b>8.6</b> Logarithms</a></li>
<li class="chapter" data-level="8.7" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#polynomials"><i class="fa fa-check"></i><b>8.7</b> Polynomials</a></li>
<li class="chapter" data-level="8.8" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#exercises-6"><i class="fa fa-check"></i><b>8.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#baking-a-cake"><i class="fa fa-check"></i><b>8.8.1</b> Baking a cake</a></li>
<li class="chapter" data-level="8.8.2" data-path="the-shape-of-the-right-hand-side.html"><a href="the-shape-of-the-right-hand-side.html#psid-earnings-panel-data"><i class="fa fa-check"></i><b>8.8.2</b> PSID Earnings Panel Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="linear-regression---common-misconceptions.html"><a href="linear-regression---common-misconceptions.html"><i class="fa fa-check"></i><b>9</b> Linear regression - common misconceptions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="linear-regression---common-misconceptions.html"><a href="linear-regression---common-misconceptions.html#heteroskedasticity"><i class="fa fa-check"></i><b>9.1</b> Heteroskedasticity</a></li>
<li class="chapter" data-level="9.2" data-path="linear-regression---common-misconceptions.html"><a href="linear-regression---common-misconceptions.html#multicolinearity"><i class="fa fa-check"></i><b>9.2</b> Multicolinearity</a></li>
<li class="chapter" data-level="9.3" data-path="linear-regression---common-misconceptions.html"><a href="linear-regression---common-misconceptions.html#omitted-variables-are-always-a-problem"><i class="fa fa-check"></i><b>9.3</b> Omitted variables are <em>always</em> a problem</a></li>
<li class="chapter" data-level="9.4" data-path="linear-regression---common-misconceptions.html"><a href="linear-regression---common-misconceptions.html#normal-errors"><i class="fa fa-check"></i><b>9.4</b> Normal errors</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html"><i class="fa fa-check"></i><b>10</b> Standard errors in linear regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#homoskedasticity-the-standard-standard-errors"><i class="fa fa-check"></i><b>10.1</b> Homoskedasticity: the “standard” standard errors</a></li>
<li class="chapter" data-level="10.2" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#heteroskedasticity-1"><i class="fa fa-check"></i><b>10.2</b> Heteroskedasticity</a></li>
<li class="chapter" data-level="10.3" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#clustered-standard-errors"><i class="fa fa-check"></i><b>10.3</b> Clustered standard errors</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#an-example"><i class="fa fa-check"></i><b>10.3.1</b> An example</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#standard-errors-for-multivariate-linear-regression"><i class="fa fa-check"></i><b>10.4</b> Standard errors for multivariate linear regression</a></li>
<li class="chapter" data-level="10.5" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#calculating-standard-errors-in-r"><i class="fa fa-check"></i><b>10.5</b> Calculating standard errors in <em>R</em></a></li>
<li class="chapter" data-level="10.6" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#exercises-7"><i class="fa fa-check"></i><b>10.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#galtons-families"><i class="fa fa-check"></i><b>10.6.1</b> Galton’s families</a></li>
<li class="chapter" data-level="10.6.2" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#simulation"><i class="fa fa-check"></i><b>10.6.2</b> Simulation</a></li>
<li class="chapter" data-level="10.6.3" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#more-simulation"><i class="fa fa-check"></i><b>10.6.3</b> More simulation</a></li>
<li class="chapter" data-level="10.6.4" data-path="standard-errors-in-linear-regression.html"><a href="standard-errors-in-linear-regression.html#instructor-ratings"><i class="fa fa-check"></i><b>10.6.4</b> Instructor ratings</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html"><i class="fa fa-check"></i><b>11</b> Hypothesis tests about more than one parameter</a>
<ul>
<li class="chapter" data-level="11.1" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#the-restricted-model"><i class="fa fa-check"></i><b>11.1</b> The restricted model</a></li>
<li class="chapter" data-level="11.2" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#a-test-using-r2-that-you-probably-shouldnt-use"><i class="fa fa-check"></i><b>11.2</b> A test using <span class="math inline">\(R^2\)</span> that you probably shouldn’t use</a></li>
<li class="chapter" data-level="11.3" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#a-more-robust-test"><i class="fa fa-check"></i><b>11.3</b> A more robust test</a></li>
<li class="chapter" data-level="11.4" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#another-example"><i class="fa fa-check"></i><b>11.4</b> Another example</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#the-height-of-a-child-does-not-depend-on-whether-the-child-is-male-of-female"><i class="fa fa-check"></i><b>11.4.1</b> The height of a child does not depend on whether the child is male of female</a></li>
<li class="chapter" data-level="11.4.2" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#the-height-of-a-child-does-not-depend-on-the-height-of-their-parents"><i class="fa fa-check"></i><b>11.4.2</b> The height of a child does not depend on the height of their parents</a></li>
<li class="chapter" data-level="11.4.3" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#the-effect-of-mother-height-on-child-height-is-the-same-as-the-effect-of-father-height-on-child-height"><i class="fa fa-check"></i><b>11.4.3</b> The effect of mother height on child height is the same as the effect of father height on child height</a></li>
<li class="chapter" data-level="11.4.4" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#the-effect-of-parent-height-on-male-childrens-height-is-the-same-as-the-effect-of-parent-height-on-female-childrens-height"><i class="fa fa-check"></i><b>11.4.4</b> The effect of parent height on male children’s height is the same as the effect of parent height on female children’s height</a></li>
<li class="chapter" data-level="11.4.5" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#the-effect-of-parent-height-on-child-height-is-linear"><i class="fa fa-check"></i><b>11.4.5</b> The effect of parent height on child height is linear</a></li>
<li class="chapter" data-level="11.4.6" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#parents-who-are-on-average-one-inch-taller-have-children-that-are-on-average-one-inch-taller"><i class="fa fa-check"></i><b>11.4.6</b> Parents who are on average one inch taller have children that are on average one inch taller</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#exercises-8"><i class="fa fa-check"></i><b>11.5</b> Exercises</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="hypothesis-tests-about-more-than-one-parameter.html"><a href="hypothesis-tests-about-more-than-one-parameter.html#project-star-student-teacher-achievement-ratio"><i class="fa fa-check"></i><b>11.5.1</b> Project STAR: Student-Teacher Achievement Ratio</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><i class="fa fa-check"></i><b>12</b> Limited dependent variable models and maximum likelihood estimation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#motivation-the-linear-probability-model-works-134-of-the-time"><i class="fa fa-check"></i><b>12.1</b> Motivation: The linear probability model works 134% of the time</a></li>
<li class="chapter" data-level="12.2" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#a-practical-solution-ensure-that-predictions-are-always-valid"><i class="fa fa-check"></i><b>12.2</b> A practical solution: Ensure that predictions are always valid</a></li>
<li class="chapter" data-level="12.3" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#interpreting-the-coefficients-of-the-probit-and-logit-models"><i class="fa fa-check"></i><b>12.3</b> Interpreting the coefficients of the probit and logit models</a></li>
<li class="chapter" data-level="12.4" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#but-how-do-we-estimate-it-maximum-likelihood"><i class="fa fa-check"></i><b>12.4</b> But how do we estimate it? Maximum likelihood</a></li>
<li class="chapter" data-level="12.5" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#doing-inference-with-maximum-likelihood"><i class="fa fa-check"></i><b>12.5</b> Doing inference with maximum likelihood</a></li>
<li class="chapter" data-level="12.6" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#how-some-estimators-relate-to-maximum-likelihood"><i class="fa fa-check"></i><b>12.6</b> How some estimators relate to maximum likelihood</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#sample-mean-for-a-bernoulli-coin-flip-variable"><i class="fa fa-check"></i><b>12.6.1</b> Sample mean for a Bernoulli (coin flip) variable</a></li>
<li class="chapter" data-level="12.6.2" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#linear-regression-1"><i class="fa fa-check"></i><b>12.6.2</b> Linear regression</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#some-examples-of-estimating-parameters-using-maximum-likelihood"><i class="fa fa-check"></i><b>12.7</b> Some examples of estimating parameters using maximum likelihood</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#geometric-distribution"><i class="fa fa-check"></i><b>12.7.1</b> Geometric distribution</a></li>
<li class="chapter" data-level="12.7.2" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#simplified-beta-distribution"><i class="fa fa-check"></i><b>12.7.2</b> Simplified Beta distribution</a></li>
</ul></li>
<li class="chapter" data-level="12.8" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#an-extended-example"><i class="fa fa-check"></i><b>12.8</b> An extended example</a>
<ul>
<li class="chapter" data-level="12.8.1" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#data"><i class="fa fa-check"></i><b>12.8.1</b> Data</a></li>
<li class="chapter" data-level="12.8.2" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#a-research-question"><i class="fa fa-check"></i><b>12.8.2</b> A research question</a></li>
<li class="chapter" data-level="12.8.3" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#the-model-based-approach"><i class="fa fa-check"></i><b>12.8.3</b> The model-based approach</a></li>
</ul></li>
<li class="chapter" data-level="12.9" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#exercises-9"><i class="fa fa-check"></i><b>12.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="12.9.1" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#checking-that-we-rolled-a-die-correctly"><i class="fa fa-check"></i><b>12.9.1</b> Checking that we rolled a die correctly</a></li>
<li class="chapter" data-level="12.9.2" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#galtons-heights-dataset"><i class="fa fa-check"></i><b>12.9.2</b> Galton’s heights dataset</a></li>
<li class="chapter" data-level="12.9.3" data-path="limited-dependent-variable-models-and-maximum-likelihood-estimation.html"><a href="limited-dependent-variable-models-and-maximum-likelihood-estimation.html#sumo-wrestling"><i class="fa fa-check"></i><b>12.9.3</b> Sumo wrestling</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="combining-and-manipulating-datasets.html"><a href="combining-and-manipulating-datasets.html"><i class="fa fa-check"></i><b>13</b> Combining and manipulating datasets</a>
<ul>
<li class="chapter" data-level="13.1" data-path="combining-and-manipulating-datasets.html"><a href="combining-and-manipulating-datasets.html#merging-data-join"><i class="fa fa-check"></i><b>13.1</b> Merging data (<code>join</code>)</a></li>
<li class="chapter" data-level="13.2" data-path="combining-and-manipulating-datasets.html"><a href="combining-and-manipulating-datasets.html#wide-and-long-formats-pivot_longer-and-pivot_wider"><i class="fa fa-check"></i><b>13.2</b> Wide and long formats (<code>pivot_longer</code> and <code>pivot_wider</code>)</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="time-series-introduction.html"><a href="time-series-introduction.html"><i class="fa fa-check"></i><b>14</b> Time series – Introduction</a>
<ul>
<li class="chapter" data-level="14.1" data-path="time-series-introduction.html"><a href="time-series-introduction.html#autoregressive-and-moving-average-arma-models-the-basic-building-blocks-of-time-series-models"><i class="fa fa-check"></i><b>14.1</b> Autoregressive and moving average (ARMA) models: the basic building blocks of time series models</a></li>
<li class="chapter" data-level="14.2" data-path="time-series-introduction.html"><a href="time-series-introduction.html#stationarity-and-properties-of-arma-processes"><i class="fa fa-check"></i><b>14.2</b> Stationarity and properties of ARMA processes</a>
<ul>
<li class="chapter" data-level="14.2.1" data-path="time-series-introduction.html"><a href="time-series-introduction.html#examples"><i class="fa fa-check"></i><b>14.2.1</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="time-series-introduction.html"><a href="time-series-introduction.html#diagnostics-autocorrelation-and-partial-autocorrelation-functions"><i class="fa fa-check"></i><b>14.3</b> Diagnostics: Autocorrelation and partial autocorrelation functions</a></li>
<li class="chapter" data-level="14.4" data-path="time-series-introduction.html"><a href="time-series-introduction.html#example-dataset-unemployment"><i class="fa fa-check"></i><b>14.4</b> Example dataset – unemployment</a></li>
<li class="chapter" data-level="14.5" data-path="time-series-introduction.html"><a href="time-series-introduction.html#stationarity-and-testing-for-unit-roots"><i class="fa fa-check"></i><b>14.5</b> Stationarity and testing for unit roots</a></li>
<li class="chapter" data-level="14.6" data-path="time-series-introduction.html"><a href="time-series-introduction.html#non-stationarity-and-spurious-correlation"><i class="fa fa-check"></i><b>14.6</b> Non-stationarity and spurious correlation</a>
<ul>
<li class="chapter" data-level="14.6.1" data-path="time-series-introduction.html"><a href="time-series-introduction.html#two-variables-share-a-trend"><i class="fa fa-check"></i><b>14.6.1</b> Two variables share a trend</a></li>
<li class="chapter" data-level="14.6.2" data-path="time-series-introduction.html"><a href="time-series-introduction.html#two-variables-are-cyclical"><i class="fa fa-check"></i><b>14.6.2</b> Two variables are cyclical</a></li>
<li class="chapter" data-level="14.6.3" data-path="time-series-introduction.html"><a href="time-series-introduction.html#two-variables-have-a-unit-root"><i class="fa fa-check"></i><b>14.6.3</b> Two variables have a unit root</a></li>
</ul></li>
<li class="chapter" data-level="14.7" data-path="time-series-introduction.html"><a href="time-series-introduction.html#differencing-and-stationarity"><i class="fa fa-check"></i><b>14.7</b> Differencing and stationarity</a>
<ul>
<li class="chapter" data-level="14.7.1" data-path="time-series-introduction.html"><a href="time-series-introduction.html#some-examples-of-making-non-stationary-series-stationary-through-differencing"><i class="fa fa-check"></i><b>14.7.1</b> Some examples of making non-stationary series stationary through differencing</a></li>
<li class="chapter" data-level="14.7.2" data-path="time-series-introduction.html"><a href="time-series-introduction.html#example-dataset-us-consumer-price-index"><i class="fa fa-check"></i><b>14.7.2</b> Example dataset: US Consumer Price Index</a></li>
<li class="chapter" data-level="14.7.3" data-path="time-series-introduction.html"><a href="time-series-introduction.html#example-data-gdp-and-money-supply"><i class="fa fa-check"></i><b>14.7.3</b> Example data: GDP and money supply</a></li>
<li class="chapter" data-level="14.7.4" data-path="time-series-introduction.html"><a href="time-series-introduction.html#example-peace-corps"><i class="fa fa-check"></i><b>14.7.4</b> Example: Peace Corps</a></li>
</ul></li>
<li class="chapter" data-level="14.8" data-path="time-series-introduction.html"><a href="time-series-introduction.html#estimating-arima-models"><i class="fa fa-check"></i><b>14.8</b> Estimating ARIMA models</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html"><i class="fa fa-check"></i><b>15</b> Time series – Forecasting</a>
<ul>
<li class="chapter" data-level="15.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#prediction-and-forecasting"><i class="fa fa-check"></i><b>15.1</b> Prediction and forecasting</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#example-prediction-with-univariate-problems"><i class="fa fa-check"></i><b>15.1.1</b> Example: Prediction with univariate problems</a></li>
<li class="chapter" data-level="15.1.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#example-prediction-in-bivariate-ols"><i class="fa fa-check"></i><b>15.1.2</b> Example: Prediction in bivariate OLS</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#cross-validation"><i class="fa fa-check"></i><b>15.2</b> Cross-validation</a></li>
<li class="chapter" data-level="15.3" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#example-cpi-and-ppi"><i class="fa fa-check"></i><b>15.3</b> Example: CPI and PPI</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#using-just-ar-and-ma-components"><i class="fa fa-check"></i><b>15.3.1</b> Using just AR and MA components</a></li>
<li class="chapter" data-level="15.3.2" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#incorporating-some-seasonality"><i class="fa fa-check"></i><b>15.3.2</b> Incorporating some seasonality</a></li>
<li class="chapter" data-level="15.3.3" data-path="time-series-forecasting.html"><a href="time-series-forecasting.html#incorporating-ppi-inflation"><i class="fa fa-check"></i><b>15.3.3</b> Incorporating PPI inflation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="additional-exercises.html"><a href="additional-exercises.html"><i class="fa fa-check"></i><b>16</b> Additional exercises</a>
<ul>
<li class="chapter" data-level="16.1" data-path="additional-exercises.html"><a href="additional-exercises.html#for-loops"><i class="fa fa-check"></i><b>16.1</b> For loops</a>
<ul>
<li class="chapter" data-level="16.1.1" data-path="additional-exercises.html"><a href="additional-exercises.html#determinants-of-wage-data-cps-1988"><i class="fa fa-check"></i><b>16.1.1</b> Determinants of wage data (CPS 1988)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="past-exam-questions.html"><a href="past-exam-questions.html"><i class="fa fa-check"></i><b>17</b> Past exam questions</a>
<ul>
<li class="chapter" data-level="17.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#fall-2022-5810-exam-1"><i class="fa fa-check"></i><b>17.1</b> Fall 2022 5810, Exam 1</a>
<ul>
<li class="chapter" data-level="17.1.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#probability"><i class="fa fa-check"></i><b>17.1.1</b> Probability</a></li>
<li class="chapter" data-level="17.1.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#inference-1"><i class="fa fa-check"></i><b>17.1.2</b> Inference</a></li>
<li class="chapter" data-level="17.1.3" data-path="past-exam-questions.html"><a href="past-exam-questions.html#estimators-and-large-sample-properties"><i class="fa fa-check"></i><b>17.1.3</b> Estimators and large-sample properties</a></li>
</ul></li>
<li class="chapter" data-level="17.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#fall-2023-5810-exam-1"><i class="fa fa-check"></i><b>17.2</b> Fall 2023 5810 Exam 1</a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#probability-1"><i class="fa fa-check"></i><b>17.2.1</b> Probability</a></li>
<li class="chapter" data-level="17.2.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#estimation-and-inference"><i class="fa fa-check"></i><b>17.2.2</b> Estimation and inference</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="past-exam-questions.html"><a href="past-exam-questions.html#fall-2024-exam-1"><i class="fa fa-check"></i><b>17.3</b> 5810 Fall 2024 Exam 1</a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#parabolic-distribution"><i class="fa fa-check"></i><b>17.3.1</b> Parabolic distribution</a></li>
<li class="chapter" data-level="17.3.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#inference-2"><i class="fa fa-check"></i><b>17.3.2</b> Inference</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="past-exam-questions.html"><a href="past-exam-questions.html#exam-2-2022"><i class="fa fa-check"></i><b>17.4</b> 5810 Exam 2 (2022)</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#directed-acyclic-graphs"><i class="fa fa-check"></i><b>17.4.1</b> Directed Acyclic Graphs</a></li>
<li class="chapter" data-level="17.4.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#linear-regression-2"><i class="fa fa-check"></i><b>17.4.2</b> Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="past-exam-questions.html"><a href="past-exam-questions.html#fall-2023-exam-2"><i class="fa fa-check"></i><b>17.5</b> 5810 Fall 2023 Exam 2</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#directed-acyclic-graphs-1"><i class="fa fa-check"></i><b>17.5.1</b> Directed Acyclic Graphs</a></li>
<li class="chapter" data-level="17.5.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#linear-regression-3"><i class="fa fa-check"></i><b>17.5.2</b> Linear regression</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="past-exam-questions.html"><a href="past-exam-questions.html#fall-2024-exam-2"><i class="fa fa-check"></i><b>17.6</b> 5810 Fall 2024 Exam 2</a>
<ul>
<li class="chapter" data-level="17.6.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#directed-acyclic-graphs-and-linear-regression"><i class="fa fa-check"></i><b>17.6.1</b> Directed Acyclic Graphs and linear regression</a></li>
<li class="chapter" data-level="17.6.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#maximum-likelihood-5810-and-siss-students-only"><i class="fa fa-check"></i><b>17.6.2</b> Maximum likelihood (5810 and SISS students only)</a></li>
</ul></li>
<li class="chapter" data-level="17.7" data-path="past-exam-questions.html"><a href="past-exam-questions.html#exam-1-2023"><i class="fa fa-check"></i><b>17.7</b> 5820, Exam 1 (2023)</a>
<ul>
<li class="chapter" data-level="17.7.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#maximum-likelihood"><i class="fa fa-check"></i><b>17.7.1</b> Maximum likelihood</a></li>
<li class="chapter" data-level="17.7.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#fire-trucks"><i class="fa fa-check"></i><b>17.7.2</b> Fire trucks</a></li>
</ul></li>
<li class="chapter" data-level="17.8" data-path="past-exam-questions.html"><a href="past-exam-questions.html#spring-2024-exam-1"><i class="fa fa-check"></i><b>17.8</b> 5820 Spring 2024 Exam 1</a>
<ul>
<li class="chapter" data-level="17.8.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#hypothesis-tests-1"><i class="fa fa-check"></i><b>17.8.1</b> Hypothesis tests</a></li>
<li class="chapter" data-level="17.8.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#causal-inference"><i class="fa fa-check"></i><b>17.8.2</b> Causal inference</a></li>
</ul></li>
<li class="chapter" data-level="17.9" data-path="past-exam-questions.html"><a href="past-exam-questions.html#spring-2024-exam-2"><i class="fa fa-check"></i><b>17.9</b> 5820 Spring 2024 Exam 2</a>
<ul>
<li class="chapter" data-level="17.9.1" data-path="past-exam-questions.html"><a href="past-exam-questions.html#properties-of-time-series"><i class="fa fa-check"></i><b>17.9.1</b> Properties of time series</a></li>
<li class="chapter" data-level="17.9.2" data-path="past-exam-questions.html"><a href="past-exam-questions.html#forecasting-a-time-series"><i class="fa fa-check"></i><b>17.9.2</b> Forecasting a time series</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Econometrics notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="time-series-forecasting" class="section level1 hasAnchor" number="15">
<h1><span class="header-section-number">15</span> Time series – Forecasting<a href="time-series-forecasting.html#time-series-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="prediction-and-forecasting" class="section level2 hasAnchor" number="15.1">
<h2><span class="header-section-number">15.1</span> Prediction and forecasting<a href="time-series-forecasting.html#prediction-and-forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For most of this course, we have focused on <em>estimating</em> things: sample means, probabilities, causal effects, and so on. However once we get into modeling times series data, we might also be interested in <em>prediction</em>: or models tell us, given some information about things now, what is going to happen tomorrow, or next week, or in a year? Note that this language is <em>way</em> different from how we think about causal inference. When we seek the <em>right</em> (i.e. causal) marginal effect, we want to ask questions like “if I change <span class="math inline">\(X\)</span>, what will this do to <span class="math inline">\(Y\)</span>?”, but with prediction, we might not actually care about the causal mechanism, we just want the number. Fortunately for us, most of our knowledge of OLS and the like follows through with <em>point</em> predictions. However we need to treat randomness slightly differently.</p>
<div id="example-prediction-with-univariate-problems" class="section level3 hasAnchor" number="15.1.1">
<h3><span class="header-section-number">15.1.1</span> Example: Prediction with univariate problems<a href="time-series-forecasting.html#example-prediction-with-univariate-problems" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Suppose that we have a dataset of <span class="math inline">\(N\)</span> iid observations of <span class="math inline">\(Y_i\)</span>: <span class="math inline">\(\{Y_i\}_{i=1}^N\)</span>. We are going to come across another <span class="math inline">\(Y\)</span> in the future, call it <span class="math inline">\(Y_{N+1}\)</span>, and we’d like to have some kind of idea what it will be. You might be tempted, and you’d also be on the right track, to take the sample mean of the <span class="math inline">\(N\)</span> <span class="math inline">\(Y\)</span>s that we already have, and use this as our {} of <span class="math inline">\(Y_{N+1}\)</span>:
<span class="math display">\[\begin{align}
\hat Y_{N+1}=\frac 1N\sum_{i=1}^NY_i=\bar Y
\end{align}\]</span>
This is a great place to start! In fact, if you were going to be making a decision based on a point prediction, and your payoff of this decision was decreasing in the mean squared error of your prediction, i.e. <span class="math inline">\(E[(\hat Y_{N+1}-Y_{N+1})^2]\)</span>, then this would be {} good.</p>
<p>But being a good econometrician, you also want to eYpress some level of uncertainty in your prediction. Again, you might be tempted to report something like the confidence interval:
<span class="math display">\[\begin{align}
\hat Y_{N+1}&amp;\pm 1.96 \sqrt{\frac{1}{N}s^2},\quad s^2=\frac 1N\sum_{i=1}^N(Y_i-\bar Y)^2
\end{align}\]</span>
which would be nice if it was correct, but you’d be vastly overstating how much you know about <span class="math inline">\(Y_{N+1}\)</span>. The problem is that this thing is an expression of our uncertainty about the population {}, not an expression of our uncertainty about <span class="math inline">\(Y_{N+1}\)</span>. If it helps, note that as <span class="math inline">\(N\)</span> gets large, this confidence interval collapses about the point prediction, which would be absolutely awesome: just collect a lot of data, and we’ll be able to predict everything perfectly! The trouble is we really want to account for the randomness associated with getting a new draw of <span class="math inline">\(Y\)</span>. This is a draw from the population distribution of <span class="math inline">\(Y\)</span>, {} a draw from the sampling distribution of <span class="math inline">\(\bar Y\)</span>.</p>
<p>One fairly reasonable thing to do would therefore be to use the 2.5th and 97.5th percentiles of or sample for the prediction interval. As <span class="math inline">\(N\to\infty\)</span>, these plim to the 2.5th and 97.5th percentiles of the population distribution, and so we are literally (and consistently) estimating two points for which <span class="math inline">\(Y\)</span> has a 95% chance of falling between. Alternatively, we could get a bit more fancy and calculate the <em>smallest</em> interval that covers 95% of our data., however if the distribution is symmetric and single-peaked, we will be calculating the same thing.</p>
<p>Another popular way of doing this is to assume that the data come from a Normal distribution (think about whether this is a good assumption for your own application, it probably won’t be). If this is the case, we can use the sample mean <span class="math inline">\(\bar Y\)</span> and variance <span class="math inline">\(s^2\)</span> to claim that:
<span class="math display">\[\begin{align}
Y_{N+1}\sim N(\mu,\sigma^2)\implies Y_{N+1}\stackrel{\text{approx}}{\sim}N\left(\bar Y, s^2\right)
\end{align}\]</span>
Note that there are three sources of randomness here:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(Y_{N+1}\)</span> is (assumed to be) normally distributed with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span></li>
<li>We don’t know <span class="math inline">\(\mu\)</span>, but we have <span class="math inline">\(\bar Y\)</span>, an estimate of it, which if <span class="math inline">\(N\)</span> is large enough will be approximately <span class="math inline">\(N(\mu,\sigma^2/N)\)</span></li>
<li>We don’t know <span class="math inline">\(\sigma^2\)</span>, but we have <span class="math inline">\(s^2\)</span>, an estimate of it. It can be shown that <span class="math inline">\((N-1)s^2/\sigma^2\xrightarrow[]{d}\chi^2_{N-1}\)</span>. Let’s assume that this process is negligible (basically you get <span class="math inline">\(t\)</span> critical values rather than normal ones)</li>
</ol>
<p>So we have:
<span class="math display">\[\begin{align}
\frac{Y_{N+1}-\bar Y}{\sqrt{s^2}}&amp;=\frac{(Y_{N+1}-\mu)-(\bar Y-\mu)}{\sqrt{s^2}}\\
&amp;\xrightarrow[]{d}\frac{(Y_{N+1}-\mu)-(\bar Y-\mu)}{\sqrt{\sigma^2}}\\
&amp;\stackrel{\text{approx}}{\sim}N(0,1)-N(0,1/N)\\
&amp;=N\left(0,1+1/N\right)\\
\implies 0.95&amp;\approx \Pr\left[\left|Y_{N+1}-\bar Y\right| \leq 1.96\sqrt{s^2(1+1/N)}\right]
\end{align}\]</span>
Note with the above expression, as <span class="math inline">\(N\to\infty\)</span> the <span class="math inline">\(1/N\)</span> term goes to zero, which reflects us knowing the population mean for sure.</p>
</div>
<div id="example-prediction-in-bivariate-ols" class="section level3 hasAnchor" number="15.1.2">
<h3><span class="header-section-number">15.1.2</span> Example: Prediction in bivariate OLS<a href="time-series-forecasting.html#example-prediction-in-bivariate-ols" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>OK, but what if we have some <span class="math inline">\(X\)</span>s as well? To begin with, our point prediction can remain the same, we simply condition on <span class="math inline">\(X\)</span> because for bivariate OLS (hopefully the multivariate case is obvious):
<span class="math display">\[\begin{align}
\hat{Y_{N+1}}\mid X_{N+1}&amp;=\widehat{E[Y_{N+1}\mid X_{N+1}]}=\hat\beta_0+\hat\beta_1X_{N+1}
\end{align}\]</span>
Again, our prediction interval needs to take into account that we are uncertain about the parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, {} that we are getting a new draw of <span class="math inline">\(Y\)</span>. In the context of OLS, we are drawing a new error term.</p>
<p>Note that:
<span class="math display">\[\begin{align}
\hat Y_{N+1}-Y_{N+1}&amp;=\hat\beta_0+\hat\beta_1X_{N+1}-\beta_0-\beta_1 X_{N+1}-\epsilon_{N+1}\\
&amp;=\underbrace{(\hat\beta_0-\beta_0)+(\hat\beta_1-\beta_1)X_{N+1}}_\text{$B=$error with mean prediction}-\epsilon_{N+1}\\
%%%%
&amp;=\underbrace{(\hat\alpha_0-\alpha_0)+(\hat\beta_1-\beta_1)(X_{N+1}-\bar X)}_\text{$B=$error with mean prediction}-\epsilon_{N+1}
\end{align}\]</span>
where we make the substitution <span class="math inline">\(\alpha_0=\beta_0+\bar X \beta_1\)</span>.
Note that <span class="math inline">\(B\)</span> and <span class="math inline">\(\epsilon_{N+1}\)</span> are (assumed to be) independent, we can analyze them separately. <span class="math inline">\(B\)</span> is the component of the prediction error associated with us not knowing the conditional mean. We can calculate its variance in the same way we’d calculate the variance of a linear combination of the parameters. Noting that the population <span class="math inline">\(\beta\)</span>s are constants, the estimators are unbiased, and the following results:</p>
<p><span class="math display">\[\begin{align}
\hat\alpha_0-\alpha_0&amp;\sim N(0,\sigma^2/N)\\
\hat\beta_1-\beta_1&amp;\sim N\left(0,\frac{\sigma^2}{\sum_i(X_i-\bar X)^2}\right)
\end{align}\]</span>
and all of these are independent, so:
<span class="math display">\[\begin{align}
V[\hat Y_{N+1}]&amp;=V\left[\hat\alpha_0+\hat\beta_1(X_{N+1}-\bar X)-\epsilon_{N+1}\right]\\
%%%
&amp;=V[\hat\alpha_0]+V[\hat\beta_1](X_{N+1}-\bar X)^2+V[\epsilon_{N+1}]\\
&amp;=\frac{\sigma^2}{N}+\frac{\sigma^2}{\sum_i(X_i-\bar X)}(X_{N+1}-\bar X)^2+\sigma^2\\
&amp;=\sigma^2\left[\frac{1}{N}+\frac{(X_{N+1}-\bar X)^2}{\sum_i(X_i-\bar X)}+1\right]
\end{align}\]</span>
which is almost like our expression for the unconditional prediction variance in the previous example. The middle term is the extra bit, which states that our prediction becomes less accurate the further away from the mean of <span class="math inline">\(X\)</span> that we want to make predictions. Note, however, that this terms would also appear in our confidence interval for the population mean conditional on <span class="math inline">\(X\)</span>. The first two terms will go to zero as <span class="math inline">\(N\to\infty\)</span>, and we are just left with <span class="math inline">\(V[\hat Y_{N+1}]\approx \sigma^2\)</span> for large <span class="math inline">\(N\)</span>.</p>
</div>
</div>
<div id="cross-validation" class="section level2 hasAnchor" number="15.2">
<h2><span class="header-section-number">15.2</span> Cross-validation<a href="time-series-forecasting.html#cross-validation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous chapter, we used the AIC as a way of selecting a model that would hopefully make good forecasts. While this method is computationally easy (<em>R</em> will calculate it by default when estimating an ARIMA model), it may not be appropriate for our needs. In particular, since AIC assesses our models’ performance on data that have been used to estimate the model, model selection using AIC is not mimicking the process we will eventually be using to make our forecast. Instead, this chapter will teach you about <em>cross-validation</em>, which will hopefully be a much more satisfactory approach for selecting a model for making forecasts.</p>
</div>
<div id="example-cpi-and-ppi" class="section level2 hasAnchor" number="15.3">
<h2><span class="header-section-number">15.3</span> Example: CPI and PPI<a href="time-series-forecasting.html#example-cpi-and-ppi" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Suppose that we wish to forecast inflation, as measured by the Consumer Price Index (CPI) using an ARIMA model. In particular, we would like to forecast monthly inflation for twelve months.</p>
<p>To begin with, here is some code importing the data, and wrangling it into a usable format.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="time-series-forecasting.html#cb313-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb313-2"><a href="time-series-forecasting.html#cb313-2" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb313-3"><a href="time-series-forecasting.html#cb313-3" tabindex="-1"></a></span>
<span id="cb313-4"><a href="time-series-forecasting.html#cb313-4" tabindex="-1"></a>CPI<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;data/CPIAUCSL.csv&quot;</span>)</span>
<span id="cb313-5"><a href="time-series-forecasting.html#cb313-5" tabindex="-1"></a>PPI<span class="ot">&lt;-</span><span class="fu">read.csv</span>(<span class="st">&quot;data/PPIACO.csv&quot;</span>)</span>
<span id="cb313-6"><a href="time-series-forecasting.html#cb313-6" tabindex="-1"></a></span>
<span id="cb313-7"><a href="time-series-forecasting.html#cb313-7" tabindex="-1"></a>D<span class="ot">&lt;-</span>CPI <span class="sc">|&gt;</span> </span>
<span id="cb313-8"><a href="time-series-forecasting.html#cb313-8" tabindex="-1"></a>  <span class="fu">left_join</span>(PPI,<span class="at">by=</span><span class="st">&quot;DATE&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb313-9"><a href="time-series-forecasting.html#cb313-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">DATE =</span> DATE <span class="sc">|&gt;</span> <span class="fu">ymd</span>())</span>
<span id="cb313-10"><a href="time-series-forecasting.html#cb313-10" tabindex="-1"></a></span>
<span id="cb313-11"><a href="time-series-forecasting.html#cb313-11" tabindex="-1"></a>D <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">DATE</th>
<th align="right">CPIAUCSL</th>
<th align="right">PPIACO</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1947-01-01</td>
<td align="right">21.48</td>
<td align="right">24.5</td>
</tr>
<tr class="even">
<td align="left">1947-02-01</td>
<td align="right">21.62</td>
<td align="right">24.7</td>
</tr>
<tr class="odd">
<td align="left">1947-03-01</td>
<td align="right">22.00</td>
<td align="right">25.3</td>
</tr>
<tr class="even">
<td align="left">1947-04-01</td>
<td align="right">22.00</td>
<td align="right">25.1</td>
</tr>
<tr class="odd">
<td align="left">1947-05-01</td>
<td align="right">21.95</td>
<td align="right">25.0</td>
</tr>
<tr class="even">
<td align="left">1947-06-01</td>
<td align="right">22.08</td>
<td align="right">25.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="time-series-forecasting.html#cb314-1" tabindex="-1"></a>(</span>
<span id="cb314-2"><a href="time-series-forecasting.html#cb314-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>D,<span class="fu">aes</span>(<span class="at">x=</span>DATE))</span>
<span id="cb314-3"><a href="time-series-forecasting.html#cb314-3" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>CPIAUCSL,<span class="at">color=</span><span class="st">&quot;CPI&quot;</span>))</span>
<span id="cb314-4"><a href="time-series-forecasting.html#cb314-4" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>PPIACO,<span class="at">color=</span><span class="st">&quot;PPI&quot;</span>))</span>
<span id="cb314-5"><a href="time-series-forecasting.html#cb314-5" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb314-6"><a href="time-series-forecasting.html#cb314-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title  =</span> <span class="st">&quot;CPI and PPI (levels)&quot;</span>)</span>
<span id="cb314-7"><a href="time-series-forecasting.html#cb314-7" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-338-1.png" width="672" /></p>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="time-series-forecasting.html#cb315-1" tabindex="-1"></a>D <span class="ot">&lt;-</span> D <span class="sc">|&gt;</span></span>
<span id="cb315-2"><a href="time-series-forecasting.html#cb315-2" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">CPIinflation =</span> <span class="fu">log</span>(CPIAUCSL)<span class="sc">-</span><span class="fu">log</span>(<span class="fu">lag</span>(CPIAUCSL,<span class="at">n=</span><span class="dv">12</span>)),</span>
<span id="cb315-3"><a href="time-series-forecasting.html#cb315-3" tabindex="-1"></a>         <span class="at">PPIinflation =</span> <span class="fu">log</span>(PPIACO)<span class="sc">-</span><span class="fu">log</span>(<span class="fu">lag</span>(PPIACO,<span class="at">n=</span><span class="dv">12</span>))</span>
<span id="cb315-4"><a href="time-series-forecasting.html#cb315-4" tabindex="-1"></a>         )</span>
<span id="cb315-5"><a href="time-series-forecasting.html#cb315-5" tabindex="-1"></a></span>
<span id="cb315-6"><a href="time-series-forecasting.html#cb315-6" tabindex="-1"></a>(</span>
<span id="cb315-7"><a href="time-series-forecasting.html#cb315-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="at">data=</span>D,<span class="fu">aes</span>(<span class="at">x=</span>DATE))</span>
<span id="cb315-8"><a href="time-series-forecasting.html#cb315-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>CPIinflation,<span class="at">color=</span><span class="st">&quot;CPI&quot;</span>))</span>
<span id="cb315-9"><a href="time-series-forecasting.html#cb315-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>PPIinflation,<span class="at">color=</span><span class="st">&quot;PPI&quot;</span>))</span>
<span id="cb315-10"><a href="time-series-forecasting.html#cb315-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Inflation&quot;</span>)</span>
<span id="cb315-11"><a href="time-series-forecasting.html#cb315-11" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb315-12"><a href="time-series-forecasting.html#cb315-12" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">labs</span>(<span class="at">title  =</span> <span class="st">&quot;CPI and PPI (inflation)&quot;</span>)</span>
<span id="cb315-13"><a href="time-series-forecasting.html#cb315-13" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-338-2.png" width="672" /></p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="time-series-forecasting.html#cb316-1" tabindex="-1"></a><span class="fu">saveRDS</span>(D,<span class="at">file=</span><span class="st">&quot;data/CPI_PPI.rds&quot;</span>)</span></code></pre></div>
<p>Once we have decided on a model, it is fairly easy to make this kind of forecast:</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="time-series-forecasting.html#cb317-1" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">arima</span>(D<span class="sc">$</span>CPIinflation,<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb317-2"><a href="time-series-forecasting.html#cb317-2" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-339-1.png" width="672" /></p>
<p>However even with just one additional explanatory variable, there are many models that we could choose from. Using cross-validation, we will investigate every combination model based on the following permutations:</p>
<ul>
<li>Between zero and 12 AR and MA lags</li>
<li>Including or not including lagged PPI as an explanatory variable</li>
</ul>
<p>We will start by just focusing on the AR and MA components of the model, then build it up to include PPI as an additional explanatory variable.</p>
<div id="using-just-ar-and-ma-components" class="section level3 hasAnchor" number="15.3.1">
<h3><span class="header-section-number">15.3.1</span> Using just AR and MA components<a href="time-series-forecasting.html#using-just-ar-and-ma-components" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start by trying to forecast the final 12 months of data that we have available. If we are using and <span class="math inline">\(ARMA(p,q)\)</span>, the code to estimate it is and make a forecast is</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="time-series-forecasting.html#cb318-1" tabindex="-1"></a>Y<span class="ot">&lt;-</span>D<span class="sc">$</span>CPIinflation</span>
<span id="cb318-2"><a href="time-series-forecasting.html#cb318-2" tabindex="-1"></a></span>
<span id="cb318-3"><a href="time-series-forecasting.html#cb318-3" tabindex="-1"></a>Y<span class="ot">&lt;-</span>Y[<span class="sc">!</span><span class="fu">is.na</span>(Y)]</span>
<span id="cb318-4"><a href="time-series-forecasting.html#cb318-4" tabindex="-1"></a></span>
<span id="cb318-5"><a href="time-series-forecasting.html#cb318-5" tabindex="-1"></a>n<span class="ot">&lt;-</span>Y <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb318-6"><a href="time-series-forecasting.html#cb318-6" tabindex="-1"></a></span>
<span id="cb318-7"><a href="time-series-forecasting.html#cb318-7" tabindex="-1"></a>y<span class="ot">&lt;-</span>Y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-12</span>)]</span>
<span id="cb318-8"><a href="time-series-forecasting.html#cb318-8" tabindex="-1"></a></span>
<span id="cb318-9"><a href="time-series-forecasting.html#cb318-9" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb318-10"><a href="time-series-forecasting.html#cb318-10" tabindex="-1"></a>q<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb318-11"><a href="time-series-forecasting.html#cb318-11" tabindex="-1"></a></span>
<span id="cb318-12"><a href="time-series-forecasting.html#cb318-12" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">arima</span>(y,<span class="at">order =</span> <span class="fu">c</span>(p,<span class="dv">0</span>,q))</span>
<span id="cb318-13"><a href="time-series-forecasting.html#cb318-13" tabindex="-1"></a></span>
<span id="cb318-14"><a href="time-series-forecasting.html#cb318-14" tabindex="-1"></a>y_forecast<span class="ot">&lt;-</span><span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>)</span></code></pre></div>
<p>And so our comparison for cross-validation is:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="time-series-forecasting.html#cb319-1" tabindex="-1"></a>comparison<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">tibble</span>(<span class="at">actual =</span> Y[(n<span class="dv">-12</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n]),y_forecast) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb319-2"><a href="time-series-forecasting.html#cb319-2" tabindex="-1"></a></span>
<span id="cb319-3"><a href="time-series-forecasting.html#cb319-3" tabindex="-1"></a>(</span>
<span id="cb319-4"><a href="time-series-forecasting.html#cb319-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(comparison,<span class="fu">aes</span>(<span class="at">x=</span>t))</span>
<span id="cb319-5"><a href="time-series-forecasting.html#cb319-5" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>actual,<span class="at">color=</span><span class="st">&quot;Actual&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;Actual&quot;</span>),<span class="at">linewidth=</span><span class="dv">2</span>)</span>
<span id="cb319-6"><a href="time-series-forecasting.html#cb319-6" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>,<span class="at">color=</span><span class="st">&quot;Forecast&quot;</span>,<span class="at">fill =</span> <span class="st">&quot;Forecast&quot;</span>),<span class="at">linewidth=</span><span class="dv">2</span>)</span>
<span id="cb319-7"><a href="time-series-forecasting.html#cb319-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>,<span class="at">ymax =</span> <span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>,<span class="at">color=</span><span class="st">&quot;Forecast&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Forecast&quot;</span>),<span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb319-8"><a href="time-series-forecasting.html#cb319-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_ribbon</span>(<span class="fu">aes</span>(<span class="at">ymin=</span><span class="st">`</span><span class="at">Lo 80</span><span class="st">`</span>,<span class="at">ymax =</span> <span class="st">`</span><span class="at">Hi 80</span><span class="st">`</span>,<span class="at">color=</span><span class="st">&quot;Forecast&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Forecast&quot;</span>),<span class="at">alpha=</span><span class="fl">0.3</span>)</span>
<span id="cb319-9"><a href="time-series-forecasting.html#cb319-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;inflation&quot;</span>)</span>
<span id="cb319-10"><a href="time-series-forecasting.html#cb319-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb319-11"><a href="time-series-forecasting.html#cb319-11" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-341-1.png" width="672" /></p>
<p>And our mean squared prediction error is:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="time-series-forecasting.html#cb320-1" tabindex="-1"></a><span class="fu">mean</span>((comparison<span class="sc">$</span>actual<span class="sc">-</span>comparison<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 8.540633e-05</code></pre>
<p>Here is where things slow down a lot, so I am going to code up the rest as a script, and run it elsewhere.</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="time-series-forecasting.html#cb322-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb322-2"><a href="time-series-forecasting.html#cb322-2" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb322-3"><a href="time-series-forecasting.html#cb322-3" tabindex="-1"></a></span>
<span id="cb322-4"><a href="time-series-forecasting.html#cb322-4" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;data/CPI_PPI.rds&quot;</span>)</span>
<span id="cb322-5"><a href="time-series-forecasting.html#cb322-5" tabindex="-1"></a></span>
<span id="cb322-6"><a href="time-series-forecasting.html#cb322-6" tabindex="-1"></a>Y<span class="ot">&lt;-</span>D<span class="sc">$</span>CPIinflation</span>
<span id="cb322-7"><a href="time-series-forecasting.html#cb322-7" tabindex="-1"></a></span>
<span id="cb322-8"><a href="time-series-forecasting.html#cb322-8" tabindex="-1"></a>Y<span class="ot">&lt;-</span>Y[<span class="sc">!</span><span class="fu">is.na</span>(Y)]</span>
<span id="cb322-9"><a href="time-series-forecasting.html#cb322-9" tabindex="-1"></a></span>
<span id="cb322-10"><a href="time-series-forecasting.html#cb322-10" tabindex="-1"></a>n<span class="ot">&lt;-</span>Y <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb322-11"><a href="time-series-forecasting.html#cb322-11" tabindex="-1"></a></span>
<span id="cb322-12"><a href="time-series-forecasting.html#cb322-12" tabindex="-1"></a>y<span class="ot">&lt;-</span>Y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-12</span>)]</span>
<span id="cb322-13"><a href="time-series-forecasting.html#cb322-13" tabindex="-1"></a></span>
<span id="cb322-14"><a href="time-series-forecasting.html#cb322-14" tabindex="-1"></a></span>
<span id="cb322-15"><a href="time-series-forecasting.html#cb322-15" tabindex="-1"></a>maxLags<span class="ot">&lt;-</span><span class="dv">12</span></span>
<span id="cb322-16"><a href="time-series-forecasting.html#cb322-16" tabindex="-1"></a>maxYears<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb322-17"><a href="time-series-forecasting.html#cb322-17" tabindex="-1"></a></span>
<span id="cb322-18"><a href="time-series-forecasting.html#cb322-18" tabindex="-1"></a>MSE<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb322-19"><a href="time-series-forecasting.html#cb322-19" tabindex="-1"></a></span>
<span id="cb322-20"><a href="time-series-forecasting.html#cb322-20" tabindex="-1"></a><span class="cf">for</span> (pp <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>maxLags) {</span>
<span id="cb322-21"><a href="time-series-forecasting.html#cb322-21" tabindex="-1"></a><span class="cf">for</span> (qq <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>maxLags) {</span>
<span id="cb322-22"><a href="time-series-forecasting.html#cb322-22" tabindex="-1"></a>  </span>
<span id="cb322-23"><a href="time-series-forecasting.html#cb322-23" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Evaluating ARMA(&quot;</span>,pp,<span class="st">&quot;,&quot;</span>,qq,<span class="st">&quot;) model&quot;</span>))</span>
<span id="cb322-24"><a href="time-series-forecasting.html#cb322-24" tabindex="-1"></a>  </span>
<span id="cb322-25"><a href="time-series-forecasting.html#cb322-25" tabindex="-1"></a>  <span class="cf">for</span> (yy <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxYears) {</span>
<span id="cb322-26"><a href="time-series-forecasting.html#cb322-26" tabindex="-1"></a>    </span>
<span id="cb322-27"><a href="time-series-forecasting.html#cb322-27" tabindex="-1"></a>    </span>
<span id="cb322-28"><a href="time-series-forecasting.html#cb322-28" tabindex="-1"></a>    <span class="co"># Training dataset: Use the last yy years of data</span></span>
<span id="cb322-29"><a href="time-series-forecasting.html#cb322-29" tabindex="-1"></a>    y<span class="ot">&lt;-</span>Y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-12</span><span class="sc">*</span>yy)]</span>
<span id="cb322-30"><a href="time-series-forecasting.html#cb322-30" tabindex="-1"></a>    <span class="co"># Estimate the model</span></span>
<span id="cb322-31"><a href="time-series-forecasting.html#cb322-31" tabindex="-1"></a>    model<span class="ot">&lt;-</span><span class="fu">arima</span>(y,<span class="at">order =</span> <span class="fu">c</span>(pp,<span class="dv">0</span>,qq),<span class="at">method=</span><span class="st">&quot;CSS&quot;</span>)</span>
<span id="cb322-32"><a href="time-series-forecasting.html#cb322-32" tabindex="-1"></a>    <span class="co"># Forecast 12 months into the future</span></span>
<span id="cb322-33"><a href="time-series-forecasting.html#cb322-33" tabindex="-1"></a>    y_forecast<span class="ot">&lt;-</span><span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb322-34"><a href="time-series-forecasting.html#cb322-34" tabindex="-1"></a>    <span class="co"># Compare </span></span>
<span id="cb322-35"><a href="time-series-forecasting.html#cb322-35" tabindex="-1"></a>    comparison<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">tibble</span>(<span class="at">actual =</span> Y[(n<span class="dv">-12</span><span class="sc">*</span>yy<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="dv">-12</span><span class="sc">*</span>yy<span class="sc">+</span><span class="dv">12</span>)]),y_forecast) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb322-36"><a href="time-series-forecasting.html#cb322-36" tabindex="-1"></a>    <span class="co"># Compute MSE</span></span>
<span id="cb322-37"><a href="time-series-forecasting.html#cb322-37" tabindex="-1"></a>    mse<span class="ot">&lt;-</span><span class="fu">mean</span>((comparison<span class="sc">$</span>actual<span class="sc">-</span>comparison<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb322-38"><a href="time-series-forecasting.html#cb322-38" tabindex="-1"></a>    <span class="co"># Store the results</span></span>
<span id="cb322-39"><a href="time-series-forecasting.html#cb322-39" tabindex="-1"></a>    MSE<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb322-40"><a href="time-series-forecasting.html#cb322-40" tabindex="-1"></a>      MSE,</span>
<span id="cb322-41"><a href="time-series-forecasting.html#cb322-41" tabindex="-1"></a>      <span class="fu">tibble</span>(<span class="at">AR =</span> pp,<span class="at">MA =</span> qq,<span class="at">years =</span> yy,<span class="at">mse =</span> mse)</span>
<span id="cb322-42"><a href="time-series-forecasting.html#cb322-42" tabindex="-1"></a>    )</span>
<span id="cb322-43"><a href="time-series-forecasting.html#cb322-43" tabindex="-1"></a>  }</span>
<span id="cb322-44"><a href="time-series-forecasting.html#cb322-44" tabindex="-1"></a>}</span>
<span id="cb322-45"><a href="time-series-forecasting.html#cb322-45" tabindex="-1"></a>}</span>
<span id="cb322-46"><a href="time-series-forecasting.html#cb322-46" tabindex="-1"></a></span>
<span id="cb322-47"><a href="time-series-forecasting.html#cb322-47" tabindex="-1"></a><span class="fu">saveRDS</span>(MSE,<span class="at">file=</span><span class="st">&quot;data/CPI_PPI_ARMAforecasting.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="time-series-forecasting.html#cb323-1" tabindex="-1"></a>MSE<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;data/CPI_PPI_ARMAforecasting.rds&quot;</span>)</span>
<span id="cb323-2"><a href="time-series-forecasting.html#cb323-2" tabindex="-1"></a></span>
<span id="cb323-3"><a href="time-series-forecasting.html#cb323-3" tabindex="-1"></a>MSEsummary<span class="ot">&lt;-</span>(</span>
<span id="cb323-4"><a href="time-series-forecasting.html#cb323-4" tabindex="-1"></a>  MSE</span>
<span id="cb323-5"><a href="time-series-forecasting.html#cb323-5" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(AR,MA)</span>
<span id="cb323-6"><a href="time-series-forecasting.html#cb323-6" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">mse =</span> <span class="fu">mean</span>(mse))</span>
<span id="cb323-7"><a href="time-series-forecasting.html#cb323-7" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mse)</span>
<span id="cb323-8"><a href="time-series-forecasting.html#cb323-8" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;AR&#39;. You can override using the `.groups`
## argument.</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="time-series-forecasting.html#cb325-1" tabindex="-1"></a>(selectedModel<span class="ot">&lt;-</span>MSEsummary[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
## # Groups:   AR [1]
##      AR    MA      mse
##   &lt;int&gt; &lt;int&gt;    &lt;dbl&gt;
## 1    12     8 0.000115</code></pre>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="time-series-forecasting.html#cb327-1" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">arima</span>(Y,<span class="at">order =</span> <span class="fu">c</span>(selectedModel<span class="sc">$</span>AR,<span class="dv">0</span>,selectedModel<span class="sc">$</span>MA))</span>
<span id="cb327-2"><a href="time-series-forecasting.html#cb327-2" tabindex="-1"></a></span>
<span id="cb327-3"><a href="time-series-forecasting.html#cb327-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-344-1.png" width="672" /></p>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="time-series-forecasting.html#cb328-1" tabindex="-1"></a>fcst<span class="ot">&lt;-</span><span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb328-2"><a href="time-series-forecasting.html#cb328-2" tabindex="-1"></a></span>
<span id="cb328-3"><a href="time-series-forecasting.html#cb328-3" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(Y,fcst<span class="sc">$</span>mean),<span class="at">ymin =</span> <span class="fu">c</span>(Y,fcst<span class="sc">$</span>lower[,<span class="dv">1</span>]),<span class="at">ymax =</span> <span class="fu">c</span>(Y,fcst<span class="sc">$</span>upper[,<span class="dv">1</span>])) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">forecast =</span> <span class="fu">abs</span>(t<span class="sc">-</span><span class="fu">n</span>())<span class="sc">&lt;=</span><span class="dv">12</span>)</span>
<span id="cb328-4"><a href="time-series-forecasting.html#cb328-4" tabindex="-1"></a></span>
<span id="cb328-5"><a href="time-series-forecasting.html#cb328-5" tabindex="-1"></a>(</span>
<span id="cb328-6"><a href="time-series-forecasting.html#cb328-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(d <span class="sc">|&gt;</span> <span class="fu">filter</span>(t<span class="sc">&gt;</span><span class="dv">850</span>),<span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>y,<span class="at">color=</span>forecast,<span class="at">ymin=</span>ymin,<span class="at">ymax=</span>ymax))</span>
<span id="cb328-7"><a href="time-series-forecasting.html#cb328-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb328-8"><a href="time-series-forecasting.html#cb328-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>() </span>
<span id="cb328-9"><a href="time-series-forecasting.html#cb328-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb328-10"><a href="time-series-forecasting.html#cb328-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Inflation (CPI)&quot;</span>)</span>
<span id="cb328-11"><a href="time-series-forecasting.html#cb328-11" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-344-2.png" width="672" /></p>
</div>
<div id="incorporating-some-seasonality" class="section level3 hasAnchor" number="15.3.2">
<h3><span class="header-section-number">15.3.2</span> Incorporating some seasonality<a href="time-series-forecasting.html#incorporating-some-seasonality" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here I will just focus on estimating AR models. There is no reason one needs to exclude the MA components, but it will speed up the process in class. In particular, let’s focus attention on models with a fixed number of parameters, say 10. That is:</p>
<p><span class="math display">\[
\text{number of 1-period lags } + \text{ number of seasonal lags } = 10
\]</span></p>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="time-series-forecasting.html#cb329-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb329-2"><a href="time-series-forecasting.html#cb329-2" tabindex="-1"></a><span class="fu">library</span>(forecast)</span>
<span id="cb329-3"><a href="time-series-forecasting.html#cb329-3" tabindex="-1"></a></span>
<span id="cb329-4"><a href="time-series-forecasting.html#cb329-4" tabindex="-1"></a>D<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;data/CPI_PPI.rds&quot;</span>)</span>
<span id="cb329-5"><a href="time-series-forecasting.html#cb329-5" tabindex="-1"></a></span>
<span id="cb329-6"><a href="time-series-forecasting.html#cb329-6" tabindex="-1"></a>Y<span class="ot">&lt;-</span>D<span class="sc">$</span>CPIinflation</span>
<span id="cb329-7"><a href="time-series-forecasting.html#cb329-7" tabindex="-1"></a></span>
<span id="cb329-8"><a href="time-series-forecasting.html#cb329-8" tabindex="-1"></a>Y<span class="ot">&lt;-</span>Y[<span class="sc">!</span><span class="fu">is.na</span>(Y)]</span>
<span id="cb329-9"><a href="time-series-forecasting.html#cb329-9" tabindex="-1"></a></span>
<span id="cb329-10"><a href="time-series-forecasting.html#cb329-10" tabindex="-1"></a>n<span class="ot">&lt;-</span>Y <span class="sc">|&gt;</span> <span class="fu">length</span>()</span>
<span id="cb329-11"><a href="time-series-forecasting.html#cb329-11" tabindex="-1"></a></span>
<span id="cb329-12"><a href="time-series-forecasting.html#cb329-12" tabindex="-1"></a>y<span class="ot">&lt;-</span>Y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-12</span>)]</span>
<span id="cb329-13"><a href="time-series-forecasting.html#cb329-13" tabindex="-1"></a></span>
<span id="cb329-14"><a href="time-series-forecasting.html#cb329-14" tabindex="-1"></a></span>
<span id="cb329-15"><a href="time-series-forecasting.html#cb329-15" tabindex="-1"></a>maxLags<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb329-16"><a href="time-series-forecasting.html#cb329-16" tabindex="-1"></a>maxYears<span class="ot">&lt;-</span><span class="dv">10</span></span>
<span id="cb329-17"><a href="time-series-forecasting.html#cb329-17" tabindex="-1"></a></span>
<span id="cb329-18"><a href="time-series-forecasting.html#cb329-18" tabindex="-1"></a>MSE<span class="ot">&lt;-</span><span class="fu">tibble</span>()</span>
<span id="cb329-19"><a href="time-series-forecasting.html#cb329-19" tabindex="-1"></a></span>
<span id="cb329-20"><a href="time-series-forecasting.html#cb329-20" tabindex="-1"></a><span class="cf">for</span> (pp <span class="cf">in</span> <span class="dv">0</span><span class="sc">:</span>maxLags) {</span>
<span id="cb329-21"><a href="time-series-forecasting.html#cb329-21" tabindex="-1"></a></span>
<span id="cb329-22"><a href="time-series-forecasting.html#cb329-22" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Evaluating model with &quot;</span>, pp ,<span class="st">&quot; 1-period lags and &quot;</span>,maxLags<span class="sc">-</span>pp,<span class="st">&quot; seasonal lags&quot;</span>))</span>
<span id="cb329-23"><a href="time-series-forecasting.html#cb329-23" tabindex="-1"></a>  </span>
<span id="cb329-24"><a href="time-series-forecasting.html#cb329-24" tabindex="-1"></a>  <span class="cf">for</span> (yy <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>maxYears) {</span>
<span id="cb329-25"><a href="time-series-forecasting.html#cb329-25" tabindex="-1"></a>    </span>
<span id="cb329-26"><a href="time-series-forecasting.html#cb329-26" tabindex="-1"></a>    </span>
<span id="cb329-27"><a href="time-series-forecasting.html#cb329-27" tabindex="-1"></a>    <span class="co"># Training dataset: Use the last yy years of data</span></span>
<span id="cb329-28"><a href="time-series-forecasting.html#cb329-28" tabindex="-1"></a>    y<span class="ot">&lt;-</span>Y[<span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-12</span><span class="sc">*</span>yy)]</span>
<span id="cb329-29"><a href="time-series-forecasting.html#cb329-29" tabindex="-1"></a>    <span class="co"># Estimate the model</span></span>
<span id="cb329-30"><a href="time-series-forecasting.html#cb329-30" tabindex="-1"></a>    model<span class="ot">&lt;-</span><span class="fu">arima</span>(y,<span class="at">order =</span> <span class="fu">c</span>(pp,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">seasonal =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(maxLags<span class="sc">-</span>pp,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">period=</span><span class="dv">12</span>),<span class="at">method=</span><span class="st">&quot;CSS&quot;</span>)</span>
<span id="cb329-31"><a href="time-series-forecasting.html#cb329-31" tabindex="-1"></a>    <span class="co"># Forecast 12 months into the future</span></span>
<span id="cb329-32"><a href="time-series-forecasting.html#cb329-32" tabindex="-1"></a>    y_forecast<span class="ot">&lt;-</span><span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb329-33"><a href="time-series-forecasting.html#cb329-33" tabindex="-1"></a>    <span class="co"># Compare </span></span>
<span id="cb329-34"><a href="time-series-forecasting.html#cb329-34" tabindex="-1"></a>    comparison<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">tibble</span>(<span class="at">actual =</span> Y[(n<span class="dv">-12</span><span class="sc">*</span>yy<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n<span class="dv">-12</span><span class="sc">*</span>yy<span class="sc">+</span><span class="dv">12</span>)]),y_forecast) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>())</span>
<span id="cb329-35"><a href="time-series-forecasting.html#cb329-35" tabindex="-1"></a>    <span class="co"># Compute MSE</span></span>
<span id="cb329-36"><a href="time-series-forecasting.html#cb329-36" tabindex="-1"></a>    mse<span class="ot">&lt;-</span><span class="fu">mean</span>((comparison<span class="sc">$</span>actual<span class="sc">-</span>comparison<span class="sc">$</span><span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb329-37"><a href="time-series-forecasting.html#cb329-37" tabindex="-1"></a>    <span class="co"># Store the results</span></span>
<span id="cb329-38"><a href="time-series-forecasting.html#cb329-38" tabindex="-1"></a>    MSE<span class="ot">&lt;-</span><span class="fu">rbind</span>(</span>
<span id="cb329-39"><a href="time-series-forecasting.html#cb329-39" tabindex="-1"></a>      MSE,</span>
<span id="cb329-40"><a href="time-series-forecasting.html#cb329-40" tabindex="-1"></a>      <span class="fu">tibble</span>(<span class="at">AR =</span> pp,<span class="at">years =</span> yy,<span class="at">mse =</span> mse)</span>
<span id="cb329-41"><a href="time-series-forecasting.html#cb329-41" tabindex="-1"></a>    )</span>
<span id="cb329-42"><a href="time-series-forecasting.html#cb329-42" tabindex="-1"></a>  }</span>
<span id="cb329-43"><a href="time-series-forecasting.html#cb329-43" tabindex="-1"></a>}</span>
<span id="cb329-44"><a href="time-series-forecasting.html#cb329-44" tabindex="-1"></a></span>
<span id="cb329-45"><a href="time-series-forecasting.html#cb329-45" tabindex="-1"></a><span class="fu">saveRDS</span>(MSE,<span class="at">file=</span><span class="st">&quot;data/CPI_PPI_ARMAforecasting_seasonal.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="time-series-forecasting.html#cb330-1" tabindex="-1"></a>MSE<span class="ot">&lt;-</span><span class="fu">readRDS</span>(<span class="st">&quot;data/CPI_PPI_ARMAforecasting_seasonal.rds&quot;</span>)</span>
<span id="cb330-2"><a href="time-series-forecasting.html#cb330-2" tabindex="-1"></a></span>
<span id="cb330-3"><a href="time-series-forecasting.html#cb330-3" tabindex="-1"></a>MSEsummary<span class="ot">&lt;-</span>(</span>
<span id="cb330-4"><a href="time-series-forecasting.html#cb330-4" tabindex="-1"></a>  MSE</span>
<span id="cb330-5"><a href="time-series-forecasting.html#cb330-5" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">group_by</span>(AR)</span>
<span id="cb330-6"><a href="time-series-forecasting.html#cb330-6" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">mse =</span> <span class="fu">mean</span>(mse))</span>
<span id="cb330-7"><a href="time-series-forecasting.html#cb330-7" tabindex="-1"></a>  <span class="sc">|&gt;</span> <span class="fu">arrange</span>(mse)</span>
<span id="cb330-8"><a href="time-series-forecasting.html#cb330-8" tabindex="-1"></a>)</span>
<span id="cb330-9"><a href="time-series-forecasting.html#cb330-9" tabindex="-1"></a> </span>
<span id="cb330-10"><a href="time-series-forecasting.html#cb330-10" tabindex="-1"></a>(selectedModel<span class="ot">&lt;-</span>MSEsummary[<span class="dv">1</span>,])</span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##      AR      mse
##   &lt;int&gt;    &lt;dbl&gt;
## 1     5 0.000171</code></pre>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="time-series-forecasting.html#cb332-1" tabindex="-1"></a>model<span class="ot">&lt;-</span><span class="fu">arima</span>(Y,<span class="at">order =</span> <span class="fu">c</span>(selectedModel<span class="sc">$</span>AR,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">seasonal=</span><span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">-</span>selectedModel<span class="sc">$</span>AR,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">period=</span><span class="dv">12</span>),<span class="at">method=</span><span class="st">&quot;CSS&quot;</span>)</span>
<span id="cb332-2"><a href="time-series-forecasting.html#cb332-2" tabindex="-1"></a></span>
<span id="cb332-3"><a href="time-series-forecasting.html#cb332-3" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>))</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-346-1.png" width="672" /></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="time-series-forecasting.html#cb333-1" tabindex="-1"></a>fcst<span class="ot">&lt;-</span><span class="fu">forecast</span>(model,<span class="at">h=</span><span class="dv">12</span>)</span>
<span id="cb333-2"><a href="time-series-forecasting.html#cb333-2" tabindex="-1"></a></span>
<span id="cb333-3"><a href="time-series-forecasting.html#cb333-3" tabindex="-1"></a>d<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">y =</span> <span class="fu">c</span>(Y,fcst<span class="sc">$</span>mean),<span class="at">ymin =</span> <span class="fu">c</span>(Y,fcst<span class="sc">$</span>lower[,<span class="dv">1</span>]),<span class="at">ymax =</span> <span class="fu">c</span>(Y,fcst<span class="sc">$</span>upper[,<span class="dv">1</span>])) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">n</span>(),<span class="at">forecast =</span> <span class="fu">abs</span>(t<span class="sc">-</span><span class="fu">n</span>())<span class="sc">&lt;=</span><span class="dv">12</span>)</span>
<span id="cb333-4"><a href="time-series-forecasting.html#cb333-4" tabindex="-1"></a></span>
<span id="cb333-5"><a href="time-series-forecasting.html#cb333-5" tabindex="-1"></a>(</span>
<span id="cb333-6"><a href="time-series-forecasting.html#cb333-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(d <span class="sc">|&gt;</span> <span class="fu">filter</span>(t<span class="sc">&gt;</span><span class="dv">850</span>),<span class="fu">aes</span>(<span class="at">x=</span>t,<span class="at">y=</span>y,<span class="at">color=</span>forecast,<span class="at">ymin=</span>ymin,<span class="at">ymax=</span>ymax))</span>
<span id="cb333-7"><a href="time-series-forecasting.html#cb333-7" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb333-8"><a href="time-series-forecasting.html#cb333-8" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">theme_bw</span>()</span>
<span id="cb333-9"><a href="time-series-forecasting.html#cb333-9" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">ylab</span>(<span class="st">&quot;Inflation (CPI)&quot;</span>)</span>
<span id="cb333-10"><a href="time-series-forecasting.html#cb333-10" tabindex="-1"></a>  <span class="sc">+</span><span class="fu">geom_ribbon</span>(<span class="at">alpha=</span><span class="fl">0.2</span>)</span>
<span id="cb333-11"><a href="time-series-forecasting.html#cb333-11" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="index_files/figure-html/unnamed-chunk-346-2.png" width="672" /></p>
</div>
<div id="incorporating-ppi-inflation" class="section level3 hasAnchor" number="15.3.3">
<h3><span class="header-section-number">15.3.3</span> Incorporating PPI inflation<a href="time-series-forecasting.html#incorporating-ppi-inflation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="time-series-forecasting.html#cb334-1" tabindex="-1"></a>X<span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="fu">lag</span>(D<span class="sc">$</span>PPIinflation,<span class="at">n=</span><span class="dv">1</span>),<span class="fu">lag</span>(D<span class="sc">$</span>PPIinflation,<span class="at">n=</span><span class="dv">2</span>),<span class="fu">lag</span>(D<span class="sc">$</span>PPIinflation,<span class="at">n=</span><span class="dv">3</span>))</span>
<span id="cb334-2"><a href="time-series-forecasting.html#cb334-2" tabindex="-1"></a>fit<span class="ot">&lt;-</span> <span class="fu">arima</span>(D<span class="sc">$</span>CPIinflation,<span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">2</span>),<span class="at">xreg =</span> X)</span>
<span id="cb334-3"><a href="time-series-forecasting.html#cb334-3" tabindex="-1"></a></span>
<span id="cb334-4"><a href="time-series-forecasting.html#cb334-4" tabindex="-1"></a>fit</span></code></pre></div>
<pre><code>## 
## Call:
## arima(x = D$CPIinflation, order = c(2, 0, 2), xreg = X)
## 
## Coefficients:
##          ar1      ar2     ma1     ma2  intercept      X1      X2      X3
##       1.0216  -0.0447  0.2106  0.0566     0.0317  0.0872  0.0289  0.0184
## s.e.  0.7088   0.6930  0.7096  0.1799     0.0065  0.0140  0.0137  0.0147
## 
## sigma^2 estimated as 1.379e-05:  log likelihood = 3807.41,  aic = -7596.81</code></pre>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="time-series-introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="additional-exercises.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
